;---------------------------------------------------------------------

;---------------------------------------------------------------------
; 基本設定
[Data]
life = 1000          ; 体力ゲージ、上限値（デフォルト：1000）
power = 5000         ; パワーゲージ、デフォルト：1000
attack = 100         ; 攻撃力（％）
defence = 125        ; 防御力（％）
fall.defence_up = 50 ; 空中コンボ修正率（％）
liedown.time = 16    ; ダウン時間
airjuggle = 150       ; 空中コンボ
sparkno = -1          ; 初期ヒットスパーク番号
guard.sparkno = -1   ; 初期ガードスパーク番号
KO.echo = 0          ; ＫＯボイスエコー（0:OFF、1:ON）
volume = 0         ; キャラボイスボリューム値
IntPersistIndex = 32 ;次のラウンドに持ち越すVarを決める
FloatPersistIndex = 15;次のラウンドに持ち越すfVarを決める

[Size]
xscale = .5          ; 水平サイズ倍率
yscale = .5          ; 垂直サイズ倍率
ground.back = 24     ; キャラ幅（地上、後ろ側）
ground.front = 24    ; キャラ幅（地上、前側）
air.back = 24        ; キャラ幅（空中、後ろ側）
air.front = 24       ; キャラ幅（空中、前側）
z.width = 10         ; キャラ幅（ｚ軸）
height = 50          ; キャラの高さ（ジャンプで飛び越せる高さ）
attack.width = 4,4   ;Default attack width: back, front
attack.dist = 360    ;Default attack distance
proj.attack.dist = 90;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too   
head.pos = 6,-140    ; 頭部座標
mid.pos = -10,-90    ; 体中心部座標
shadowoffset = 0     ; キャラの影・オフセット値

[Velocity]
walk.fwd  = 2.2       ; 前進速度
walk.back = -2.0      ; 後退速度
run.fwd  = 3.0, 0  ; 前ダッシュ速度（y<0の場合、ホップステップ）
run.back = -3.5,-3.05  ; バックステップ速度（y=0の場合、走り）
jump.neu = 0,-11.5    ; 垂直ジャンプ速度
jump.fwd = 2.6        ; 前方ジャンプ速度
jump.back = -2.6      ; 後方ジャンプ速度
runjump.fwd = 3.4,-15.5      ;前方ハイジャンプ
runjump.back = -3.4,-15.5 ;後方ハイジャンプ
airjump.fwd = 4.0    ;前方空中ダッシュ
airjump.back = -4.0  ;後方空中ダッシュ

[Movement]
airjump.num = 0        ; 空中ジャンプ回数
;airjump.height = 35   ; 空中ジャンプ最低高度
yaccel = .56           ; キャラ重力加速度
stand.friction = .85   ; 摩擦係数（立ち状態）
crouch.friction = .82  ; 摩擦係数（しゃがみ状態）


;勝利ポーズ
[statedef 180]
type = S
movetype = I
physics = S
ctrl = 0
anim = 180
velset = 0,0

[state 180]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1
value = 10,ifelse(var(45)=10000,102,ifelse(numhelper(8800),101,ifelse(matchover,99+random%2,ifelse(random%2=1,99,88))))
channel = 1

;見よ、半兵衛…
[state 180]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1&&!numenemy
trigger1 = var(10) := floor(548*(TicksPerSecond/60))
value = 10,236
channel = 1
;9.129sec

;心の眼を開かぬ者に…誠の強さなど語れぬわ！
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=1 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(340*(TicksPerSecond/60))
value = 10,89
channel = 1
;5.658sec

;わが進軍こそ未来を拓く…うぬら武田には…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=2 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(406*(TicksPerSecond/60))
value = 10,90
channel = 1
;6.758sec

;さらばだ…わが友よ
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=3 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(190*(TicksPerSecond/60))
value = 10,91
channel = 1
;3.156sec

;我求めるは大儀なす力…夜郎自大の謀りなど・・・
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=6 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(509*(TicksPerSecond/60))
value = 10,92
channel = 1
;8.471sec

;駒を生かすは将の器…貴様の兵は…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=7 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(422*(TicksPerSecond/60))
value = 10,93
channel = 1
;7.023sec

;魔は滅せり！
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=9 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(158*(TicksPerSecond/60))
value = 10,94
channel = 1
;2.631sec

;神仏の加護など不要！この国は我が護る！
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=4 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(377*(TicksPerSecond/60))
value = 10,95
channel = 1
;6.269sec

;魔に魅入られし魂…哀れなり
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=5 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(275*(TicksPerSecond/60))
value = 10,96
channel = 1
;4.582sec

;この国の未来は、我が双肩にあり！
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=10 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(245*(TicksPerSecond/60))
value = 10,97
channel = 1
;4.083sec

;大儀なすには…竜は小さすぎる
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=11 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(261*(TicksPerSecond/60))
value = 10,98
channel = 1
;4.344sec

[state 180]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,1

;==WIN
[state -2]
type = Helper
triggerall = time=210 && matchover
trigger1 = !numpartner
trigger2 = numpartner
trigger2 = (ID-partner,ID)>0 && (partner,authorname="rei"||partner,authorname="gal129")&&partner,fvar(39)=7
id = 8600
stateno=8600
pos = 0,0
postype = back
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

;==PERFECT
[state -2]
type = Helper
triggerall = time=180 && !matchover && WinPerfect
trigger1 = !numpartner
trigger2 = numpartner
trigger2 = (ID-partner,ID)>0 && (partner,authorname="rei"||partner,authorname="gal129")&&partner,fvar(39)=7
id = 8650
stateno=8650
pos = 0,0
postype = back
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

[state 180]
type = AssertSpecial
trigger1 = ifelse(matchover,time<560,ifelse(!numenemy,1,time<360||var(10)!=0))
flag = roundnotover

;イントロ
[statedef 190]
type = S
ctrl = 0
velset = 0,0
anim = 190

;援軍ゲージ、一撃ゲージMAXに
[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(43) = 100000

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(42) = 200

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(41) = 200

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(40) = 1

[state 5900]
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
fvar(15) = 1.00

[state 190]
type = ChangeAnim
trigger1 = Anim=190&&((enemynear,stateno!=[190,199])||teamside=1||Time>=600)&&time>=60
value = 191

[state 190]
type = AssertSpecial
trigger1 = 1
flag = Intro

[state 190]
type = PlaySND
trigger1 = Anim=191&&AnimElem=2
value = 30,5

[state 190]
type = EnvShake
trigger1 = Anim=191&&AnimElem=2
time = 12
ample = 6

[state 190]
type = EnvShake
trigger1 = Anim=191&&AnimElem=3
time = 6
ample = 3

[state 190]
type = varadd
trigger1 = animelemtime(4)>0&&!var(10)&&var(7)
var(7) = -1

[state 190]
type = varset
trigger1 = animelemtime(4)>0&&!var(10)&&!var(7)
var(7) = 30
persistent=0

;竜よ…わが道を遮るか
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=4 && fvar(11)=1
trigger1 = var(10) := floor(212*(TicksPerSecond/60))
value = 10,78
channel = 1
;3.533sec

;来い小僧！…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=4 && fvar(11)=2
trigger1 = var(10) := floor(300*(TicksPerSecond/60))
value = 10,79
channel = 1
;4.997sec

;我が見するは未来…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=4 && fvar(11)=3
trigger1 = var(10) := floor(374*(TicksPerSecond/60))
value = 10,80
channel = 1
;6.221sec

;四国長曾我部！…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=4 && fvar(11)=6
trigger1 = var(10) := floor(351*(TicksPerSecond/60))
value = 10,81
channel = 1
;5.844sec

;国の未来のため…貴様の水軍は…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=4 && fvar(11)=7
trigger1 = var(10) := floor(311*(TicksPerSecond/60))
value = 10,82
channel = 1
;5.170sec

;信長…この国に蔓延る悪手よ…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=4 && fvar(11)=9
trigger1 = var(10) := floor(451*(TicksPerSecond/60))
value = 10,83
channel = 1
;7.502sec

;進軍の邪魔者は神仏とて薙ぎ払う！
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=4 && fvar(11)=4
trigger1 = var(10) := floor(222*(TicksPerSecond/60))
value = 10,84
channel = 1
;3.695sec

;市よ…お前には憐れみしか浮かばん
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=4 && fvar(11)=5
trigger1 = var(10) := floor(277*(TicksPerSecond/60))
value = 10,85
channel = 1
;4.601sec

;益無き争いは我も好まん…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=4 && fvar(11)=10
trigger1 = var(10) := floor(417*(TicksPerSecond/60))
value = 10,86
channel = 1
;6.940sec

;片倉…武将を…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=4 && fvar(11)=11
trigger1 = var(10) := floor(416*(TicksPerSecond/60))
value = 10,87
channel = 1
;6.933sec

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=4
trigger1 = var(10) := floor(ifelse(var(50)%2=0,219,180)*(TicksPerSecond/60))
value = 10,ifelse(var(50)%2=0,0,77)
channel = 1
;3.646sec
;2.992sec

[state 190]
type = ChangeAnim
trigger1 = Anim!=0&&AnimTime=0
value = 0

[state 190]
type = ChangeState
trigger1 = Anim=0 && !var(10) && !var(7)
value = 0

;挑発
[statedef 195]
type = S
movetype=I
physics = S
ctrl = 0
velset = 0,0
anim = 195
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 195]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=7
value = 10,ifelse(random%3!=0,53,44)
channel = 1

[state 195]
type = EnvShake
trigger1 = AnimElem=7
ampl = 4
time = 16

[state 195]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;立ち弱
[statedef 200]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !((movecontact||animelemtime(5)>0)&&prevstateno=200)
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !((movecontact||animelemtime(5)>0)&&prevstateno=200)
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !((movecontact||animelemtime(5)>0)&&prevstateno=200)
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 200

[state 190]
type = PlaySND
trigger1 = AnimElem=4&&!IsHelper
value = 7300,0
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&random%2=0&&AnimElem=4
value = 10,1+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 10

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;覇道天唱
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;猿舞剛把
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Enbu",3000,var(53))

;金剛破滅
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Kongou",3100,var(53))

;威風万丈
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ifuu",1400,var(53))

;破邪衝天
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command = "Haja",1300,var(53))

;天地葬送
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tenchi",1200,var(53))

;灰塵乱渦
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Kaijin",1100+ifelse(command="y",50,0),var(53))

;~~~~
;吹き飛ばし攻撃
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59) && var(52)>0 && movecontact
trigger1 = command="yz"&&command!="holddown"
var(53) = 900

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200

;連打
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59) && var(52)>0 && movecontact
trigger1 = command="x"&&command!="holddown"
var(53) = 200
;~~~~~~~~~~~

;Attack Lv.1
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=5
damage = floor(ifelse(33*fvar(0)<1,1+(var(2)%5=4),33*fvar(0))*1.22)
ground.slidetime = 10
ground.hittime = 10
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,10+var(49)*5
ground.velocity = -9.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-9.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0010,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),20+10,10-ifelse(floor(var(14)/100)>5,5,floor(var(14)/100))+10)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,0)
guardsound = s7000,0
getpower = floor(ifelse(var(9),0,floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = Light
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(33*fvar(14)<1,1+(var(2)%5=1),33*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 0
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(ifelse(P2dist X>166*const(size.xscale),166*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(18) = floor(ifelse(P2statetype=C,-176,-210)*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-10.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-9.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,8,10)
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (10-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;立ち中
[statedef 210]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 210

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElem=5
value = 7300,3
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&random%3!=0&&AnimElem=5
value = 10,3+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 12

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;覇道天唱
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;猿舞剛把
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Enbu",3000,var(53))

;金剛破滅
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Kongou",3100,var(53))

;威風万丈
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ifuu",1400,var(53))

;破邪衝天
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command = "Haja",1300,var(53))

;天地葬送
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tenchi",1200,var(53))

;灰塵乱渦
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Kaijin",1100+ifelse(command="y",50,0),var(53))

;~~~~
;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(var(0)<10 && command="longjump",50+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),ifelse(command="holdup",40+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),0))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=6
damage = ifelse(floor(65*fvar(0))<1,1+(var(2)%5=4),ceil(floor(65*fvar(0))*1.22))
ground.slidetime = 14+(P2statetype=C)+var(49)*6
ground.hittime = 14+(P2statetype=C)+var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+var(49)*6
ground.velocity = -18.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-18.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0012,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-13.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),30+12,16-ifelse(floor(var(14)/75)>7,7,floor(var(14)/75))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(55*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-160*const(size.xscale))
animtype = Medium
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0

[state 200]
type = ChangeState
triggerall = movecontact&&!(var(52)>0&&movecontact)
trigger1 = (command="holdup"||(var(53)=[40,52]))&&!var(59)
value = 40

[state 200]
type = AttackDist
trigger1 = AnimElem=7
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(floor(65*fvar(0))<1,1+(var(2)%5=4),floor(65*fvar(0)))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=4
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0||AnimElem=10,>=0&&AnimElem=11,<0
var(17) = floor(ifelse(P2dist X>306*const(size.xscale),306*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6&&AnimElem=7,<0
var(18) = floor(-130*const(size.yscale))-floor(ifelse(floor(P2dist X)<(28+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(306*const(size.xscale)),60,(floor(P2dist X)-(25+enemynear,const(size.ground.front)))*.5)))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-10.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-18.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-18.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,12,14+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (12-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1


;立ち強
[statedef 220]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||(prevstateno=[400,410])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||(prevstateno=[400,410])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||(prevstateno=[400,410])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 220

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=23

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
triggerall = anim=220
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=9
value = 10,5+(random<=500)
channel = 1

[state 190]
type = PlaySND
triggerall = anim=220
trigger1 = AnimElem=9
value = 7300,4
channel = 10

[state 220]
type = PosAdd
trigger1 = AnimElem=2
x = -floor(6*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=3
x = floor(18*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=5
x = floor(8*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=6
x = floor(4*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=7
x = floor(4*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=8
x = floor(2*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=9
x = floor(2*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=10
x = floor(4*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=11
x = floor(4*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=12
x = floor(-6*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=13
x = floor(-4*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=14
x = floor(-4*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=15
x = floor(-4*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=16
x = floor(-4*const(size.xscale))

[state 220]
type = null;PosAdd
trigger1 = AnimElem=17
x = floor(-6*const(size.xscale))

[state 220]
type = PosAdd
trigger1 = AnimElem=18
x = floor(-6*const(size.xscale))

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;覇道天唱
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;猿舞剛把
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Enbu",3000,var(53))

;金剛破滅
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Kongou",3100,var(53))

;威風万丈
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ifuu",1400,var(53))

;破邪衝天
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command = "Haja",1300,var(53))

;天地葬送
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tenchi",1200,var(53))

;灰塵乱渦
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Kaijin",1100+ifelse(command="y",50,0),var(53))

;~~~~
;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = !movecontact && !movereversed
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
damage = floor(ifelse(87*fvar(0)<1,1+(var(2)%5=4),87*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7
ground.velocity = -18.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-18.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-7.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-9.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(90*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(90*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(90*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(90*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M

[state 200]
type = AttackDist
trigger1 = AnimElem=10
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(87*fvar(14)<1,1+(var(2)%5=1),87*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=9
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
var(17) = floor(ifelse(P2dist X>306*const(size.xscale),306*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=9&&AnimElem=10,<0
var(18) = floor(-160*const(size.yscale))-floor(ifelse(floor(P2dist X)<(28+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(25+enemynear,const(size.ground.front)))*.25)))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-10.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-18.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-18.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;6中
[statedef 310]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 310

[state 200]
type = ChangeAnim
trigger1 = Time=1&&AnimElemNo(0)=7
value = 310
elem = 8

[state 200]
type = VarSet
trigger1 = Time=13&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=13&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=13&&var(34)
var(35)=11

[state 200]
type = Helper
trigger1 = Time=13&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=13&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=13&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)&&root,AnimElemTime(6)>=0

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElem=8
value = 7300,3
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=8
value = 10,6
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=10
value = 5100,2

[state 190]
type = EnvShake
trigger1 = AnimElem=10
time = 12
ample = 6

[State 40, 1]
type = Helper
trigger1 = AnimElem=10
id = 6925
stateno = 6920
pos = floor(200*const(size.xscale)),floor(30*const(size.yscale))
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

;転倒食らい
[state 190]
type = Targetstate
trigger1 = numtarget && movehit=1 && var(1)%2<1 && var(1)%8<4 && var(6)%10<1
trigger1 = target,time=0
value = 15070

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;天地葬送
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tenchi",1200,var(53))

;~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = !movecontact && !movereversed
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
damage = floor(ifelse(70*fvar(0)<1,1+(var(2)%5=4),70*fvar(0))*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -3*const(size.xscale),ifelse(var(49),10,(-7.0-.9)*const(size.yscale))
guard.velocity = ifelse(numtarget(920),-44,-13.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity =ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-3.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,ifelse(var(49),10,(-7.0*(51-var(3))/51-.9)*const(size.yscale)))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,0)
;fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(70*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(70*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-240*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = H

[state 200]
type = AttackDist
trigger1 = AnimElem=11
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(70*fvar(14)<1,1+(var(2)%5=1),70*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=10
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
var(17) = floor(ifelse(P2dist X>242*const(size.xscale),242*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=10&&AnimElem=11,<0
var(18) = floor(-120*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-6.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-13.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;しゃがみ弱
[statedef 400]
type = C
movetype=A
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&prevstateno=200)
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&prevstateno=200)
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&prevstateno=200)
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 400

[state 210]
type = ChangeAnim
trigger1 = time=2&&AnimElemNo(0)=7&&!IsHelper
value = anim
elem = 8

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = PosAdd
trigger1 = Time=0&&var(34)
x = -1

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=7

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper&&!time
value = 20000+stateno

[state 200]
type = ChangeAnim
trigger1 = IsHelper
trigger1 = (root,stateno=150||root,stateno=152||root,stateno=154)
value = 20000+stateno
elem = Root,AnimElemNo(0)-(root,time=0)

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = ifelse(root,animelemtime(7)>=0,0,1),0

[state 190]
type = PlaySND
trigger1 = AnimElem=2&&!IsHelper
value = 7300,0
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&random%2=0&&AnimElem=2
value = 10,1+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 10

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;覇道天唱
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;猿舞剛把
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Enbu",3000,var(53))

;金剛破滅
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Kongou",3100,var(53))

;威風万丈
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ifuu",1400,var(53))

;破邪衝天
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command = "Haja",1300,var(53))

;天地葬送
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tenchi",1200,var(53))

;灰塵乱渦
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Kaijin",1100+ifelse(command="y",50,0),var(53))

;~~~~
;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.1
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=3
damage = floor(ifelse(37*fvar(0)<1,1+(var(2)%5=4),37*fvar(0))*1.22)
ground.slidetime = 10
ground.hittime = 10
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,10+var(49)*5
ground.velocity = -8.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-8.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0010,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),20+10,10-ifelse(floor(var(14)/100)>5,5,floor(var(14)/100))+10)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = L
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=4
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(37*fvar(14)<1,1+(var(2)%5=1),37*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=3
var(16) = 0;
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=3,>=0&&AnimElem=4,<0
var(17) = floor(ifelse(P2dist X>192*const(size.xscale),192*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=3
var(18) = floor(-45*const(size.yscale))+floor(ifelse(floor(P2dist X)<(28+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(176*const(size.xscale)),24,(floor(P2dist X)-(25+enemynear,const(size.ground.front)))*.5)))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-10.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-8.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-9.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,8,10)
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (10-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 11
ctrl = 1


;しゃがみ中
[statedef 410]
type = C
movetype=A
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 410

[state 200]
type = VarSet
trigger1 = Time=15&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElem=4
value = 7300,3
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&random%3!=0&&AnimElem=4
value = 10,3+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;覇道天唱
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;猿舞剛把
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Enbu",3000,var(53))

;金剛破滅
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Kongou",3100,var(53))

;威風万丈
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ifuu",1400,var(53))

;破邪衝天
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command = "Haja",1300,var(53))

;天地葬送
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tenchi",1200,var(53))

;灰塵乱渦
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Kaijin",1100+ifelse(command="y",50,0),var(53))

;~~~~
;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>3 && roundstate=2 && !var(59)
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=5
damage = ifelse(floor(60*fvar(0))<1,1+(var(2)%5=4),ceil(floor(60*fvar(0))*1.22))
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7
ground.velocity = -13.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-7.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-12.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(45*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(45*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(45*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(45*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Hard
ground.type = High
attr = C,NA
hitflag = MAFD
guardflag = M
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(63*fvar(14)<1,1+(var(2)%5=1),63*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(ifelse(P2dist X>242*const(size.xscale),242*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5&&AnimElem=6,<0
var(18) = floor(-140*const(size.yscale))+floor(enemynear,const(size.ground.front)*.25)


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-10.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-13.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 11
ctrl = 1

;しゃがみ強
[statedef 420]
type = C
movetype=A
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=400))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=400))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=400))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 420

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=7&&Anim=420
value = 420
elem = 6

[state 200]
type = VarSet
trigger1 = Time=9&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=9&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=9&&var(34)
var(35)=10;本来11F

;攻撃発生中のガードポイント
[state 200]
type = HitBy
trigger1 = var(32)&&AnimElemTime(9)>0&&AnimElemTime(9)<=1&&!movecontact
value = ,AT

[state 200]
type = Helper
trigger1 = Time=9&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=9&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=9&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=5
value = 10,5+(random<=500)
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=5
value = 7300,3
channel = 10

[state 190]
type = PlaySND
trigger1 = AnimElem=6
value = 5100,2

[state 190]
type = EnvShake
trigger1 = AnimElem=6
time = 12
ample = 6

[State 40, 1]
type = Helper
trigger1 = AnimElem=6
id = 6925
stateno = 6920
pos = floor(120*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[State 40, 1]
type = Helper
trigger1 = AnimElem=6
id = 6310
stateno = 6310
pos = floor(120*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

;転倒食らい
[state 190]
type = Targetstate
trigger1 = numtarget && movehit=1 && var(1)%2<1 && var(1)%8<4 && var(6)%10<1
trigger1 = target,time=0
value = 15070

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;覇道天唱
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;猿舞剛把
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Enbu",3000,var(53))

;金剛破滅
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Kongou",3100,var(53))

;威風万丈
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ifuu",1400,var(53))

;破邪衝天
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command = "Haja",1300,var(53))

;天地葬送
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tenchi",1200,var(53))

;灰塵乱渦
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Kaijin",1100+ifelse(command="y",50,0),var(53))

;~~~~
;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=6
damage = ifelse(floor(72*fvar(0))<1,1+(var(2)%5=4),ceil(floor(72*fvar(0))*1.22))
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7
ground.velocity = -8*const(size.xscale),-9.0*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-8.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-8.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(55*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-50*const(size.xscale))
animtype = Light
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = L
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=10
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(72*fvar(14)<1,1+(var(2)%5=1),72*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(17) = floor(ifelse(P2dist X>230*const(size.xscale),230*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(18) = floor(-10*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 11
ctrl = 1

;ジャンプ弱
[statedef 600]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)+fvar(8),Vel X),vel Y
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !((movecontact||animelemtime(4)>0)&&var(1)%4<2&&prevstateno=600)
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !((movecontact||animelemtime(4)>0)&&var(1)%4<2&&prevstateno=600)
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !((movecontact||animelemtime(4)>0)&&var(1)%4<2&&prevstateno=600)
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 600

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 600]
type = VelSet
trigger1 = (prevstateno=[110,115])&&time<4
y = 0

[state 600]
type = VelAdd
trigger1 = !((prevstateno=[110,115])&&time<4)&&!(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.08,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,.9,1.0)*ifelse(fvar(10)>0&&var(1)%2>=1,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 190]
type = PlaySND
trigger1 = AnimElem=3&&!IsHelper
value = 7300,0
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&random%2=0&&AnimElem=3
value = 10,1+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,10)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

;~~必殺技~~~

;~~~~~~~~~~~
;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && roundstate=2 && !var(59)
trigger1 = movecontact
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,var(53)))

;２段ジャンプ、２段ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && roundstate=2 && !var(59)
trigger1 = movecontact&&var(1)%4>=2
var(53) = ifelse(var(0)%ifelse(var(0)>=1000,1000,100)<10&&command="longjump",50+ifelse(command="holdfwd",1,ifelse(command="holdback",2,0)),ifelse(command="up",40,ifelse(command="fwdup",41,ifelse(command="backup",42,var(53)))))

;空中投げ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = var(1)%4<2
trigger1 = command="z"&&(command="holdfwd"||command="holdback")&&command!="holddown"&&command!="holdup"&&P2bodydist X<=floor(78*const(size.xscale))&&P2statetype=A&&!(P2statetype=L&&enemynear,alive)
var(53) = ifelse(command="holdback",855,850)

;エリアルスパイク
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = var(1)%4>=2
trigger1 = command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&P2bodydist X<=floor(85*const(size.xscale))&&P2statetype=A&&!(P2statetype=L&&enemynear,alive)
var(53) = 720

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = (command="x"||command="y"||command="z")
var(53) = ifelse(command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&var(1)%4>=2,720,ifelse(command="z",620,ifelse(command="y",610,ifelse(command="x"&&0,600,var(53)))))

;連打
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59) && var(52)>0 && movecontact
trigger1 = command="x"&&command!="holddown"
var(53) = 600
;~~~~~~~~~~~

;Attack Lv.1
[state 200]
type = Hitdef
trigger1 = AnimElem=4
triggerall = var(1)%4<2
damage = floor(ifelse(28*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=4),28*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ground.slidetime = 10
ground.hittime = 10
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,10+var(49)*5
ground.velocity = -9.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-9.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0010,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),20+ifelse(var(1)%4>=2,8,10),10-ifelse(floor(var(14)/100)>5,5,floor(var(14)/100))+ifelse(var(1)%4>=2,8,10))
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,0)
guardsound = s7000,0
getpower = floor(ifelse(var(9),0,floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Light
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;Attack Lv.1
[state 200]
type = Hitdef
trigger1 = AnimElem=4
triggerall = var(1)%4>=2
damage = floor(ifelse(28*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=4),28*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ground.slidetime = 10
ground.hittime = 10
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,9
ground.velocity = -9.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-9.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -9.0*const(size.xscale)-.0009,-9.0*((4-(var(4)-ifelse(var(4)>=100,floor(var(4)/100)*100-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0),0)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0)))*1.0/4)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = 1.0*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),20+ifelse(var(1)%4>=2,8,10),10-ifelse(floor(var(14)/100)>5,5,floor(var(14)/100))+ifelse(var(1)%4>=2,8,10))
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,0)
guardsound = s7000,0
getpower = floor(ifelse(var(9),0,floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Light
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=5
value = 0

;エリアル中
[state -2]
type = varset
trigger1 = animelem=4,>=0&&animelem=5,<0&&!movecontact&&var(1)%4>=2&&floor(fvar(26))=91000
fvar(26) = ifelse((var(4)-ifelse(var(4)>=100,floor(var(4)/100)*100-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0),0)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))=0,floor(P2bodydist Y),90000)

[state -2]
type = targetbind
trigger1 = movecontact=1&&var(1)%4>=2&&(var(4)-ifelse(var(4)>=100,floor(var(4)/100)*100-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0),0)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))=0&&floor(fvar(26))<90000
pos = floor(P2dist X),floor(fvar(26))

[state -2]
type = VarAdd
trigger1 = var(1)%4>=2 && movecontact=1 && !var(2)
var(1) = -2
ignorehitpause=1

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && var(1)%2<1 && movecontact=1
y = -9.0*const(size.yscale)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(28*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),28*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=4
var(16) = 0
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
var(17) = floor(ifelse(P2dist X>168*const(size.xscale),168*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=4
var(18) = floor(-100*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,8,10)
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,10)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact)
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;ジャンプ中
[statedef 610]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)+fvar(8),Vel X),vel Y
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=600||(var(1)%4>=2&&prevstateno=620)))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=600||(var(1)%4>=2&&prevstateno=620)))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=600||(var(1)%4>=2&&prevstateno=620)))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 610

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 600]
type = VelSet
trigger1 = (prevstateno=[110,115])&&time<2
y = 0

[state 600]
type = VelAdd
trigger1 = !((prevstateno=[110,115])&&time<4)&&!(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.08,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,.9,1.0)*ifelse(fvar(10)>0&&var(1)%2>=1,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 190]
type = PlaySND
trigger1 = AnimElem=5
value = 7300,2
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&random%3!=0&&AnimElem=5
value = 10,3+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,12)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

;~~必殺技~~~

;~~~~~~~~~~~
;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && roundstate=2 && !var(59)
trigger1 = movecontact
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,var(53)))

;２段ジャンプ、２段ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && roundstate=2 && !var(59)
trigger1 = movecontact
var(53) = ifelse(var(0)%ifelse(var(0)>=1000,1000,100)<10&&command="longjump",50+ifelse(command="holdfwd",1,ifelse(command="holdback",2,0)),ifelse(command="up"&&var(0)<200,40,ifelse(command="fwdup",41,ifelse(command="backup",42,var(53)))))

;空中投げ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = var(1)%4<2
trigger1 = command="z"&&(command="holdfwd"||command="holdback")&&command!="holddown"&&command!="holdup"&&P2bodydist X<=floor(78*const(size.xscale))&&P2statetype=A&&!(P2statetype=L&&enemynear,alive)
var(53) = ifelse(command="holdback",855,850)

;エリアルスパイク
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = var(1)%4>=2
trigger1 = command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&P2bodydist X<=floor(85*const(size.xscale))&&P2statetype=A&&!(P2statetype=L&&enemynear,alive)
var(53) = 720

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = (command="x"||command="y"||command="z")
var(53) = ifelse(command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&var(1)%4>=2,720,ifelse(command="z",620,ifelse(command="y"&&0,610,ifelse(command="x"&&var(1)%4>=2,600,var(53)))))
;~~~~~~~~~~~
;Attack Lv.3
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
triggerall = var(1)%4<2
trigger1 = AnimElem=5
damage = ifelse(floor(56*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(56*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+var(49)*6
ground.velocity = -12.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0012,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-15.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),30+12,16-ifelse(floor(var(14)/75)>7,7,floor(var(14)/75))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(55*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Medium
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
triggerall = var(1)%4>=2
trigger1 = AnimElem=5
damage = ifelse(floor(56*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(56*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,9
ground.velocity = -12.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -9.0*const(size.xscale)-.0009,-9.0*((4-(floor(var(4)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))/100)*1.0)/4)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = 1.0*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),30+9,16-ifelse(floor(var(14)/75)>7,7,floor(var(14)/75))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(55*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Medium
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;エリアル中
[state -2]
type = varset
trigger1 = animelem=5,>=0&&animelem=6,<0&&!movecontact&&var(1)%4>=2&&floor(fvar(26))=91000
fvar(26) = ifelse((floor(var(4)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))/100)=0,floor(P2bodydist Y),90000)

[state -2]
type = targetbind
trigger1 = movecontact=1&&var(1)%4>=2&&(floor(var(4)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))/100)=0&&floor(fvar(26))<90000
pos = floor(P2dist X),floor(fvar(26))

[state -2]
type = VarAdd
trigger1 = var(1)%4>=2 && movecontact=1 && !var(2)
var(1) = -2
ignorehitpause=1

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && var(1)%2<1 && movecontact=1
y = -9.0*const(size.yscale)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(56*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),56*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5&&AnimElem=6,<0
var(18) = floor(-210*const(size.yscale))+ifelse(P2bodydist Y<0,ifelse(P2bodydist Y<-20*const(size.yscale),floor(-20*const(size.yscale)),floor(P2bodydist Y)),0)


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-12.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,12,14+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,12)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact) && !IsHelper
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;ジャンプ強
[statedef 620]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)+fvar(8),Vel X),vel Y
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 620

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 600]
type = VelSet
trigger1 = (prevstateno=[110,115])&&time<2
y = 0

[state 600]
type = VelAdd
trigger1 = !((prevstateno=[110,115])&&time<4)&&!(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.08,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,.9,1.0)*ifelse(fvar(10)>0&&var(1)%2>=1,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&(prevstateno!=[130,154])
var(7) = 0

[state 220]
type = varadd
trigger1 = var(7)<20&&((command="hold_z"&&!var(59))||(vel y<1&&var(1)%4<2&&var(5)%2<1&&var(59)))
trigger1 = (anim=621&&var(7))||(animelemtime(4)=0&&!var(7))
var(7) = 1

[state 220]
type = ChangeAnim
trigger1 = anim=620&&animelemtime(4)=0&&var(7)&&var(7)<20
trigger1 = ((command="hold_z"&&!var(59))||(vel y<1&&var(1)%4<2&&var(5)%2<1&&var(59)))
value = 621
persistent=0

[state 220]
type = ChangeAnim
trigger1 = var(7)&&animelemtime(4)=0&&anim=620
value = anim
elem = 4
persistent=0

[state 220]
type = ChangeAnim
trigger1 = ((command!="hold_z"&&!var(59))||var(7)>=20)&&var(7)
value = 620+(var(7)>=20)*5
elem = 4
persistent=0

;~~~~~

[state 190]
type = PlaySND
trigger1 = AnimElem=4
value = 7300,3
channel = 10
persistent=0

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=4
value = 10,5+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,13+(anim=625))

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

;~~~~~~~~~~~

;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && roundstate=2 && !var(59)
trigger1 = movecontact
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,var(53)))

;２段ジャンプ、２段ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && roundstate=2 && !var(59)
trigger1 = movecontact&&var(1)%4>=2
var(53) = ifelse(var(0)%ifelse(var(0)>=1000,1000,100)<10&&command="longjump",50+ifelse(command="holdfwd",1,ifelse(command="holdback",2,0)),ifelse(command="up",40,ifelse(command="fwdup",41,ifelse(command="backup",42,var(53)))))

;空中投げ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = var(1)%4<2
trigger1 = command="z"&&(command="holdfwd"||command="holdback")&&command!="holddown"&&command!="holdup"&&P2bodydist X<=floor(78*const(size.xscale))&&P2statetype=A&&!(P2statetype=L&&enemynear,alive)
var(53) = ifelse(command="holdback",855,850)

;エリアルスパイク
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = var(1)%4>=2
trigger1 = command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&P2bodydist X<=floor(85*const(size.xscale))&&P2statetype=A&&!(P2statetype=L&&enemynear,alive)
var(53) = 720

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && roundstate=2 && !var(59)
trigger1 = (command="x"||command="y"||command="z")
var(53) = ifelse(command="z"&&0,620,ifelse(command="y"&&var(1)%4>=2,610,ifelse(command="x"&&var(1)%4>=2,600,var(53))))
;~~~~~~~~~~~
;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = AnimElem=5
trigger1 = var(1)%4<2
damage = ifelse(floor(88*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(88*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -15.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(80*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(80*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(80*fvar(0)/fvar(2)*.8*1.0/8)*1.22
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = AnimElem=5
trigger1 = var(1)%4>=2
damage = ifelse(floor(88*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(88*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,9
ground.velocity = -15.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -9.0*const(size.xscale)-.0009,-9.0*((4-floor(var(4)/10000))*1.0/4)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = 1.0*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+9,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(80*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(80*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(80*fvar(0)/fvar(2)*.8*1.0/8)*1.22
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;溜め版~~~
;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = AnimElem=5&&anim=625
trigger1 = var(1)%4<2
damage = ifelse(floor(88*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(88*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7
ground.velocity = -18.0*const(size.xscale),-10*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-18.0*(1.0+ifelse(var(2)>31,31,var(2))*.05)-.0014,-16.0*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(80*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(80*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(80*fvar(0)/fvar(2)*.8*1.0/8)*1.22
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = AnimElem=5&&anim=625
trigger1 = var(1)%4>=2
damage = ifelse(floor(88*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(88*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,9
ground.velocity = -16.0*const(size.xscale),-12*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -10*const(size.xscale)-.0008,-9.0*((6-floor(var(4)/10000))*1.0/6)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = 1.0*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+9,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(80*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(80*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(80*fvar(0)/fvar(2)*.8*1.0/8)*1.22
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

[state 200]
type = StatetypeSet
trigger1 = AnimElem=6
movetype=I

;エリアル中
[state -2]
type = varset
trigger1 = animelem=5,>=0&&animelem=6,<0&&!movecontact&&var(1)%4>=2&&floor(fvar(26))=91000
fvar(26) = ifelse(floor(var(4)/10000)=0,floor(P2bodydist Y),90000)

[state -2]
type = targetbind
trigger1 = movecontact=1&&var(1)%4>=2&&floor(var(4)/10000)=0&&floor(fvar(26))<90000
pos = floor(P2dist X),floor(fvar(26))

[state -2]
type = VarAdd
trigger1 = var(1)%4>=2 && movecontact=1 && !var(2)
var(1) = -2
ignorehitpause=1

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && var(1)%2<1 && movecontact=1
y = -9.0*const(size.yscale)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*ifelse(floor(88*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(88*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(ifelse(P2dist X>188*const(size.xscale),188*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0&&var(7)>=20
var(17) = floor(ifelse(P2dist X>200*const(size.xscale),200*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(ifelse(P2bodydist Y<-30,-110,-50+ifelse(P2bodydist Y>0,0,P2bodydist Y))*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0&&var(7)>=20
var(18) = floor(ifelse(P2bodydist Y<-37,-110,-36+ifelse(P2bodydist Y>0,0,P2bodydist Y))*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-13.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,13)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact) && !IsHelper
value = 52

[state 200]
type = ChangeState
trigger1 = Anim!=621&&AnimTime=0
value = 50
ctrl = 1

;■■■■■■■
;エリアルスパイク
;(発生4F)
[statedef 720]
type = A
physics = N
movetype=A
ctrl = 0
velset = ifelse(fvar(9),fvar(9)+fvar(8),Vel X),vel Y

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 720

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = (P2stateno!=[150,155])
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
attr = A,NT
hitflag = AF
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=721
p1facing = ifelse((command="holdback"&&!var(59))||(ifelse(facing=1,-(helper(30005),pos x-pos x),helper(30000),pos x-pos x)<(160+const(size.ground.back))&&var(59))||var(53)=855,-1,1)
p2facing=1
fall.recover=0
numhits=0

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = animelem=3
var(53) = 0

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;戻り動作
[state 1000]
type = AttackDist
trigger1 = AnimElem=3
value = 0

[state 1000]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;■■■■■■■
;エリアルスパイク掴み
[statedef 721]
type = A
physics = N
movetype=A
ctrl = 0
velset = 0,0
anim = 851

[state 800]
type = varset
trigger1 = !time
fvar(8) = 0

[state 800]
type = varset
trigger1 = !time
fvar(9) = 0

[state 800]
type = varset
trigger1 = !time
fvar(10) = 0

;気絶値リセット
[state 801]
type = varset
trigger1 = !time
var(28) = ifelse(var(28)>0,0,var(28))

[state 801]
type = varset
trigger1 = !time
var(29) = 0

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !time
var(53) = 0

[state 800]
type = PlaySND
trigger1 = !time
value = 7100,0
channel = 10

[state 190]
type = PlaySND
trigger1 = animelemtime(7)=0
value = 7300,3
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&animelemtime(7)=0
value = 10,5+(random<500)
channel = 1

[state 801]
type = targetstate
trigger1 = time=0||(target,stateno!=856&&animelemtime(8)<0)
value = 856

[state 801]
type = Width
trigger1 = animelemtime(1)=0
edge = floor(154*const(size.xscale)),0

[state 801]
type = targetbind
trigger1 = animelemtime(2)<0
pos = floor(160*const(size.xscale)),floor(-208*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(2)>=0&&animelemtime(3)<0
pos = floor(160*const(size.xscale)),floor(-264*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
pos = floor(148*const(size.xscale)),floor(-402*const(size.xscale))

[state 801]
type = targetbind
trigger1 = animelemtime(4)>=0&&animelemtime(5)<0
pos = -floor(20*const(size.xscale)),floor(-336*const(size.xscale))

[state 801]
type = targetbind
trigger1 = animelemtime(5)>=0&&animelemtime(6)<0
pos = -floor(32*const(size.xscale)),floor(-340*const(size.xscale))

[state 801]
type = targetbind
trigger1 = animelemtime(6)>=0&&animelemtime(7)<0
pos = -floor(40*const(size.xscale)),floor(-338*const(size.xscale))

[state 801]
type = targetbind
trigger1 = animelemtime(7)>=0&&animelemtime(8)<0
pos = floor(56*const(size.xscale)),floor(-305*const(size.xscale))

[state 801]
type = targetbind
trigger1 = animelemtime(8)=0
pos = floor(160*const(size.xscale)),floor(40*const(size.xscale))

;コンボ補正なし
[state 801]
type = targetlifeadd
trigger1 = animelemtime(8)=0
value = -ceil(floor(86*fvar(0)*1.22)*const(data.attack)/100)

[state 801]
type = poweradd
trigger1 = animelemtime(8)=0
value = floor(ifelse(var(9),0,floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16)))

[state 801]
type = targetpoweradd
trigger1 = animelemtime(8)=0
value = floor(floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3)

[state 801]
type = targetstate
trigger1 = animelemtime(8)=0
value = 857

[state -1]
type = hitadd
trigger1 = animelemtime(8)=0
value = 1
ignorehitpause=1

[state -1]
type = varadd
trigger1 = animelemtime(8)=0
var(2) = 1
ignorehitpause=1

[state -1]
type = varadd
trigger1 = animelemtime(8)=0
var(3) = 1
ignorehitpause=1

;気絶値増加
[state -1]
type = varadd
trigger1 = animelemtime(8)=0
var(29) = floor(7*fvar(1))
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = animelemtime(8)=0
fvar(15) = .00005*floor(ifelse(96*fvar(14)<1,1+(var(2)%5=1),86*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = animelemtime(8)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

[state 1000]
type = VelSet
trigger1 = AnimElem=8
x = -.5
y = -4.0

[state 1000]
type = VelAdd
trigger1 = AnimElem=8,>0
y = ifelse(var(1)%4>=2,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.1,1)*ifelse(var(5)%4>=2||var(5)%8>=4,.9,1)*2*const(size.yscale)

[state 721]
type = AttackDist
trigger1 = 1
value = 0

[state 1000]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact) && !IsHelper
value = 52

;■■■■■■■
;通常投げ
;(発生5F)
[statedef 800]
type = S
physics = S
movetype=A
ctrl = 0
velset = ifelse(fvar(2),fvar(2),vel x),0
anim = 800

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = (P2stateno!=[150,155])
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
attr = S,NT
hitflag = M-
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=801
p1facing = ifelse((command="holdback"&&!var(59))||(ifelse(facing=1,-(helper(30005),pos x-pos x),helper(30000),pos x-pos x)<(160+const(size.ground.back))&&var(59)),-1,1)
p2facing=1
fall.recover=0
numhits = 0

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = (P2stateno!=[150,155])&&enemynear,anim=5300
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
attr = S,NT
hitflag = M
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=801
p1facing = ifelse((command="holdback"&&!var(59))||(ifelse(facing=1,-(helper(30005),pos x-pos x),helper(30000),pos x-pos x)<(160+const(size.ground.back))&&var(59)),-1,1)
p2facing=1
fall = 1
numhits = 0

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;戻り動作
[state 1000]
type = AttackDist
trigger1 = AnimElem=3
value = 0

[state 1000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;■■■■■■■
;通常投げ掴み
[statedef 801]
type = S
physics = S
movetype=A
ctrl = 0
velset = 0,0
anim = 801

[state 800]
type = varset
trigger1 = !time
fvar(8) = 0

[state 800]
type = varset
trigger1 = !time
fvar(9) = 0

[state 800]
type = varset
trigger1 = !time
fvar(10) = 0

;気絶値リセット
[state 801]
type = varset
trigger1 = !time
var(28) = ifelse(var(28)>0,0,var(28))

[state 801]
type = varset
trigger1 = !time
var(29) = 0

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=6
value = 10,27
channel = 1

[state 801]
type = Explod
trigger1 = AnimElem=7
id = 6200
anim = 6200
pos = floor(160*const(size.xscale)),0
postype = p1
scale = .5,.5
ownpal = 1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

[state 801]
type = Explod
trigger1 = AnimElem=7
id = 6200
anim = 6200
pos = floor(160*const(size.xscale)),0
postype = p1
scale = .5,.5
ownpal = 1
facing=-1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

[state 190]
type = PlaySND
trigger1 = AnimElem=7
value = 5100,2

[state 190]
type = EnvShake
trigger1 = AnimElem=7
time = 12
ample = 6

[State 40, 1]
type = Helper
trigger1 = AnimElem=7
id = 6925
stateno = 6920
pos = floor(160*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[state 190]
type = PlaySND
trigger1 = AnimElem=7,=7
value = 7100,2
channel = 10

[state 801]
type = hitadd
trigger1 = animelemtime(7)=7
value = 1

[state 801]
type = varadd
trigger1 = animelemtime(7)=7
var(2) = 1

[state 801]
type = varadd
trigger1 = animelemtime(7)=7
var(3) = 1

[state 801]
type = targetstate
trugger1 = numtarget
trigger1 = time=0||(target,stateno!=806&&animelemtime(7)<0)
value = 806

[state 801]
type = Width
trigger1 = animelemtime(1)=0
edge = floor(170*const(size.xscale)),0

[state 801]
type = Width
trigger1 = animelemtime(7)=0
edge = floor(190*const(size.xscale)),0

;コンボ補正なし
[state 801]
type = targetlifeadd
trigger1 = animelemtime(7)=7
value = -ceil(floor(110*fvar(0)*1.22)*const(data.attack)/100)

[state 801]
type = poweradd
trigger1 = animelemtime(7)=7
value = floor(ifelse(var(9),0,floor(95*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16)))

[state 801]
type = targetpoweradd
trigger1 = animelemtime(7)=7
value = floor(floor(95*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3)

[state 801]
type = targetbind
trigger1 = animelemtime(2)<0
pos = floor(170*const(size.xscale)),0

[state 801]
type = targetbind
trigger1 = animelemtime(2)>=0&&animelemtime(3)<0
pos = -floor(20*const(size.xscale)),-floor(344*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
pos = -floor(88*const(size.xscale)),-floor(334*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(4)>=0&&animelemtime(5)<0
pos = -floor(102*const(size.xscale)),-floor(300*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(5)>=0&&animelemtime(6)<0
pos = -floor(78*const(size.xscale)),-floor(320*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(6)>=0&&animelemtime(7)<0
pos = floor(72*const(size.xscale)),-floor(340*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(7)=0
pos = floor(190*const(size.xscale)),floor(40*const(size.yscale))

[state 801]
type = targetstate
trigger1 = animelemtime(7)=0
value = 807

;強制基底補正50%
[state -1]
type = varadd
trigger1 = animelemtime(7)=7&& var(8)%8<4
var(8) = 4
ignorehitpause=1

;気絶値増加
[state -1]
type = varadd
trigger1 = animelemtime(7)=7
var(29) = floor(7*fvar(1))
ignorehitpause=1

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = animelemtime(7)=7
fvar(15) = .00005*floor(ifelse(110*fvar(14)<1,1+(var(2)%5=1),110*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = animelemtime(7)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

[state 1000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;■■■■■■■
;通常投げ食らい
[statedef 806]
type = S
physics = N
movetype=H
ctrl = 0
velset = 0,0
sprpriority = 2

[state 806]
type = ScreenBound
trigger1 = 1
value = 1

[state 806]
type = ChangeAnim2
trigger1 = time=0
value = 806

[state 1116]
type = AngleDraw
trigger1 = AnimElemTime(2)>=8
value = -15

[state 806]
type = SelfState
trigger1 = time>=180
value = 5000

;■■■■■■■
;通常投げ食らい（吹き飛び）
[statedef 807]
type = A
physics = N
movetype=H
ctrl = 0
velset = 0,0
sprpriority = 2

[state 806]
type = ChangeAnim2
trigger1 = time=0
value = 807

[state 806]
type = VelSet
trigger1 = Time=8
x = -4.0
y = 2.0

[state 806]
type = ChangeState
trigger1 = Time=8
value = 15075

;■■■■■■■
;空中投げ
;(発生4F)
[statedef 850]
type = A
physics = N
movetype=A
ctrl = 0
velset = ifelse(fvar(9),fvar(9)+fvar(8),Vel X),vel Y

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 720

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 600]
type = VelAdd
trigger1 = !((prevstateno=[110,115])&&time<4)&&!(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.08,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,.9,1.0)*ifelse(fvar(10)>0&&var(1)%2>=1,.9,1.0)*2.0*const(size.yscale)

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = (P2stateno!=[150,155])
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
attr = A,NT
hitflag = AF
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=851
p1facing = ifelse((command="holdback"&&!var(59))||(ifelse(facing=1,-(helper(30005),pos x-pos x),helper(30000),pos x-pos x)<(160+const(size.ground.back))&&var(59))||var(53)=855,-1,1)
p2facing=1
fall.recover=0
numhits=0

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = animelem=3
var(53) = 0

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;戻り動作
[state 1000]
type = AttackDist
trigger1 = AnimElem=3
value = 0

[state 1000]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
value = 52

[state 1000]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;■■■■■■■
;空中投げ掴み
[statedef 851]
type = A
physics = N
movetype=A
ctrl = 0
velset = 0,0
anim = 851

[state 800]
type = varset
trigger1 = !time
fvar(8) = 0

[state 800]
type = varset
trigger1 = !time
fvar(9) = 0

[state 800]
type = varset
trigger1 = !time
fvar(10) = 0

;気絶値リセット
[state 801]
type = varset
trigger1 = !time
var(28) = ifelse(var(28)>0,0,var(28))

[state 801]
type = varset
trigger1 = !time
var(29) = 0

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !time
var(53) = 0

[state 800]
type = PlaySND
trigger1 = !time
value = 7100,0
channel = 10

[state 190]
type = PlaySND
trigger1 = animelemtime(7)=0
value = 7300,3
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&animelemtime(7)=0
value = 10,5+(random<500)
channel = 1

[state 801]
type = targetstate
trigger1 = time=0||(target,stateno!=856&&animelemtime(8)<0)
value = 856

[state 801]
type = Width
trigger1 = animelemtime(1)=0
edge = floor(154*const(size.xscale)),0

[state 801]
type = targetbind
trigger1 = animelemtime(2)<0
pos = floor(160*const(size.xscale)),floor(-208*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(2)>=0&&animelemtime(3)<0
pos = floor(160*const(size.xscale)),floor(-264*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
pos = floor(148*const(size.xscale)),floor(-402*const(size.xscale))

[state 801]
type = targetbind
trigger1 = animelemtime(4)>=0&&animelemtime(5)<0
pos = -floor(20*const(size.xscale)),floor(-336*const(size.xscale))

[state 801]
type = targetbind
trigger1 = animelemtime(5)>=0&&animelemtime(6)<0
pos = -floor(32*const(size.xscale)),floor(-340*const(size.xscale))

[state 801]
type = targetbind
trigger1 = animelemtime(6)>=0&&animelemtime(7)<0
pos = -floor(40*const(size.xscale)),floor(-338*const(size.xscale))

[state 801]
type = targetbind
trigger1 = animelemtime(7)>=0&&animelemtime(8)<0
pos = floor(56*const(size.xscale)),floor(-305*const(size.xscale))

[state 801]
type = targetbind
trigger1 = animelemtime(8)=0
pos = floor(160*const(size.xscale)),floor(40*const(size.xscale))

;コンボ補正なし
[state 801]
type = targetlifeadd
trigger1 = animelemtime(8)=0
value = -ceil(floor(95*fvar(0)*1.22)*const(data.attack)/100)

[state 801]
type = poweradd
trigger1 = animelemtime(8)=0
value = floor(ifelse(var(9),0,floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16)))

[state 801]
type = targetpoweradd
trigger1 = animelemtime(8)=0
value = floor(floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3)

[state 801]
type = targetstate
trigger1 = animelemtime(8)=0
value = 857

[state -1]
type = hitadd
trigger1 = animelemtime(8)=0
value = 1
ignorehitpause=1

[state -1]
type = varadd
trigger1 = animelemtime(8)=0
var(2) = 1
ignorehitpause=1

[state -1]
type = varadd
trigger1 = animelemtime(8)=0
var(3) = 1
ignorehitpause=1

;強制基底補正60%
[state -1]
type = varadd
trigger1 = animelemtime(8)=0 && var(8)%64<32
var(8) = 32
ignorehitpause=1

;気絶値増加
[state -1]
type = varadd
trigger1 = animelemtime(8)=0
var(29) = floor(7*fvar(1))
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = animelemtime(8)=0
fvar(15) = .00005*floor(ifelse(106*fvar(14)<1,1+(var(2)%5=1),95*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = animelemtime(8)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

[state 1000]
type = VelSet
trigger1 = AnimElem=8
x = -.5
y = -4.0

[state 1000]
type = VelAdd
trigger1 = AnimElem=8,>0
y = ifelse(var(1)%4>=2,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.1,1)*ifelse(var(5)%4>=2||var(5)%8>=4,.9,1)*2*const(size.yscale)

[state 1000]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact) && !IsHelper
value = 52

;■■■■■■■
;空中投げ食らい
[statedef 856]
type = A
physics = N
movetype=H
ctrl = 0
velset = 0,0

[state 806]
type = ScreenBound
trigger1 = 1
value = 1

[state 806]
type = PlayerPush
trigger1 = 1
value = 0

[state 806]
type = ChangeAnim2
trigger1 = time=0
value = 856

[state 806]
type = SelfState
trigger1 = time>=180
value = 5000

;■■■■■■■
;空中投げ食らい（吹き飛び）
[statedef 857]
type = A
physics = N
movetype=H
ctrl = 0
velset = -8.0,6.0

[state 806]
type = ChangeAnim
trigger1 = time=0
value = 5050

[state 806]
type = VelAdd
trigger1 = 1
y = .5

[state 806]
type = VelSet
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
y = 0.1

[state 806]
type = ChangeState
trigger1 = Vel Y>0 && (Pos Y>=-Vel Y||vel Y=.1)
value = 15075

;吹き飛ばし攻撃
[statedef 900]
type = S
movetype = A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(prevstateno=200&&movecontact)
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(prevstateno=200&&movecontact)
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(prevstateno=200&&movecontact)
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])&&anim!=905
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 900

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=20

;攻撃発生中のガードポイント
[state 200]
type = HitBy
trigger1 = var(32)&&AnimElemTime(6)>0&&AnimElemTime(7)<=0&&!movecontact
value = ,AT

;攻撃状態維持用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&(prevstateno!=[130,154])
var(7) = 0

[state 220]
type = varadd
trigger1 = var(7)<120&&((command="hold_y"&&command="hold_z"&&!var(59))||((P2bodydist X>70||var(1)%2>=1)&&var(59)))
trigger1 = (anim=905&&var(7))||(animelemtime(6)=0&&!var(7))
var(7) = 1

[state 220]
type = ChangeAnim
trigger1 = anim=900&&animelemtime(6)=0&&var(7)&&var(7)<=120
trigger1 = ((command="hold_y"&&command="hold_z"&&!var(59))||((P2bodydist X>70||var(1)%2>=1)&&var(59)))
value = 905
persistent=0

[state 220]
type = ChangeAnim
trigger1 = (((command!="hold_y"||command!="hold_z")&&!var(59))||((P2bodydist X<ifelse(P2bodydist Y<-40,70,10)||var(1)%2<1)&&random%5<2&&var(59))||var(7)>=120)&&var(7)
value = 900
elem = 6
persistent=0

;溜めエフェクト
[state -2]
type = Helper
trigger1 = var(7)%8=1 &&anim=905
id = 7770
stateno=7770
pos = 0,0
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

[state 220]
type = PalFX
trigger1 = anim=905&&(var(7)=[60,68])
add = 255-(var(7)-60)*30,255-(var(7)-60)*30,255-(var(7)-60)*30
time = 1
;~~~~~

[state 190]
type = PlaySND
trigger1 = AnimElem=7
value = 7300,3
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=7
value = 10,9
channel = 1

[state 900]
type = StatetypeSet
trigger1 = AnimElem=8
physics = N

[state 900]
type = VelSet
trigger1 = !fvar(9)&&AnimElem=8
x = 5.0

[state 900]
type = VelMul
trigger1 = AnimElem=8,>0
x = .9

;現在の速度取得
[state 900]
type = VarSet
trigger1 = AnimElem=8
fvar(8) = 5.0

[state 900]
type = VarSet
trigger1 = AnimElem=8,>0
fvar(8) = fvar(8)*.9

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13+(var(7)>=60)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = AnimElem=8
damage = floor(ifelse(60*fvar(0)<1,1+(var(2)%5=4),60*fvar(0))*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -11.5,-11*const(size.yscale)
guard.velocity = -13.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%2>=1||var(1)%16<8,-11.5*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-15*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-5.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+10,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(70*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(70*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = High
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0


;Attack Lv.5
[state 200]
type = Hitdef
triggerall = var(7)>=60
trigger1 = AnimElem=8
damage = floor(ifelse(60*fvar(0)<1,1+(var(2)%5=4),60*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7
ground.velocity = -10,-11*const(size.yscale)
guard.velocity = -44*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(1)%16<8,-10.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-8*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+10,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(70*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(70*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = High
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0
ID = 920

;==壁ダウンに
[state 920]
type = varadd
trigger1 = movehit=1 && numtarget && var(6)%10=0
trigger1 = target,time=0
var(1) = ifelse(var(7)<60&&var(1)%2<1&&var(1)%16<8,4+8,ifelse(var(1)%2<1&&var(7)>=60,1,0))-(var(1)%16>=8&&var(1)%8>=4)*4
ignorehitpause=1
persistent=0

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && var(6)%10=0 && (var(1)%2>=1||var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(var(7)<60&&var(1)%2<1,938,928)
ignorehitpause=1
persistent=0

[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && var(52)>0 && time>4 && var(7)<60 && !var(59)
var(53) = ifelse(var(0)<10 && command="longjump",50,ifelse(command="holdup",40,var(53)))+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0))
ignorehitpause=1

;ブースト
[state 900]
type = VarSet
triggerall = (movehit||(moveguarded&&var(7)>=60)) && var(52)>0 && movecontact
trigger1 = command="holdfwd"&&command!="holdup"&&command!="holddown"&&!var(59)
var(53) = 2000+ifelse(var(53)=40||var(53)=50,var(53),0)

;ブースト
[state 900]
type = ChangeState
triggerall = (movehit||(moveguarded&&var(7)>=60))&&!(var(52)>0&&movecontact) && (var(1)%2>=1||var(1)%8>=4) && P2dist X>0
trigger1 = (command="holdfwd"||(var(53)=[2000,2050]))&&!var(59)
trigger2 = var(59)
value = 2000

;ジャンプ
[state 900]
type = ChangeState
triggerall = movecontact&&!(var(52)>0&&movecontact)
trigger1 = (command="up"||command="fwdup"||command="backup"||(var(53)=[40,42])||(var(53)=[50,52]))&&!var(59)
trigger2 = var(1)%2<1&&var(59)
value = 40

[state 200]
type = AttackDist
trigger1 = AnimElem=9
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&hitpausetime=ifelse(var(7)>=60,14,13)
fvar(15) = .00005*floor(ifelse(60*fvar(14)<1,1+(var(2)%5=1),60*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=8
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=8&&AnimElem=9,<0
var(18) = floor(-180*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = (ifelse(var(7)>=60,-15.0,-13.5)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (ifelse(var(7)>=60,-15.0,-13.5)*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&var(6))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(var(7)>=60,ifelse(moveguarded,18,20+(P2statetype=C)),ifelse(moveguarded,15,17+(P2statetype=C)))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&var(6))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(7)>=60,14,13)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 2000]
type = ChangeState
trigger1 = Anim=900&&AnimTime=0
value = 0
ctrl = 1


;エリアル攻撃
[statedef 910]
type = S
movetype = A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 910

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=4
value = 910
elem = 5

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=14

;攻撃状態維持用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
trigger1 = AnimElem=6
value = 7300,3
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=6
value = 10,8
channel = 1

[state 910]
type = RemoveExplod
trigger1 = AnimElem=7
trigger2 = AnimElem=8
trigger3 = AnimElem=9
trigger4 = AnimElem=10
trigger5 = AnimElem=11
id = 6000

[state 910]
type = Explod
trigger1 = AnimElem=7
id = 6000
anim = 6000
pos = 0,0
postype = p1
bindtime = -1
removeongethit=1
scale = .75,.75
sprpriority = 3

[state 910]
type = Explod
trigger1 = AnimElem=8
id = 6000
anim = 6001
pos = 0,0
postype = p1
bindtime = -1
removeongethit=1
scale = .75,.75
sprpriority = 3

[state 910]
type = Explod
trigger1 = AnimElem=9
id = 6000
anim = 6002
pos = 0,0
postype = p1
bindtime = -1
removeongethit=1
scale = .75,.75
sprpriority = 3

[state 910]
type = Explod
trigger1 = AnimElem=10
id = 6000
anim = 6003
pos = 0,0
postype = p1
bindtime = -1
removeongethit=1
scale = .75,.75
sprpriority = 3

[state 190]
type = EnvShake
trigger1 = AnimElem=7
time = 12
ample = -6

[State 40, 1]
type = Helper
trigger1 = AnimElem=7
id = 6925
stateno = 6920
pos = floor(120*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4(1)
[state 200]
type = Hitdef
triggearll = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=7
damage = floor(ifelse(70*fvar(0)<1,1+(var(2)%5=4),70*fvar(0))*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,13+var(49)*7
ground.velocity = 0,-22*const(size.yscale)
guard.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,ifelse(var(6)%10>0,-8,0)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-21.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(55*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-160*const(size.xscale))
animtype  = diagup
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0

[state 200]
type = VarAdd
trigger1 = movehit=1&&numtarget&&var(1)%4<2&&var(6)%10<1
var(1) = 2
ignorehitpause=1

;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && var(52)>0 && movehit && !var(59)
trigger1 = command="holdup"
var(53) = 40+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0))

[state 200]
type = ChangeState
triggerall = movehit&&numtarget&&!(var(52)>0&&movecontact)
trigger1 = (command="holdup"||(var(53)=[40,42]))&&!var(59)
trigger2 = (var(3)>11||enemynear,life<=ifelse(var(2)>1,70,90))&&var(59)
value = 40

[state 200]
type = AttackDist
trigger1 = AnimElem=9
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(70*fvar(14)<1,1+(var(2)%5=1),70*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=7
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=9,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
var(18) = floor(-80*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(18) = floor(-140*const(size.yscale))

;現在の速度取得
[state 240]
type = varset
trigger1 = !time
fvar(8) = 0

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0&&(var(6)||moveguarded)
fvar(5) = (-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-13.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&(var(6)||moveguarded))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,8,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&(var(6)||moveguarded))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 2000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;伝衝裂鬼
[statedef 1000]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1000

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = (P2stateno!=[150,155])
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
attr = S,ST
hitflag = M
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=1010
p1facing = 1016
p2facing=1
fall = 1
fall.recovertime = 60
numhits = 0

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;戻り動作
[state 1000]
type = AttackDist
trigger1 = AnimElem=3
value = 0

[state 1050]
type = changestate
trigger1 = animtime=0
value = 0
ctrl = 1

;伝衝裂鬼掴み動作
[statedef 1010]
type = S
physics = N
movetype=A
velset = 0,0
anim = 1010

[state 800]
type = varset
trigger1 = !time
fvar(5) = 0

[state 800]
type = varset
trigger1 = !time
fvar(6) = 0

[state 800]
type = varset
trigger1 = !time
fvar(7) = 0

[state 800]
type = varset
trigger1 = !time
fvar(8) = 0

[state 800]
type = varset
trigger1 = !time
fvar(9) = 0

[state 800]
type = varset
trigger1 = !time
fvar(10) = 0

;気絶値リセット
[state 801]
type = varset
trigger1 = !time
var(28) = ifelse(var(28)>0,0,var(28))

[state 801]
type = varset
trigger1 = !time
var(29) = 0

[state 800]
type = varset
trigger1 = !time
var(7) = 0

[state 800]
type = varset
trigger1 = anim=1020&&animtime=0
var(7) = 1

[state 800]
type = varset
trigger1 = anim=1010&&animelemtime(14)>0
var(7) = 0

[state 800]
type = PlaySND
trigger1 = !time
value = 7100,0
channel = 10

[state 801]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&anim=1010&&animelemtime(5)=0
value = 10,3
channel = 1

[state 801]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&anim=1010&&animelemtime(6)=0
value = 10,42
channel = 1

[state 801]
type = ScreenBound
trigger1 = anim=1010&&animelemtime(8)>=0&&animelemtime(14)<0
trigger2 = anim=1020
value = 0
movecamera = 1,1

[state 801]
type = VelSet
trigger1 = anim=1010&&animelemtime(8)=0
trigger2 = anim=1020
x = 10

[state 801]
type = ChangeAnim
trigger1 = anim=1010&&animelemtime(9)=0&&ifelse(facing=1,helper(30000),pos x-enemynear,pos x,-(helper(30005),pos x-enemynear,pos x))>(-80+enemynear,const(size.air.back));&&frontedgebodydist>5
value = 1020

[state 801]
type = ChangeAnim
trigger1 = anim=1020&&animelemno(0)!=animelemno(-1)&&ifelse(facing=1,helper(30000),pos x-enemynear,pos x,-(helper(30005),pos x-enemynear,pos x))<=(-80+enemynear,const(size.air.back));&&frontedgebodydist<=5
trigger2 = anim=1020&&animtime=0
value = 1010
elem = 9

[state 801]
type = VelMul
trigger1 = anim=1010&&animelemtime(9)>=0
x = .8

[state 910]
type = Explod
trigger1 = Anim=1020&&AnimElem=1
trigger2 = Anim=1020&&AnimElem=2
trigger3 = Anim=1020&&AnimElem=3
trigger4 = Anim=1020&&AnimElem=4
id = 6100
anim = 6100
pos = 0,0
postype = p1
removeongethit=1
scale = .75,.75
sprpriority = 3

[state 190]
type = Explod
trigger1 = Anim=1020&&AnimElem=1
trigger2 = Anim=1020&&AnimElem=2
trigger3 = Anim=1020&&AnimElem=3
trigger4 = Anim=1020&&AnimElem=4
id = 6915
anim = 6915
pos = floor(-80*const(size.xscale)),0
postype = P1
sprpriority = 3
bindtime=1
scale = const(size.xscale),const(size.yscale)

[state 190]
type = PlaySND
trigger1 = Anim=1010&&AnimElem=5
trigger2 = Anim=1020&&AnimElem=1
trigger3 = Anim=1020&&AnimElem=2
trigger4 = Anim=1020&&AnimElem=3
trigger5 = Anim=1020&&AnimElem=4
value = 5100,1
channel = 10

[state 190]
type = EnvShake
trigger1 = Anim=1010&&AnimElem=5
trigger2 = Anim=1020&&AnimElem=1
trigger3 = Anim=1020&&AnimElem=2
trigger4 = Anim=1020&&AnimElem=3
trigger5 = Anim=1020&&AnimElem=4
time = 12
ample = 6

[State 40, 1]
type = Helper
trigger1 = Anim=1010&&AnimElem=5
id = 6925
stateno = 6920
pos = floor(90*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[State 40, 1]
type = Helper
trigger1 = Anim=1020&&AnimElem=1
trigger2 = Anim=1020&&AnimElem=2
trigger3 = Anim=1020&&AnimElem=3
trigger4 = Anim=1020&&AnimElem=4
id = 6925
stateno = 6920
pos = floor(180*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[state 190]
type = PlaySND
trigger1 = Anim=1010&&AnimElem=9
value = 1000,0

[state 800]
type = PlaySND
trigger1 = Anim=1010&&AnimElem=13
value = 7300,4
channel = 10

[state 1100]
type = TargetState
trigger1 = anim=1010&&animelemtime(4)<0&&numtarget
trigger1 = target,stateno!=1016
value = 1016

[state 1100]
type = TargetState
trigger1 = anim=1010&&animelemtime(4)>=0&&animelemtime(5)<0&&numtarget
trigger1 = target,stateno!=1017
value = 1017

[state 1100]
type = TargetState
trigger1 = ((anim=1010&&animelemtime(5)>=0&&animelemtime(10)<0)||anim=1020)&&numtarget
trigger1 = target,stateno!=1018
value = 1018

[state 801]
type = null;Width
trigger1 = anim=1010&&animelemtime(1)=0
edge = floor(176*const(size.xscale)),0

[state 801]
type = null;Width
trigger1 = anim=1010&&animelemtime(8)>=0&&animelemtime(9)<0
edge = floor(176*const(size.xscale)),0

[state 801]
type = Width
trigger1 = anim=1010&&animelemtime(14)=0
edge = ifelse((enemynear,const(size.air.front)+enemynear,const(size.air.back))>50,70,0)+floor(40*const(size.xscale)),0

[state 801]
type = Width
trigger1 = anim=1010&&animelemtime(14)=0&&var(7)=1&&ifelse(facing=1,helper(30000),pos x-enemynear,pos x,-(helper(30005),pos x-enemynear,pos x))>enemynear,const(size.air.back)
edge = floor(210*const(size.xscale)),0

[state 801]
type = TargetBind
trigger1 = anim=1010&&AnimElemTime(2)<0
pos = floor(178*const(size.xscale)),floor(-202*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=1010&&AnimElemTime(2)>=0&&AnimElemTime(3)<0
pos = floor(176*const(size.xscale)),floor(-256*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=1010&&AnimElemTime(3)>=0&&AnimElemTime(4)<0
pos = floor(116*const(size.xscale)),floor(-302*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=1010&&AnimElemTime(4)>=0&&AnimElemTime(5)<0
pos = floor(120*const(size.xscale)),floor(-256*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=1010&&AnimElemTime(5)>=0&&AnimElemTime(6)<0
pos = floor(92*const(size.xscale)),floor(-8*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=1010&&AnimElemTime(6)>=0&&AnimElemTime(7)<0
pos = floor(90*const(size.xscale)),floor(-6*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=1010&&AnimElemTime(7)>=0&&AnimElemTime(8)<0
pos = floor(130*const(size.xscale)),floor(-10*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=1010&&AnimElemTime(8)>=0&&AnimElemTime(9)<0
pos = floor(176*const(size.xscale)),floor(-46*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=1010&&AnimElemTime(9)>=0&&AnimElemTime(10)<0
pos = floor(30*const(size.xscale)),floor(-42*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=1010&&AnimElemTime(10)>=0&&AnimElemTime(11)<0
pos = floor(-120*const(size.xscale)),floor(-38*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=1010&&AnimElemTime(11)>=0&&AnimElemTime(12)<0
pos = floor(-98*const(size.xscale)),floor(-36*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=1010&&AnimElemTime(12)>=0&&AnimElemTime(13)<0
pos = floor(-76*const(size.xscale)),floor(-34*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=1010&&AnimElemTime(13)>=0&&AnimElemTime(14)<0
pos = floor(-16*const(size.xscale)),floor(-68*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = Anim=1010&&AnimElemTime(14)=0
pos = floor(200*const(size.xscale)),floor(-110*const(size.yscale))

[state 801]
type = TargetState
trigger1 = Anim=1010&&AnimElemTime(14)=0
value = 1019

[state 801]
type = hitadd
trigger1 = anim=1010&&animelemtime(5)=0
trigger2 = anim=1010&&animelemtime(14)=0
trigger3 = anim=1020&&animelemtime(1)=0
trigger4 = anim=1020&&animelemtime(2)=0
trigger5 = anim=1020&&animelemtime(3)=0
trigger6 = anim=1020&&animelemtime(4)=0
value = 1

[state 801]
type = varadd
trigger1 = anim=1010&&animelemtime(5)=0
trigger2 = anim=1010&&animelemtime(14)=0
trigger3 = anim=1020&&animelemtime(1)=0
trigger4 = anim=1020&&animelemtime(2)=0
trigger5 = anim=1020&&animelemtime(3)=0
trigger6 = anim=1020&&animelemtime(4)=0
var(2) = 1

[state 801]
type = varadd
trigger1 = anim=1010&&animelemtime(14)=0
var(3) = 1

[state 801]
type = poweradd
trigger1 = anim=1010&&animelemtime(5)=0
value = floor(ifelse(var(9),0,floor(45*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16)))

[state 801]
type = targetpoweradd
trigger1 = anim=1010&&animelemtime(5)=0
value = floor(floor(45*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3)

[state 801]
type = poweradd
trigger1 = anim=1020&&animelemtime(1)=0
trigger2 = anim=1020&&animelemtime(2)=0
trigger3 = anim=1020&&animelemtime(3)=0
trigger4 = anim=1020&&animelemtime(4)=0
value = floor(ifelse(var(9),0,floor(10*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16)))

[state 801]
type = targetpoweradd
trigger1 = anim=1020&&animelemtime(1)=0
trigger2 = anim=1020&&animelemtime(2)=0
trigger3 = anim=1020&&animelemtime(3)=0
trigger4 = anim=1020&&animelemtime(4)=0
value = floor(floor(10*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3)

[state 801]
type = poweradd
trigger1 = anim=1010&&animelemtime(14)=0
value = floor(ifelse(var(9),0,floor(45*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16)))

[state 801]
type = targetpoweradd
trigger1 = anim=1010&&animelemtime(14)=0
value = floor(floor(45*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3)

[state 801]
type = targetlifeadd
trigger1 = anim=1010&&animelemtime(5)=0
value = -floor(40*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)
kill = 0

[state 801]
type = targetlifeadd
trigger1 = anim=1020&&animelemtime(1)=0
value = -floor(12*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)
kill = 0

[state 801]
type = targetlifeadd
trigger1 = anim=1020&&animelemtime(2)=0
value = -floor(10*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)
kill = 0

[state 801]
type = targetlifeadd
trigger1 = anim=1020&&animelemtime(3)=0
value = -floor(9*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)
kill = 0

[state 801]
type = targetlifeadd
trigger1 = anim=1020&&animelemtime(4)=0
value = -floor(10*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)
kill = 0

[state 801]
type = targetlifeadd
trigger1 = anim=1010&&animelemtime(14)=0
value = -floor(50*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = anim=1010&&animelemtime(5)=0
fvar(15) = .00005*floor(ifelse(40*fvar(14)<1,1+(var(2)%5=1),40*fvar(14))*1.22)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = anim=1020&&animelemtime(1)=0&&roundstate<3
fvar(15) = .00005*floor(ifelse(12*fvar(14)<1,1+(var(2)%5=1),12*fvar(14))*1.22)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = anim=1020&&animelemtime(2)=0&&roundstate<3
fvar(15) = .00005*floor(ifelse(10*fvar(14)<1,1+(var(2)%5=1),10*fvar(14))*1.22)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = anim=1020&&animelemtime(3)=0&&roundstate<3
fvar(15) = .00005*floor(ifelse(9*fvar(14)<1,1+(var(2)%5=1),9*fvar(14))*1.22)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = anim=1020&&animelemtime(4)=0&&roundstate<3
fvar(15) = .00005*floor(ifelse(10*fvar(14)<1,1+(var(2)%5=1),10*fvar(14))*1.22)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = anim=1010&&animelemtime(14)=0
fvar(15) = .00005*floor(ifelse(50*fvar(14)<1,1+(var(2)%5=1),50*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = anim=1010&&animelemtime(5)=0
trigger2 = anim=1020&&animelemtime(1)=0
trigger3 = anim=1020&&animelemtime(2)=0
trigger4 = anim=1020&&animelemtime(3)=0
trigger5 = anim=1020&&animelemtime(4)=0
trigger6 = anim=1010&&animelemtime(14)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;強制基底補正80%
[state -1]
type = varadd
trigger1 = anim=1010&&AnimElemTime(14)=0 && var(8)%128<64
var(8) = 64
ignorehitpause=1

;基底補正解除
[state 800]
type = varadd
trigger1 = anim=1010&&AnimElemTime(14)=0
var(8) = -(var(8)%4>=2)*2-(var(8)%2>=1)

;気絶値増加
[state -1]
type = varadd
trigger1 = anim=1010&&AnimElemTime(14)=0
var(29) = floor(4*fvar(1))
ignorehitpause=1

[state 1010]
type = AttackDist
trigger1 = 1
value = 0

[state 1050]
type = changestate
trigger1 = animtime=0
value = 0
ctrl = 1

;伝衝裂鬼相手動作
[statedef 1016]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=1016
value = 1016

[state 1116]
type = PlayerPush
trigger1 = 1
value = 0

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 1,1

[state 1116]
type = SprPriority
trigger1 = 1
value = 2

[state 1116]
type = SelfState
trigger1 = time>=24
value = 5210

;伝衝裂鬼相手動作
[statedef 1017]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=1017
value = 1017

[state 1116]
type = PlayerPush
trigger1 = 1
value = 0

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 1,1

[state 1116]
type = SprPriority
trigger1 = 1
value = -1

[state 1116]
type = SelfState
trigger1 = time>=8
value = 5210

;伝衝裂鬼相手動作
[statedef 1018]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=1018
value = 1018

[state 1116]
type = PlayerPush
trigger1 = 1
value = 0

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 1,1

[state 1116]
type = SprPriority
trigger1 = 1
value = -1

[state 1116]
type = SelfState
trigger1 = time>=80
value = 5210

;伝衝裂鬼相手動作4
[statedef 1019]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim
trigger1 = time<4
value = 5050

[state 1116]
type = ChangeAnim
trigger1 = time=[4,11]
value = 5050+(SelfAnimExist(5051))

[state 1017]
type = VelSet
trigger1 = Time=4
x = 3.5
y = -11.5

[state 1017]
type = VelAdd
trigger1 = Time>=4
y = .5

[state 1017]
type = SelfState
trigger1 = time>12&&Vel Y>2.5
value = 5050

;灰塵乱渦(弱)
[statedef 1100]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1100

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;==ブーストエフェクト
[state 2000]
type = Helper
trigger1 = AnimElem=5
id = 7720
stateno=7720
pos = 0,floor(-160*const(size.yscale))
postype = p1
ignorehitpause=1
pausemovetime=999
supermovetime=999
ownpal = 1
sprpriority = 2

;=====

[state 19000]
type = Explod
trigger1 = AnimElem=5
id = 6915
anim = 6915
pos = floor(-80*const(size.xscale)),0
postype = p1
ownpal = 1
sprpriority = 3
ignorehitpause=1
pausemovetime=999
supermovetime=999
scale = const(size.xscale),const(size.yscale)

[state 3100]
type = VarSet
trigger1 = Anim=1100&&AnimElem=5,=1
fvar(8) = 20.0

;==ブレーキ
[state 1100]
type = varset
trigger1 = !time
var(7) = 0

[state 1100]
type = varset
triggerall = AnimElem=5,>=1&&AnimElem=6,<0
trigger1 = command="holdback"&&!var(59)
var(7) = 1

[state 1100]
type = ChangeAnim
triggerall = AnimElem=5,>=1&&AnimElem=6,<0
trigger1 = var(7)=1
value = anim
elem = 7

[state 1050]
type = playsnd
trigger1 = AnimElem=7
value = 35,0

[state 3100]
type = VarSet
trigger1 = var(7)=1
fvar(8) = fvar(8)*.75

[state 3100]
type = VarSet
trigger1 = AnimElem=7,>=0&&var(7)!=1
fvar(8) = fvar(8)*.75

[state 19000]
type = Explod
trigger1 = AnimElem=7
id = 6915
anim = 6915
pos = floor(-80*const(size.xscale)),0
postype = p1
ownpal = 1
sprpriority = 3
ignorehitpause=1
pausemovetime=999
supermovetime=999
facing=-1
scale = const(size.xscale),const(size.yscale)

[state 5210]
type = varset
trigger1 = !time
var(56) = 0

[state 5210]
type = varadd
triggerall = var(45)<=0
trigger1 = AnimElem=5
trigger2 = var(56)
var(56) = 1

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = var(56) = [1,9]
time = 1
add = 255-(var(56)-1)*30,255-(var(56)-1)*30,255-(var(56)-1)*30

[state 1050]
type = playsnd
trigger1 = AnimElem=5
value = 30,1
channel = 10

[state 1100]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = !(P2stateno=11400&&P2movetype=I)
triggerall = !(P2stateno=15910&&P2movetype=I)
trigger1 = (P2stateno!=[150,155])&&!var(2)
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
attr = S,ST
hitflag = H
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
;ground.velocity = -26*const(size.xscale),-12*const(size.yscale)
;air.velocity = -26*const(size.xscale),-12*const(size.yscale)
p1stateno=1110
p1facing = 1
p2facing=1
numhits = 0
fall.recover=0

[state 1100]
type = HitDef
triggerall = !(P2stateno=1257&&P2movetype=H)
triggerall = !(P2stateno=11400&&P2movetype=H)
trigger1 = (P2stateno!=[150,155])&&var(2)
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
attr = S,ST
hitflag = HAF+
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=1110
p1facing = 1
p2facing=1
numhits = 0
fall.recover=0

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;戻り動作
[state 1000]
type = AttackDist
trigger1 = AnimElem=6
value = 0

[state 3100]
type = VelSet
trigger1 = !fvar(9) && !(fvar(5)&&!fvar(7)&&(enemynear,frontedgebodydist<=5||enemynear,backedgebodydist<=5))
x = fvar(8)

[state 3100]
type = VarSet
trigger1 = Anim=1100&&AnimElem=3
fvar(5) = 0

[state 1050]
type = changestate
trigger1 = animtime=0
value = 0
ctrl = 1

;灰塵乱渦（弱）掴み動作
[statedef 1110]
type = S
movetype=A
physics = S
ctrl = 0
velset = 0,0
anim = 1110

[state 800]
type = varset
trigger1 = !time
fvar(5) = 0

[state 800]
type = varset
trigger1 = !time
fvar(6) = 0

[state 800]
type = varset
trigger1 = !time
fvar(7) = 0

[state 800]
type = varset
trigger1 = !time
fvar(8) = 0

[state 800]
type = varset
trigger1 = !time
fvar(9) = 0

[state 800]
type = varset
trigger1 = !time
fvar(10) = 0

;気絶値リセット
[state 801]
type = varset
trigger1 = !time
var(28) = ifelse(var(28)>0,0,var(28))

[state 801]
type = varset
trigger1 = !time
var(29) = 0

[state 800]
type = varset
trigger1 = !time
var(1) = ifelse(var(1)%16>=8,8,0)

[state 800]
type = varset
trigger1 = !time
var(6) = ifelse(floor(var(6)%10000/1000)>0,1000,0)

[state 1100]
type = TargetState
trigger1 = animelemtime(20)<0&&numtarget
trigger1 = target,stateno!=1116
value = 1116

[state 5210]
type = varadd
trigger1 = var(56)
var(56) = 1

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = var(56) = [1,9]
time = 1
add = 255-(var(56)-1)*30,255-(var(56)-1)*30,255-(var(56)-1)*30

[state 5210]
type = Explod
trigger1 = AnimElem=6
trigger2 = AnimElem=10
id = 6150
anim = 6150
pos = 0,-floor(280*const(size.yscale))
postype = p1
bindtime=-1
sprpriority = 4
ownpal = 1
scale = .75,.5
removeongethit=1

[state 5210]
type = Explod
trigger1 = AnimElem=6
trigger2 = AnimElem=10
id = 6160
anim = 6160
pos = 0,-floor(260*const(size.yscale))
postype = p1
bindtime=-1
sprpriority = 4
ownpal = 1
scale = .75,.5
removeongethit=1

[state 5210]
type = Explod
trigger1 = AnimElem=6
trigger2 = AnimElem=10
id = 6160
anim = 6160
pos = 0,-floor(180*const(size.yscale))
postype = p1
bindtime=-1
sprpriority = 4
ownpal = 1
scale = .75,.5
removeongethit=1

[state 5210]
type = Explod
trigger1 = AnimElem=6
trigger2 = AnimElem=10
id = 6150
anim = 6150
pos = 0,-floor(140*const(size.yscale))
postype = p1
bindtime=-1
sprpriority = 4
ownpal = 1
scale = .75,.5
removeongethit=1

[state 190]
type = Explod
trigger1 = AnimElem=1
trigger2 = AnimElem=1,=3
trigger3 = AnimElem=1,=7
trigger4 = AnimElem=1,=11
trigger5 = AnimElem=2
trigger6 = AnimElem=3
trigger7 = AnimElem=4
trigger8 = AnimElem=5
id = 6910
anim = 6910
pos = floor(-20*const(size.xscale)),0
postype = P1
ownpal = 1
sprpriority = 3
bindtime=1
scale = const(size.xscale),const(size.yscale)

[state 190]
type = Explod
trigger1 = AnimElem=6
trigger2 = AnimElem=10
id = 6915
anim = 6915
pos = floor(-40*const(size.xscale)),0
postype = P1
ownpal = 1
sprpriority = 3
bindtime=1
scale = const(size.xscale),const(size.yscale)

[state 190]
type = Explod
trigger1 = AnimElem=8
trigger2 = AnimElem=12
id = 6915
anim = 6915
pos = floor(40*const(size.xscale)),0
postype = P1
ownpal = 1
sprpriority = 3
bindtime=1
facing=-1
scale = const(size.xscale),const(size.yscale)

[state 1250]
type = NotHitBy
trigger1 = AnimElemTime(2)>=0&&AnimElemTime(20)<=0
value = SCA

[state 1250]
type = PlayerPush
trigger1 = 1
value = 0

[state 801]
type = Width
trigger1 = animelemtime(1)=1
edge = floor(166*const(size.xscale)),0

[state 801]
type = Width
trigger1 = animelemtime(3)=1
edge = floor(240*const(size.xscale)),0

[state 801]
type = Width
trigger1 = animelemtime(4)=1
edge = floor(160*const(size.xscale))-floor(target,const(size.head.pos.y)*4.0/10),0

[state 801]
type = Width
trigger1 = animelemtime(5)=1
edge = floor(40*const(size.xscale))-target,const(size.head.pos.y),0

[state 801]
type = Width
trigger1 = animelemtime(20)=0
edge = ifelse(target,const(size.head.pos.y)<=-120,-target,const(size.head.pos.y)+target,const(size.ground.front),120-target,const(size.ground.front))+target,const(size.ground.back),0

[state 800]
type = PlaySND
trigger1 = !time
value = 7100,0
channel = 10

[state 801]
type = PlaySND
trigger1 = animelemtime(6)=0
trigger2 = animelemtime(9)=0
value = 30,2
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&animelemtime(20)=0
value = 10,5+(random<=500)
channel = 1

[state 801]
type = hitadd
trigger1 = animelemtime(1)=0
trigger2 = animelemtime(20)=0
value = 1

[state 801]
type = varadd
trigger1 = animelemtime(1)=0
trigger2 = animelemtime(20)=0
var(2) = 1

[state 801]
type = varadd
trigger1 = animelemtime(1)=0
trigger2 = animelemtime(20)=0
var(3) = 1

[state 801]
type = poweradd
trigger1 = animelemtime(20)=0
value = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16)))

[state 801]
type = targetpoweradd
trigger1 = animelemtime(20)=0
value = floor(floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3)

[state 801]
type = targetlifeadd
trigger1 = animelemtime(20)=0
value = -floor(77*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)

;強制基底補正80%
[state -1]
type = varadd
trigger1 = animelemtime(20)=0 && var(8)%16<8
var(8) = 8
ignorehitpause=1

;基底補正解除
[state 800]
type = varadd
trigger1 = animelemtime(20)=0
var(8) = -(var(8)%4>=2)*2-(var(8)%2>=1)

[state 801]
type = TargetBind
trigger1 = animelemtime(1)>=0&&animelemtime(3)<0
pos = floor(166*const(size.xscale)),floor(-180*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
pos = floor(240*const(size.xscale)),floor(-230*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(4)>=0&&animelemtime(5)<0
pos = floor(240*const(size.xscale)),floor(-140*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(5)>=0&&animelemtime(6)<0
pos = floor(140*const(size.xscale)),floor(-128*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(6)>=0&&animelemtime(7)<0
trigger2 = animelemtime(11)>=0&&animelemtime(12)<0
pos = -floor(110*const(size.xscale)),floor(-244*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(7)>=0&&animelemtime(8)<0
trigger2 = animelemtime(12)>=0&&animelemtime(13)<0
pos = -floor(120*const(size.xscale)),floor(-272*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(8)>=0&&animelemtime(9)<0
trigger2 = animelemtime(13)>=0&&animelemtime(14)<0
pos = floor(118*const(size.xscale)),floor(-268*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(9)>=0&&animelemtime(10)<0
trigger2 = animelemtime(14)>=0&&animelemtime(15)<0
pos = floor(180*const(size.xscale)),floor(-250*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(10)>=0&&animelemtime(11)<0
trigger2 = animelemtime(15)>=0&&animelemtime(16)<0
pos = floor(126*const(size.xscale)),floor(-236*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(16)>=0&&animelemtime(17)<0
pos = floor(-142*const(size.xscale)),floor(-222*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(17)>=0&&animelemtime(18)<0
pos = floor(-150*const(size.xscale)),floor(-270*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(18)>=0&&animelemtime(19)<0
pos = floor(-72*const(size.xscale)),floor(-328*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(19)>=0&&animelemtime(20)<0
pos = floor(46*const(size.xscale)),floor(-342*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(20)=0
pos = floor(240*const(size.xscale)),floor(-80*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(20)=0&&target,const(size.head.pos.y)<=-120
pos = -(target,const(size.head.pos.y)+24),floor(-80*const(size.yscale))-(target,const(size.head.pos.y)<=-120)*ifelse((target,const(size.head.pos.y)+100)<-20,-20,(target,const(size.head.pos.y)+100))

[state 801]
type = TargetBind
trigger1 = numtarget
trigger1 = animelemtime(20)=0&&target,const(size.head.pos.y)>=-100
pos = floor(240*const(size.xscale))-(target,const(size.head.pos.y)+100),floor(-80*const(size.yscale))-5

[state 1050]
type = TargetState
trigger1 = animelemtime(20)=0
value = 926

[state 1050]
type = VarAdd
trigger1 = animelemtime(20)=0 && var(1)%2<1
var(1) = 1-(var(1)%16>=8&&var(1)%8>=4)*4

[state 1050]
type = PosAdd
trigger1 = animelemtime(18)=0
x = floor(40*const(size.xscale))

[state 1050]
type = VelSet
trigger1 = animelemtime(18)=1
x = 6.0

[state 1050]
type = VelMul
trigger1 = animelemtime(18)>1
x = .9

[state 1050]
type = VelSet
trigger1 = animelemtime(21)=0
x = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = AnimElemTime(20)=0
fvar(15) = .00005*floor(ifelse(77*fvar(14)<1,1+(var(2)%5=1),77*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = AnimElemTime(20)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

[state 1050]
type = changestate
trigger1 = animtime=0
value = 0
ctrl = 1

;灰塵乱渦（弱）相手動作
[statedef 1116]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=1116
value = 1116

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 0,0

[state 1116]
type = SprPriority
trigger1 = 1
value = -1

[state 1116]
type = SprPriority
trigger1 = time=[15,30]
trigger2 = time=[35,41]
trigger3 = time=[45,51]
trigger4 = time=[52,63]
value = 2

[state 1116]
type = SelfState
trigger1 = time>=77
value = 5210

;灰塵乱渦（中）
[statedef 1150]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1150

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;==ブーストエフェクト
[state 2000]
type = Helper
trigger1 = Anim=1150&&AnimElem=5
id = 7720
stateno=7720
pos = 0,floor(-160*const(size.yscale))
postype = p1
ignorehitpause=1
pausemovetime=999
supermovetime=999
ownpal = 1
sprpriority = 2

;=====

[state 1100]
type = Explod
trigger1 = Anim=1150&&AnimElem=5
id = 6915
anim = 6915
pos = floor(-80*const(size.xscale)),0
postype = p1
ownpal = 1
sprpriority = 3
ignorehitpause=1
pausemovetime=999
supermovetime=999
scale = const(size.xscale),const(size.yscale)

[state 3100]
type = VarSet
trigger1 = Anim=1150&&AnimElem=5,=1
fvar(8) = 20.0

;==ブレーキ
[state 1100]
type = varset
trigger1 = !time
var(7) = 0

[state 1100]
type = varset
triggerall = Anim=1150&&AnimElem=5,>=2&&AnimElem=6,<0
trigger1 = command="holdback"&&!var(59)
trigger2 = AnimElem=5,>=2&&((random%10<7&&P2bodydist X<=50&&(var(2)<=1||((Prevstateno=410||prevstateno=220)&&var(2)<=4)))||(prevstateno=1400&&var(2)<=1))&&!var(3)&&var(59)
var(7) = 1

[state 1100]
type = ChangeAnim
triggerall = Anim=1150&&AnimElem=5,>=2&&AnimElem=6,<0
trigger1 = var(7)=1
value = 1155

[state 1050]
type = playsnd
trigger1 = AnimElem=7
value = 35,0

[state 3100]
type = VarSet
trigger1 = var(7)=1
fvar(8) = fvar(8)*.75

[state 3100]
type = VarSet
trigger1 = AnimElem=7,>=0&&var(7)!=1
fvar(8) = fvar(8)*.75

[state 19000]
type = Explod
trigger1 = AnimElem=7
trigger2 = Anim=1155&&AnimElem=1
id = 6915
anim = 6915
pos = floor(-80*const(size.xscale)),0
postype = p1
ownpal = 1
sprpriority = 3
ignorehitpause=1
pausemovetime=999
supermovetime=999
facing=-1
scale = const(size.xscale),const(size.yscale)

[state 5210]
type = varset
trigger1 = !time
var(56) = 0

[state 5210]
type = varadd
triggerall = var(45)<=0
trigger1 = Anim=1150&&AnimElem=5
trigger2 = var(56)
var(56) = 1

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = var(56) = [1,9]
time = 1
add = 255-(var(56)-1)*30,255-(var(56)-1)*30,255-(var(56)-1)*30

[state 1050]
type = playsnd
trigger1 = Anim=1150&&AnimElem=5
value = 30,1
channel = 10

[state 1100]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = !(P2stateno=11400&&P2movetype=I)
triggerall = !(P2stateno=15910&&P2movetype=I)
trigger1 = (P2stateno!=[150,155])&&!var(2)
trigger1 = Anim=1150&&AnimElem=5,>=0&&AnimElem=6,<0
attr = S,ST
hitflag = L
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=1160
p1facing = 1
p2facing=1
numhits = 0
fall.recover=0

[state 1100]
type = HitDef
triggerall = !(P2stateno=1257&&P2movetype=H)
triggerall = !(P2stateno=11400&&P2movetype=H)
trigger1 = (P2stateno!=[150,155])&&var(2)
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
attr = S,ST
hitflag = LAF+
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=1160
p1facing = 1
p2facing=1
numhits = 0
fall.recover=0

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;戻り動作
[state 1000]
type = AttackDist
trigger1 = AnimElem=6||Anim=1155
value = 0

[state 3100]
type = VelSet
trigger1 = !fvar(9) && !(fvar(5)&&!fvar(7)&&(enemynear,frontedgebodydist<=5||enemynear,backedgebodydist<=5))
x = fvar(8)

[state 3100]
type = VarSet
trigger1 = Anim=1150&&AnimElem=3
fvar(5) = 0

[state 1050]
type = changestate
trigger1 = animtime=0
value = 0
ctrl = 1

;灰塵乱渦（中）掴み動作
[statedef 1160]
type = S
movetype=A
physics = S
ctrl = 0
velset = 0,0
anim = 1160

[state 800]
type = varset
trigger1 = !time
fvar(5) = 0

[state 800]
type = varset
trigger1 = !time
fvar(6) = 0

[state 800]
type = varset
trigger1 = !time
fvar(7) = 0

[state 800]
type = varset
trigger1 = !time
fvar(8) = 0

[state 800]
type = varset
trigger1 = !time
fvar(9) = 0

[state 800]
type = varset
trigger1 = !time
fvar(10) = 0

;気絶値リセット
[state 801]
type = varset
trigger1 = !time
var(28) = ifelse(var(28)>0,0,var(28))

[state 801]
type = varset
trigger1 = !time
var(29) = 0

[state 800]
type = varset
trigger1 = !time
var(1) = ifelse(var(1)%16>=8,8,0)

[state 800]
type = varset
trigger1 = !time
var(6) = ifelse(floor(var(6)%10000/1000)>0,1000,0)

[state 1100]
type = TargetState
trigger1 = animelemtime(2)<0&&numtarget
trigger1 = target,stateno!=1166
value = 1166

[state 1050]
type = TargetState
trigger1 = animelemtime(2)>=0&&animelemtime(3)<0&&numtarget
trigger1 = target,stateno!=1167
value = 1167

[state 1050]
type = TargetState
trigger1 = animelemtime(3)>=0&&animelemtime(5)<0&&numtarget
trigger1 = target,stateno!=1168
value = 1168

[state 1050]
type = TargetState
trigger1 = animelemtime(5)>=0&&animelemtime(7)<0&&numtarget
trigger1 = target,stateno!=1169
value = 1169

[state 800]
type = varset
trigger1 = !time
var(1) = ifelse(var(1)%16>=8,8,0)

[state 800]
type = varset
trigger1 = !time
var(6) = ifelse(floor(var(6)%10000/1000)>0,1000,0)

[state 5210]
type = varadd
trigger1 = var(56)
var(56) = 1

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = var(56) = [1,9]
time = 1
add = 255-(var(56)-1)*30,255-(var(56)-1)*30,255-(var(56)-1)*30

[state 801]
type = Width
trigger1 = animelemtime(1)=1
edge = floor(144*const(size.xscale)),0

[state 801]
type = Width
trigger1 = animelemtime(2)=1
edge = floor(166*const(size.xscale)),0

[state 801]
type = Width
trigger1 = animelemtime(7)=0
edge = 0,target,const(size.air.back);floor(206*const(size.xscale))+target,const(size.air.back)

[state 1250]
type = NotHitBy
trigger1 = AnimElemTime(2)>=0&&AnimElemTime(7)<=0
value = SCA

[state 1250]
type = PlayerPush
trigger1 = 1
value = 0

[state 800]
type = PlaySND
trigger1 = !time
value = 7100,0
channel = 10

[state 801]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&animelemtime(7)=0
value = 10,5+(random<=500)
channel = 1

[state 801]
type = hitadd
trigger1 = animelemtime(1)=0
trigger2 = animelemtime(7)=0
value = 1

[state 801]
type = varadd
trigger1 = animelemtime(1)=0
trigger2 = animelemtime(7)=0
var(2) = 1

[state 801]
type = varadd
trigger1 = animelemtime(1)=0
trigger2 = animelemtime(7)=0
var(3) = 1

[state 801]
type = poweradd
trigger1 = animelemtime(7)=0
value = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16)))

[state 801]
type = targetpoweradd
trigger1 = animelemtime(7)=0
value = floor(floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3)

[state 801]
type = targetlifeadd
trigger1 = animelemtime(7)=0
value = -floor(77*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)

;強制基底補正80%
[state -1]
type = varadd
trigger1 = animelemtime(7)=0 && var(8)%16<8
var(8) = 8
ignorehitpause=1

;基底補正解除
[state 800]
type = varadd
trigger1 = animelemtime(7)=0
var(8) = -(var(8)%4>=2)*2-(var(8)%2>=1)

[state 801]
type = TargetBind
trigger1 = animelemtime(1)>=0&&animelemtime(2)<0
pos = floor(144*const(size.xscale)),floor(-220*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(2)>=0&&animelemtime(3)<0
pos = floor(166*const(size.xscale)),floor(-236*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
pos = floor(148*const(size.xscale)),floor(-294*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(4)>=0&&animelemtime(5)<0
pos = floor(100*const(size.xscale)),floor(-292*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(5)>=0&&animelemtime(6)<0
pos = floor(58*const(size.xscale)),floor(-304*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(6)>=0&&animelemtime(7)<0
pos = floor(-40*const(size.xscale)),floor(-334*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(7)=0
pos = floor(-206*const(size.xscale)),floor(-80*const(size.yscale))-(target,const(size.head.pos.y)<=-120)*ifelse((target,const(size.head.pos.y)+100)<-20,-20,(target,const(size.head.pos.y)+100))

[state 801]
type = TargetBind
trigger1 = animelemtime(7)=0&&target,const(size.head.pos.y)>=-105
pos = floor(-206*const(size.xscale)),floor(-80*const(size.yscale))-ifelse((target,const(size.head.pos.y)+110)>40,20,floor((target,const(size.head.pos.y)+100)*.5))

[state 1050]
type = TargetState
trigger1 = animelemtime(7)=0
value = 926

[state 1050]
type = VarAdd
trigger1 = animelemtime(7)=0 && var(1)%2<1
var(1) = 1-(var(1)%16>=8&&var(1)%8>=4)*4

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = AnimElemTime(7)=0
fvar(15) = .00005*floor(ifelse(77*fvar(14)<1,1+(var(2)%5=1),77*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = AnimElemTime(7)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

[state 1050]
type = null;turn
trigger1 = animtime=-1

[state 1050]
type = null;CtrlSet
trigger1 = animtime=-1
value = 1

[state 1050]
type = changestate
trigger1 = animtime=0
value = 0
ctrl = 1

;灰塵乱渦（中）相手動作
[statedef 1166]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=1166
value = 1166

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 0,0

[state 1116]
type = SprPriority
trigger1 = 1
value = -1

[state 1116]
type = SelfState
trigger1 = time>=20
value = 5210

;灰塵乱渦（中）相手動作
[statedef 1167]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=1167
value = 1167

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 0,0

[state 1116]
type = SprPriority
trigger1 = 1
value = -1

[state 1116]
type = Turn
trigger1 = !time&&prevstateno=1166

[state 1116]
type = SelfState
trigger1 = time>=8
value = 5210

;灰塵乱渦（中）相手動作
[statedef 1168]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=1168
value = 1168

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 0,0

[state 1116]
type = SprPriority
trigger1 = 1
value = -1

[state 1116]
type = SelfState
trigger1 = time>=12
value = 5210

;灰塵乱渦（中）相手動作
[statedef 1169]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=1169
value = 1169

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 0,0

[state 1116]
type = SprPriority
trigger1 = 1
value = 2

[state 1116]
type = SelfState
trigger1 = time>=12
value = 5210

;天地葬送
[statedef 1200]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))&&fvar(10)<=0
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1200

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(prevstateno=155,stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=6

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
triggerall = anim=1200
trigger1 = AnimElem=6
value = 7300,3
channel = 10

[state 190]
type = PlaySND
triggerall = anim=1200
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=6
value = 10,5+(random<500)
channel = 1

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (P2stateno!=[150,155])
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
hitsound = -1
guardsound = -1
getpower = 0,0
givepower = 0,0
numhits = 0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
yaccel = .5
attr = A,ST
hitflag = AFD
priority = 1,Miss
p1stateno=1250
p1facing = 1
p2facing = 1

[state 200]
type = AttackDist
trigger1 = AnimElem=8
value = 0

[state 200]
type = Statetypeset
trigger1 = AnimElem=8
movetype=I

[state 1200]
type = PlayerPush
trigger1 = Statetype=A&&(P2bodydist Y>40||P2bodydist Y<-40)
value = 0

[state 200]
type = NotHitBy
trigger1 = AnimElem=6,<0
value = SCA

[state 200]
type = StatetypeSet
trigger1 = AnimElem=6
statetype=A
physics = N

[state 200]
type = VelSet
trigger1 = Anim=1200 && AnimElem=6,=1
x = 14.0
y = -11.5

[state 200]
type = VelSet
trigger1 = Anim=1200 && AnimElem=7
x = 12.0

[state 200]
type = VelMul
trigger1 = Anim=1200 && AnimElem=7,>0 && vel Y<0
x = .8

[state 200]
type = VelSet
trigger1 = Anim=1200 && AnimElem=6,>0 && Vel Y>=0
x = 0
persistent=0

[state 200]
type = VelAdd
trigger1 = Anim=1200 && AnimElem=6,>0
y = .55

[state 50]
type = PlaySND
trigger1 = AnimElem=10,=1
value = 41,0
volume = 128

[state 200]
type = VarSet
trigger1 = !time&&(prevstateno=[1000,1999])&&var(5)%256<128
var(5) = var(5)+128

[state 200]
type = ChangeState
trigger1 = Anim=1200 && Vel Y>0 && Pos Y>=-Vel Y
value = 52

[state 200]
type = VarSet
trigger1 = !Time
fvar(8) = 0

[state 200]
type = VarSet
trigger1 = Anim=1200 && AnimElem=6,=1
fvar(8) = 14.0

[state 200]
type = VarSet
trigger1 = Anim=1200 && AnimElem=7
fvar(8) = 12.0

[state 200]
type = VarSet
trigger1 = Anim=1200 && AnimElem=7,>0 && vel Y<0
fvar(8) = fvar(8)*.8

[state 200]
type = VarSet
trigger1 = Anim=1200 && AnimElem=6,>0 && Vel Y>=0
fvar(8) = 0

;■■■■■■■
;天地葬送掴み
[statedef 1250]
type = A
physics = N
movetype=A
ctrl = 0
velset = 0,0
anim = 1250

[state 800]
type = varset
trigger1 = !time
fvar(5) = 0

[state 800]
type = varset
trigger1 = !time
fvar(6) = 0

[state 800]
type = varset
trigger1 = !time
fvar(7) = 0

[state 800]
type = varset
trigger1 = !time
fvar(8) = 0

[state 800]
type = varset
trigger1 = !time
fvar(9) = 0

[state 800]
type = varset
trigger1 = !time
fvar(10) = 0

;気絶値リセット
[state 801]
type = varset
trigger1 = !time
var(28) = ifelse(var(28)>0,0,var(28))

[state 801]
type = varset
trigger1 = !time
var(29) = 0

[state 800]
type = varset
trigger1 = !time
var(1) = ifelse(var(1)%16>=8,8,0)

[state 800]
type = varset
trigger1 = !time
var(6) = ifelse(floor(var(6)%10000/1000)>0,1000,0)

[state 801]
type = targetstate
trigger1 = time=0||(target,stateno!=1256&&anim=1250)
value = 1256

[state 801]
type = ChangeAnim
trigger1 = Anim=1250&&Vel Y>0 && Pos Y>=-Vel Y
value = 1251

[state 801]
type = StatetypeSet
trigger1 = Anim=1251
statetype=S
physics = S
persistent=0

[state 801]
type = VelSet
trigger1 = Anim=1251
x = 0
y = 0
persistent=0

[state 801]
type = posadd
trigger1 = Anim=1251&&AnimElemTime(1)=0
x = floor(60*const(size.xscale))

[state 801]
type = PosSet
trigger1 = Anim=1251
y = 0
persisten=0

[state 1250]
type = varset
trigger1 = Anim=1251&&AnimElem=1
var(12) = 143+36
persistent=0

[state 5210]
type = Explod
trigger1 = Anim=1250&&AnimElem=3,=1&&Vel Y>=0
id = 6150
anim = 6155
pos = 0,-floor(320*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
scale = const(size.xscale),const(size.yscale)
removeongethit=1

[state 5210]
type = Explod
trigger1 = Anim=1250&&AnimElem=3,=1&&Vel Y>=0
id = 6160
anim = 6165
pos = 0,-floor(260*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
scale = const(size.xscale),const(size.yscale)
removeongethit=1

[state 5210]
type = Explod
trigger1 = Anim=1250&&AnimElem=3,=1&&Vel Y>=0
id = 6160
anim = 6165
pos = 0,-floor(180*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
scale = const(size.xscale),const(size.yscale)
removeongethit=1

[state 5210]
type = Explod
trigger1 = Anim=1250&&AnimElem=3,=1&&Vel Y>=0
id = 6150
anim = 6155
pos = 0,-floor(160*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
scale = const(size.xscale),const(size.yscale)
removeongethit=1

[state 801]
type = VarSet
trigger1 = !time
var(7) = 0

[state 801]
type = VarSet
trigger1 = frontedgebodydist<=(target,const(size.air.back)+target,const(size.air.front))
var(7) = frontedgebodydist

[state 1250]
type = NotHitBy
trigger1 = Anim=1250 && AnimElemTime(2)>=0
value = SCA

[state 806]
type = PlayerPush
trigger1 = Anim=1250
value = 0

[state 801]
type = ScreenBound
trigger1 = anim=1250 && AnimElemTime(2)>=0
value = 0
movecamera = 1,1

[state 4100]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=1251&&animelem=6&&random%2=0&&var(2)>1&&roundstate=2
trigger1 = var(10) := floor(172*(TicksPerSecond/60))
value = 10,63
channel = 1
;2.857sec

[state 801]
type = Width
trigger1 = Anim=1250&&animelemtime(1)=0
edge = floor(140*const(size.xscale)),0

[state 801]
type = Width
trigger1 = Anim=1251&&animelemtime(1)=0
edge = floor(40*const(size.xscale))+target,const(size.air.back),0

[state 801]
type = hitadd
trigger1 = Anim=1250&&animelemtime(1)=0
trigger2 = Anim=1251&&animelemtime(1)=0
value = 1

[state 801]
type = varadd
trigger1 = Anim=1250&&animelemtime(1)=0
trigger2 = Anim=1251&&animelemtime(1)=0
var(2) = 1

[state 801]
type = varadd
trigger1 = Anim=1250&&animelemtime(1)=0
trigger2 = Anim=1251&&animelemtime(1)=0
var(3) = 1

[state 801]
type = targetlifeadd
trigger1 = Anim=1251&&animelemtime(1)=0
value = -floor(109*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)

;強制基底補正70%
[state -1]
type = varadd
trigger1 = Anim=1251&&animelemtime(1)=0 && var(8)%32<16
var(8) = 16
ignorehitpause=1

;基底補正解除
[state 800]
type = varadd
trigger1 = Anim=1251&&animelemtime(1)=0
var(8) = -(var(8)%4>=2)*2-(var(8)%2>=1)

;気絶値増加
[state -1]
type = varadd
trigger1 = Anim=1251&&animelemtime(1)=0
var(29) = floor(6*fvar(1))
ignorehitpause=1

[state 801]
type = poweradd
trigger1 = Anim=1251&&animelemtime(1)=0
value = floor(ifelse(var(9),0,floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16)))

[state 801]
type = targetpoweradd
trigger1 = Anim=1251&&animelemtime(1)=0
value = floor(floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3)

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = animelemtime(2)<0
pos = floor(100*const(size.xscale)),floor(-380*const(size.yscale))

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = animelemtime(2)>=0&&animelemtime(3)<0
pos = floor(25*const(size.xscale)),floor(-240*const(size.yscale))

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
trigger2 = animelemtime(5)>=0&&animelemtime(6)<0
pos = floor(0*const(size.xscale)),floor(-80*const(size.xscale))

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = animelemtime(4)>=0&&animelemtime(5)<0
pos = floor(-40*const(size.xscale)),floor(-80*const(size.xscale))

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = animelemtime(6)>=0
pos = floor(40*const(size.xscale)),floor(-80*const(size.xscale))

[state 801]
type = VelSet
trigger1 = Anim=1250&&AnimElemTime(2)=1
x = 2.5
y = -9.0
persistent=0

[state 801]
type = VelAdd
trigger1 = Anim=1250&&AnimElemTime(2)>1
y = .5

[state 801]
type = targetbind
trigger1 = Anim=1251&&AnimElemTime(1)=0
pos = floor(70*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetstate
trigger1 = Anim=1251&&numtarget
trigger1 = target,stateno!=1257
value = 1257

[state 801]
type = PlaySND
trigger1 = Anim=1250&&animelemtime(1)=0
value = 7100,2
channel = 10

[state 801]
type = PlaySND
trigger1 = Anim=1250&&animelemtime(3)=1
value = 7300,2
channel = 10

[state 801]
type = PlaySND
trigger1 = Anim=1250&&animelemtime(6)=1
value = 30,2
channel = 11

[state 801]
type = null;PlaySND
trigger1 = Anim=1251&&animelemtime(1)=0
value = 5100,2
channel = 10

[state 4100]
type = PlaySND
trigger1 = Anim=1251&&animelemtime(1)=0
value = 30,3
channel = 11
volume = 128

[state 5210]
type = RemoveExplod
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6150

[state 5210]
type = RemoveExplod
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6160

[state 1250]
type = EnvShake
trigger1 = Anim=1251&&animelemtime(1)=0
ampl = 4
time = 16

[state 6310]
type = Helper
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6310
stateno = 6310
pos = 40+ifelse(var(7),var(7)-target,const(size.air.front)-target,const(size.air.back),0)
postype = p1
ownpal = 1
sprpriority = 4

[state 1250]
type = Helper
trigger1 = Anim=1251&&animelemtime(1)=0&&numtarget
trigger1 = (!target,SelfAnimExist(9060)||!(target,authorname="rei"||target,authorname="gal129"||target,name="keiji"))
id = 6855
stateno = 6855
pos = floor(20*const(size.xscale))+target,const(size.air.back)+ifelse(var(7),var(7)-target,const(size.air.front)-target,const(size.air.back),0),8
postype = p1
ownpal = 1
sprpriority = 4
size.xscale = ifelse((target,const(size.ground.front)+target,const(size.ground.back))>=40,.75,.5)*const(size.xscale)
size.yscale = ifelse((target,const(size.ground.front)+target,const(size.ground.back))>=40,.75,.5)*const(size.yscale)

[state 801]
type = Explod
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6200
anim = 6200
pos = floor(0*const(size.xscale))+target,const(size.air.back),0
postype = p1
scale = .5,.5
ownpal = 1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

[state 801]
type = Explod
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6200
anim = 6200
pos = floor(0*const(size.xscale))+target,const(size.air.back),0
postype = p1
scale = .5,.5
ownpal = 1
facing=-1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

[State 40, 1]
type = Helper
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6925
stateno = 6920
pos = floor(0*const(size.xscale))+target,const(size.air.back)+ifelse(var(7),var(7)-target,const(size.air.front)-target,const(size.air.back),0),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = Anim=1251&&AnimElemTime(1)=0
fvar(15) = .00005*floor(ifelse(109*fvar(14)<1,1+(var(2)%5=1),109*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = Anim=1251&&AnimElemTime(1)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

[state 1000]
type = PosAdd
trigger1 = Anim=1251&&AnimElem=5
x = -floor(10*const(size.xscale))

[state 1000]
type = PosAdd
trigger1 = Anim=1251&&AnimElem=6
x = -floor(20*const(size.xscale))

[state 1000]
type = ChangeState
trigger1 = Anim=1251&&AnimTime=0
value = 0
ctrl = 1

;■■■■■■■
;天地葬送食らい
[statedef 1256]
type = S
physics = N
movetype=H
ctrl = 0
velset = 0,0
sprpriority = -1

[state 806]
type = ChangeAnim2
trigger1 = time=0&&Anim!=1256
value = 1256

[state 806]
type = PlayerPush
trigger1 = 1
value = 0

[state 806]
type = ScreenBound
trigger1 = 1
value = 0

[state 806]
type = SelfState
trigger1 = !enemynear,numpartner
trigger1 = enemynear,name="Toyotomi_Hideyoshi"&&P2movetype=H
trigger2 = time>=90
value = 5040

;■■■■■■■
;天地葬送食らい（生き埋め）
[statedef 1257]
type = A
physics = N
movetype=H
ctrl = 0
velset = 0,0
sprpriority = 2

[state 1257]
type = NotHitBy
trigger1 = roundstate>=3
value = SCA

[state 806]
type = PlayerPush
trigger1 = 1
value = (time>36)

[state 806]
type = PosFreeze
trigger1 = 1
value = 1

[state 806]
type = ChangeAnim2
trigger1 = time=0&&(!SelfAnimExist(9060)||!(authorname="rei"||authorname="gal129"||name="keiji"))
value = 1257+(const(size.head.pos.y)<=-100)

[state 806]
type = ChangeAnim
trigger1 = time=0&&SelfAnimExist(9060)&&(authorname="rei"||authorname="gal129"||name="keiji")
value = 9060

[state 806]
type = Posset
trigger1 = Anim!=9060
y = -ceil(const(size.head.pos.y)/2.25)

[state 806]
type = PosAdd
trigger1 = Time>=60&&alive&&!IsHelper&&time%2=0
trigger1 = (enemynear,name="Toyotomi Hideyoshi"&&enemynear,authorname="rei"&&enemynear,var(12)<48)||!(enemynear,name="Toyotomi Hideyoshi"&&enemynear,authorname="rei"&&time>=48)
x = -2*ifelse(time%4=0,-1,1)

[state 806]
type = PosSet
trigger1 = Time>=60&&alive&&!IsHelper
trigger1 = (enemynear,name="Toyotomi Hideyoshi"&&enemynear,authorname="rei"&&!enemynear,var(12))||!(enemynear,name="Toyotomi Hideyoshi"&&enemynear,authorname="rei")
y = -1

[state 3516]
type = ChangeState
trigger1 = Time>=60 && !alive && (enemynear(numenemy-1),stateno=0&&enemynear(0),stateno=0)
trigger2 = Time>=60 && IsHelper
value = 5150

[state 806]
type = SelfState
trigger1 = Time>=60&&alive&&!IsHelper
trigger1 = (enemynear,name="Toyotomi Hideyoshi"&&enemynear,authorname="rei"&&!enemynear,var(12))||!(enemynear,name="Toyotomi Hideyoshi"&&enemynear,authorname="rei")
value = 5210

;生き埋め用
[statedef 1258]
type     = A
physics  = N
movetype = H
ctrl     = 0
velset   = 0,0

[state 926]
type = PosSet
trigger1 = !time
y = 0

[state 926]
type = SelfState
trigger1 = !time
value = 5000

;叩きつけオーラエフェクト
[statedef 6310]
type = S
ctrl = 0
anim = 90000

[state 3510]
type = Explod
trigger1 = !time
anim = 6310
id = 6310
pos = 0,0
postype = p1
sprpriority = -3
scale = const(size.xscale)*1.5,const(size.yscale)*.5

[state 3510]
type = ModifyExplod
trigger1 = 1
scale = const(size.xscale)*2.0*(1+time*.125),const(size.yscale)*.5*(1+time*.125)

[state 6310]
type = DestroySelf
trigger1 = Time>11

;生き埋め時地面岩盤
[statedef 6855]
type = S
ctrl = 0
anim = 90000

[state 6855]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3510]
type = Explod
trigger1 = !time
anim = 6851
id = 6851
pos = 0,floor(60*const(size.yscale))
postype = p1
sprpriority = 4
removeongethit=1
scale = const(size.xscale)*.75,const(size.yscale)*1.25

[state 3510]
type = Explod
trigger1 = !time
anim = 6851
id = 6851
pos = 0,0
postype = p1
sprpriority = 4
removeongethit=1
scale = const(size.xscale)*.75,const(size.yscale)*1.25

[state 3510]
type = RemoveExplod
trigger1 = time&&enemynear,id=var(1)&&!(enemynear,stateno=1257&&P2movetype=H)&&!(enemynear,stateno=5150&&enemynear,prevstateno=1257&&(enemynear,anim=[1257,1258]))
persistent=0

[state 3510]
type = Explod
trigger1 = time&&enemynear,id=var(1)&&!(enemynear,stateno=1257&&P2movetype=H)&&!(enemynear,stateno=5150&&enemynear,prevstateno=1257&&(enemynear,anim=[1257,1258]))
anim = 6852
id = 6852
pos = 0,floor(40*const(size.yscale))
postype = p1
sprpriority = 4
removeongethit=1
scale = const(size.xscale)*.75,const(size.yscale)*1.25
persistent=0

[state 3510]
type = Explod
trigger1 = time&&enemynear,id=var(1)&&!(enemynear,stateno=1257&&P2movetype=H)&&!(enemynear,stateno=5150&&enemynear,prevstateno=1257&&(enemynear,anim=[1257,1258]))
anim = 6852
id = 6852
pos = 0,0
postype = p1
sprpriority = 4
removeongethit=1
scale = const(size.xscale)*.75,const(size.yscale)*1.25
persistent=0

[state 6850]
type = varset
trigger1 = !time
var(1) = ifelse(numenemy=2&&enemynear(numenemy-1),stateno!=1257,enemynear(0),id,enemynear(numenemy-1),id)

[state 6850]
type = VarAdd
trigger1 = time&&enemynear,id=var(1)&&!(enemynear,stateno=1257&&P2movetype=H)&&!(enemynear,stateno=5150&&enemynear,prevstateno=1257&&(enemynear,anim=[1257,1258]))
trigger2 = var(0)
var(0) = 1

[state 6850]
type = RemoveExplod
trigger1 = var(0)>14

[state 6850]
type = DestroySelf
trigger1 = var(0)>14

;破邪衝天
[statedef 1300]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1300

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=7

;攻撃状態維持用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = (!root,var(34)||root,animelemtime(4)>=0||(root,stateno!=1300&&root,anim!=1300))

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElem=4
value = 30,4
channel = 10

[state 200]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=4&&!IsHelper
value = 10,42+(random%2)*2
channel = 1

[state 1300]
type = varset
trigger1 = animelemtime(5)=0
var(7) = 0
ignorehitpause=1

[state 1300]
type = varadd
trigger1 = animelemtime(5)>=0&&animelemtime(8)<=0
trigger1 = (command="y"&&!var(59))||var(59)
var(7) = 1
ignorehitpause=1

[state 1300]
type = changestate
trigger1 = animelemtime(8)=0&&var(7)>=1
value = 1310
ignorehitpause=1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4(1)
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=5
trigger2 = AnimElem=7
damage = floor(ifelse(30*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)<1,1+(var(2)%5=4),30*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4))*1.22),floor(ceil(30*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,13+var(49)*7
ground.velocity = -0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(55*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-240*const(size.xscale))
animtype = hard
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA

[state 200]
type = AttackDist
trigger1 = AnimElem=8
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(30*fvar(14)<1,1+(var(2)%5=1),30*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 10+random%6
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=8,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-160*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
var(18) = floor(-200*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = 0*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
triggerall = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
trigger1 = var(1)=1||(var(1)=[3,6])
fvar(5) = 0*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,8,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;破邪衝天・追打1
[statedef 1310]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1310

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElem=2
trigger2 = AnimElem=3
trigger3 = AnimElem=4
trigger4 = AnimElem=5
value = 30,4
channel = 10

[state 1300]
type = varset
trigger1 = animelemtime(2)=0
var(7) = 0
ignorehitpause=1

[state 1300]
type = varadd
trigger1 = animelemtime(1)>=0&&animelemtime(5)<=0
trigger1 = ((command="y"&&!var(59))||var(59))&&var(7)<9
var(7) = 1
ignorehitpause=1

[state 1300]
type = changestate
trigger1 = animelemtime(5)=0&&var(7)=[1,9]
value = 1320
ignorehitpause=1

[state 1300]
type = varset
trigger1 = animelemtime(2)>=0&&animelemtime(5)<0
trigger1 = command="z"&&!var(59)
var(7) = 10
ignorehitpause=1

[state 1300]
type = changestate
trigger1 = (animelemtime(3)=0||animelemtime(4)=0||animelemtime(5)=0)&&movecontact!=1&&var(7)>=10
value = 1350
ignorehitpause=1

[state 900]
type = StatetypeSet
trigger1 = AnimElem=2
physics = N

[state 900]
type = VelSet
trigger1 = AnimElem=2
x = 1.0+fvar(9)

[state 900]
type = VelSet
trigger1 = AnimElem=5,=0
x = 0+fvar(9)

;現在の速度取得
[state 900]
type = VarSet
trigger1 = AnimElem=2
fvar(8) = 1.0

[state 900]
type = VarSet
trigger1 = AnimElem=5,=0
fvar(8) = 0

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 4

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4(1)
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=2
trigger2 = AnimElem=3
trigger3 = AnimElem=4
damage = floor(ifelse(12*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)<1,1+(var(2)%5=4),12*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4))*1.22),floor(ceil(12*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,4+var(49)*7
ground.velocity = -6.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-6.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0005,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-8.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-240*const(size.xscale))
animtype = hard
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA

[state 200]
type = AttackDist
trigger1 = AnimElem=11
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(12*fvar(14)<1,1+(var(2)%5=1),12*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=2
var(16) = 10+random%6
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=2,>=0&&AnimElem=5,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=2,>=0&&AnimElem=5,<0
var(18) = floor(-160*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=3,>=0&&AnimElem=4,<0
var(18) = floor(-100*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-6.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-6.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
triggerall = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
trigger1 = var(1)=1||(var(1)=[3,6])
fvar(5) = (-6.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,8,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (4-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;破邪衝天・追打2
[statedef 1320]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1320

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper&&!(((prevstateno=[600,620])||(prevstateno=[1320,1344])||(prevstateno=[1650,1660]))&&var(11))
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=7

;攻撃状態維持用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = (!root,var(34)||root,animelemtime(4)>=0||(root,stateno!=1300&&root,anim!=1300))

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElem=1
trigger2 = AnimElem=2
trigger3 = AnimElem=3
trigger4 = AnimElem=4
trigger5 = AnimElem=5
trigger6 = AnimElem=6
value = 30,4
channel = 10

[state 1300]
type = varset
trigger1 = animelemtime(1)=0
var(7) = 0
ignorehitpause=1

[state 1300]
type = varadd
trigger1 = animelemtime(1)>=0&&animelemtime(10)<0
trigger1 = command="z"&&!var(59)
var(7) = 1
ignorehitpause=1

[state 1300]
type = changestate
trigger1 = (animelemtime(2)=0||animelemtime(3)=0||animelemtime(4)=0||animelemtime(5)=0||animelemtime(6)=0||animelemtime(7)=0)&&movecontact!=1&&var(7)>=1
value = 1350
ignorehitpause=1

[state 900]
type = StatetypeSet
trigger1 = AnimElem=1
physics = N

[state 900]
type = VelSet
trigger1 = AnimElem=1
x = 1.0+fvar(9)

[state 900]
type = VelSet
trigger1 = AnimElem=6,=0
x = 0+fvar(9)

;現在の速度取得
[state 900]
type = VarSet
trigger1 = AnimElem=1
fvar(8) = 1.0

[state 900]
type = VarSet
trigger1 = AnimElem=6,=0
fvar(8) = 0

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 4

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4(1)
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=1
trigger2 = AnimElem=2
trigger3 = AnimElem=3
trigger4 = AnimElem=4
trigger5 = AnimElem=5
trigger6 = AnimElem=6
damage = floor(ifelse(12*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)<1,1+(var(2)%5=4),12*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4))*1.22),floor(ceil(12*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,4
ground.velocity = -6.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-6.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0005,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-8.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-240*const(size.xscale))
animtype = hard
ground.type = Low
attr = S,SA
hitflag = MAFD
guardflag = MA

[state 200]
type = AttackDist
trigger1 = AnimElem=7
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(12*fvar(14)<1,1+(var(2)%5=1),12*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=1
var(16) = 10+random%6
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=1,>=0&&AnimElem=7,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=1,>=0&&AnimElem=7,<0
var(18) = floor(-160*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
trigger2 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-100*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-6.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-6.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
triggerall = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
trigger1 = var(1)=1||(var(1)=[3,6])
fvar(5) = (-6.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,8,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (4-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;破邪衝天・終撃
[statedef 1350]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0

;先行入力リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1350

[state 910]
type = RemoveExplod
trigger1 = AnimElem=5
trigger2 = AnimElem=5,=2
trigger3 = AnimElem=6
trigger4 = AnimElem=6,=2
id = 6300

[state 910]
type = RemoveExplod
trigger1 = AnimElem=6
trigger2 = AnimElem=6,=2
trigger3 = AnimElem=7
trigger4 = AnimElem=7,=2
trigger5 = AnimElem=8
id = 6305

[state 6160]
type = Explod
trigger1 = AnimElem=4
id = 6300
anim = 6300
pos = floor(0*const(size.xscale)),floor(40*const(size.yscale))
postype = p1
bindtime=-1
scale = 1,1
sprpriority = 3
removeongethit=1

[state 6160]
type = Explod
trigger1 = AnimElem=5
id = 6300
anim = 6301
pos = floor(140*const(size.xscale)),0
postype = p1
bindtime=-1
scale = 1,1
sprpriority = 3
removeongethit=1

[state 6160]
type = Explod
trigger1 = AnimElem=5,=2
id = 6300
anim = 6302
pos = floor(120*const(size.xscale)),0
postype = p1
bindtime=-1
scale = 1.5,1.5
sprpriority = 3
removeongethit=1

[state 6160]
type = Explod
trigger1 = AnimElem=6
id = 6305
anim = 6303
pos = floor(120*const(size.xscale)),0
postype = p1
bindtime=-1
scale = 1,1
sprpriority = 3
removeongethit=1

[state 6160]
type = Explod
trigger1 = AnimElem=6,=2
id = 6305
anim = 6304
pos = floor(120*const(size.xscale)),0
postype = p1
bindtime=-1
scale = 1,1
sprpriority = 3
removeongethit=1

[state 6160]
type = Explod
trigger1 = AnimElem=7
id = 6305
anim = 6305
pos = floor(120*const(size.xscale)),0
postype = p1
bindtime=-1
scale = 1,1
sprpriority = 3
removeongethit=1

[state 6160]
type = Explod
trigger1 = AnimElem=7,=2
id = 6305
anim = 6306
pos = floor(120*const(size.xscale)),0
postype = p1
bindtime=-1
scale = 1,1
sprpriority = 3
removeongethit=1

[state 190]
type = PlaySND
trigger1 = AnimElem=5
value = 30,5

[state 190]
type = EnvShake
trigger1 = AnimElem=5
time = 12
ampl = -6
phase = -2
freq = 104

[State 40, 1]
type = Helper
trigger1 = AnimElem=5
id = 6925
stateno = 6920
pos = floor(100*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[state 6310]
type = Helper
trigger1 = AnimElem=5
id = 6310
stateno = 6310
pos = floor(100*const(size.xscale)),0
postype = p1
ownpal = 1
sprpriority = 4

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=5
damage = floor(ifelse(50*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)<1,1+(var(2)%5=4),50*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4))*1.22),floor(ceil(50*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -4*const(size.xscale),-12*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-13.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-12*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(55*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-240*const(size.xscale))
animtype = hard
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(50*fvar(14)<1,1+(var(2)%5=1),50*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 10+random%6
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-40*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
triggerall = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
trigger1 = var(1)=1||(var(1)=[3,6])
fvar(5) = (-13.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;威風万丈
[statedef 1400]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1400

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 1320]
type = VarSet
trigger1 = !time
fvar(8) = 0

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&(prevstateno!=[130,154])
var(7) = 0

[state 220]
type = varadd
trigger1 = var(7)<92&&((command="hold_z"&&!var(59))||((P2statetype=L||P2bodydist X>70||var(7)>=72||1)&&var(59)))
trigger1 = (anim=1405&&var(7))||(animelemtime(7)=0&&!var(7))
var(7) = 1

[state 220]
type = ChangeAnim
trigger1 = anim=1400&&animelemtime(7)=0&&var(7)&&var(7)<=82
trigger1 = ((command="hold_z"&&!var(59))||(((P2statetype=L&&(P2stateno=[15100,15110]))||P2bodydist X>70||var(7)>=72)&&var(59)))
value = 1405
persistent=0

[state 220]
type = ChangeAnim
trigger1 = ((command!="hold_z"&&!var(59))||(P2statetype!=L&&P2bodydist X<=70&&var(7)<=72&&var(59))||var(7)>=82)&&var(7)
value = 1400+(var(7)>=32)*10+(var(7)>=62)*10
elem = 9
persistent=0

;溜めエフェクト
[state -2]
type = Helper
trigger1 = var(7)%8=1 &&anim=1405
id = 7770
stateno=7770
pos = 0,0
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

[state 220]
type = PalFX
trigger1 = anim=1405&&(var(7)=[32,40])&&((command="hold_z"&&!var(59))||((P2statetype=L||P2bodydist X>70||var(7)>=72)&&var(59)))
add = 255-(var(7)-32)*30,192-(var(7)-32)*22,128-(var(7)-32)*15
time = 1
;~~~~~

[state 900]
type = StatetypeSet
trigger1 = AnimElem=9
physics = N

[state 900]
type = VelSet
trigger1 = !fvar(9)&&AnimElem=9
x = (4.0+(anim=1410)*8.0+(anim=1420)*16.0)*const(size.xscale)

[state 900]
type = VelMul
trigger1 = AnimElem=10,>0 &&  AnimElem=11,<0
trigger1 = 1||fvar(8) := fvar(8)*.925
x = .925

[state 900]
type = VelSet
trigger1 = AnimElem=11
trigger1 = 1||fvar(8) := 0
x = 0

;現在の速度取得
[state 900]
type = VarSet
trigger1 = AnimElem=9
fvar(8) = (4.0+(anim=1410)*8.0+(anim=1420)*16.0)*const(size.xscale)

[state 19000]
type = Explod
trigger1 = (anim=1410||anim=1420)&&AnimElem=10
id = 6915
anim = 6915
pos = floor(-80*const(size.xscale)),0
postype = p1
ownpal = 1
sprpriority = 3
ignorehitpause=1
pausemovetime=999
supermovetime=999
scale = const(size.xscale),const(size.yscale)

[state 190]
type = PlaySND
trigger1 = AnimElem=10
value = 30,6
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=10
value = 10,37+(Anim=1410)*1+(Anim=1420)*2
channel = 1

[state 190]
type = Helper
trigger1 = AnimElem=10
id = 11450
stateno=11450
pos = 0,0
postype = p1
ownpal = 1
ignorehitpause=1

;飛び道具跳ね返し
[State 1000,Projectile]
type = Projectile
trigger1 =  animelemtime(10)>=0&&animelemtime(11)<0&&!(!numprojid(11460) && animelemtime(10)>0)&&!Numhelper(11460)&&!Numhelper(11470)&&!Numhelper(11480)
projanim = 11460+(anim=1410)+(anim=1420)*2
projID = 11460
projshadow = -1
velocity = 0, 0
projremovetime = 1
sprpriority = 5
; HitDefs
attr = S, SP
hitflag = P
getpower = 0,0
givepower = 0,0
ignorehitpause=1

;飛び道具跳ね返し
[State 1000,Projectile]
type = Projectile
trigger1 =  animelemtime(10)>=0&&animelemtime(11)<0&&!(!numprojid(11470) && animelemtime(10)>0)&&!Numhelper(11460)&&!Numhelper(11470)&&!Numhelper(11480)
projanim = 11470+(anim=1410)+(anim=1420)*2
projID = 11470
projshadow = -1
velocity = 0, 0
projremovetime = 1
sprpriority = 5
; HitDefs
attr = S, SP
hitflag = P
getpower = 0,0
givepower = 0,0
ignorehitpause=1

;飛び道具跳ね返し
[State 1000,Projectile]
type = Projectile
trigger1 =  animelemtime(10)>=0&&animelemtime(11)<0&&!(!numprojid(11480) && animelemtime(10)>0)&&!Numhelper(11460)&&!Numhelper(11470)&&!Numhelper(11480)
projanim = 11480+(anim=1410)+(anim=1420)*2
projID = 11480
projshadow = -1
velocity = 0, 0
projremovetime = 1
sprpriority = 5
; HitDefs
attr = S, SP
hitflag = P
getpower = 0,0
givepower = 0,0
ignorehitpause=1

;飛び道具跳ね返し
[state 1000]
type = Helper
trigger1 = animelemtime(10)>=0&&animelemtime(11)<0&&(!numprojid(11460)||!numprojid(11470)||!numprojid(11480))&&!Numhelper(11460)&&!Numhelper(11470)&&!Numhelper(11480)
stateno=11460
id = 11460+ifelse(!numprojid(11470),1,ifelse(!numprojid(11480),2,0))*10
name="shoot"
pos = floor(80*const(size.xscale)),-floor(ifelse(!numprojid(11470),140,ifelse(!numprojid(11480),80,200))*const(size.yscale))
postype = p1
ignorehitpause=1
persistent=0

[state 1400]
type = Helper
triggerall = var(52)=100||var(52)<=0
trigger1 = AnimElem=10
trigger3 = anim>=1410&&AnimElem=11,=2
trigger2 = anim=1420&&AnimElem=12,=2
id = 6350
stateno = 6350
pos = floor(180*const(size.xscale)),-floor(260*const(size.xscale))
postype = p1
ownpal = 1
sprpriority = 4
ignorehitpause=1
size.xscale = const(size.xscale)*2
size.yscale = const(size.yscale)*2

[state -2]
type = EnvShake
trigger1 = movecontact=1 && anim=1420
time = 12
ampl = -8

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 12

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;覇道天唱
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && !var(53) && var(52)>0 && movecontact && var(7)>=32 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;猿舞剛把
[state 250]
type = varset
trigger1 = Power>=1000 && !var(53) && var(52)>0 && movecontact && var(7)>=32 && !var(59)
var(53) = ifelse(command="Enbu",3000,var(53))

;金剛破滅
[state 250]
type = varset
trigger1 = Power>=1000 && !var(53) && var(52)>0 && movecontact && var(7)>=32 && !var(59)
var(53) = ifelse(command="Kongou",3100,var(53))

;威風万丈
[state 250]
type = varset
trigger1 = !var(53) && var(52)>0 && movecontact && var(7)>=32 && !var(59)
var(53) = ifelse(command="Ifuu",1400,var(53))

;破邪衝天
[state 250]
type = varset
trigger1 = !var(53) && var(52)>0 && movecontact && var(7)>=32 && !var(59)
var(53) = ifelse(command = "Haja",1300,var(53))

;天地葬送
[state 250]
type = varset
trigger1 = !var(53) && var(52)>0 && movecontact && var(7)>=32 && !var(59)
var(53) = ifelse(command="Tenchi",1200,var(53))

;灰塵乱渦
[state 250]
type = varset
trigger1 = !var(53) && var(52)>0 && movecontact && var(7)>=32 && !var(59)
var(53) = ifelse(command="Kaijin",1100+ifelse(command="y",50,0),var(53))

;~~~~

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = var(52)<=0||var(52)=100
trigger1 = AnimElem=10
damage = floor(ifelse(90*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)<1,1+(var(2)%5=4),ceil(90*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)))*1.22),ceil(floor(90*fvar(0)*1.0/8)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+var(49)*6
ground.velocity = ifelse(var(7)>=32,-6,-16)*const(size.xscale),-11*const(size.yscale)
guard.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-16.0*(1.0+ifelse(var(2)>31,31,var(2))*.07)-.0012,ifelse(var(7)>=32,-6,-14)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),30+12,16-ifelse(floor(var(14)/75)>7,7,floor(var(14)/75))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(90*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(90*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(90*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(90*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
envshake.time = 12
envshake.phase = -4
envshake.ampl = -8
envshake.freq = 60

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = var(52)<=0||var(52)=100
trigger1 = Anim>=1410&&AnimElem=10
damage = floor(ifelse(90*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)<1,1+(var(2)%5=4),ceil(90*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)))*1.22),ceil(floor(90*fvar(0)*1.0/8)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+var(49)*6
ground.velocity = -6*const(size.xscale),-11*const(size.yscale)
guard.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-4.0*(1.0+ifelse(var(2)>31,31,var(2))*.07)-.0012,-6*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),30+12,16-ifelse(floor(var(14)/75)>7,7,floor(var(14)/75))+12)
hitsound = s5910,0
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(90*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(90*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(90*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,floor(90*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
envshake.time = 12
envshake.phase = -4
envshake.ampl = -8
envshake.freq = 60

[state 200]
type = AttackDist
trigger1 = AnimElem=11
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(90*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)<1,1+(var(2)%5=4),ceil(90*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=10
var(16) = 10+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
var(18) = floor(-160*const(size.yscale))

;・・・・自分側ヒットバック・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2&&statetype!=A&&animelemtime(4)>0
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2&&statetype!=A&&animelemtime(4)>0
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-12.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2&&statetype!=A&&animelemtime(4)>0
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,12,14+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2&&statetype!=A&&animelemtime(4)>0
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (12-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・
;よろけ
[state 1400]
type = playsnd
trigger1 = moveguarded=1&&numtarget&&var(7)>=62
trigger1 = target,time=0
value = 5910,0

;エフェクト
[State 6100, Explod]
type = Explod
trigger1 = ifelse(var(7)>=62,movecontact=1,movehit=1)&&var(7)>=32&&numtarget
trigger1 = target,time=0
anim = 7750
id = 7750
postype = P1
pos = 10,-50
vel = -1,1
ownpal = 1
pausemovetime=9999
supermovetime=9999
ignorehitpause = 1
sprpriority = 5
scale = 1,1

;エフェクト
[State 6100, Explod]
type = Explod
trigger1 = ifelse(var(7)>=62,movecontact=1,movehit=1)&&var(7)>=32&&numtarget
trigger1 = target,time=0
anim = 7750
id = 7750
postype = P1
pos = 0,-65
vel = 1,1
ownpal = 1
pausemovetime=9999
supermovetime=9999
ignorehitpause = 1
sprpriority = 5
scale = 1,1

;エフェクト
[State 6100, Explod]
type = Explod
trigger1 = ifelse(var(7)>=62,movecontact=1,movehit=1)&&var(7)>=32&&numtarget
trigger1 = target,time=0
anim = 7750
id = 7750
postype = P1
pos = -10,-50
vel = -1,-1
ownpal = 1
pausemovetime=9999
supermovetime=9999
ignorehitpause = 1
sprpriority = 5
scale = 1,1

;エフェクト
[State 6100, Explod]
type = Explod
trigger1 = ifelse(var(7)>=62,movecontact=1,movehit=1)&&var(7)>=32&&numtarget
trigger1 = target,time=0
anim = 7750
id = 7750
postype = P1
pos = 5,-35
vel = 1,1
ownpal = 1
pausemovetime=9999
supermovetime=9999
ignorehitpause = 1
sprpriority = 5
scale = 1,1

;よろけ
[state 1400]
type = targetstate
trigger1 = movehit=1&&numtarget&&(var(7)=[32,62))&&var(3)<=1
trigger1 = target,time=0
value = 11400

;よろけ
[state 1400]
type = targetstate
trigger1 = movecontact=1&&numtarget&&var(7)>=62&&var(3)<=1
trigger1 = target,time=0
value = 11400

[state 200]
type = ChangeState
trigger1 = Anim!=1405&&AnimTime=0
value = 0
ctrl = 1

;エフェクト
[statedef 6350]
type = S
ctrl = 0
anim = 6350
sprpriority = 4

[state 11450]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6350]
type = BindtoRoot
trigger1 = 1
pos = floor(160*root,const(size.xscale)),-floor(220*root,const(size.xscale))

[state 6350]
type = AngleDraw
trigger1 = 1
value = 20
scale = 1,1

[state 6350]
type = Trans
trigger1 = 1
trans = add

[state 1400]
type = varset
trigger1 = !time
var(0) = NumHelper(6350)

[state 1400]
type = Helper
triggeral = parent,id=root,id
trigger1 = Time=8 && root,animelemtime(11)<0
id = 6350
stateno = 6350
pos = floor(160*1.5*const(size.xscale)),-floor(220*1.5*const(size.xscale))
postype = p1
ownpal = 1
sprpriority = 4
ignorehitpause=1
;size.xscale = const(size.xscale)*1.5
;size.yscale = const(size.yscale)*1.5

[state 6350]
type = DestroySelf
trigger1 = AnimTime=0
trigger2 = Root,stateno!=1400||(root,stateno=1400&&root,time=1)

;---------------------------------------------------------------------------
;相手側よろけ（立ち）
[Statedef 11400]
statetype=S
movetype = H
physics=S
ctrl = 0
velset = 0,0
anim = 150

[state 11400]
type = PosSet
trigger1 = !time&&prevstateno=11405
y = 0

[state 11400]
type = null;ChangeState
trigger1 = !time&&pos y<0
value = 11405

[state 11400]
type = SelfState
trigger1 = !time&&pos y<0
value = 5020

[state 11400]
type = HitFallSet
trigger1 = !time
value = 0

[state 15910]
type = ChangeAnim
trigger1 = hitshakeover
value = 5002
persistent=0

[state 15910]
type = ChangeAnim
trigger1 = time>0&&animtime=-1&&(anim=[5000,5029])
value = anim
elem = AnimElemNo(0)

[state 15910]
type = ChangeAnim
trigger1 = time=49+12
value = 5007

[state 15910]
type = ChangeAnim
trigger1 = time=0
trigger1 = SelfAnimExist(5910)
value = 5910

[state 15910]
type = ChangeAnim
trigger1 = time=49+12
trigger1 = SelfAnimExist(5911)
value = 5911

[state 831]
type = PlaySND
trigger1 = time=0&&(authorname="rei"||authorname="gal129")&&(fvar(39)=1||fvar(39)=4)
value = 5910,1
channel = 1

[state 831]
type = PlaySND
trigger1 = time=0&&authorname="rei"&&name="cvsbalrog"
value = 5000,2
channel = 1

[state 831]
type = PlaySND
trigger1 = time=0&&authorname="rei"&&name="cvsurien"
value = 5950,0
channel = 1

[state 15910]
type = SelfState
trigger1 = time=60+12
value = 0
ctrl = 1

[state 15910]
type = SelfState
trigger1 = !alive
value = 5000
;---------------------------------------------------------------------------
;相手側よろけ（空中）
[Statedef 11405]
type    = A
movetype = H
physics = N
ctrl = 0
velset = 0,0
anim = 150

[state 15910]
type = ChangeAnim
trigger1 = hitshakeover
value = ifelse(selfanimexist(5910),5910,5002)
persistent=0

[state 15910]
type = ChangeAnim
trigger1 = time>0&&animtime=-1&&(anim=[5000,5029])
value = anim
elem = AnimElemNo(0)

[state 11405]
type = VelSet
trigger1 = hitshakeover
x = -3
y = -2
persistent=0

[state 15910]
type = VelAdd
trigger1 = hitshakeover
y = gethitvar(yaccel)

[state 15910]
type = ChangeState
trigger1 = time>0 && vel Y>0 && Pos Y>=-Vel Y
value = 11400

[state 15910]
type = SelfState
trigger1 = !alive
value = 5020
;---------------------------------------------------------------------------
;飛び道具跳ね返し(Projectile用)
[Statedef 11450]
type = A
movetype = A
physics = N
ctrl = 0
velset = 0,0
anim = 11450+(root,anim=1410)+(root,anim=1420)*2

[state 11450]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11450]
type = BindtoRoot
trigger1 = 1
pos = 0,0
time = 1

[state 11450]
type = ReversalDef
trigger1 = 1
pausetime = 1,0
attr = S, SA
reversal.attr = SCA, AP
sparkno = -1
p2stateno = 11455
p1facing = 1
p2facing = 1
numhits = 0
ignorehitpause=1
persistent = 1

[state 11450]
type = DestroySelf
trigger1 = AnimTime=0||root,movetype=H

;飛び道具跳ね返し（相手飛び道具）
[Statedef 11455]
type = A
movetype = A
physics = N
ctrl = 0
velset = -vel x*1.25,vel y
movehitpersist = 0
hitcountpersist = 0
hitdefpersist = 0
sprpriority = 4
;anim = anim

[state 11455]
type = SelfState
trigger1 = !IsHelper
value = 5000
;ctrl = 1

[state 11450]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = turn
trigger1 = !time

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=11456
time = 1

[state 11455]
type = Hitdef
trigger1 = 1
damage = 59,15
ground.slidetime = 14
ground.hittime = 14
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+var(49)*6
ground.velocity = -5,-6
guard.velocity = -6
ground.cornerpush.veloff = 0
air.velocity = -5,-6
airguard.velocity = -3,-1
air.cornerpush.veloff = 0
yaccel = .45
fall.recover = 1
fall.recovertime = 16+12
hitsound = 5,4
guardsound = 6,0
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = 3
guard.sparkno = 40
sparkxy = ifelse(P2bodydist X<20,-20,-10),0
animtype = hard
ground.type = High
attr = S,SP
hitflag = MAFD
guardflag = MA
affectteam = F
;guarddist = 180

[state 11455]
type = RemoveExplod
trigger1 = movecontact||ScreenPos Y<0||ScreenPos Y>240||frontedgebodydist<=-20||backedgebodydist<=-20||Pos Y>=-Vel Y
trigger2 = Vel X =0 && Vel Y =0 && time>60

[state 11455]
type = DestroySelf
trigger1 = movecontact||ScreenPos Y<0||frontedgebodydist<=-20||backedgebodydist<=-20||Pos Y>=-Vel Y
trigger2 = Vel X =0 && Vel Y =0 && time>60

;飛び道具消滅
[statedef 11456]
type = A
movetype=I
physics = N

[state 11455]
type = NotHitBy
trigger1 = 1
value = SCA

[state 11455]
type = DestroySelf
trigger1 = time

;飛び道具跳ね返し
[Statedef 11460]
type = A
movetype = A
physics = N
ctrl = 0
velset = 8,ifelse(IsHelper(11460),-4,0)
anim = 6360

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=11461
time = 1

;Attack Lv.3
[state 200]
type = Hitdef
trigger1 = 1
damage = floor(ifelse(49*root,fvar(0)<1,1+(root,var(2)%5=4),ceil(49*root,fvar(0)))*1.22),ceil(floor(49*root,fvar(0)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+root,var(49)*6
ground.velocity = -12.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.02)*const(size.xscale)
guard.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-8.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0010,-10.0*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-13.0*(51-root,var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,2
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(55*root,fvar(1)*root,fvar(3))*1.3*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(55*root,fvar(3)*1.0/8)*1.3*root,fvar(16)))
givepower = floor(55*.8*root,fvar(1)*root,fvar(3))*1.3,floor(55*root,fvar(3)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,SP
hitflag = MAFD
guardflag = MA

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget&&root,var(3)
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(49*root,fvar(0)<1,1+(root,var(2)%5=4),ceil(49*root,fvar(0)))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

[state 11455]
type = DestroySelf
trigger1 = movecontact||ScreenPos Y<0||Pos Y>=-Vel Y||frontedgebodydist<=-20||backedgebodydist<=-20

;飛び道具消滅
[statedef 11461]
type = A
movetype=I
physics = N

[state 11455]
type = NotHitBy
trigger1 = 1
value = SCA

[state 11455]
type = DestroySelf
trigger1 = time

;ブースト(吹き飛ばし攻撃後)
[statedef 2000]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,ifelse(pos Y<0,vel Y,0)
anim = 2000

;ブーストエフェクト
[state 2000]
type = Helper
trigger1 = !time
id = 7720
stateno=7720
pos = 0,floor(-160*const(size.yscale))
postype = p1
pausemovetime=999
supermovetime=999
ownpal = 1
sprpriority = 2
ignorehitpause=1

[state 2000]
type = PlaySND
trigger1 = !time
value = 2000,0
volume = 255

[State 0, AfterImage]
type = AfterImage
trigger1 = !time
time=24
length = 5
palbright = 0,0,0
palcontrast = 256,256,256
palpostbright = -30,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 1
framegap = 2
trans = AddAlpha
alpha = 128,128

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = !time||(fvar(10)=[32,40])
time = 1
add = ifelse(fvar(10)<32,255,floor(fvar(10)-32)*32),ifelse(fvar(10)<32,255,floor(fvar(10)-32)*32),ifelse(fvar(10)<32,255,floor(fvar(10)-32)*32)

;ブースト
[state 2000]
type = varadd
trigger1 = !time
var(6) = 100*(!floor(var(6)%1000/100))+1000*(var(1)%2<1&&!floor(var(6)%10000/1000))

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = !time
var(9)=ifelse(var(9)>=10000,12000-floor(var(9)/100)*100,12000)

;ヒットバック0
[state 900]
type = VarSet
trigger1 = !time
fvar(5) = 0

[state 2000]
type = PosAdd
trigger1 = time=0
x = -13.0

[state 2000]
type = VelSet
trigger1 = time=0
x = 13.0
y = ifelse(vel Y<0,-4,0)

[state 2000]
type = StatetypeSet
trigger1 = Pos Y<0
statetype=A
physics = N

[state 2000]
type = StatetypeSet
trigger1 = Pos Y>=0
statetype=S
physics = N

[state 2000]
type = Gravity
trigger1 = time>=2&&statetype=A

;現在の速度
[state 2000]
type = VarSet
trigger1 = !time
fvar(8) = 0

;ブースト速度
[state 2000]
type = VarSet
trigger1 = !time
fvar(9) = 13.0

;ブースト時間
[state 2000]
type = VarSet
trigger1 = !time
fvar(10) = 40

[state 200]
type = VarAdd
trigger1 = !Time&&var(53)>2000
var(53) = -2000

[state 2000]
type = ChangeState
trigger1 = !time&&(var(53)=40||var(53)=50)
value = 40

[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 2000]
type = ChangeState
trigger1 = time>=4
trigger1 = !fvar(10)||(P2bodydist X<=0&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
trigger2 = time>=30
value = 0
ctrl = 1

;ガードキャンセル攻撃
[statedef 2500]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 2500
poweradd =-1000

;ガードゲージ減少
[state 2000]
type = VarAdd
trigger1 = Time=0
var(23)=ifelse(var(23)<=128,-var(23)+1,-128)

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = 1
var(9)=ifelse((var(9)=[1,999]),420-var(9),420)

[state 2000]
type = PalFX
trigger1 = Time=[0,7]
add = 255-32*time,255-32*time,255-32*time
time = 1

[state 900]
type = PlaySND
trigger1 = Time=0
value = 2500,0

[state 2000]
type = HitBy
trigger1 = Time=[0,13]
value = ,AT

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=7
value = 10,9
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=7
value = 7300,3
channel = 10

[state 900]
type = StatetypeSet
trigger1 = AnimElem=8
physics = N

;現在の速度取得
[state 900]
type = VarSet
trigger1 = AnimElem=8
fvar(8) = 5.0

[state 900]
type = VarSet
trigger1 = AnimElem=8,>0
fvar(8) = fvar(8)*.9

[state -2]
type = velset
trigger1 = animelem=8,>0 && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
x = fvar(8)+fvar(9)

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = AnimElem=8
damage = floor(ifelse(40*fvar(0)<1,1+(var(2)%5=4),40*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7
ground.velocity = -18*const(size.xscale),-5*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -18*const(size.xscale),ifelse(var(6)%10>0,var(6)%10*1.5,-5*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.yvelocity = 0
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = High
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
kill = 0
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=9
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(40*fvar(14)<1,1+(var(2)%5=1),40*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=8
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=8&&AnimElem=9,<0
var(18) = floor(-180*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = (-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 2000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;猿舞剛把
[statedef 3000]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
trigger1 = !((prevstateno=1100||prevstateno=1150)&&var(7)=1)&&!(prevstateno=1400&&var(7)>=32&&ifelse(var(7)>=62,movecontact,movehit))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
trigger1 = !((prevstateno=1100||prevstateno=1150)&&var(7)=1)&&!(prevstateno=1400&&var(7)>=32&&ifelse(var(7)>=62,movecontact,movehit))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
trigger1 = !((prevstateno=1100||prevstateno=1150)&&var(7)=1)&&!(prevstateno=1400&&var(7)>=32&&ifelse(var(7)>=62,movecontact,movehit))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time&&(prevstateno!=[5000,5099])

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
triggerall = Anim!=3000
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3000

;無敵
[state 200]
type = NotHitBy
trigger1 = AnimElem=3,<0
value = SCA

;BASARAゲージ回復不能時間
[state 2000]
type = VarSet
trigger1 = AnimElem=1,=1&&(prevstateno!=[5000,5099])
var(9)=420

[state 200]
type = null;NotHitBy
trigger1 = !IsHelper&&AnimElem=1,=1&&(prevstateno!=[5000,5099])
value = ,AP
time=33

[state 200]
type = pause
trigger1 = !IsHelper&&AnimElem=1&&(prevstateno!=[5000,5099])
time = 33
movetime = 33

[state -2]
type = poweradd
trigger1 = !IsHelper&&(prevstateno!=[5000,5099])&&AnimElem=1,=1
value = -1000
persistent=0

[state 200]
type = helper
trigger1 = !IsHelper&&AnimElem=1&&(prevstateno!=[5000,5099])
id = 7560
stateno = 7560
pos = floor(26*const(size.yscale)),-floor(176*const(size.yscale))
postype = P1
pausemovetime=33+999
ownpal = 1

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)
var(46) = 1

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=1&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[1,33]
value = 3000
elem = 1

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=2&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[34,36]
value = 3000
elem = 2

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=3&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[37,40]
value = 3000
elem = 3

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=4&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[41,56]
value = 3000
elem = 4

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=5&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[57,60]
value = 3000
elem = 5

[state 1610]
type = null;ChangeAnim
trigger1 = Time<var(48) && (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = anim
elem = AnimElemNo(0)

[state 1610]
type = PosFreeze
trigger1 = Time<var(48) && (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = 1

;>>>>>>>>>>><<<<<<<<<<<

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = (P2stateno!=[150,155])
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
attr = S,HT
hitflag = M-
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=3010
p1facing = 3016
p2facing=1
fall = 1
fall.recover = 0

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = (P2stateno!=[150,155])&&enemynear,anim=5300
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
attr = S,HT
hitflag = M
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=3010
p1facing = 3016
p2facing=1
fall = 1
fall.recover = 0

[state 200]
type = AttackDist
trigger1 = 1
value = 0

;強制停止中に動かないように
[state -2]
type = PosFreeze
trigger1 = AnimElemTime(1)>=1&&AnimElemTime(1)<31
trigger2 = NumHelper(7560)
trigger2 = helper(7560),time<30
value = 1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=1
var(16) = -1
persistent=0

[state 240]
type = PlaySnd
trigger1 = Time>=var(48)&&AnimElem=4
value = 7300,3
channel = 10

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;猿舞剛把掴み動作
[statedef 3010]
type = S
physics = N
movetype=A
velset = 0,0
anim = 3010

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&!numhelper(13010)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)
var(46) = 1

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = time&&numhelper(13010)
trigger1 = helper(13010),movetype=H
value = -helper(13010),var(0)

;ダメージ
[state 1610]
type = ChangeState
trigger1 = time&&numhelper(13010)
trigger1 = helper(13010),movetype=H
trigger1 = life<=helper(13010),var(0)
value = 5000

;ヒットポーズ
[state 1610]
type = VarSet
trigger1 = time&&numhelper(13010)
trigger1 = helper(13010),movetype=H
var(48) = -helper(13010),var(1)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&!numhelper(13010)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&var(46)<=42
value = 3000
elem = ifelse(AnimElemNo(0)!=4&&var(46)>=25,4,ifelse(AnimElemNo(0)!=3&&var(46)>=7,3,ifelse(AnimElemNo(0)!=2&&var(46)>=4,2,ifelse(AnimElemNo(0)!=1&&var(46)>=1,1,AnimElemNo(0)))))

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&var(46)<=42
value = 3000
elem = ifelse(AnimElemNo(0)!=6&&var(46)>=40,6,ifelse(AnimElemNo(0)!=6&&var(46)>=31,6,ifelse(AnimElemNo(0)!=5&&var(46)>=28,5,AnimElemNo(0))))

[state 1610]
type = ChangeAnim
trigger1 = Time<var(48)
value = anim
elem = AnimElemNo(0)

;アーマー処理
[State 5210, 1] 
type = Helper
trigger1 = !time&&!numhelper(13010)
id = 13010
stateno=13010
pos = 0,0
postype = p1
ownpal = 1
sprpriority = -1
ignorehitpause=1

[state 800]
type = varset
trigger1 = !time
fvar(5) = 0

[state 800]
type = varset
trigger1 = !time
fvar(6) = 0

[state 800]
type = varset
trigger1 = !time
fvar(7) = 0

[state 800]
type = varset
trigger1 = !time
fvar(8) = 0

[state 800]
type = varset
trigger1 = !time
fvar(9) = 0

[state 800]
type = varset
trigger1 = !time
fvar(10) = 0

;気絶値リセット
[state 801]
type = varset
trigger1 = !time
var(28) = ifelse(var(28)>0,0,var(28))

[state 801]
type = varset
trigger1 = !time
var(29) = 0

[state 800]
type = PlaySND
trigger1 = !time
value = 7100,0
channel = 10

[State 40, 1]
type = varrandom
trigger1 = AnimElem=1
v = 56
range = 0,7

[State 40, 1]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1
value = 10,ifelse(var(56)%8<4,181+var(56)%8,ifelse(var(56)%8>4,37+var(56)%3,44))
channel = 1

[state 3010]
type = NotHitBy
trigger1 = 1
value = SCA

;~~~追加入力受付
[state 3010]
type = varset
trigger1 = !time
var(7) = 0

[state 3010]
type = varadd
trigger1 = animelemtime(6)<0 && var(7)%10=0
trigger1 = (command="x"||command="y"||command="z")&&!var(59)
var(7) = ifelse(command="z",3,ifelse(command="y",2,1))

[state 3010]
type = varadd
triggerall = animelemtime(6)<0 && var(7)%10=0
trigger1 = animelemtime(4)>0&&random%5<3&&var(59)
var(7) = ifelse(var(51)<400,3,ifelse(var(51)<800,1,2))

[state 3010]
type = Explod
trigger1 = var(7)%10>0
id = 6700
anim = 6700+var(7)%10-1
pos = ifelse((facing=-1&&teamside=1)||(facing=1&&teamside=2),230-(var(7)%10-1)*15,90+(var(7)%10-1)*15),200
postype = back
scale = .5,.5
sprpriority = 5
ownpal = 1
facing = facing
bindtime=-1
persistent=0

;~~~投げ抜け入力受付
[state 3010]
type = varadd
trigger1 = numtarget
trigger1 = animelemtime(6)<0 && floor(var(7)%100/10)=0
trigger1 = target,command="x"||target,command="y"||target,command="z"
var(7) = ifelse(target,command="z",3,ifelse(target,command="y",2,1))*10

[state 3010]
type = Explod
trigger1 = floor(var(7)%100/10)>0
id = 6700
anim = 6700+floor(var(7)%100/10)-1
pos = ifelse((facing=1&&teamside=1)||(facing=-1&&teamside=2),230-(floor(var(7)%100/10)-1)*15,90+(floor(var(7)%100/10)-1)*15),200
postype = back
scale = .5,.5
sprpriority = 5
ownpal = 1
facing = facing
bindtime=-1
persistent=0

;~~~派生決定時
[State 5210, 1]
type = PlaySND
trigger1 = animElemTime(6)=0&&var(7)%10>0
value = ifelse(var(7)%10=floor(var(7)%100/10),5210,2500),0

[State 5210, 1] 
type = Helper
trigger1 = animElemTime(6)=0&&var(7)%10>0&&var(7)%10!=floor(var(7)%100/10)
id = 7730
stateno=7730
pos = 0,floor(-180*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 4
ignorehitpause=1
size.xscale = .5
size.yscale = .5

[State 5210, 1] 
type = Helper
trigger1 = numtarget
trigger1 = animElemTime(6)=0&&var(7)%10>0&&var(7)%10=floor(var(7)%100/10)
trigger1 = target,alive
id = 7730
stateno=7730
pos = floor(120*const(size.xscale)),floor(-120*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 4
ignorehitpause=1
size.xscale = .5
size.yscale = .5

[state 3010]
type = varadd
trigger1 = var(56)>0&&animelemtime(6)>=0
var(56) = 1

[state 3010]
type = varset
trigger1 = animElemTime(6)=0
var(56) = (var(7)%10>0&&var(7)%10!=floor(var(7)%100/10))

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = AnimElemTime(6)>=0&&var(56) = [1,25]
time = 1
add = 255-(var(56)-1)*10,0,0

[state 200]
type = ChangeState
trigger1 = AnimElemTime(7)=0&&var(7)%10>0&&var(7)%10!=floor(var(7)%100/10)
value = 3020+(var(7)%10-1)*10

;~~~~投げ抜け
[state 200]
type = PlaySND
trigger1 = numtarget
trigger1 = (!var(10)||var(10)>=1000)&&AnimElemTime(7)>=0&&var(7)%10>0&&var(7)%10=floor(var(7)%100/10)
trigger1 = target,alive
value = 10,64+random%2
channel = 1
persistent=0

[state 200]
type = TargetState
trigger1 = numtarget
trigger1 = AnimElemTime(7)=0&&var(7)%10>0&&var(7)%10=floor(var(7)%100/10)
trigger1 = target,alive
value = 3096

[state 200]
type = null;ChangeState
trigger1 = AnimElemTime(7)=0&&var(7)%10>0&var(7)%10=floor(var(7)%100/10)
value = 3090
;~~~~~~~~~~~~~~~~~~~

[state 190]
type = PlaySND
trigger1 = AnimElem=6
value = 5100,2

[state 190]
type = EnvShake
trigger1 = AnimElem=6
time = 12
ample = 6

[State 40, 1]
type = Helper
trigger1 = AnimElem=6
id = 6925
stateno = 6920
pos = floor(160*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[state 190]
type = PlaySND
trigger1 = AnimElem=6
value = 7100,2
channel = 10

[state 801]
type = HitAdd
trigger1 = animelemtime(6)=0
value = 1

[state 801]
type = VarAdd
trigger1 = animelemtime(6)=0
var(2) = 1

[state 801]
type = targetstate
trigger1 = numtarget
trigger1 = target,stateno!=3015&&animelemtime(2)<0
value = 3015

[state 801]
type = targetstate
trigger1 = numtarget
trigger1 = target,stateno!=3016&&animelemtime(2)>=0&&animelemtime(3)<0
value = 3016

[state 801]
type = targetstate
trigger1 = numtarget
trigger1 = target,stateno!=3017&&animelemtime(3)>=0&&animelemtime(5)<0
value = 3017

[state 801]
type = targetstate
trigger1 = numtarget
trigger1 = target,stateno!=3018&&animelemtime(5)>=0&&animelemtime(6)<0
value = 3018

[state 801]
type = Width
trigger1 = animelemtime(1)=0
edge = floor(170*const(size.xscale)),0

;コンボ補正なし
[state 801]
type = targetlifeadd
trigger1 = numtarget
trigger1 = animelemtime(6)=0
value = -ceil(floor(52*fvar(0)*1.22)*const(data.attack)/100)

[state 801]
type = targetbind
trigger1 = numtarget
trigger1 = animelemtime(3)<0
pos = floor(170*const(size.xscale)),0

[state 801]
type = targetbind
trigger1 = numtarget
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
pos = floor(100*const(size.xscale)),-floor(394*const(size.yscale))

[state 801]
type = targetbind
trigger1 = numtarget
trigger1 = animelemtime(4)>=0&&animelemtime(5)<0
pos = floor(74*const(size.xscale)),-floor(384*const(size.yscale))

[state 801]
type = targetbind
trigger1 = numtarget
trigger1 = animelemtime(5)>=0&&animelemtime(6)<0
pos = floor(130*const(size.xscale)),-floor(340*const(size.yscale))

[state 801]
type = targetbind
trigger1 = numtarget
trigger1 = animelemtime(6)=0
pos = floor(140*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetstate
trigger1 = numtarget
trigger1 = animelemtime(6)=0
value = ifelse(var(7)%10>0&&var(7)%10!=floor(var(7)%100/10),1257,3019)

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = animelemtime(6)=0
fvar(15) = .00005*floor(ifelse(52*fvar(14)<1,1+(var(2)%5=1),52*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = AnimElemTime(6)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

[state 1610]
type = AttackDist
trigger1 = 1
value = 0

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=1
var(16) = -1
persistent=0

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;猿舞剛把相手動作1
[statedef 3015]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0
SprPriority = 2

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=3015
value = 3015

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 1,1

[state 1116]
type = SelfState
trigger1 = time>=60
value = 5210

;猿舞剛把相手動作2
[statedef 3016]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0
SprPriority = 2

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=3016
value = 3016

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 1,1

[state 1116]
type = SelfState
trigger1 = time>=60
value = 5210

;猿舞剛把相手動作3
[statedef 3017]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0
SprPriority = 2

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=3017
value = 3017

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 1,1

[state 1116]
type = SelfState
trigger1 = time>=60
value = 5210

;猿舞剛把相手動作4
[statedef 3018]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0
SprPriority = 2

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=3018
value = 3018

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 1,1

[state 1116]
type = AngleDraw
trigger1 = 1
value = -90

[state 1116]
type = SelfState
trigger1 = time>=60
value = 5210

;猿舞剛把相手動作5
[statedef 3019]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 806]
type = ChangeAnim2
trigger1 = time=0&&(!SelfAnimExist(9060)||!(authorname="rei"||authorname="gal129"||name="keiji"))
value = 1257+(const(size.head.pos.y)<=100)

[state 806]
type = ChangeAnim
trigger1 = time=0&&SelfAnimExist(9060)&&(authorname="rei"||authorname="gal129"||name="keiji")
value = 9060

[state 806]
type = Posset
trigger1 = Anim!=9060
y = -ceil(const(size.head.pos.y)/2.25)

[state 1017]
type = VelSet
trigger1 = Time=9
x = -4.5
y = -4.5

[state 1017]
type = PosSet
trigger1 = time>=9
y = 0

[state 1017]
type = ChangeState
trigger1 = time>=9
value = 15076

;A派生1岩盤叩きつけ動作
[statedef 3020]
type = S
physics = N
movetype=A
velset = 0,0
anim = 3020

[state 3010]
type = NotHitBy
trigger1 = 1
value = SCA

;~~~追加入力受付
[state 3010]
type = varadd
trigger1 = AnimElemTime(10)<0 && floor(var(7)%1000/100)=0&&!var(59)
trigger1 = (command="x"&&var(7)%10!=1)||(command="y"&&var(7)%10!=2)||(command="z"&&var(7)%10!=3)
var(7) = ifelse(command="z"&&var(7)%10!=3,3,ifelse(command="y"&&var(7)%10!=2,2,1))*100

[state 3010]
type = varadd
trigger1 = AnimElemTime(10)<0 && floor(var(7)%1000/100)=0&&var(59)
trigger1 = AnimElemTime(8)>0&&random%3<2
var(7) = ifelse(floor(var(7)%100/10)=2&&Power>=1000&&var(40)=1,2,3)*100

[state 3010]
type = Explod
trigger1 = floor(var(7)%1000/100)>0
id = 6700
anim = 6700+floor(var(7)%1000/100)-1
pos = ifelse((facing=-1&&teamside=1)||(facing=1&&teamside=2),230-(floor(var(7)%1000/100)-1)*15,90+(floor(var(7)%1000/100)-1)*15),200
postype = back
scale = .5,.5
sprpriority = 5
ownpal = 1
facing = facing
bindtime=-1
persistent=0

;~~~投げ抜け入力受付
[state 3010]
type = varadd
trigger1 = AnimElemTime(10)<0 && numtarget && floor(var(7)%10000/1000)=0
trigger1 = (target,command="x"&&floor(var(7)%100/10)!=1)||(target,command="y"&&floor(var(7)%100/10)!=2)||(target,command="z"&&floor(var(7)%100/10)!=3)
var(7) = ifelse(target,command="z"&&floor(var(7)%100/10)!=3,3,ifelse(target,command="y"&&floor(var(7)%100/10)!=2,2,1))*1000

[state 3010]
type = Explod
trigger1 = floor(var(7)%10000/1000)>0
id = 6700
anim = 6700+floor(var(7)%10000/1000)-1
pos = ifelse((facing=1&&teamside=1)||(facing=-1&&teamside=2),230-(floor(var(7)%10000/1000)-1)*15,90+(floor(var(7)%10000/1000)-1)*15),200
postype = back
scale = .5,.5
sprpriority = 5
ownpal = 1
facing = facing
bindtime=-1
persistent=0

;~~~派生決定時
[State 5210, 1]
type = PlaySND
trigger1 = animElemTime(10)=0&&floor(var(7)%1000/100)>0
value = ifelse(floor(var(7)%1000/100)=floor(var(7)%10000/1000),5210,2500),0

[State 5210, 1] 
type = Helper
trigger1 = animElemTime(10)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)!=floor(var(7)%10000/1000)
id = 7730
stateno=7730
pos = 0,floor(-180*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 4
ignorehitpause=1
size.xscale = .5
size.yscale = .5

[State 5210, 1] 
type = Helper
trigger1 = animElemTime(10)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)=floor(var(7)%10000/1000)&&numtarget
trigger1 = target,alive
id = 7730
stateno=7730
pos = floor(120*const(size.xscale)),floor(-120*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 4
ignorehitpause=1
size.xscale = .5
size.yscale = .5

[state 3010]
type = varadd
trigger1 = var(56)>0
var(56) = 1

[state 3010]
type = varset
trigger1 = animElemTime(10)=0
var(56) = (floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)!=floor(var(7)%10000/1000))

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = var(56) = [1,25]
time = 1
add = 255-(var(56)-1)*10,0,0

[state 200]
type = ChangeState
trigger1 = AnimElemTime(11)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)!=floor(var(7)%10000/1000)
value = 3050+(floor(var(7)%1000/100)-1)*10

;~~~~投げ抜け
[state 200]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElemTime(11)>=0&&floor(var(7)%1000/100)>0&&floor(var(7)%10000/1000)=floor(var(7)%10000/1000)&&numtarget
trigger1 = target,alive
value = 10,64+random%2
channel = 1
persistent=0

[state 200]
type = TargetState
trigger1 = AnimElemTime(11)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%10000/1000)=floor(var(7)%10000/1000)&&numtarget
trigger1 = target,alive
value = 3096

[state 200]
type = null;ChangeState
trigger1 = AnimElemTime(11)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)=floor(var(7)%10000/1000)
value = 3091
;~~~~~~~~~~~~~~~~~~~

[state 801]
type = Explod
trigger1 = AnimElem=6
id = 6200
anim = 6200
pos = -floor(160*const(size.xscale)),0
postype = p1
scale = .5,.5
ownpal = 1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

[state 801]
type = Explod
trigger1 = AnimElem=6
id = 6200
anim = 6200
pos = -floor(160*const(size.xscale)),0
postype = p1
scale = .5,.5
ownpal = 1
facing=-1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0


[state 801]
type = Explod
trigger1 = AnimElem=10
id = 6200
anim = 6200
pos = floor(160*const(size.xscale)),0
postype = p1
scale = .5,.5
ownpal = 1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

[state 801]
type = Explod
trigger1 = AnimElem=10
id = 6200
anim = 6200
pos = floor(160*const(size.xscale)),0
postype = p1
scale = .5,.5
ownpal = 1
facing=-1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

[state 190]
type = PlaySND
trigger1 = AnimElem=6
trigger2 = AnimElem=10
value = 5100,2
channel = 11

[state 190]
type = PlaySND
trigger1 = AnimElem=6
trigger2 = AnimElem=10
value = 7100,2
channel = 10

[state 190]
type = EnvShake
trigger1 = AnimElem=6
trigger2 = AnimElem=10
time = 12
ample = 6

[State 40, 1]
type = Helper
trigger1 = AnimElem=6
id = 6925
stateno = 6920
pos = -floor(160*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[State 40, 1]
type = Helper
trigger1 = AnimElem=10
id = 6925
stateno = 6920
pos = floor(160*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[state 801]
type = HitAdd
trigger1 = AnimElemTime(6)=0
trigger2 = AnimElemTime(10)=0
value = 1

[state 801]
type = VarAdd
trigger1 = AnimElemTime(6)=0
trigger2 = AnimElemTime(10)=0
var(2) = 1

[state 801]
type = VarAdd
trigger1 = AnimElemTime(6)=0
trigger2 = AnimElemTime(10)=0
var(3) = 1

[state 801]
type = targetstate
trigger1 = numtarget
trigger1 = target,stateno!=3026&&AnimElemTime(3)>=0&&AnimElemTime(6)<0
value = 3026

[state 801]
type = Width
trigger1 = animelemtime(1)=0
edge = floor(140*const(size.xscale)),0

;コンボ補正なし
[state 801]
type = targetlifeadd
trigger1 = AnimElemTime(6)=0
trigger2 = AnimElemTime(10)=0
value = -ceil(floor(103*fvar(0)*1.22)*const(data.attack)/100)
kill = (AnimElemTime(10)=0)

[state 801]
type = targetbind
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
pos = floor(240*const(size.xscale)),-floor(80*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(4)>=0&&animelemtime(5)<0
pos = floor(260*const(size.xscale)),-floor(180*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(5)>=0&&AnimElemTime(6)<0
pos = floor(50*const(size.xscale)),-floor(208*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(6)>=0&&AnimElemTime(7)<0
pos = -floor(190*const(size.xscale)),-floor(20*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(7)>=0&&AnimElemTime(8)<0
pos = -floor(170*const(size.xscale)),-floor(10*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(8)>=0&&AnimElemTime(9)<0
pos = -floor(220*const(size.xscale)),-floor(304*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(9)>=0&&AnimElemTime(10)<0
pos = -floor(80*const(size.xscale)),-floor(324*const(size.yscale))

[state 801]
type = targetbind
trigger1 = AnimElemTime(10)=0
pos = floor(260*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetstate
trigger1 = AnimElemTime(6)=0
value = 3027

[state 801]
type = targetstate
trigger1 = AnimElemTime(9)=0
value = 3028

[state 801]
type = targetstate
trigger1 = AnimElemTime(10)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)!=floor(var(7)%10000/1000)
value = 3029

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = AnimElemTime(6)=0
trigger2 = AnimElemTime(10)=0
fvar(15) = .00005*floor(ifelse(103*fvar(14)<1,1+(var(2)%5=1),103*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = AnimElemTime(6)=0
trigger2 = AnimElemTime(10)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

[state 1610]
type = AttackDist
trigger1 = 1
value = 0

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;A派生1岩盤叩きつけ相手動作
[statedef 3026]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0
SprPriority = 2

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=3026
value = 3026

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 0,0

[state 1116]
type = ChangeAnim
trigger1 = Anim=3026&&AnimTime=0
trigger2 = Anim=5160
value = 5160

[state 1116]
type = PlayerPush
trigger1 = 1
value = 0

[state 1116]
type = AngleDraw
trigger1 = Anim=3026
value = -45-(time>=4)*15

[state 1116]
type = AngleDraw
trigger1 = Anim=5160
value = 60

[state 1116]
type = SelfState
trigger1 = time>=40
value = 5210

;A派生1岩盤叩きつけ相手動作2
[statedef 3027]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0
SprPriority = 2

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=3027
value = 3027

[state 1116]
type = PlayerPush
trigger1 = 1
value = 0

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 0,0

[state 1116]
type = AngleDraw
trigger1 = Anim=3027
value = -60

[state 1116]
type = AngleDraw
trigger1 = Anim=3027&&Animelemtime(2)>=0
value = 30

[state 1116]
type = SelfState
trigger1 = time>=32
value = 5210

;A派生1岩盤叩きつけ相手動作3
[statedef 3028]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0
SprPriority = 2

[state 1116]
type = ChangeAnim
trigger1 = !time&&anim!=5160
value = 5160

[state 1116]
type = ChangeAnim
trigger1 = time>=4
value = 5170

[state 1116]
type = PlayerPush
trigger1 = 1
value = 0

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 0,0

[state 1116]
type = AngleDraw
trigger1 = Anim=5160
value = -180

[state 1116]
type = ChangeState
trigger1 = time>=16
value = 15110

;A派生1岩盤叩きつけ相手動作4
[statedef 3029]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0
SprPriority = 2

[state 1116]
type = ChangeAnim
trigger1 = !time&&anim!=5170
value = 5170

[state 1116]
type = ChangeAnim
trigger1 = anim=5170&&AnimTime=0
value = 5110

[state 1116]
type = PlayerPush
trigger1 = 1
value = 0

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 1,1

[state 1116]
type = SelfState
trigger1 = time>=40
value = 5210

;■■■■■■■
;B派生1掴み
[statedef 3030]
type = S
physics = S
movetype=A
ctrl = 0
velset = 0,0
anim = 801

[state 3010]
type = NotHitBy
trigger1 = 1
value = SCA

;~~~追加入力受付
[state 3010]
type = varadd
trigger1 = AnimElemTime(7)<0 && floor(var(7)%1000/100)=0&&!var(59)
trigger1 = (command="x"&&var(7)%10!=1)||(command="y"&&var(7)%10!=2)||(command="z"&&var(7)%10!=3)
var(7) = ifelse(command="z"&&var(7)%10!=3,3,ifelse(command="y"&&var(7)%10!=2,2,1))*100

[state 3010]
type = varadd
trigger1 = AnimElemTime(7)<0 && floor(var(7)%1000/100)=0&&var(59)
trigger1 = AnimElemTime(4)>0&&random%2=0
var(7) = ifelse(var(51)<1000,3,1)*100

[state 3010]
type = Explod
trigger1 = floor(var(7)%1000/100)>0
id = 6700
anim = 6700+floor(var(7)%1000/100)-1
pos = ifelse((facing=-1&&teamside=1)||(facing=1&&teamside=2),230-(floor(var(7)%1000/100)-1)*15,90+(floor(var(7)%1000/100)-1)*15),200
postype = back
scale = .5,.5
sprpriority = 5
ownpal = 1
facing = facing
bindtime=-1
persistent=0

;~~~投げ抜け入力受付
[state 3010]
type = varadd
trigger1 = AnimElemTime(7)<0 && numtarget && floor(var(7)%10000/1000)=0
trigger1 = (target,command="x"&&floor(var(7)%100/10)!=1)||(target,command="y"&&floor(var(7)%100/10)!=2)||(target,command="z"&&floor(var(7)%100/10)!=3)
var(7) = ifelse(target,command="z"&&floor(var(7)%100/10)!=3,3,ifelse(target,command="y"&&floor(var(7)%100/10)!=2,2,1))*1000

[state 3010]
type = Explod
trigger1 = floor(var(7)%10000/1000)>0
id = 6700
anim = 6700+floor(var(7)%10000/1000)-1
pos = ifelse((facing=1&&teamside=1)||(facing=-1&&teamside=2),230-(floor(var(7)%10000/1000)-1)*15,90+(floor(var(7)%10000/1000)-1)*15),200
postype = back
scale = .5,.5
sprpriority = 5
ownpal = 1
facing = facing
bindtime=-1
persistent=0

;~~~派生決定時
[State 5210, 1]
type = PlaySND
trigger1 = animElemTime(7)=0&&floor(var(7)%1000/100)>0
value = ifelse(floor(var(7)%1000/100)=floor(var(7)%10000/1000),5210,2500),0

[State 5210, 1] 
type = Helper
trigger1 = animElemTime(7)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)!=floor(var(7)%10000/1000)
id = 7730
stateno=7730
pos = 0,floor(-180*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 4
ignorehitpause=1
size.xscale = .5
size.yscale = .5

[State 5210, 1] 
type = Helper
trigger1 = animElemTime(7)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)=floor(var(7)%10000/1000)&&numtarget
trigger1 = target,alive
id = 7730
stateno=7730
pos = floor(120*const(size.xscale)),floor(-120*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 4
ignorehitpause=1
size.xscale = .5
size.yscale = .5

[state 3010]
type = varadd
trigger1 = var(56)>0
var(56) = 1

[state 3010]
type = varset
trigger1 = animElemTime(7)=0
var(56) = (floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)!=floor(var(7)%10000/1000))

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = var(56) = [1,25]
time = 1
add = 255-(var(56)-1)*10,0,0

[state 200]
type = ChangeState
trigger1 = AnimElemTime(8)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)!=floor(var(7)%10000/1000)
value = 3050+(floor(var(7)%1000/100)-1)*10

;~~~~投げ抜け
[state 200]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElemTime(8)>=0&&floor(var(7)%1000/100)>0&&floor(var(7)%10000/1000)=floor(var(7)%10000/1000)&&numtarget
trigger1 = target,alive
value = 10,64+random%2
channel = 1
persistent=0

[state 200]
type = TargetState
trigger1 = AnimElemTime(8)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%10000/1000)=floor(var(7)%10000/1000)&&numtarget
trigger1 = target,alive
value = 3096

[state 200]
type = null;ChangeState
trigger1 = AnimElemTime(8)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)=floor(var(7)%10000/1000)
value = 3091
;~~~~~~~~~~~~~~~~~~~

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=6
value = 10,27
channel = 1
lowpriority = 1

[state 801]
type = Explod
trigger1 = AnimElem=7
id = 6200
anim = 6200
pos = floor(160*const(size.xscale)),0
postype = p1
scale = .5,.5
ownpal = 1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

[state 801]
type = Explod
trigger1 = AnimElem=7
id = 6200
anim = 6200
pos = floor(160*const(size.xscale)),0
postype = p1
scale = .5,.5
ownpal = 1
facing=-1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

[state 190]
type = PlaySND
trigger1 = AnimElem=7
value = 5100,2

[state 190]
type = EnvShake
trigger1 = AnimElem=7
time = 12
ample = 6

[State 40, 1]
type = Helper
trigger1 = AnimElem=7
id = 6925
stateno = 6920
pos = floor(160*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[state 190]
type = PlaySND
trigger1 = AnimElem=7,=7
value = 7100,2
channel = 10

[state 801]
type = hitadd
trigger1 = animelemtime(7)=7
value = 1

[state 801]
type = varadd
trigger1 = animelemtime(7)=7
var(2) = 1

[state 801]
type = varadd
trigger1 = animelemtime(7)=7
var(3) = 1

[state 801]
type = targetstate
trigger1 = numtarget
trigger1 = time=0||(target,stateno!=3036&&animelemtime(7)<0)
value = 3036

[state 801]
type = Width
trigger1 = animelemtime(1)=0
edge = floor(170*const(size.xscale)),0

[state 801]
type = Width
trigger1 = animelemtime(7)=0
edge = floor(190*const(size.xscale)),0

[state 801]
type = targetlifeadd
trigger1 = animelemtime(7)=7
value = -ceil(floor(119*fvar(0)*1.22)*const(data.attack)/100)

[state 801]
type = poweradd
trigger1 = animelemtime(7)=7
value = floor(ifelse(var(9),0,floor(95*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16)))

[state 801]
type = targetpoweradd
trigger1 = animelemtime(7)=7
value = floor(floor(95*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3)

[state 801]
type = targetbind
trigger1 = animelemtime(2)<0
pos = floor(170*const(size.xscale)),0

[state 801]
type = targetbind
trigger1 = animelemtime(2)>=0&&animelemtime(3)<0
pos = -floor(20*const(size.xscale)),-floor(344*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
pos = -floor(88*const(size.xscale)),-floor(334*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(4)>=0&&animelemtime(5)<0
pos = -floor(102*const(size.xscale)),-floor(300*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(5)>=0&&animelemtime(6)<0
pos = -floor(78*const(size.xscale)),-floor(320*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(6)>=0&&animelemtime(7)<0
pos = floor(72*const(size.xscale)),-floor(340*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(7)=0
pos = floor(190*const(size.xscale)),floor(40*const(size.yscale))

[state 801]
type = targetstate
trigger1 = animelemtime(7)=0
value = 3037

;強制基底補正50%
[state -1]
type = varadd
trigger1 = animelemtime(7)=7 && var(8)%8<4
var(8) = 4
ignorehitpause=1

;気絶値増加
[state -1]
type = varadd
trigger1 = animelemtime(7)=7
var(29) = floor(6*fvar(1))
ignorehitpause=1

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = animelemtime(7)=7
fvar(15) = .00005*floor(ifelse(119*fvar(14)<1,1+(var(2)%5=1),119*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = animelemtime(7)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

[state 1000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;■■■■■■■
;B派生1食らい
[statedef 3036]
type = S
physics = N
movetype=H
ctrl = 0
velset = 0,0
sprpriority = 2

[state 806]
type = ScreenBound
trigger1 = 1
value = 1

[state 806]
type = ChangeAnim2
trigger1 = time=0
value = 806

[state 1116]
type = AngleDraw
trigger1 = AnimElemTime(2)>=8
value = -15

[state 806]
type = SelfState
trigger1 = time>=180
value = 5000

;■■■■■■■
;B派生1食らい（吹き飛び）
[statedef 3037]
type = A
physics = N
movetype=H
ctrl = 0
velset = 0,0
sprpriority = 2

[state 806]
type = ChangeAnim2
trigger1 = time=0
value = 807

[state 806]
type = VelSet
trigger1 = Time=6
x = -4.0
y = 2.0

[state 806]
type = ChangeState
trigger1 = Time=6
value = 15075


;■■■■■■■
;C派生1天地葬送掴み
[statedef 3040]
type = A
physics = N
movetype=A
ctrl = 0
velset = 0,0
anim = 1250

[state 3010]
type = NotHitBy
trigger1 = 1
value = SCA

;~~~追加入力受付
[state 3010]
type = varadd
trigger1 = Anim=1250 && floor(var(7)%1000/100)=0&&!var(59)
trigger1 = (command="x"&&var(7)%10!=1)||(command="y"&&var(7)%10!=2)||(command="z"&&var(7)%10!=3)
var(7) = ifelse(command="z"&&var(7)%10!=3,3,ifelse(command="y"&&var(7)%10!=2,2,1))*100

[state 3010]
type = Explod
trigger1 = floor(var(7)%1000/100)>0
id = 6700
anim = 6700+floor(var(7)%1000/100)-1
pos = ifelse((facing=-1&&teamside=1)||(facing=1&&teamside=2),230-(floor(var(7)%1000/100)-1)*15,90+(floor(var(7)%1000/100)-1)*15),200
postype = back
scale = .5,.5
sprpriority = 5
ownpal = 1
facing = facing
bindtime=-1
persistent=0

;~~~投げ抜け入力受付
[state 3010]
type = varadd
trigger1 = Anim=1250 && numtarget && floor(var(7)%10000/1000)=0
trigger1 = (target,command="x"&&floor(var(7)%100/10)!=1)||(target,command="y"&&floor(var(7)%100/10)!=2)||(target,command="z"&&floor(var(7)%100/10)!=3)
var(7) = ifelse(target,command="z"&&floor(var(7)%100/10)!=3,3,ifelse(target,command="y"&&floor(var(7)%100/10)!=2,2,1))*1000

[state 3010]
type = Explod
trigger1 = floor(var(7)%10000/1000)>0
id = 6700
anim = 6700+floor(var(7)%10000/1000)-1
pos = ifelse((facing=1&&teamside=1)||(facing=-1&&teamside=2),230-(floor(var(7)%10000/1000)-1)*15,90+(floor(var(7)%10000/1000)-1)*15),200
postype = back
scale = .5,.5
sprpriority = 5
ownpal = 1
facing = facing
bindtime=-1
persistent=0

;~~~派生決定時
[State 5210, 1]
type = PlaySND
trigger1 = Anim=1251&&animElemTime(1)=1&&floor(var(7)%1000/100)>0
value = ifelse(floor(var(7)%1000/100)=floor(var(7)%10000/1000),5210,2500),0

[State 5210, 1] 
type = Helper
trigger1 = Anim=1251&&animElemTime(1)=1&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)!=floor(var(7)%10000/1000)
id = 7730
stateno=7730
pos = 0,floor(-180*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 4
ignorehitpause=1
size.xscale = .5
size.yscale = .5

[State 5210, 1] 
type = Helper
trigger1 = Anim=1251&&animElemTime(1)=1&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)=floor(var(7)%10000/1000)&&numtarget
trigger1 = target,alive
id = 7730
stateno=7730
pos = floor(120*const(size.xscale)),floor(-120*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 4
ignorehitpause=1
size.xscale = .5
size.yscale = .5

[state 3010]
type = varadd
trigger1 = var(56)>0
var(56) = 1

[state 3010]
type = varset
trigger1 = Anim=1251&&animElemTime(1)=1
var(56) = (floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)!=floor(var(7)%10000/1000))

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = var(56) = [1,25]
time = 1
add = 255-(var(56)-1)*10,0,0

[state 200]
type = ChangeState
trigger1 = Anim=1251&&AnimElemTime(2)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)!=floor(var(7)%10000/1000)
value = 3050+(floor(var(7)%1000/100)-1)*10

;~~~~投げ抜け
[state 200]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=1251&&AnimElemTime(2)>=0&&floor(var(7)%1000/100)>0&&floor(var(7)%10000/1000)=floor(var(7)%10000/1000)&&numtarget
trigger1 = target,alive
value = 10,64+random%2
channel = 1
persistent=0

[state 200]
type = TargetState
trigger1 = Anim=1251&&AnimElemTime(2)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)=floor(var(7)%10000/1000)&&numtarget
trigger1 = target,alive
value = 3096

[state 200]
type = null;ChangeState
trigger1 = Anim=1251&&AnimElemTime(2)=0&&floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)=floor(var(7)%10000/1000)
value = 3091
;~~~~~~~~~~~~~~~~~~~

[state 801]
type = targetstate
triggerall = numtarget
trigger1 = time=0||(target,stateno!=3046&&anim=1250)
value = 3046

[state 801]
type = ChangeAnim
trigger1 = Anim=1250&&Vel Y>0 && Pos Y>=-Vel Y
value = 1251

[state 801]
type = StatetypeSet
trigger1 = Anim=1251
statetype=S
physics = S
persistent=0

[state 801]
type = VelSet
trigger1 = Anim=1251
x = 0
y = 0
persistent=0

[state 801]
type = posadd
trigger1 = Anim=1251&&AnimElemTime(1)=0
x = floor(60*const(size.xscale))

[state 801]
type = PosSet
trigger1 = Anim=1251
y = 0
persisten=0

[state 1250]
type = varset
trigger1 = Anim=1251&&AnimElem=1
var(12) = 143+36
persistent=0

[state 5210]
type = Explod
trigger1 = Anim=1250&&AnimElem=3,=1&&Vel Y>=0
id = 6150
anim = 6155
pos = 0,-floor(320*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
scale = const(size.xscale),const(size.yscale)
removeongethit=1

[state 5210]
type = Explod
trigger1 = Anim=1250&&AnimElem=3,=1&&Vel Y>=0
id = 6160
anim = 6165
pos = 0,-floor(260*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
scale = const(size.xscale),const(size.yscale)
removeongethit=1

[state 5210]
type = Explod
trigger1 = Anim=1250&&AnimElem=3,=1&&Vel Y>=0
id = 6160
anim = 6165
pos = 0,-floor(180*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
scale = const(size.xscale),const(size.yscale)
removeongethit=1

[state 5210]
type = Explod
trigger1 = Anim=1250&&AnimElem=3,=1&&Vel Y>=0
id = 6150
anim = 6155
pos = 0,-floor(160*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
scale = const(size.xscale),const(size.yscale)
removeongethit=1

[state 801]
type = VarSet
trigger1 = vel Y>1
var(56) = 0
persistent=0

[state 801]
type = VarSet
trigger1 = numtarget
trigger1 = vel Y>1&&frontedgebodydist<=(target,const(size.air.back)+target,const(size.air.front))
var(56) = frontedgebodydist

[state 1250]
type = NotHitBy
trigger1 = Anim=1250 && AnimElemTime(2)>=0
value = SCA

[state 806]
type = PlayerPush
trigger1 = Anim=1250
value = 0

[state 801]
type = ScreenBound
trigger1 = anim=1250 && AnimElemTime(2)>=0
value = 0
movecamera = 1,1

[state 4100]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=1250&&animelem=2
value = 10,42
channel = 1
lowpriority = 1
persistent=0

[state 4100]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=1251&&animelem=6&&random%2=0&&var(2)>1&&roundstate=2
trigger1 = var(10) := floor(172*(TicksPerSecond/60))
value = 10,63
channel = 1
lowpriority = 1
;2.857sec

[state 801]
type = Width
trigger1 = Anim=1250&&animelemtime(1)=0
edge = floor(140*const(size.xscale)),0

[state 801]
type = Width
trigger1 = numtarget
trigger1 = Anim=1251&&animelemtime(1)=0
edge = floor(40*const(size.xscale))+target,const(size.air.back),0

[state 801]
type = hitadd
trigger1 = Anim=1251&&animelemtime(1)=0
value = 1

[state 801]
type = varadd
trigger1 = Anim=1251&&animelemtime(1)=0
var(2) = 1

[state 801]
type = varadd
trigger1 = Anim=1251&&animelemtime(1)=0
var(3) = 1

[state 801]
type = targetlifeadd
trigger1 = numtarget
trigger1 = Anim=1251&&animelemtime(1)=0
value = -floor(119*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)

;強制基底補正70%
[state -1]
type = varadd
trigger1 = Anim=1251&&animelemtime(1)=0 && var(8)%32<16
var(8) = 16
ignorehitpause=1

;気絶値増加
[state -1]
type = varadd
trigger1 = Anim=1251&&animelemtime(1)=0
var(29) = floor(6*fvar(1))
ignorehitpause=1

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = numtarget
trigger1 = animelemtime(2)<0
pos = floor(100*const(size.xscale)),floor(-380*const(size.yscale))

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = numtarget
trigger1 = animelemtime(2)>=0&&animelemtime(3)<0
pos = floor(25*const(size.xscale)),floor(-240*const(size.yscale))

[state 801]
type = targetbind
triggerall = Anim=1250
triggerall = numtarget
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
trigger2 = animelemtime(5)>=0&&animelemtime(6)<0
pos = floor(0*const(size.xscale)),floor(-80*const(size.xscale))

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = numtarget
trigger1 = animelemtime(4)>=0&&animelemtime(5)<0
pos = floor(-40*const(size.xscale)),floor(-80*const(size.xscale))

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = numtarget
trigger1 = animelemtime(6)>=0
pos = floor(40*const(size.xscale)),floor(-80*const(size.xscale))

[state 801]
type = VelSet
trigger1 = Anim=1250&&AnimElemTime(2)=1
x = 2.5
y = -8.0
persistent=0

[state 801]
type = VelAdd
trigger1 = Anim=1250&&AnimElemTime(2)>1
y = .5

[state 801]
type = targetbind
trigger1 = numtarget
trigger1 = Anim=1251&&AnimElemTime(1)=0
pos = floor(70*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetstate
trigger1 = Anim=1251&&numtarget
trigger1 = target,stateno!=1257&&!(floor(var(7)%1000/100)>0&&floor(var(7)%1000/100)=floor(var(7)%10000/1000))
value = 1257

[state 801]
type = PlaySND
trigger1 = Anim=1250&&animelemtime(1)=0
value = 7100,2
channel = 10

[state 801]
type = PlaySND
trigger1 = Anim=1250&&animelemtime(3)=1
value = 7300,2
channel = 10

[state 801]
type = PlaySND
trigger1 = Anim=1250&&animelemtime(6)=1
value = 30,2
channel = 11

[state 801]
type = null;PlaySND
trigger1 = Anim=1251&&animelemtime(1)=0
value = 5100,2
channel = 10

[state 4100]
type = PlaySND
trigger1 = Anim=1251&&animelemtime(1)=0
value = 30,3
channel = 11
volume = 128

[state 5210]
type = RemoveExplod
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6150

[state 5210]
type = RemoveExplod
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6160

[state 1250]
type = EnvShake
trigger1 = Anim=1251&&animelemtime(1)=0
ampl = 4
time = 16

[state 6310]
type = Helper
trigger1 = numtarget
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6310
stateno = 6310
pos = 40+ifelse(var(56),var(56)-target,const(size.air.front)-target,const(size.air.back),0)
postype = p1
ownpal = 1
sprpriority = 4

[state 1250]
type = Helper
trigger1 = Anim=1251&&animelemtime(1)=0&&numtarget
trigger1 = (!target,SelfAnimExist(9060)||!(target,authorname="rei"||target,authorname="gal129"||target,name="keiji"))
id = 6855
stateno = 6855
pos = floor(20*const(size.xscale))+target,const(size.air.back)+ifelse(var(56),var(56)-target,const(size.air.front)-target,const(size.air.back),0),8
postype = p1
ownpal = 1
sprpriority = 4
size.xscale = ifelse((target,const(size.ground.front)+target,const(size.ground.back))>=40,.75,.5)*const(size.xscale)
size.yscale = ifelse((target,const(size.ground.front)+target,const(size.ground.back))>=40,.75,.5)*const(size.yscale)

[state 801]
type = Explod
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6200
anim = 6200
pos = floor(40*const(size.xscale)),0
postype = p1
scale = .5,.5
ownpal = 1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

[state 801]
type = Explod
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6200
anim = 6200
pos = floor(40*const(size.xscale)),0
postype = p1
scale = .5,.5
ownpal = 1
facing=-1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

[State 40, 1]
type = Helper
trigger1 = numtarget
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6925
stateno = 6920
pos = floor(0*const(size.xscale))+target,const(size.air.back)+ifelse(var(56),var(56)-target,const(size.air.front)-target,const(size.air.back),0),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = Anim=1251&&AnimElemTime(1)=0
fvar(15) = .00005*floor(ifelse(119*fvar(14)<1,1+(var(2)%5=1),119*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = Anim=1251&&AnimElemTime(1)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

[state 1000]
type = ChangeState
trigger1 = Anim=1251&&AnimTime=0
value = 0
ctrl = 1

;■■■■■■■
;C派生1天地葬送食らい
[statedef 3046]
type = S
physics = N
movetype=H
ctrl = 0
velset = 0,0
sprpriority = -1

[state 806]
type = ChangeAnim2
trigger1 = time=0&&Anim!=1256
value = 1256

[state 806]
type = PlayerPush
trigger1 = 1
value = 0

[state 806]
type = ScreenBound
trigger1 = 1
value = 0

[state 806]
type = SelfState
trigger1 = !enemynear,numpartner
trigger1 = enemynear,name="Toyotomi_Hideyoshi"&&P2movetype=H
trigger2 = time>=70
value = 5040

;A派生2伝衝裂鬼掴み動作
[statedef 3050]
type = S
physics = N
movetype=A
velset = 0,0
anim = 3050

[state 3010]
type = NotHitBy
trigger1 = 1
value = SCA

[state 800]
type = varset
trigger1 = anim=3050&&animelemtime(4)>=0
var(56) = 0

[state 800]
type = varset
trigger1 = anim=1020&&animtime=0
var(56) = 1

[state 800]
type = varset
trigger1 = anim=3050&&animelemtime(14)>0
var(56) = 0

[state 800]
type = varadd
trigger1 = anim=3050&&animelemtime(4)<0&&var(56)>0
var(56) = 1

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = anim=3050&&animelemtime(4)<0&&var(56) = [1,25]
time = 1
add = 255-(var(56)-1)*10,0,0

[state 800]
type = PlaySND
trigger1 = !time
value = 7100,0
channel = 10

[state 801]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&anim=3050&&animelemtime(5)=0
value = 10,3
lowpriority = 1
channel = 1

[state 801]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&anim=3050&&animelemtime(6)=0
value = 10,42
lowpriority = 1
channel = 1

[state 801]
type = ScreenBound
trigger1 = anim=3050&&animelemtime(8)>=0&&animelemtime(14)<0
trigger2 = anim=1020
value = 0
movecamera = 1,1

[state 801]
type = VelSet
trigger1 = anim=3050&&animelemtime(8)=0
trigger2 = anim=1020
x = 10

[state 801]
type = ChangeAnim
trigger1 = anim=3050&&animelemtime(9)=0&&ifelse(facing=1,helper(30000),pos x-enemynear,pos x,-(helper(30005),pos x-enemynear,pos x))>(-80+enemynear,const(size.air.back));&&frontedgebodydist>5
value = 1020

[state 801]
type = ChangeAnim
trigger1 = anim=1020&&animelemno(0)!=animelemno(-1)&&ifelse(facing=1,helper(30000),pos x-enemynear,pos x,-(helper(30005),pos x-enemynear,pos x))<=(-80+enemynear,const(size.air.back));&&frontedgebodydist<=5
trigger2 = anim=1020&&animtime=0
value = 3050
elem = 9

[state 801]
type = VelMul
trigger1 = anim=3050&&animelemtime(9)>=0
x = .8

[state 910]
type = Explod
trigger1 = Anim=1020&&AnimElem=1
trigger2 = Anim=1020&&AnimElem=2
trigger3 = Anim=1020&&AnimElem=3
trigger4 = Anim=1020&&AnimElem=4
id = 6100
anim = 6100
pos = 0,0
postype = p1
removeongethit=1
scale = .75,.75
sprpriority = 3

[state 190]
type = Explod
trigger1 = Anim=1020&&AnimElem=1
trigger2 = Anim=1020&&AnimElem=2
trigger3 = Anim=1020&&AnimElem=3
trigger4 = Anim=1020&&AnimElem=4
id = 6915
anim = 6915
pos = floor(-80*const(size.xscale)),0
postype = P1
sprpriority = 3
bindtime=1
scale = const(size.xscale),const(size.yscale)

[state 190]
type = PlaySND
trigger1 = Anim=3050&&AnimElem=5
trigger2 = Anim=1020&&AnimElem=1
trigger3 = Anim=1020&&AnimElem=2
trigger4 = Anim=1020&&AnimElem=3
trigger5 = Anim=1020&&AnimElem=4
value = 5100,1
channel = 10

[state 190]
type = EnvShake
trigger1 = Anim=3050&&AnimElem=5
trigger2 = Anim=1020&&AnimElem=1
trigger3 = Anim=1020&&AnimElem=2
trigger4 = Anim=1020&&AnimElem=3
trigger5 = Anim=1020&&AnimElem=4
time = 12
ample = 6

[State 40, 1]
type = Helper
trigger1 = Anim=3050&&AnimElem=5
id = 6925
stateno = 6920
pos = floor(90*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[State 40, 1]
type = Helper
trigger1 = Anim=1020&&AnimElem=1
trigger2 = Anim=1020&&AnimElem=2
trigger3 = Anim=1020&&AnimElem=3
trigger4 = Anim=1020&&AnimElem=4
id = 6925
stateno = 6920
pos = floor(180*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[state 190]
type = PlaySND
trigger1 = Anim=3050&&AnimElem=9
value = 1000,0

[state 800]
type = PlaySND
trigger1 = Anim=3050&&AnimElem=13
value = 7300,4
channel = 10

[state 1100]
type = TargetState
trigger1 = anim=3050&&animelemtime(4)<0&&numtarget
trigger1 = target,stateno!=3056
value = 3056

[state 1100]
type = TargetState
trigger1 = anim=3050&&animelemtime(4)>=0&&animelemtime(5)<0&&numtarget
trigger1 = target,stateno!=3057
value = 3057

[state 1100]
type = TargetState
trigger1 = ((anim=3050&&animelemtime(5)>=0&&animelemtime(10)<0)||anim=1020)&&numtarget
trigger1 = target,stateno!=3058
value = 3058

[state 801]
type = null;Width
trigger1 = anim=3050&&animelemtime(1)=0
edge = floor(176*const(size.xscale)),0

[state 801]
type = null;Width
trigger1 = anim=3050&&animelemtime(8)>=0&&animelemtime(9)<0
edge = floor(176*const(size.xscale)),0

[state 801]
type = Width
trigger1 = anim=3050&&animelemtime(14)=0
edge = ifelse((enemynear,const(size.air.front)+enemynear,const(size.air.back))>50,70,0)+floor(40*const(size.xscale)),0

[state 801]
type = Width
trigger1 = anim=3050&&animelemtime(14)=0&&var(56)=1&&ifelse(facing=1,helper(30000),pos x-enemynear,pos x,-(helper(30005),pos x-enemynear,pos x))>enemynear,const(size.air.back)
edge = floor(210*const(size.xscale)),0

[state 801]
type = TargetBind
trigger1 = anim=3050&&AnimElemTime(2)<0
pos = floor(178*const(size.xscale)),floor(-202*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=3050&&AnimElemTime(2)>=0&&AnimElemTime(3)<0
pos = floor(176*const(size.xscale)),floor(-256*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=3050&&AnimElemTime(3)>=0&&AnimElemTime(4)<0
pos = floor(116*const(size.xscale)),floor(-302*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=3050&&AnimElemTime(4)>=0&&AnimElemTime(5)<0
pos = floor(120*const(size.xscale)),floor(-256*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=3050&&AnimElemTime(5)>=0&&AnimElemTime(6)<0
pos = floor(92*const(size.xscale)),floor(-8*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=3050&&AnimElemTime(6)>=0&&AnimElemTime(7)<0
pos = floor(90*const(size.xscale)),floor(-6*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=3050&&AnimElemTime(7)>=0&&AnimElemTime(8)<0
pos = floor(130*const(size.xscale)),floor(-10*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=3050&&AnimElemTime(8)>=0&&AnimElemTime(9)<0
pos = floor(176*const(size.xscale)),floor(-46*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=3050&&AnimElemTime(9)>=0&&AnimElemTime(10)<0
pos = floor(30*const(size.xscale)),floor(-42*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=3050&&AnimElemTime(10)>=0&&AnimElemTime(11)<0
pos = floor(-120*const(size.xscale)),floor(-38*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=3050&&AnimElemTime(11)>=0&&AnimElemTime(12)<0
pos = floor(-98*const(size.xscale)),floor(-36*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=3050&&AnimElemTime(12)>=0&&AnimElemTime(13)<0
pos = floor(-76*const(size.xscale)),floor(-34*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = anim=3050&&AnimElemTime(13)>=0&&AnimElemTime(14)<0
pos = floor(-16*const(size.xscale)),floor(-68*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = Anim=3050&&AnimElemTime(14)=0
pos = floor(200*const(size.xscale)),floor(-110*const(size.yscale))

[state 801]
type = TargetState
trigger1 = Anim=3050&&AnimElemTime(14)=0
value = 3059

[state 801]
type = hitadd
trigger1 = anim=3050&&animelemtime(5)=0
trigger2 = anim=3050&&animelemtime(14)=0
trigger3 = anim=1020&&animelemtime(1)=0
trigger4 = anim=1020&&animelemtime(2)=0
trigger5 = anim=1020&&animelemtime(3)=0
trigger6 = anim=1020&&animelemtime(4)=0
value = 1

[state 801]
type = varadd
trigger1 = anim=3050&&animelemtime(5)=0
trigger2 = anim=3050&&animelemtime(14)=0
trigger3 = anim=1020&&animelemtime(1)=0
trigger4 = anim=1020&&animelemtime(2)=0
trigger5 = anim=1020&&animelemtime(3)=0
trigger6 = anim=1020&&animelemtime(4)=0
var(2) = 1

[state 801]
type = varadd
trigger1 = anim=3050&&animelemtime(5)=0
trigger2 = anim=3050&&animelemtime(14)=0
trigger3 = anim=1020&&animelemtime(1)=0
trigger4 = anim=1020&&animelemtime(2)=0
trigger5 = anim=1020&&animelemtime(3)=0
trigger6 = anim=1020&&animelemtime(4)=0
var(3) = 1

[state 801]
type = targetlifeadd
trigger1 = anim=3050&&animelemtime(5)=0
value = -floor(40*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)
kill = 0

[state 801]
type = targetlifeadd
trigger1 = anim=1020&&animelemtime(1)=0
value = -floor(12*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)
kill = 0

[state 801]
type = targetlifeadd
trigger1 = anim=1020&&animelemtime(2)=0
value = -floor(10*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)
kill = 0

[state 801]
type = targetlifeadd
trigger1 = anim=1020&&animelemtime(3)=0
value = -floor(9*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)
kill = 0

[state 801]
type = targetlifeadd
trigger1 = anim=1020&&animelemtime(4)=0
value = -floor(10*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)
kill = 0

[state 801]
type = targetlifeadd
trigger1 = anim=3050&&animelemtime(14)=0
value = -floor(50*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = anim=3050&&animelemtime(5)=0
fvar(15) = .00005*floor(ifelse(40*fvar(14)<1,1+(var(2)%5=1),40*fvar(14))*1.22)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = anim=1020&&animelemtime(1)=0&&roundstate<3
fvar(15) = .00005*floor(ifelse(12*fvar(14)<1,1+(var(2)%5=1),12*fvar(14))*1.22)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = anim=1020&&animelemtime(2)=0&&roundstate<3
fvar(15) = .00005*floor(ifelse(10*fvar(14)<1,1+(var(2)%5=1),10*fvar(14))*1.22)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = anim=1020&&animelemtime(3)=0&&roundstate<3
fvar(15) = .00005*floor(ifelse(9*fvar(14)<1,1+(var(2)%5=1),9*fvar(14))*1.22)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = anim=1020&&animelemtime(4)=0&&roundstate<3
fvar(15) = .00005*floor(ifelse(10*fvar(14)<1,1+(var(2)%5=1),10*fvar(14))*1.22)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = anim=3050&&animelemtime(14)=0
fvar(15) = .00005*floor(ifelse(50*fvar(14)<1,1+(var(2)%5=1),50*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = anim=3050&&animelemtime(5)=0
trigger2 = anim=1020&&animelemtime(1)=0
trigger3 = anim=1020&&animelemtime(2)=0
trigger4 = anim=1020&&animelemtime(3)=0
trigger5 = anim=1020&&animelemtime(4)=0
trigger6 = anim=3050&&animelemtime(14)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

[state 3050]
type = AttackDist
trigger1 = 1
value = 0

[state 1050]
type = changestate
trigger1 = animtime=0
value = 0
ctrl = 1

;A派生2伝衝裂鬼相手動作
[statedef 3056]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=1016
value = 1016

[state 1116]
type = PlayerPush
trigger1 = 1
value = 0

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 1,1

[state 1116]
type = SprPriority
trigger1 = 1
value = 2

[state 1116]
type = SelfState
trigger1 = time>=24
value = 5210

;A派生2伝衝裂鬼相手動作2
[statedef 3057]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=1017
value = 1017

[state 1116]
type = PlayerPush
trigger1 = 1
value = 0

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 1,1

[state 1116]
type = SprPriority
trigger1 = 1
value = -1

[state 1116]
type = SelfState
trigger1 = time>=8
value = 5210

;A派生2伝衝裂鬼相手動作3
[statedef 3058]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=1018
value = 1018

[state 1116]
type = PlayerPush
trigger1 = 1
value = 0

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 1,1

[state 1116]
type = SprPriority
trigger1 = 1
value = -1

[state 1116]
type = SelfState
trigger1 = time>=80
value = 5210

;A派生2伝衝裂鬼相手動作4
[statedef 3059]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim
trigger1 = time<4
value = 5050

[state 1116]
type = ChangeAnim
trigger1 = time=[4,11]
value = 5050+(SelfAnimExist(5051))

[state 1017]
type = VelSet
trigger1 = Time=4
x = -3.5
y = -11.5

[state 1017]
type = VelAdd
trigger1 = Time>=4
y = .5

[state 1017]
type = SelfState
trigger1 = time>12&&Vel Y>6
value = 5050

;B派生2灰塵乱渦掴み動作
[statedef 3060]
type = S
movetype=A
physics = S
ctrl = 0
velset = 0,0
anim = 3060

[state 3010]
type = NotHitBy
trigger1 = 1
value = SCA

[state 800]
type = varadd
trigger1 = var(56)>0
var(56) = 1

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = var(56) = [1,25]
time = 1
add = 255-(var(56)-1)*10,0,0

[state 1100]
type = TargetState
trigger1 = animelemtime(25)<0&&numtarget
trigger1 = target,stateno!=3066
value = 3066

[state 800]
type = varset
trigger1 = !time
var(1) = ifelse(var(1)%16>=8,8,0)

[state 5210]
type = Explod
trigger1 = AnimElem=6
trigger2 = AnimElem=10
trigger3 = AnimElem=14
id = 6150
anim = 6150
pos = 0,-floor(280*const(size.yscale))
postype = p1
bindtime=-1
sprpriority = 4
ownpal = 1
scale = .75,.5
removeongethit=1

[state 5210]
type = Explod
trigger1 = AnimElem=6
trigger2 = AnimElem=10
trigger3 = AnimElem=14
id = 6160
anim = 6160
pos = 0,-floor(260*const(size.yscale))
postype = p1
bindtime=-1
sprpriority = 4
ownpal = 1
scale = .75,.5
removeongethit=1

[state 5210]
type = Explod
trigger1 = AnimElem=6
trigger2 = AnimElem=10
trigger3 = AnimElem=14
id = 6160
anim = 6160
pos = 0,-floor(180*const(size.yscale))
postype = p1
bindtime=-1
sprpriority = 4
ownpal = 1
scale = .75,.5
removeongethit=1

[state 5210]
type = Explod
trigger1 = AnimElem=6
trigger2 = AnimElem=10
id = 6150
anim = 6150
pos = 0,-floor(140*const(size.yscale))
postype = p1
bindtime=-1
sprpriority = 4
ownpal = 1
scale = .75,.5
removeongethit=1

[state 190]
type = Explod
trigger1 = AnimElem=1
trigger2 = AnimElem=1,=3
trigger3 = AnimElem=1,=7
trigger4 = AnimElem=1,=11
trigger5 = AnimElem=2
trigger6 = AnimElem=3
trigger7 = AnimElem=4
trigger8 = AnimElem=5
id = 6910
anim = 6910
pos = floor(-20*const(size.xscale)),0
postype = P1
ownpal = 1
sprpriority = 3
bindtime=1
scale = const(size.xscale),const(size.yscale)

[state 190]
type = Explod
trigger1 = AnimElem=6
trigger2 = AnimElem=10
trigger3 = AnimElem=14
id = 6915
anim = 6915
pos = floor(-40*const(size.xscale)),0
postype = P1
ownpal = 1
sprpriority = 3
bindtime=1
scale = const(size.xscale),const(size.yscale)

[state 190]
type = Explod
trigger1 = AnimElem=8
trigger2 = AnimElem=12
trigger3 = AnimElem=14
id = 6915
anim = 6915
pos = floor(40*const(size.xscale)),0
postype = P1
ownpal = 1
sprpriority = 3
facing=-1
bindtime=1
scale = const(size.xscale),const(size.yscale)

[state 1250]
type = NotHitBy
trigger1 = AnimElemTime(2)>=0
value = SCA

[state 1250]
type = PlayerPush
trigger1 = 1
value = 0

[state 801]
type = Width
trigger1 = animelemtime(1)=1
edge = floor(166*const(size.xscale)),0

[state 801]
type = Width
trigger1 = animelemtime(3)=1
edge = floor(220*const(size.xscale)),0

[state 801]
type = Width
trigger1 = animelemtime(4)=1
edge = floor(160*const(size.xscale))-floor(target,const(size.head.pos.y)*4.0/10),0

[state 801]
type = Width
trigger1 = animelemtime(5)=1
edge = floor(40*const(size.xscale))-target,const(size.head.pos.y),0

[state 801]
type = Width
trigger1 = animelemtime(25)=0
edge = ifelse(target,const(size.head.pos.y)<=-120,-target,const(size.head.pos.y)+target,const(size.ground.front),120-target,const(size.ground.front))+target,const(size.ground.back),0

[state 800]
type = PlaySND
trigger1 = !time
value = 7100,0
channel = 10

[state 801]
type = PlaySND
trigger1 = animelemtime(6)=0
trigger2 = animelemtime(9)=0
trigger3 = animelemtime(12)=0
value = 30,2
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&animelemtime(25)=0
value = 10,5+(random<=500)
lowpriority = 1
channel = 1

[state 801]
type = hitadd
trigger1 = animelemtime(1)=0
trigger2 = animelemtime(25)=0
value = 1

[state 801]
type = varadd
trigger1 = animelemtime(1)=0
trigger2 = animelemtime(25)=0
var(2) = 1

[state 801]
type = varadd
trigger1 = animelemtime(1)=0
trigger2 = animelemtime(25)=0
var(3) = 1

[state 801]
type = targetlifeadd
trigger1 = animelemtime(25)=0
value = -floor(130*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)

[state 801]
type = TargetBind
trigger1 = animelemtime(1)>=0&&animelemtime(3)<0
pos = floor(166*const(size.xscale)),floor(-180*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
pos = floor(220*const(size.xscale)),floor(-230*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(4)>=0&&animelemtime(5)<0
pos = floor(220*const(size.xscale)),floor(-140*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(5)>=0&&animelemtime(6)<0
pos = floor(100*const(size.xscale)),floor(-128*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(6)>=0&&animelemtime(7)<0
trigger2 = animelemtime(11)>=0&&animelemtime(12)<0
trigger3 = animelemtime(16)>=0&&animelemtime(17)<0
pos = -floor(110*const(size.xscale)),floor(-244*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(7)>=0&&animelemtime(8)<0
trigger2 = animelemtime(12)>=0&&animelemtime(13)<0
trigger3 = animelemtime(17)>=0&&animelemtime(18)<0
pos = -floor(120*const(size.xscale)),floor(-272*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(8)>=0&&animelemtime(9)<0
trigger2 = animelemtime(13)>=0&&animelemtime(14)<0
trigger3 = animelemtime(18)>=0&&animelemtime(19)<0
pos = floor(118*const(size.xscale)),floor(-268*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(9)>=0&&animelemtime(10)<0
trigger2 = animelemtime(14)>=0&&animelemtime(15)<0
trigger3 = animelemtime(19)>=0&&animelemtime(20)<0
pos = floor(180*const(size.xscale)),floor(-250*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(10)>=0&&animelemtime(11)<0
trigger2 = animelemtime(15)>=0&&animelemtime(16)<0
trigger3 = animelemtime(20)>=0&&animelemtime(21)<0
pos = floor(126*const(size.xscale)),floor(-236*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(21)>=0&&animelemtime(22)<0
pos = floor(-142*const(size.xscale)),floor(-222*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(22)>=0&&animelemtime(23)<0
pos = floor(-150*const(size.xscale)),floor(-270*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(23)>=0&&animelemtime(24)<0
pos = floor(-72*const(size.xscale)),floor(-328*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(24)>=0&&animelemtime(25)<0
pos = floor(46*const(size.xscale)),floor(-342*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(25)=0
pos = floor(240*const(size.xscale)),floor(-80*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = animelemtime(25)=0&&target,const(size.head.pos.y)<=-120
pos = -(target,const(size.head.pos.y)+24),floor(-80*const(size.yscale))-(target,const(size.head.pos.y)<=-120)*ifelse((target,const(size.head.pos.y)+100)<-20,-20,(target,const(size.head.pos.y)+100))

[state 801]
type = TargetBind
trigger1 = numtarget
trigger1 = animelemtime(25)=0&&target,const(size.head.pos.y)>=-100
pos = floor(240*const(size.xscale))-(target,const(size.head.pos.y)+100),floor(-80*const(size.yscale))-5

[state 1050]
type = TargetState
trigger1 = animelemtime(25)=0
value = 926

[state 1050]
type = VarAdd
trigger1 = animelemtime(25)=0 && var(1)%2<1
var(1) = 1-(var(1)%16>=8&&var(1)%8>=4)*4

[state 1050]
type = PosAdd
trigger1 = animelemtime(23)=0
x = floor(40*const(size.xscale))

[state 1050]
type = VelSet
trigger1 = animelemtime(23)=1
x = 8.0

[state 1050]
type = VelMul
trigger1 = animelemtime(23)>1
x = .9

[state 1050]
type = VelSet
trigger1 = animelemtime(26)=0
x = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = AnimElemTime(25)=0
fvar(15) = .00005*floor(ifelse(130*fvar(14)<1,1+(var(2)%5=1),130*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = AnimElemTime(25)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

[state 1050]
type = changestate
trigger1 = animtime=0
value = 0
ctrl = 1

;B派生2灰塵乱渦相手動作
[statedef 3066]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=3066
value = 3066

[state 1116]
type = ScreenBound
trigger1 = Time>=13
value = 0
movecamere = 0,0

[state 1116]
type = SprPriority
trigger1 = 1
value = -1

[state 1116]
type = SprPriority
trigger1 = time=[15,30]
trigger2 = time=[35,41]
trigger3 = time=[45,51]
trigger4 = time=[55,61]
trigger5 = time=[62,73]
value = 2

[state 1116]
type = SelfState
trigger1 = time>=97
value = 5210

;■■■■■■■
;C派生2天地葬送掴み
[statedef 3070]
type = A
physics = N
movetype=A
ctrl = 0
velset = 0,0
anim = 1250

[state 3010]
type = NotHitBy
trigger1 = 1
value = SCA

[state 800]
type = varadd
trigger1 = var(56)>0
var(56) = 1

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = var(56) = [1,25]
time = 1
add = 255-(var(56)-1)*10,0,0

[state 801]
type = targetstate
trigger1 = time=0||(target,stateno!=3076&&anim=1250)
value = 3076

[state 801]
type = ChangeAnim
trigger1 = Anim=1250&&Vel Y>0 && Pos Y>=-Vel Y
value = 1251

[state 801]
type = StatetypeSet
trigger1 = Anim=1251
statetype=S
physics = S
persistent=0

[state 801]
type = VelSet
trigger1 = Anim=1251
x = 0
y = 0
persistent=0

[state 801]
type = posadd
trigger1 = Anim=1251&&AnimElemTime(1)=0
x = floor(60*const(size.xscale))

[state 801]
type = PosSet
trigger1 = Anim=1251
y = 0
persisten=0

[state 1250]
type = varset
trigger1 = Anim=1251&&AnimElem=1
var(12) = 143+36
persistent=0

[state 5210]
type = Explod
trigger1 = Anim=1250&&AnimElem=3,=1&&Vel Y>=0
id = 6150
anim = 6155
pos = 0,-floor(320*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
scale = const(size.xscale),const(size.yscale)
removeongethit=1

[state 5210]
type = Explod
trigger1 = Anim=1250&&AnimElem=3,=1&&Vel Y>=0
id = 6160
anim = 6165
pos = 0,-floor(260*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
scale = const(size.xscale),const(size.yscale)
removeongethit=1

[state 5210]
type = Explod
trigger1 = Anim=1250&&AnimElem=3,=1&&Vel Y>=0
id = 6160
anim = 6165
pos = 0,-floor(180*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
scale = const(size.xscale),const(size.yscale)
removeongethit=1

[state 5210]
type = Explod
trigger1 = Anim=1250&&AnimElem=3,=1&&Vel Y>=0
id = 6150
anim = 6155
pos = 0,-floor(160*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
scale = const(size.xscale),const(size.yscale)
removeongethit=1

[state 801]
type = VarSet
trigger1 = vel Y>1
var(56) = 0

[state 801]
type = VarSet
trigger1 = vel Y>1
trigger1 = frontedgebodydist<=(target,const(size.air.back)+target,const(size.air.front))
var(56) = frontedgebodydist

[state 1250]
type = NotHitBy
trigger1 = Anim=1250 && AnimElemTime(2)>=0
value = SCA

[state 806]
type = PlayerPush
trigger1 = Anim=1250
value = 0

[state 801]
type = ScreenBound
trigger1 = anim=1250 && AnimElemTime(2)>=0
value = 0
movecamera = 1,1

[state 4100]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=1250&&animelem=2
value = 10,42
channel = 1
lowpriority = 1
persistent=0

[state 4100]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=1251&&animelem=6&&random%2=0&&var(2)>1&&roundstate=2
trigger1 = var(10) := floor(172*(TicksPerSecond/60))
value = 10,63
channel = 1
;2.857sec

[state 801]
type = Width
trigger1 = Anim=1250&&animelemtime(1)=0
edge = floor(140*const(size.xscale)),0

[state 801]
type = Width
trigger1 = Anim=1251&&animelemtime(1)=0
edge = floor(40*const(size.xscale))+target,const(size.air.back),0

[state 801]
type = hitadd
trigger1 = Anim=1251&&animelemtime(1)=0
value = 1

[state 801]
type = varadd
trigger1 = Anim=1251&&animelemtime(1)=0
var(2) = 1

[state 801]
type = varadd
trigger1 = Anim=1251&&animelemtime(1)=0
var(3) = 1

[state 801]
type = targetlifeadd
trigger1 = Anim=1251&&animelemtime(1)=0
value = -floor(120*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0))*1.22)

;強制基底補正70%
[state -1]
type = varadd
trigger1 = Anim=1251&&animelemtime(1)=0 && var(8)%32<16
var(8) = 16
ignorehitpause=1

;気絶値増加
[state -1]
type = varadd
trigger1 = Anim=1251&&animelemtime(1)=0
var(29) = floor(6*fvar(1))
ignorehitpause=1

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = animelemtime(2)<0
pos = floor(100*const(size.xscale)),floor(-380*const(size.yscale))

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = animelemtime(2)>=0&&animelemtime(3)<0
pos = floor(25*const(size.xscale)),floor(-240*const(size.yscale))

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
trigger2 = animelemtime(5)>=0&&animelemtime(6)<0
pos = floor(0*const(size.xscale)),floor(-80*const(size.xscale))

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = animelemtime(4)>=0&&animelemtime(5)<0
pos = floor(-40*const(size.xscale)),floor(-80*const(size.xscale))

[state 801]
type = targetbind
triggerall = Anim=1250
trigger1 = animelemtime(6)>=0
pos = floor(40*const(size.xscale)),floor(-80*const(size.xscale))

[state 801]
type = VelSet
trigger1 = Anim=1250&&AnimElemTime(2)=1
x = 2.5
y = -24.0
persistent=0

[state 801]
type = VelAdd
trigger1 = Anim=1250&&AnimElemTime(2)>1
y = .5

[state 801]
type = targetbind
trigger1 = Anim=1251&&AnimElemTime(1)=0
pos = floor(70*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetstate
trigger1 = Anim=1251&&numtarget
trigger1 = target,stateno!=1257
value = 1257

[state 801]
type = PlaySND
trigger1 = Anim=1250&&animelemtime(1)=0
value = 7100,2
channel = 10

[state 801]
type = PlaySND
trigger1 = Anim=1250&&animelemtime(3)=1
value = 7300,2
channel = 10

[state 801]
type = PlaySND
trigger1 = Anim=1250&&animelemtime(6)=1
value = 30,2
channel = 11

[state 801]
type = null;PlaySND
trigger1 = Anim=1251&&animelemtime(1)=0
value = 5100,2
channel = 10

[state 4100]
type = PlaySND
trigger1 = Anim=1251&&animelemtime(1)=0
value = 30,3
channel = 11
volume = 128

[state 5210]
type = RemoveExplod
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6150

[state 5210]
type = RemoveExplod
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6160

[state 1250]
type = EnvShake
trigger1 = Anim=1251&&animelemtime(1)=0
ampl = 4
time = 16

[state 6310]
type = Helper
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6310
stateno = 6310
pos = 40+ifelse(var(56),var(56)-target,const(size.air.front)-target,const(size.air.back),0),0
postype = p1
ownpal = 1
sprpriority = 4

[state 1250]
type = Helper
trigger1 = Anim=1251&&animelemtime(1)=0&&numtarget
trigger1 = (!target,SelfAnimExist(9060)||!(target,authorname="rei"||target,authorname="gal129"||target,name="keiji"))
id = 6855
stateno = 6855
pos = floor(20*const(size.xscale))+target,const(size.air.back)+ifelse(var(56),var(56)-target,const(size.air.front)-target,const(size.air.back),0),8
postype = p1
ownpal = 1
sprpriority = 4
size.xscale = ifelse((target,const(size.ground.front)+target,const(size.ground.back))>=40,.75,.5)*const(size.xscale)
size.yscale = ifelse((target,const(size.ground.front)+target,const(size.ground.back))>=40,.75,.5)*const(size.yscale)

[state 801]
type = Explod
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6200
anim = 6200
pos = floor(0*const(size.xscale))+target,const(size.air.back),0
postype = p1
scale = .5,.5
ownpal = 1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

[state 801]
type = Explod
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6200
anim = 6200
pos = floor(0*const(size.xscale))+target,const(size.air.back),0
postype = p1
scale = .5,.5
ownpal = 1
facing=-1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

[State 40, 1]
type = Helper
trigger1 = Anim=1251&&animelemtime(1)=0
id = 6925
stateno = 6920
pos = floor(0*const(size.xscale))+target,const(size.air.back)+ifelse(var(56),var(56)-target,const(size.air.front)-target,const(size.air.back),0),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = Anim=1251&&AnimElemTime(1)=0
fvar(15) = .00005*floor(ifelse(129*fvar(14)<1,1+(var(2)%5=1),129*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = Anim=1251&&AnimElemTime(1)=0
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

[state 1000]
type = ChangeState
trigger1 = Anim=1251&&AnimTime=0
value = 0
ctrl = 1

;■■■■■■■
;C派生2天地葬送食らい
[statedef 3076]
type = S
physics = N
movetype=H
ctrl = 0
velset = 0,0
sprpriority = -1

[state 806]
type = ChangeAnim2
trigger1 = time=0&&Anim!=1256
value = 1256

[state 806]
type = PlayerPush
trigger1 = 1
value = 0

[state 806]
type = ScreenBound
trigger1 = 1
value = 0

[state 806]
type = SelfState
trigger1 = !enemynear,numpartner
trigger1 = enemynear,name="Toyotomi_Hideyoshi"&&P2movetype=H
trigger2 = time>=120
value = 5040

;猿舞剛把投げ抜けられ動作1
[statedef 3090]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0
anim=3090

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;猿舞剛把投げ抜けられ動作2
[statedef 3091]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0
anim=3091

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;猿舞剛把投げ抜け動作
[statedef 3096]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1017]
type = PosSet
trigger1 = !time
y = 0

[state 1017]
type = SelfState
trigger1 = !time
value = 105

[statedef 13010]
type = S
movetype=U
physics = S
ctrl = 0
velset = 0,0

[state 13010]
type = AssertSpecial
trigger1 = 1
flag = NoKOSND

[state 13010]
type = BindtoRoot
trigger1 = 1
pos = 0,0
time = 1

[state 13010]
type = ChangeAnim
trigger1 = 1
value = 3010
elem = root,animelemno(0)

[state 13010]
type = AssertSpecial
trigger1 = 1
flag = invisible

[state 13010]
type = LifeSet
trigger1 = !time&&!gethitvar(damage)
value = root,life

[state 13010]
type = varset
trigger1 = gethitvar(damage)
var(0) = gethitvar(damage)

[state 13010]
type = varset
trigger1 = gethitvar(damage)
var(1) = gethitvar(hitshaketime)

[state 13010]
type = varset
trigger1 = gethitvar(damage)
var(2) = gethitvar(animtype)

[state 13010]
type = varset
trigger1 = gethitvar(damage)
var(3) = gethitvar(groundtype)

[state 13010]
type = varset
trigger1 = gethitvar(damage)
fvar(0) = gethitvar(xvel)

[state 13010]
type = varset
trigger1 = gethitvar(damage)
fvar(1) = gethitvar(yvel)

[state 13010]
type = varset
trigger1 = gethitvar(damage)
fvar(2) = gethitvar(yaccel)

[state 13010]
type = lifeset
trigger1 = life<=0
value = 1

[state 13010]
type = statetypeset
trigger1 = time
movetype=I

[state 13010]
type = NotHitBy
trigger1 = 1
value = ,AT

[state 13010]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
stateno = stateno
slot = 0
time = 1

[state 3010]
type = changeanim
trigger1 = root,stateno!=3010
value = 90000

[state 3010]
type = DestroySelf
trigger1 = root,stateno!=3010&&root,movetype!=H

;金剛破滅
[statedef 3100]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = (prevstateno=[1000,1999])&&!((prevstateno=1100||prevstateno=1150)&&var(7)=1)&&!(prevstateno=1400&&var(7)>=32&&ifelse(var(7)>=62,movecontact,movehit))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = (prevstateno=[1000,1999])&&!((prevstateno=1100||prevstateno=1150)&&var(7)=1)&&!(prevstateno=1400&&var(7)>=32&&ifelse(var(7)>=62,movecontact,movehit))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = (prevstateno=[1000,1999])&&!((prevstateno=1100||prevstateno=1150)&&var(7)=1)&&!(prevstateno=1400&&var(7)>=32&&ifelse(var(7)>=62,movecontact,movehit))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time&&(prevstateno!=[5000,5099])

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
triggerall = Anim!=3100
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3100

[state 200]
type = VarSet
trigger1 = !IsHelper&&!Time
fvar(8) = 0

;BASARAゲージ回復不能時間
[state 2000]
type = VarSet
trigger1 = AnimElem=1,=1&&(prevstateno!=[5000,5099])
var(9)=420

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&AnimElem=1,=1&&(prevstateno!=[5000,5099])
value = ,AP
time=30

[state 200]
type = pause
trigger1 = !IsHelper&&AnimElem=1&&!var(46)&&(prevstateno!=[5000,5099])
time = 30
movetime = 30

[state -2]
type = poweradd
trigger1 = !IsHelper&&(prevstateno!=[5000,5099])&&AnimElem=1,=1
value = -1000
persistent=0

[state 200]
type = helper
trigger1 = !IsHelper&&AnimElem=1&&!var(46)
id = 7560
stateno = 7560
pos = floor(30*const(size.xscale)),floor(-180*const(size.yscale))
postype = P1
pausemovetime=54+999
ownpal = 1

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)&&!(var(52)>0&&movecontact)&&var(46)
var(46) = 1

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=1&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[1,31]
value = 3100
elem = 1

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=2&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[32,36]
value = 3100
elem = 2

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=3&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[37,40]
value = 3100
elem = 3

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=4&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[41,43]
value = 3100
elem = 4

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=5&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[44,45]
value = 3100
elem = 5

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=6&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[46,47]
value = 3100
elem = 6

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=7&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=48
value = 3100
elem = 7

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=8&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=49
value = 3100
elem = 8

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=9&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=50
value = 3100
elem = 9

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=10&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=51
value = 3100
elem = 10

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=11&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=52
value = 3100
elem = 11

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=12&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=53
value = 3100
elem = 12

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=13&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[54,55]
value = 3100
elem = 13

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=14&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[56,57]
value = 3100
elem = 14

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=15&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[58,59]
value = 3100
elem = 15

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=16&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[60,61]
value = 3100
elem = 16

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=17&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[62,71]
value = 3100
elem = 17

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=18&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[72,79]
value = 3100
elem = 18

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=19&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[80,83]
value = 3100
elem = 19

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=20&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[84,88]
value = 3100
elem = 20

[state 1610]
type = null;ChangeAnim
trigger1 = Time<var(48) && (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = anim
elem = AnimElemNo(0)

[state 1610]
type = PosFreeze
trigger1 = Time<var(48) && (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = 1


[state 3100]
type = RemoveExplod
trigger1 = AnimElem=15
trigger2 = AnimElem=16
trigger3 = AnimElem=17
trigger4 = AnimElem=17,=2
id = 6450

[state 6150]
type = Explod
trigger1 = AnimElem=14
id = 6450
anim=6450
pos = -floor(100*const(size.xscale)),floor(60*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6150]
type = Explod
trigger1 = AnimElem=15
id = 6450
anim=6451
pos = -floor(100*const(size.xscale)),floor(60*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6150]
type = Explod
trigger1 = AnimElem=16
id = 6450
anim=6452
pos = -floor(100*const(size.xscale)),floor(60*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6150]
type = Explod
trigger1 = AnimElem=17
id = 6450
anim=6453
pos = -floor(100*const(size.xscale)),floor(60*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[State 40, 1]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1,=1
value = 10,43+(random%2=0)*2
channel = 1

;Dust
[state 190]
type = Explod
trigger1 = AnimElem=14
id = 6915
anim = 6915
pos = floor(120*const(size.xscale)),0
postype = P1
ownpal = 1
sprpriority = 3
bindtime=1
facing=-1
scale = const(size.xscale),const(size.yscale)

[state 3100]
type = null;PosAdd
trigger1 = AnimElem=7
x = floor(80*const(size.xscale))

[state 3100]
type = null;PosAdd
trigger1 = AnimElem=19
x = -floor(20*const(size.xscale))

[state 3100]
type = null;PosAdd
trigger1 = AnimElem=20
x = -floor(80*const(size.xscale))

[state 3100]
type = ChangeState
trigger1 = animtime=0&&var(28)>0
value = 3110

[state 800]
type = varset
trigger1 = movehit=1
var(1) = ifelse(var(1)%16>=8,8,0)

[state 800]
type = varset
trigger1 = movehit=1
var(6) = ifelse(floor(var(6)%10000/1000)>0,1000,0)


[state 800]
type = MovehitReset
trigger1 = movecontact!=1
trigger1 = animelem=15
value = 1

;>>>>>>>>>>><<<<<<<<<<<


;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&(prevstateno!=[5000,5099])
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0&&time>=var(48)
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(AnimElem=5,<=0,24,13)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=4&&AnimElem=5,<0
damage = ceil(floor(40*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0)))*1.22),ceil(floor(40*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.hittime = 15
pausetime = 1,32
ground.velocity = 0
guard.velocity = -13.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale),ifelse(var(6)%10>0,4,-8.0*(51-var(3))/51-.9)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = 0,0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-130*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = M

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=15,>=0&&AnimElem=16,<0
damage = ceil(floor(50*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0)))*1.22),ceil(floor(50*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -8*const(size.xscale),-32*const(size.yscale)
guard.velocity = -13.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -8*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale),ifelse(var(6)%10>0,4,-32.0*(51-var(3))/51-.9)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = diagup
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = M

;==壁コン解除
[state 920]
type = varset
trigger1 = (movehit=[1,5])&&numtarget
trigger1 = target,time=0 && animelemtime(15)>=0
var(1) = ifelse(var(1)%16>=8,8,0)
ignorehitpause=1
persistent=0

[state 3100]
type = EnvShake
trigger1 = animelemtime(15)<0&&hitpausetime=22
ampl = 8
time = 20
ignorehitpause=1

[state 3100]
type = EnvShake
trigger1 = animelemtime(15)<0&&hitpausetime=2
ampl = 4
time = 12
ignorehitpause=1

[state 3100]
type = EnvShake
trigger1 = animelemtime(12)=0&&movecontact
ampl = 2
time = 8
ignorehitpause=1

[state 200]
type = AttackDist
trigger1 = AnimElem=17
value = 0

;強制停止中に動かないように
[state -2]
type = PosFreeze
trigger1 = AnimElemTime(1)>=1&&AnimElemTime(2)<0
trigger2 = NumHelper(7560)
trigger2 = helper(7560),time<30
value = 1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*ifelse(animelemtime(15)>=0,floor(50*fvar(14)*1.22),floor(40*fvar(14)*1.22))
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=4
var(16) = 10+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=16,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
var(18) = floor(-160*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=15,>=0&&AnimElem=17,<0
var(18) = floor(-180*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-6.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),ifelse(AnimElemTime(15)>=0,-13.5,0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = 0*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(animelemtime(15)>=0,13,19)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1


;金剛破滅（待機）
[statedef 3110]
type = S
movetype=I
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3110

[state 3110]
type = Helper
trigger1 = !numhelper(6480)
id = 6480
stateno=6480
pos = 0,-floor(280*const(size.yscale))
ownpal = 1
sprpriority = -3
pausemovetime=999
supermovetime=999

[state 3110]
type = ChangeState
trigger1 = P2stateno=15300
value = 3120

[state 3110]
type = ChangeState
trigger1 = !var(28)||(enemynear,prevstateno=15300&&P2stateno!=15300)
value = 0
ctrl = 1

;金剛破滅（歩き）
[statedef 3120]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3120

[state 3100]
type = VelSet
trigger1 = AnimElem=2,>=0
x = const(velocity.walk.fwd.x)

;援軍アシスト
[state 3000]
type = VarSet
triggerall = (var(40)=1||(var(40)=[5,6]))&&Power>=1000
trigger1 = command="a"&&!var(59)
trigger2 = (enemynear,life=[80,140])&&P2bodydist X>120
trigger2 = random%3=0&&var(59)
var(40) = 7
ignorehitpause=1

;援軍アシスト
[state 3000]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&var(40)=7
value = 10,48
channel = 1

;援軍アタック・勝利(プレイヤーヘルパー削除時用)
[state -2]
type = Helper
triggerall = var(40)=7 && numhelper(10000) && !numhelper(11000)
triggerall = !(stateno=3000&&AnimElemTime(1)>=1&&AnimElemTime(1)<31)&&!(stateno=3100&&AnimElemTime(1)>=1&&AnimElemTime(2)<0)&&!(stateno=3500&&AnimElemTime(1)>=1&&AnimElemTime(1)<31)
trigger1 = (var(40)=[5,9])
name="Takenaka-Hambe"
id = 11000
stateno = 11000
pos = floor(helper(10000),pos x-pos x)*ifelse(helper(10000),facing!=facing,-1,1)*ifelse(teamside=2,-1,1),-floor(Pos Y)
postype = p1
ownpal = 1
size.xscale = const(size.xscale)
size.yscale = const(size.yscale)
size.ground.fwd = 20
size.ground.back = 20
size.head.pos = -10,-80
size.mid.pos = -5,-50
facing = helper(10000),facing
ignorehitpause=1

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = (P2stateno!=[150,155])
trigger1 = AnimElem=2,>=0
attr = S,HT
hitflag = MAF+
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=3150
p1facing = 1
p2facing=1
numhits=0

[state 3150]
type = AttackDist
trigger1 = 1
value = 0

[state 3110]
type = ChangeState
trigger1 = !(P2stateno=15300 && P2movetype=H)&&(var(28)=[-1,0])
value = 0
ctrl = 1

;金剛破滅（とどめ）
[statedef 3150]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3150

;気絶値リセット
[state 801]
type = varset
trigger1 = !time
var(28) = ifelse(var(28)>0,0,var(28))

[state 3110]
type = Explod
trigger1 = !time
id = 6480
anim=6485
pos = 0,-floor(280*const(size.yscale))
ownpal = 1
sprpriority = -3
removeongethit=1
scale = const(size.xscale)*2,const(size.yscale)*2
pausemovetime=999
supermovetime=999

[state 3110]
type = Explod
trigger1 = animelem=5
id = 6800
anim=6800
pos = -floor(20*const(size.xscale)),floor(80*const(size.yscale))
ownpal = 1
sprpriority = 4
removeongethit=1
removetime=-1
scale = const(size.xscale)*2.5,const(size.yscale)*2.5
pausemovetime=999
supermovetime=999

[state 3150]
type = RemoveExplod
trigger1 = AnimElem=6
id = 6800

[state 3150]
type = RemoveExplod
trigger1 = AnimElem=11
id = 6470

[state 3150]
type = RemoveExplod
trigger1 = AnimElem=11
id = 6475

[state 3150]
type = Explod
trigger1 = AnimElem=10
id = 6470
anim=6470
pos = -floor(40*const(size.xscale)),floor(40*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3150]
type = Explod
trigger1 = AnimElem=10
id = 6475
anim=6475
pos = -floor(40*const(size.xscale)),floor(40*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3100]
type = RemoveExplod
trigger1 = AnimElem=10
trigger2 = AnimElem=11
id = 6460

[state 6150]
type = Explod
trigger1 = AnimElem=9
id = 6460
anim=6460
pos = -floor(0*const(size.xscale)),floor(80*const(size.yscale))
postype = p1
sprpriority = 4
ownpal = 1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6150]
type = Explod
trigger1 = AnimElem=10
id = 6460
anim=6461
pos = -floor(0*const(size.xscale)),floor(80*const(size.yscale))
postype = p1
sprpriority = 4
removetime=4
ownpal = 1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3100,dust]
type = Explod
trigger1 = AnimElem=10||AnimElem=13
id = 6915
anim = 6915
pos = floor(-40*const(size.xscale)),0
postype = P1
ownpal = 1
sprpriority = 3
bindtime=1
scale = const(size.xscale),const(size.yscale)

[state 3100,dust]
type = Explod
trigger1 = AnimElem=10||AnimElem=13
id = 6915
anim = 6915
pos = floor(40*const(size.xscale)),0
postype = P1
ownpal = 1
sprpriority = 3
bindtime=1
facing=-1
scale = const(size.xscale),const(size.yscale)

[state 1100]
type = TargetState
trigger1 = animelemtime(10)<0&&numtarget
trigger1 = target,stateno!=3156+(animelemtime(5)>=0)
value = 3156+(animelemtime(5)>=0)

[state 801]
type = Width
trigger1 = AnimElemTime(5)>=0&&AnimElemTime(6)<0
edge = floor(166*const(size.xscale))

[state 801]
type = Width
trigger1 = AnimElemTime(10)>=0&&AnimElemTime(11)<0
edge = floor(232*const(size.xscale))

[state 801]
type = TargetBind
trigger1 = AnimElemTime(5)>=0&&AnimElemTime(6)<0
pos = floor(166*const(size.xscale)),-floor(258*const(size.yscale))

[state 801]
type = TargetBind
trigger1 = movehit=1
pos = floor(232*const(size.xscale)),-floor(80*const(size.yscale))
ignorehitpause=1
persistent=0

;BASARA Moves Finish
[state 3510]
type = Helper
trigger1 = movehit=1 && !enemynear,alive && roundstate=3 && !numhelper(8800) && !numexplod(60000)
id  = 8800
stateno=8800
pos = 0,0
postype = left
scale = const(size.xscale),const(size.yscale)
persistent=0
ignorehitpause=1

;KO
[state 3500]
type = explod
trigger1 = WinKO && !numexplod(60000)
id = 60000
anim = 90000
name="ko"
ownpal = 1
removetime=-1
facing=facing
ignorehitpause=1

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = var(52)<=0||var(52)=100
trigger1 = AnimElem=10
damage = ceil(floor(130*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0)))*1.22),ceil(floor(130*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.hittime = 15
pausetime = 50,49
ground.velocity = -26*const(size.xscale),-12*const(size.yscale)
guard.velocity = -13.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -26*const(size.xscale),ifelse(var(6)%10>0,4,-12)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = MAFD
;guardflag = M

;==壁貼り付け
[state 920]
type = varadd
trigger1 = (movehit=[1,5])&&numtarget && var(1)%2<1
trigger1 = target,time=0
var(1) = 1-(var(1)%16>=8&&var(1)%8>=4)*4
ignorehitpause=1
persistent=0

[state 920]
type = targetstate
trigger1 = (movehit=[1,5])&&numtarget
trigger1 = target,time=0
value = 926
ignorehitpause=1
persistent=0

;強制基底補正10%
[state -1]
type = varadd
trigger1 = movehit=1 && var(8)%2048<1024
var(8) = 1024
ignorehitpause=1

[state 3100]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=6
value = 10,ifelse(random%2=0,40,46)
channel = 1

[state 3100]
type = null;PosAdd
trigger1 = AnimElem=13
x = -floor(120*const(size.xscale))

[state 900]
type = PlaySND
trigger1 = hitpausetime=39
value = 7100,20
ignorehitpause=1

[state 3100]
type = PlaySND
trigger1 = hitpausetime=39
value = 30,5
channel = 10
ignorehitpause=1

[state 3100]
type = EnvShake
trigger1 = hitpausetime=49
ampl = 8
time = 36
ignorehitpause=1

[state 3100]
type = EnvShake
trigger1 = hitpausetime=13
ampl = 4
time = 18
ignorehitpause=1

[state 3100]
type = EnvShake
trigger1 = AnimElem=12
ampl = 2
time = 10
ignorehitpause=1

[state 3150]
type = AttackDist
trigger1 = AnimElem=11
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&hitpausetime=49
fvar(15) = .00005*floor(130*fvar(14)*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1&&hitpausetime=49
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=10
var(16) = 10+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
var(17) = floor(240*const(size.xscale));floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
var(18) = floor(-160*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1&&target,stateno=926
fvar(5) = (-30.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1&&target,stateno=926)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1&&target,stateno=926)
fvar(7) = (49-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;金剛破滅相手動作
[statedef 3156]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim
trigger1 = time<16
value = Anim
elem = AnimElemNo(0)

[state 1116]
type = ChangeState
trigger1 = time=16
value = 3156

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 1,0

[state 1116]
type = SelfState
trigger1 = time>=80
value = 5210

;金剛破滅相手動作
[statedef 3157]
type = A
movetype=H
physics=N
ctrl = 0
velset = 0,0

[state 1116]
type = ChangeAnim2
trigger1 = !time&&anim!=3156
value = 3156

[state 1116]
type = ScreenBound
trigger1 = 1
value = 0
movecamere = 1,0

[state 1116]
type = SelfState
trigger1 = time>=112
value = 5210

;金剛破滅オーラ
[statedef 6480]
ctrl = 0
anim = 90000

[state 6480]
type = BindtoRoot
trigger1 = 1
pos = 0,-floor(280*const(size.yscale))
time = 1

[state 6480]
type = Explod
trigger1 = time%48=0
id = 6480
anim=6480
pos = 0,0
scale = const(size.xscale)*2,const(size.yscale)*3
ownpal = 1
sprpriority = -3
bindtime=-1
pausemovetime=999
supermovetime=999

[state 6480]
type = Explod
trigger1 = time%48=24
id = 6480
anim=6480
pos = 0,0
scale = const(size.xscale)*2,const(size.yscale)*3
ownpal = 1
sprpriority = -3
bindtime=-1
pausemovetime=999
supermovetime=999

[state 6480]
type = RemoveExplod
trigger1 = (root,stateno!=[3110,3120])

[state 6480]
type = DestroySelf
trigger1 = (root,stateno!=[3110,3120])

;覇道天唱
[statedef 3500]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999])),-1.00,1.00),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3500

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=38

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1
pausemovetime=54+8

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1
pausemovetime=54+8

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;一撃BASARA技使用不能時間
[state 195]
type = VarSet
trigger1 = !Time
var(45) = -1

[state 200]
type = pause
trigger1 = !IsHelper&&AnimElem=1
time = 50
movetime = 50

[state 200]
type = NotHitBy
trigger1 = P2movetype=A&&inguarddist&&(prevstateno!=[5000,5099])&&!IsHelper&&AnimElem=1,=1
value = ,AP
time=50

[state 200]
type = helper
trigger1 = !IsHelper&&AnimElem=1
id = 7580
stateno = 7580
pos = 0,0
postype = P1
pausemovetime=50+999

[state 190]
type = PlayerPush
trigger1 = 1
value = 0

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=2
value = 10,41
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=8
value = 30,8
channel = 10
volume = 192

[state 3510]
type = Explod
trigger1 = AnimElem=8
anim = 6800
id = 6800
pos = floor(110*const(size.xscale)),0
postype = p1
sprpriority = 4
removetime=-1
removeongethit=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3510]
type = Explod
trigger1 = AnimElem=8
anim = 6800
id = 6800
pos = -floor(120*const(size.xscale)),0
postype = p1
sprpriority = 4
removetime=-1
removeongethit=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3510]
type = Explod
trigger1 = AnimElem=8
anim = 6810
id = 6810
pos = floor(120*const(size.xscale)),0
postype = p1
sprpriority = 4
removetime=-1
removeongethit=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3510]
type = Explod
trigger1 = AnimElem=8
anim = 6810
id = 6810
pos = -floor(120*const(size.xscale)),0
postype = p1
sprpriority = 4
removetime=-1
removeongethit=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3510]
type = Helper
trigger1 = AnimElem=8
stateno = 6880
id = 6880
pos = -floor(10*const(size.xscale)),0
postype = p1
sprpriority = -3

[state 3510]
type = RemoveExplod
trigger1 = AnimElem=13
id = 6800

[state 3510]
type = RemoveExplod
trigger1 = AnimElem=13
id = 6810

;>>>>>>>>>>><<<<<<<<<<<

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(movehit=1,0,14)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = var(52)<=0||var(52)=100
trigger1 = AnimElem=8
damage = 1
kill = 0
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.hittime = 18
pausetime = 1,14+var(49)*7
guard.pausetime = 1,14+var(49)*7
ground.velocity = 0*const(size.xscale),-6*const(size.yscale)
guard.velocity = 0
ground.cornerpush.veloff = 0
air.velocity = 0*const(size.xscale),-6*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .1*const(size.yscale)
fall.recover = 0
hitsound = -1
guardsound = s7000,2
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-80*const(size.xscale))
animtype = up
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = MA
numhits = 0

[state 3500]
type = NotHitBy
triggerall = roundstate=2
trigger1 = Movehit
value = SCA
ignorehitpause=1

;相手を固定
[state 6710]
type = targetstate
triggerall = roundstate=2
trigger1 = Movehit=1
value = 3516
ignorehitpause=1
persistent=0

;ヒット後の演出へ
[state 3500]
type = Pause
triggerall = roundstate=2
trigger1 = Movehit=1
time = 0
movetime=0

;ヒット後の演出へ
[state 3500]
type = ChangeState
triggerall = roundstate=2
trigger1 = Movehit
value = 3510

[state 200]
type = AttackDist
trigger1 = AnimElem=9
value = 0

;強制停止中に動かないように
[state -2]
type = PosFreeze
trigger1 = (AnimElem=1)
trigger2 = NumHelper(7580)
trigger2 = helper(7580),time<30
value = 1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(16) = -1

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(17) = floor(ifelse(P2dist X>180*const(size.xscale),180*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(18) = floor(-40*const(size.yscale))

[state 195]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;一撃BASARA技ヒット後
[statedef 3510]
type = S
movetype=A
physics = S
ctrl = 0
velset = 0,0
Anim=3510

[state 3500]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause=1

[state 190]
type = PlayerPush
trigger1 = 1
value = 0

;一撃BASARA技成功後
[state 195]
type = VarSet
trigger1 = !Time
var(45) = 10000
ignorehitpause=1

[state 801]
type = AssertSpecial
trigger1 = 1
flag = NoMusic
flag2 = TimerFreeze

[state 801]
type = PlaySND
trigger1 = !Time
value = 7900,0
loop = 1
channel = 30
lowpriority = 1

[state 3510]
type = Explod
trigger1 = AnimElem=1
anim = 6800
id = 6800
pos = floor(110*const(size.xscale)),0
postype = p1
sprpriority = 4
removetime=-1
removeongethit=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3510]
type = Explod
trigger1 = AnimElem=1
anim = 6800
id = 6800
pos = -floor(120*const(size.xscale)),0
postype = p1
sprpriority = 4
removetime=-1
removeongethit=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3510]
type = Explod
trigger1 = AnimElem=1
anim = 6810
id = 6810
pos = floor(120*const(size.xscale)),0
postype = p1
sprpriority = 4
removetime=-1
removeongethit=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3510]
type = Explod
trigger1 = AnimElem=1
anim = 6810
id = 6810
pos = -floor(120*const(size.xscale)),0
postype = p1
sprpriority = 4
removetime=-1
removeongethit=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3510]
type = RemoveExplod
trigger1 = AnimElem=6
id = 6800

[state 3510]
type = RemoveExplod
trigger1 = AnimElem=6
id = 6810

[state 3510]
type = Explod
trigger1 = AnimElem=6
anim = 6890
id = 6890
pos = floor(160*const(size.xscale)),-floor(360*const(size.yscale))
postype = p1
sprpriority = 4
vel = 0,-5
removeongethit=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3510]
type = Explod
trigger1 = AnimElem=6
anim = 6890
id = 6891
pos = -floor(180*const(size.xscale)),-floor(360*const(size.yscale))
postype = p1
sprpriority = 4
vel = 0,-5
removeongethit=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3510]
type = Explod
trigger1 = AnimElem=6
anim = 6890
id = 6892
pos = floor(120*const(size.xscale)),-floor(180*const(size.yscale))
postype = p1
sprpriority = 4
vel = 0,-5
removeongethit=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3510]
type = Explod
trigger1 = AnimElem=6
anim = 6890
id = 6893
pos = -floor(140*const(size.xscale)),-floor(180*const(size.yscale))
postype = p1
sprpriority = 4
vel = 0,-5
removeongethit=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3510]
type = EnvShake
trigger1 = AnimElem=6,=60
ample = 8
time = 30

[state 3510]
type = EnvShake
trigger1 = AnimElem=6,=90
ample = 6
time = 24

[state 3510]
type = EnvShake
trigger1 = AnimElem=6,=114
ample = 4
time = 16

[state 3510]
type = EnvShake
trigger1 = AnimElem=6,=130
ample = 2
time = 8

[state 3510]
type = Explod
trigger1 = AnimElem=6,=60
anim = 6870
id = 6870
pos = 0,0
postype = p1
sprpriority = -4
ownpal = 1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 3510]
type = Helper
trigger1 = AnimElem=6,=64
stateno = 6870
id = 6870
pos = 0,0
postype = p1
sprpriority = -4
ownpal = 1
pausemovetime=999

[state 3510]
type = Explod
trigger1 = AnimElem=6,=60
anim = 6850
id = 6850
pos = 0,0
postype = p1
sprpriority = 4
removeongethit=1
scale = const(size.xscale)*1.5,const(size.yscale)*1.5

[state 3510]
type = Explod
trigger1 = AnimElem=6,=60
trigger2 = AnimElem=6,=85
trigger3 = AnimElem=6,=110
trigger4 = AnimElem=6,=130
trigger5 = AnimElem=6,=145
trigger6 = AnimElem=6,=160
anim = 6860
id = 6860
pos = floor(ifelse((animelem=6,=85)||(animelem=6,=130)||(animelem=6,=160),-80,80)*const(size.xscale)),floor(240*const(size.xscale))
postype = p1
sprpriority = 5
vel = ifelse(animelem=6,<120,ifelse((animelem=6,=85),-2,2),0),-9
removeongethit=1
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
pausemovetime=999
supermovetime=999

[state 3510]
type = Explod
trigger1 = AnimElem=6,=60
trigger2 = AnimElem=6,=80
trigger3 = AnimElem=6,=100
trigger4 = AnimElem=6,=120
trigger5 = AnimElem=6,=135
trigger6 = AnimElem=6,=150
trigger7 = AnimElem=6,=170
anim = 6861
id = 6861
pos = floor(ifelse((animelem=6,=100)||(animelem=6,=135)||(animelem=6,=170),-220,220)*const(size.xscale)),floor(240*const(size.xscale))
postype = p1
sprpriority = 5
vel = ifelse(animelem=6,<120,ifelse((animelem=6,=100),-2,2),0),-9
removeongethit=1
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
pausemovetime=999
supermovetime=999

[state 3510]
type = Explod
trigger1 = AnimElem=6,=60
trigger2 = AnimElem=6,=75
trigger3 = AnimElem=6,=90
trigger4 = AnimElem=6,=105
trigger5 = AnimElem=6,=120
trigger6 = AnimElem=6,=135
trigger7 = AnimElem=6,=145
trigger8 = AnimElem=6,=160
trigger9 = AnimElem=6,=170
anim = 6862
id = 6862
pos = floor(ifelse(animelem=6,=75||animelem=6,=105||animelem=6,=135||animelem=6,=160,-140,140)*const(size.xscale)),floor(240*const(size.xscale))
postype = p1
sprpriority = 5
vel = ifelse(animelem=6,<120,ifelse((animelem=6,=75)||(animelem=6,=105),-2,2),0),-9
removeongethit=1
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
pausemovetime=999
supermovetime=999

[state 3510]
type = PlaySND
trigger1 = Anim=3510 && AnimElem=6,=60
value = 30,9
channel = 10
volume = 192

[state 3510]
type = PlaySND
trigger1 = Anim=3510 && AnimElem=6,=60
value = 30,5
channel = 11
volume = 192

[state 3510]
type = PlaySND
trigger1 = Anim=3510 && AnimElem=6,=60
value = 10,47
channel = 1

[state 200]
type = targetstate
trigger1 = Anim=3510 && AnimElem=6,=60
value = 3517

;BASARA K.O.
[state 3510]
type = Helper
trigger1 = Anim=3510 && AnimElem=6,=134 && !numhelper(8850)
id  = 8850
stateno=8850
pos = 0,0
postype = left
scale = const(size.xscale),const(size.yscale)
persistent=0
ignorehitpause=1

[state 3510]
type = AttackDist
trigger1 = 1
value = 0

[state 195]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;一撃BASARA技ヒット後（相手）
[statedef 3516]
type = S
movetype=H
physics = S
ctrl = 0
velset = 0,0

[state 3516]
type = ChangeAnim2
trigger1 = !Time
value = 3516

[state 3516]
type = PosSet
trigger1 = Pos y>0
y = 0

[state 3516]
type = PosFreeze
trigger1 = 1
value = 1

[state 3516]
type = NotHitBy
trigger1 = Time<120
value = SCA

[state 3516]
type = SelfState
trigger1 = HitShakeover && Time && Vel Y>0 && Pos Y>=0 && time>120
value = 5000

;一撃BASARA技ヒット後（相手）
[statedef 3517]
type = A
movetype=H
physics = N
ctrl = 0
velset = 0,0

[state 3516]
type = ChangeAnim2
trigger1 = !Time
value = 3517

[state 3516]
type = NotHitBy
trigger1 = 1
value = SCA

[state 3516]
type = VelSet
trigger1 = gethitvar(hitshaketime)
x = 0

[state 3516]
type = VelSet
trigger1 = Time=12
x = 0
y = -40.0

[state 3516]
type = LifeSet
trigger1 = Time=75
value = 0

[state 3516]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3516]
type = SelfState
trigger1 = Time>=162 && alive
value = 5050

[state 3516]
type = ChangeState
trigger1 = Time>=162 && !alive && (enemynear(numenemy-1),stateno=0&&enemynear(0),stateno=0)
trigger2 = Time>=162 && IsHelper
value = 5150

;一撃BASARA技ヒット後（相手）
[statedef 3518]
type = L
movetype=H
physics = N
ctrl = 0
velset = 0,0

[state 3516]
type = ChangeAnim2
trigger1 = !Time
value = 3516

[state 3516]
type = AssertSpecial
trigger1 = 1
flag = invisible

[state 3516]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3516]
type = StatetypeSet
trigger1 = (Time=[1,80])
movetype=I

[state 3516]
type = StatetypeSet
trigger1 = Time>=80
movetype=H

[state 3516]
type = ChangeState
trigger1 = Time>=80 && !alive && (enemynear(numenemy-1),stateno=0&&enemynear(0),stateno=0) && roundstate=3
value = 5150

;==火柱
[statedef 6870]
type = S
ctrl = 0
anim = 90000
sprpriority = -3

[state 6870]
type = Explod
trigger1 = time%53=0
id = 6871
anim = 6871+(var(0)!=0)*2
pos = 0,0
postype= p1
sprpriority = -3
removeongethit=1
scale = const(size.xscale)*1.75,const(size.yscale)*1.75
pausemovetime=99

[state 6870]
type = Explod
trigger1 = time%53=0
id = 6871
anim = 6871+(var(0)!=0)*2
pos = 0,floor(256*1.75*const(size.yscale))
postype= p1
sprpriority = -3
removeongethit=1
scale = const(size.xscale)*1.75,const(size.yscale)*1.75
pausemovetime=99

[state 6870]
type = Explod
trigger1 = time%53=0
id = 6872
anim = 6872+(var(0)!=0)
pos = 0,0
postype= p1
sprpriority = -3
removeongethit=1
scale = const(size.xscale)*2.0,const(size.yscale)*1.75
pausemovetime=99

[state 6870]
type = Explod
trigger1 = time%53=0
id = 6872
anim = 6872+(var(0)!=0)
pos = 0,floor(256*1.75*const(size.yscale))
postype= p1
sprpriority = -3
removeongethit=1
scale = const(size.xscale)*2.0,const(size.yscale)*1.75
pausemovetime=99

[state 6870]
type = VarAdd
trigger1 = root,stateno=3510 && root,animelemtime(6)=190
trigger2 = var(0)
var(0) = 1

[state 6870]
type = RemoveExplod
trigger1 = var(0)>=9

[state 6870]
type = DestroySelf
trigger1 = var(0)>=9

;溜めエフェクト
[statedef 6880]
type = S
physics =N
movetype = I
velset = 0,0
anim=6880
sprpriority = -1

[state 7990]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 3510]
type = Helper
trigger1 = Time=4
stateno = 6880
id = 6880
pos = 0,0
postype = p1
sprpriority = -3

[state 7990]
type = AngleDraw
trigger1 = 1
value = 0
scale = 1.0*(time*.25+1),.25*(time*.25+1)

[state 7990]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256-time*ifelse(time>=8,24,ifelse(time>=4,16,8)),256

[state 7990]
type = destroyself
trigger1 = !Time&&!(root,stateno=3500&&root,animelemtime(12)<0)&&!(root,stateno=3510&&root,animelemtime(4)<0)

[state 7990]
type = destroyself
trigger1 = !AnimTime

;一撃BASARA技発動準備
[statedef 2900]
type = S
movetype=I
physics = S
ctrl = 0
velset = 0,0
anim = 2900
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;一撃BASARA技発動可能時間
[state 195]
type = VarSet
trigger1 = AnimElem=7
var(45) = 600+ifelse(Life*100/const(data.life)<40,600,(100-Life*100/const(data.life))*10)+1

[state 195]
type = PlaySND
trigger1 = AnimElem=7
value = 7400,0

[state 195]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=7
value = 10,10
channel = 1

[state 195]
type = EnvShake
trigger1 = AnimElem=7
ampl = 4
time = 16

[state 195]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

