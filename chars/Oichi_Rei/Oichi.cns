


;---------------------------------------------------------------------

;---------------------------------------------------------------------
; 基本設定
[Data]
life = 1000          ; 体力ゲージ、上限値（デフォルト：1000）
power = 5000         ; パワーゲージ、デフォルト：1000
attack = 100         ; 攻撃力（％）
defence = 75        ; 防御力（％）
fall.defence_up = 50 ; 空中コンボ修正率（％）
liedown.time = 16    ; ダウン時間
airjuggle = 150       ; 空中コンボ
sparkno = -1          ; 初期ヒットスパーク番号
guard.sparkno = -1   ; 初期ガードスパーク番号
KO.echo = 0          ; ＫＯボイスエコー（0:OFF、1:ON）
volume = 0         ; キャラボイスボリューム値
IntPersistIndex = 32 ;次のラウンドに持ち越すVarを決める
FloatPersistIndex = 15;次のラウンドに持ち越すfVarを決める

[Size]
xscale = .5          ; 水平サイズ倍率
yscale = .5          ; 垂直サイズ倍率
ground.back = 14     ; キャラ幅（地上、後ろ側）
ground.front = 14    ; キャラ幅（地上、前側）
air.back = 14        ; キャラ幅（空中、後ろ側）
air.front = 14       ; キャラ幅（空中、前側）
z.width = 10         ; キャラ幅（ｚ軸）
height = 50          ; キャラの高さ（ジャンプで飛び越せる高さ）
attack.width = 4,4   ;Default attack width: back, front
attack.dist = 160    ;Default attack distance
proj.attack.dist = 90;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too   
head.pos = 2,-100    ; 頭部座標
mid.pos = -6,-72    ; 体中心部座標
shadowoffset = 0     ; キャラの影・オフセット値

[Velocity]
walk.fwd  = 2.4       ; 前進速度
walk.back = -2.5      ; 後退速度
run.fwd  = 2.75, 0  ; 前ダッシュ速度（y<0の場合、ホップステップ）
run.back = -3.75,-4.25  ; バックステップ速度（y=0の場合、走り）
jump.neu = 0,-7.2    ; 垂直ジャンプ速度
jump.fwd = 2.25        ; 前方ジャンプ速度
jump.back = -2.25      ; 後方ジャンプ速度
runjump.fwd = 3.5,-10.25      ;前方ハイジャンプ
runjump.back = -3.5,-10.25 ;後方ハイジャンプ
airjump.fwd = 5.0   ;前方空中ダッシュ
airjump.back = -5.0  ;後方空中ダッシュ

[Movement]
airjump.num = 0        ; 空中ジャンプ回数
;airjump.height = 35   ; 空中ジャンプ最低高度
yaccel = .27           ; キャラ重力加速度
stand.friction = .85   ; 摩擦係数（立ち状態）
crouch.friction = .82  ; 摩擦係数（しゃがみ状態）


;勝利ポーズ
[statedef 180]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,0

[state 180]
type = changestate
trigger1 = !time&&var(45)=10000
trigger2 = !time&&numpartner
trigger2 = partner,alive&&((partner,name="Oda Nobunaga"&&partner,authorname="rei"&&matchover)||(partner,name="cvsiori"&&partner,authorname="H”"&&partner,anim=182))
value = 182

[state 180]
type = ChangeAnim
trigger1 = !time
value = 180

[state 180]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1
value = 10,ifelse(var(45)=10000,110,ifelse(numhelper(8800),109,ifelse(matchover&&random<500,108,ifelse(wintime,112,ifelse(random%2=0,95,107)))))
channel = 1

[state 180]
type = PlaySND
trigger1 = AnimElem=9
value = 41,0

[state 1110]
type = Explod
trigger1 = AnimElem=2
id = 6180
anim = 6180
pos = floor(40*const(size.xscale)),floor(10*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
removetime=-1
bindtime=-1

;天は我に屈した…
[state 180]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1&&!numenemy
trigger1 = var(10) := floor(591*(TicksPerSecond/60))
value = 10,194
channel = 1
;9.848sec

;心の眼を開かぬ者に…誠の強さなど語れぬわ！
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=1 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(340*(TicksPerSecond/60))
value = 10,96
channel = 1
;5.658sec

;わが進軍こそ未来を拓く…うぬら武田には…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=2 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(406*(TicksPerSecond/60))
value = 10,97
channel = 1
;6.758sec

;さらばだ…わが友よ
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=3 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(190*(TicksPerSecond/60))
value = 10,98
channel = 1
;3.156sec

;我求めるは大儀なす力…夜郎自大の謀りなど・・・
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=6 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(509*(TicksPerSecond/60))
value = 10,99
channel = 1
;8.471sec

;駒を生かすは将の器…貴様の兵は…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=7 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(422*(TicksPerSecond/60))
value = 10,100
channel = 1
;7.023sec

;魔は滅せり！
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=8 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(158*(TicksPerSecond/60))
value = 10,101
channel = 1
;2.631sec

;神仏の加護など不要！この国は我が護る！
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=9 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(377*(TicksPerSecond/60))
value = 10,102
channel = 1
;6.269sec

;魔に魅入られし魂…哀れなり
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=4 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(275*(TicksPerSecond/60))
value = 10,103
channel = 1
;4.582sec

;この国の未来は、我が双肩にあり！
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=10 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(245*(TicksPerSecond/60))
value = 10,104
channel = 1
;4.083sec

;大儀なすには…竜は小さすぎる
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=11 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(261*(TicksPerSecond/60))
value = 10,105
channel = 1
;4.344sec

;大儀なすには…竜は小さすぎる
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1 && fvar(11)=12 && !(var(45)=10000||numhelper(8800)||matchover)
trigger1 = var(10) := floor(261*(TicksPerSecond/60))
value = 10,106
channel = 1
;4.344sec

[state 180]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,1

;==WIN
[state -2]
type = Helper
triggerall = time=270 && matchover
trigger1 = !numpartner
trigger2 = numpartner
trigger2 = (ID-partner,ID)>0 && (partner,authorname="rei"||partner,authorname="gal129")&&partner,fvar(39)=7
id = 8600
stateno=8600
pos = 0,0
postype = back
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

;==PERFECT
[state -2]
type = Helper
triggerall = time=240 && !matchover && WinPerfect
trigger1 = !numpartner
trigger2 = numpartner
trigger2 = (ID-partner,ID)>0 && (partner,authorname="rei"||partner,authorname="gal129")&&partner,fvar(39)=7
id = 8650
stateno=8650
pos = 0,0
postype = back
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

[state 180]
type = AssertSpecial
trigger1 = ifelse(matchover,time<560,ifelse(!numenemy,1,time<360||var(10)!=0))
trigger2 = numpartner&&time<500&&anim=182
trigger2 = partner,alive&&var(45)!=10000
flag = roundnotover

;勝利ポーズ2
[statedef 182]
type = S
movetype = I
physics = S
ctrl = 1
velset = 0,0

[state 181]
type = CtrlSet
trigger1 = roundstate=4
value = 0

[state 182]
type = ChangeAnim
trigger1 = !time&&Anim!=182
value = 182

;フハハハハハ…
[state 180]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1&&numpartner&&anim=182&&var(45)!=10000
trigger1 = var(10) := floor((204+180+ifelse(matchover,160,0))*(TicksPerSecond/60))
value = 10,163
channel = 1

;余の怒りに…天もひるんでおるわ！
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=8,=30
trigger1 = var(10) := floor((204+180+ifelse(matchover,160,0))*(TicksPerSecond/60))
value = 10,110
channel = 1
;3.399sec

[state 180]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,1

;==WIN
[state -2]
type = Helper
triggerall = time=270 && matchover
trigger1 = !numpartner
trigger2 = numpartner
trigger2 = (ID-partner,ID)>0 && (partner,authorname="rei"||partner,authorname="gal129")&&partner,fvar(39)=7
id = 8600
stateno=8600
pos = 0,0
postype = back
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

;==PERFECT
[state -2]
type = Helper
triggerall = time=240 && !matchover && WinPerfect
trigger1 = !numpartner
trigger2 = numpartner
trigger2 = (ID-partner,ID)>0 && (partner,authorname="rei"||partner,authorname="gal129")&&partner,fvar(39)=7
id = 8650
stateno=8650
pos = 0,0
postype = back
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

[state 180]
type = AssertSpecial
trigger1 = roundstate=4&&var(10)!=0
trigger2 = numpartner&&time<500&&var(45)!=10000
trigger2 = partner,alive
flag = roundnotover

;イントロ
[statedef 190]
type = S
ctrl = 0
velset = 0,0
anim = 190

;援軍ゲージ、一撃ゲージMAXに
[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(43) = 100000

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(42) = 200

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(41) = 200

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(40) = 1

[state 5900]
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
fvar(15) = 1.00

[state 190]
type = ChangeAnim
trigger1 = Anim=190&&((enemynear,stateno!=[190,199])||teamside=1||(Time>=600&&enemynear,name!="Oda Nobunaga"))&&time>=60
value = 191

[state 190]
type = AssertSpecial
trigger1 = 1
flag = Intro

[state 190]
type = varadd
trigger1 = animelemtime(5)>0&&!var(10)&&var(7)
var(7) = -1

[state 190]
type = varset
trigger1 = animelemtime(5)>0&&!var(10)&&!var(7)
var(7) = 30
persistent=0

;小童が…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=5 && fvar(11)=1
trigger1 = var(10) := floor(237*(TicksPerSecond/60))
value = 10,84
channel = 1
;3.937sec

;武田の飼い犬が！…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=5 && fvar(11)=2
trigger1 = var(10) := floor(316*(TicksPerSecond/60))
value = 10,85
channel = 1
;5.256sec

;ふ！道化には…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=5 && fvar(11)=3
trigger1 = var(10) := floor(189*(TicksPerSecond/60))
value = 10,86
channel = 1
;3.138sec

;餓鬼が鬼を…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=5 && fvar(11)=6
trigger1 = var(10) := floor(385*(TicksPerSecond/60))
value = 10,87
channel = 1
;6.403sec

;策など…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=5 && fvar(11)=7
trigger1 = var(10) := floor(311*(TicksPerSecond/60))
value = 10,88
channel = 1
;5.170sec

;は！山猿が…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=5 && fvar(11)=8
trigger1 = var(10) := floor(307*(TicksPerSecond/60))
value = 10,89
channel = 1
;5.114sec

;軍神よ！最上の…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=5 && fvar(11)=9
trigger1 = var(10) := floor(254*(TicksPerSecond/60))
value = 10,90
channel = 1
;4.230sec

;我に歯向かうか市よ…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=5 && fvar(11)=4
trigger1 = var(10) := floor(403*(TicksPerSecond/60))
value = 10,91
channel = 1
;6.707sec

;余に歯向かう…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=5 && fvar(11)=10
trigger1 = var(10) := floor(338*(TicksPerSecond/60))
value = 10,92
channel = 1
;5.619sec

;竜の右目…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=5 && fvar(11)=11
trigger1 = var(10) := floor(364*(TicksPerSecond/60))
value = 10,93
channel = 1
;6.066sec

;豊臣の猿回し…
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=5 && fvar(11)=12
trigger1 = var(10) := floor(402*(TicksPerSecond/60))
value = 10,94
channel = 1
;6.690sec

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&Anim=191 && AnimElem=5
trigger1 = var(10) := floor(266*(TicksPerSecond/60))
value = 10,83
channel = 1
;4.423sec
;12.869sec

[state 190]
type = ChangeAnim
trigger1 = Anim!=0&&Anim!=190&&AnimTime=0
value = 0

[state 190]
type = ChangeState
trigger1 = Anim=0 && !var(10) && !var(7)
value = 0

;挑発
[statedef 195]
type = S
movetype=I
physics = S
ctrl = 0
velset = 0,0
anim = 195
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[200,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 195]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1
value = 10,54
channel = 1

[state 195]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;立ち弱
[statedef 200]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;最大慣性速度
[state -2]
type = varset
trigger1 = !time&&(prevstateno=[100,101])
fvar(9) = ifelse(fvar(9)>const(velocity.run.fwd.x)*2,const(velocity.run.fwd.x)*2,fvar(9)*.9)
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !((movecontact||animelemtime(5)>0)&&prevstateno=200)
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !((movecontact||animelemtime(5)>0)&&prevstateno=200)
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !((movecontact||animelemtime(5)>0)&&prevstateno=200)
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 200

[state 190]
type = PlaySND
trigger1 = AnimElemNo(2)=3&&AnimElemNo(1)=2
value = 7300,0
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&random%2=0&&AnimElemNo(2)=3&&AnimElemNo(1)=2
value = 10,1+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 10

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;至れ死の淵
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;集え根の夢
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tsudoe",3000,var(53))

;染れ緋の雨
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Somare",3100,var(53))

;拒め緋の渦・陰
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Madoe_b",1350,var(53))

;拒め緋の渦・陽
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command = "Madoe_f",1300,var(53))

;開け根の国
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Kaikoku",1100,var(53))

;~~~~
;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200

;連打キャンセル
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = command="x"&&command!="holddown"
var(53) = 200
;~~~~~~~~~~~

;Attack Lv.1
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=3,>=0&&AnimElem=4,<0
damage = floor(ifelse(floor(16*fvar(0))<1,1+(var(2)%5=4),floor(16*fvar(0)))*1.22),floor(ceil(16*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 10
ground.hittime = 10
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,10+var(49)*5
ground.velocity = -8.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-8.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0010,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-9.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),20+10,10-ifelse(floor(var(14)/100)>5,5,floor(var(14)/100))+10)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,3)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(16*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(16*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(16*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(16*fvar(0)/fvar(2)*.8*1.0/8)*1.250
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-90*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NA
hitflag = MAFD
guardflag = L
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(130*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=4
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(16*fvar(14)<1,1+(var(2)%5=1),16*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=3,>=0&&AnimElem=4,<0
var(16) = 4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=3,>=0&&AnimElem=4,<0
var(17) = floor(ifelse(P2dist X>130*const(size.xscale),130*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=3,>=0&&AnimElem=4,<0
var(18) = floor(-80*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-8.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-8.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,8,10)
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (10-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;立ち中
[statedef 210]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;最大慣性速度
[state -2]
type = varset
trigger1 = !time&&(prevstateno=[100,101])
fvar(9) = ifelse(fvar(9)>const(velocity.run.fwd.x)*2,const(velocity.run.fwd.x)*2,fvar(9)*.9)
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 210

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElemNo(2)=6&&AnimElemNo(1)=5
value = 7300,2
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&random%3!=0&&AnimElemNo(2)=6&&AnimElemNo(1)=5
value = 10,3+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;至れ死の淵
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;集え根の夢
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tsudoe",3000,var(53))

;染れ緋の雨
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Somare",3100,var(53))

;拒め緋の渦・陰
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Madoe_b",1350,var(53))

;拒め緋の渦・陽
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command = "Madoe_f",1300,var(53))

;開け根の国
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Kaikoku",1100,var(53))

;~~~~
;ダッシュ
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
trigger1 = movecontact&&var(36)
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),100,var(53))

;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = movecontact&&var(36)
var(53) = ifelse(var(0)<10 && command="longjump",50+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),ifelse(command="holdup",40+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),0))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
damage = floor(ifelse(floor(30*fvar(0))<1,1+(var(2)%5=4),floor(30*fvar(0)))*1.22),floor(ceil(30*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = ifelse(var(49),0,-13.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)),ifelse(var(49),-13.5*const(size.yscale),0)
guard.velocity = ifelse(numtarget(920),-44,-13.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity=ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-12.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+12,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(45*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(45*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(45*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(45*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = ifelse(var(49),1,0)
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-160*const(size.xscale))
animtype = Medium
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0 && var(49)
damage = floor(ifelse(floor(30*fvar(0))<1,1+(var(2)%5=4),floor(30*fvar(0)))*1.22),floor(ceil(30*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = ifelse(var(49),0,-13.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)),ifelse(var(49),-13.5*const(size.yscale),0)
guard.velocity = ifelse(numtarget(920),-44,-13.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity=ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-13.5*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+12,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(30*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(30*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(30*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(30*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = ifelse(var(49),1,0)
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-160*const(size.xscale))
animtype = Medium
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(188*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(30*fvar(0)<1,1+(var(2)%5=4),30*fvar(0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 3
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(ifelse(P2dist X>188*const(size.xscale),188*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-160*const(size.yscale))-floor(ifelse(floor(P2dist X)<(28+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(148*const(size.xscale)),20,(floor(P2dist X)-(20+enemynear,const(size.ground.front)))*.5)))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse((var(3)&&target,statetype=A&&var(6)%10<1)||var(49),-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-13.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1


;立ち強
[statedef 220]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;最大慣性速度
[state -2]
type = varset
trigger1 = !time&&(prevstateno=[100,101])
fvar(9) = ifelse(fvar(9)>const(velocity.run.fwd.x)*2,const(velocity.run.fwd.x)*2,fvar(9)*.9)
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||(prevstateno=[400,410])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||(prevstateno=[400,410])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||(prevstateno=[400,410])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 220

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElemNo(2)=8&&AnimElemNo(1)=7
value = 7300,3
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElemNo(2)=8&&AnimElemNo(1)=7
value = 10,5+(random<=500)
channel = 1

[state 190]
type = PosAdd
trigger1 = AnimElem=7
x = floor(30*const(size.xscale))

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;至れ死の淵
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;集え根の夢
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tsudoe",3000,var(53))

;染れ緋の雨
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Somare",3100,var(53))

;拒め緋の渦・陰
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Madoe_b",1350,var(53))

;拒め緋の渦・陽
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command = "Madoe_f",1300,var(53))

;開け根の国
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Kaikoku",1100,var(53))

;~~~~
;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=8,>=0&&AnimElem=10,<0
damage = floor(ifelse(floor(54*fvar(0))<1,1+(var(2)%5=4),floor(54*fvar(0)))*1.22),floor(ceil(54*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -15.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(55*fvar(0)/fvar(2)*.8*1.0/8)*1.250
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(286*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=10
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(54*fvar(14)<1,1+(var(2)%5=1),54*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=8
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(17) = floor(ifelse(P2dist X>286*const(size.xscale),286*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(18) = -floor(ifelse(P2dist Y<-55*const(size.xscale),175*const(size.xscale),-floor(P2dist Y)+floor(120*const(size.yscale))))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-10.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;6中
[statedef 310]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;最大慣性速度
[state -2]
type = varset
trigger1 = !time&&(prevstateno=[100,101])
fvar(9) = ifelse(fvar(9)>const(velocity.run.fwd.x)*2,const(velocity.run.fwd.x)*2,fvar(9)*.9)
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 310

[state 900]
type = StatetypeSet
trigger1 = AnimElem=9
statetype=C
physics = C

[state 900]
type = StatetypeSet
trigger1 = AnimElem=15
statetype=S
physics = S

[state 310]
type = targetstate
trigger1 = Anim=310&&movehit=1&&numtarget
trigger1 = target,statetype=S&&target,time=0
value = 15010
ignorehitpause=1
persistent=0

[state 190]
type = PlaySND
trigger1 = AnimElemNo(2)=10&&AnimElemNo(1)=9
value = 7300,3
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&AnimElemNo(2)=10&&AnimElemNo(1)=9
value = 10,6
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;至れ死の淵
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;集え根の夢
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tsudoe",3000,var(53))

;染れ緋の雨
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Somare",3100,var(53))

;拒め緋の渦・陰
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Madoe_b",1350,var(53))

;拒め緋の渦・陽
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command = "Madoe_f",1300,var(53))

;開け根の国
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Kaikoku",1100,var(53))

;~~~~
;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = (command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",210,var(53)))+(command="holddown")*200
;~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
damage = floor(ifelse(floor(32*fvar(0))<1,1+(var(2)%5=4),floor(32*fvar(0)))*1.22),floor(ceil(32*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 17+(P2statetype=C||P2statetype!=A)
ground.hittime = 17+(P2statetype=C||P2statetype!=A)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -6.0*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-6.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,-8.0*((51-var(3))/51)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,0)
;fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(30*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(30*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(30*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(30*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-240*const(size.xscale))
animtype = hard
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = H

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(258*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=11
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(32*fvar(14)<1,1+(var(2)%5=1),32*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=10
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
var(17) = floor(ifelse(P2dist X>258*const(size.xscale),258*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=10&&AnimElem=11,<0
var(18) = floor(-40*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-6.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-6.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;強制しゃがみ食らい
[statedef 15010]
type = C
movetype=H
physics = C

[state 15010]
type = SelfState
trigger1 = !time
value = 5010

;しゃがみ弱
[statedef 400]
type = C
movetype=A
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;最大慣性速度
[state -2]
type = varset
trigger1 = !time&&(prevstateno=[100,101])
fvar(9) = ifelse(fvar(9)>const(velocity.run.fwd.x)*2,const(velocity.run.fwd.x)*2,fvar(9)*.9)
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&prevstateno=200)
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&prevstateno=200)
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&prevstateno=200)
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 400

[state 190]
type = PlaySND
trigger1 = AnimElemNo(2)=5&&AnimElemNo(1)=4
value = 7300,0
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&random%2=0&&AnimElemNo(2)=5&&AnimElemNo(1)=4
value = 10,1+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 10

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;至れ死の淵
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;集え根の夢
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tsudoe",3000,var(53))

;染れ緋の雨
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Somare",3100,var(53))

;拒め緋の渦・陰
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Madoe_b",1350,var(53))

;拒め緋の渦・陽
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command = "Madoe_f",1300,var(53))

;開け根の国
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Kaikoku",1100,var(53))

;~~~~
;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.1
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
damage = floor(ifelse(14*fvar(0)<1,1+(var(2)%5=4),14*fvar(0))*1.22),floor(ceil(14*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 10
ground.hittime = 10
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,10+var(49)*5
ground.velocity = -8.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-8.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0010,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-9.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),20+10,10-ifelse(floor(var(14)/100)>5,5,floor(var(14)/100))+10)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,0)
guardsound = s7000,0
getpower = floor(ifelse(var(9),0,floor(15*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(15*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(15*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(15*fvar(0)/fvar(2)*.8*1.0/8)*1.250
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = L
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(136*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(14*fvar(14)<1,1+(var(2)%5=1),14*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 0;
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(ifelse(P2dist X>126*const(size.xscale),126*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-10*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-8.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-8.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,8,10)
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (10-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 11
ctrl = 1


;しゃがみ中
[statedef 410]
type = C
movetype=A
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;最大慣性速度
[state -2]
type = varset
trigger1 = !time&&(prevstateno=[100,101])
fvar(9) = ifelse(fvar(9)>const(velocity.run.fwd.x)*2,const(velocity.run.fwd.x)*2,fvar(9)*.9)
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 410

[state 410]
type = PosAdd
trigger1 = AnimElem=6
trigger2 = AnimElem=11
x = floor(20*const(size.xscale))

[state 410]
type = NotHitBy
trigger1 = time=[0,10]
value = ,AT

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElemNo(2)=6&&AnimElemNo(1)=5
value = 7300,2
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&random%3!=0&&AnimElemNo(2)=6&&AnimElemNo(1)=5
value = 10,3+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 12

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;至れ死の淵
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;集え根の夢
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tsudoe",3000,var(53))

;染れ緋の雨
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Somare",3100,var(53))

;拒め緋の渦・陰
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Madoe_b",1350,var(53))

;拒め緋の渦・陽
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command = "Madoe_f",1300,var(53))

;開け根の国
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Kaikoku",1100,var(53))

;~~~~
;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = movecontact
var(53) = ifelse(var(0)<10 && command="longjump",50+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),ifelse(command="holdup",40+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),0))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=6,>=0&&AnimElem=8,<0
damage = floor(ifelse(floor(34*fvar(0))<1,1+(var(2)%5=4),floor(34*fvar(0)))*1.22),floor(ceil(34*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+var(49)*6
ground.velocity = -12.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0012,-8.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),30+12,16-ifelse(floor(var(14)/75)>7,7,floor(var(14)/75))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,4)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(35*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(35*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(35*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(35*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-120*const(size.xscale))
animtype = Medium
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = M
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(180*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=8
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(34*fvar(14)<1,1+(var(2)%5=1),34*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(17) = floor(ifelse(P2dist X>180*const(size.xscale),180*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6&&AnimElem=7,<0
var(18) = floor(-120*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-12.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 11
ctrl = 1

;しゃがみ強
[statedef 420]
type = C
movetype=A
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;最大慣性速度
[state -2]
type = varset
trigger1 = !time&&(prevstateno=[100,101])
fvar(9) = ifelse(fvar(9)>const(velocity.run.fwd.x)*2,const(velocity.run.fwd.x)*2,fvar(9)*.9)
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=400))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=400))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=400))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 420

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElemNo(2)=7&&AnimElemNo(1)=6
value = 7300,3
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElemNo(2)=7&&AnimElemNo(1)=6
value = 10,5+(random<=500)
channel = 1

;転倒食らい
[state 190]
type = Targetstate
trigger1 = numtarget && movehit=1 && var(1)%2<1 && var(1)%8<4 && var(6)%10<1
trigger1 = target,time=0
value = 15070

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;至れ死の淵
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;集え根の夢
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tsudoe",3000,var(53))

;染れ緋の雨
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Somare",3100,var(53))

;拒め緋の渦・陰
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Madoe_b",1350,var(53))

;拒め緋の渦・陽
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command = "Madoe_f",1300,var(53))

;開け根の国
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Kaikoku",1100,var(53))

;~~~~
;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = movecontact
var(53) = ifelse(var(0)<10 && command="longjump",50+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),ifelse(command="holdup",40+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),0))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=7,>=0&&AnimElem=9,<0
damage = floor(ifelse(floor(55*fvar(0))<1,1+(var(2)%5=4),floor(55*fvar(0)))*1.22),floor(ceil(55*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -4.0*const(size.xscale),(-10.0-1.0)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-1.0)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = 1.0*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(55*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-50*const(size.xscale))
animtype = hard
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = L
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(182*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = floor(224*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=9
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(55*fvar(14)<1,1+(var(2)%5=1),55*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=7
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
var(17) = floor(ifelse(P2dist X>182*const(size.xscale),182*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(17) = floor(ifelse(P2dist X>224*const(size.xscale),224*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=9,<0
var(18) = -floor(ifelse(P2dist Y<-78*const(size.xscale),118*const(size.xscale),-floor(P2dist Y)+floor(40*const(size.yscale))))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-4.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 11
ctrl = 1

;ジャンプ弱
[statedef 600]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0+fvar(8),Vel X),vel Y
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !((movecontact||animelemtime(4)>0)&&var(1)%4<2&&prevstateno=600)
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !((movecontact||animelemtime(4)>0)&&var(1)%4<2&&prevstateno=600)
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !((movecontact||animelemtime(4)>0)&&var(1)%4<2&&prevstateno=600)
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 600

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 600]
type = VelSet
trigger1 = (prevstateno=[110,115])&&time<0
y = 0

[state 600]
type = VelAdd
trigger1 = !((prevstateno=[110,115])&&time<0)&&!(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2&&var(1)%2<1,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.08,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,.95,1.0)*ifelse(fvar(10)>0&&var(1)%2>=1,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 190]
type = PlaySND
trigger1 = AnimElemNo(2)=5&&AnimElemNo(1)=4
value = 7300,0
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&random%2=0&&AnimElemNo(2)=5&&AnimElemNo(1)=4
value = 10,1+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,11)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

;~~必殺技~~~
;集え根の夢
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tsudoe",3050,var(53))

;惑え緋の羽・陰
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Madoe_b",1250,var(53))

;惑え緋の羽・陽
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Madoe_f",1200,var(53))

;~~~~~~~~~~~
;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,0))

;２段ジャンプ、２段ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
var(53) = ifelse(var(0)%ifelse(var(0)>=1000,1000,100)<10&&command="longjump",50+ifelse(command="holdfwd",1,ifelse(command="holdback",2,0)),ifelse(command="up",40,ifelse(command="fwdup",41,ifelse(command="backup",42,var(53)))))

;エリアルスパイク
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = var(1)%4>=2
trigger1 = command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&P2bodydist X<=floor(85*const(size.xscale))&&P2statetype=A&&!(P2statetype=L&&enemynear,alive)
var(53) = 720

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = (command="x"||command="y"||command="z")
var(53) = ifelse(command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&var(1)%4>=2,720,ifelse(command="z",620,ifelse(command="y",610,ifelse(command="x"&&0,600,var(53)))))

;連打キャンセル
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = command="x"&&var(1)%4<2
var(53) = 600
;~~~~~~~~~~~

;Attack Lv.2
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=3,>=0&&AnimElem=4,<0
triggerall = var(1)%4<2
damage = floor(ifelse(floor(24*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),floor(24*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)))*1.22),floor(ceil(24*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 12+(P2statetype=C)
ground.hittime = 12+(P2statetype=C)
guard.slidetime = 10
guard.hittime = 10
pausetime = 1,11+var(49)*6
ground.velocity = -10.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-10.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0011,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),24+11,12-ifelse(floor(var(14)/90)>6,6,floor(var(14)/90))+11)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,0
getpower = floor(ifelse(var(9),0,floor(24*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(24*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(24*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(24*fvar(0)/fvar(2)*.8*1.0/8)*1.250
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Light
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;Attack Lv.2
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=3,>=0&&AnimElem=4,<0
triggerall = var(1)%4>=2
damage = floor(ifelse(floor(24*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),floor(24*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)))*1.22),floor(ceil(12*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 12+(P2statetype=C)
ground.hittime = 12+(P2statetype=C)
guard.slidetime = 10
guard.hittime = 10
pausetime = 1,9
ground.velocity = -10.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-10.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -9.0*const(size.xscale)-.0009,-9.0*((4-(var(4)-ifelse(var(4)>=100,floor(var(4)/100)*100-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0),0)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0)))*1.0/4)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = 1.0*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),24+9,12-ifelse(floor(var(14)/90)>6,6,floor(var(14)/90))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,0
getpower = floor(ifelse(var(9),0,floor(24*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(24*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(24*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(24*fvar(0)/fvar(2)*.8*1.0/8)*1.250
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Light
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(114*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;エリアル中
[state -2]
type = varset
trigger1 = animelem=5,>=0&&animelem=6,<0&&!movecontact&&var(1)%2<1&&var(1)%8<4&&var(1)%4>=2&&floor(fvar(26))=91000
fvar(26) = ifelse((var(4)-ifelse(var(4)>=100,floor(var(4)/100)*100-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0),0)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))=0,floor(P2bodydist Y),90000)

[state -2]
type = targetbind
trigger1 = movecontact=1&&var(1)%2<1&&var(1)%8<4&&var(1)%4>=2&&(var(4)-ifelse(var(4)>=100,floor(var(4)/100)*100-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0),0)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))=0&&floor(fvar(26))<90000
pos = floor(P2dist X),floor(fvar(26))

[state -2]
type = VarAdd
trigger1 = var(1)%4>=2 && movecontact=1 && !var(2)
var(1) = -2
ignorehitpause=1

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && var(1)%2<1 && movecontact=1
y = -9.0*const(size.yscale)
ignorehitpause=1

[State 0, AfterImage]
type = AfterImage
trigger1 = Time = 0&&var(1)%4>=2
time=24
length = 5
palbright = 0,0,0
palcontrast = 256,256,256
palpostbright = -30,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 1
framegap = 2
trans = AddAlpha
alpha = 128,128

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(24*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),24*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 0
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(ifelse(P2dist X>118*const(size.xscale),118*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-80*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-10.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-10.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,10,12+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,11)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact)
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;ジャンプ中
[statedef 610]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0+fvar(8),Vel X),vel Y
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=600||(var(1)%4>=2&&prevstateno=620)))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=600||(var(1)%4>=2&&prevstateno=620)))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=600||(var(1)%4>=2&&prevstateno=620)))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 610

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 600]
type = VelSet
trigger1 = (prevstateno=[110,115])&&time<0
y = 0

[state 600]
type = VelAdd
trigger1 = !((prevstateno=[110,115])&&time<0)&&!(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2&&var(1)%2<1,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.08,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,.95,1.0)*ifelse(fvar(10)>0&&var(1)%2>=1,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElemNo(2)=4&&AnimElemNo(1)=3
value = 7300,2
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&random%3!=0&&AnimElemNo(2)=4&&AnimElemNo(1)=3
value = 10,3+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,12)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

;~~必殺技~~~
;集え根の夢
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tsudoe",3050,var(53))

;惑え緋の羽・陰
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Madoe_b",1250,var(53))

;惑え緋の羽・陽
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Madoe_f",1200,var(53))

;~~~~~~~~~~~
;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,0))

;２段ジャンプ、２段ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
var(53) = ifelse(var(0)%ifelse(var(0)>=1000,1000,100)<10&&command="longjump",50+ifelse(command="holdfwd",1,ifelse(command="holdback",2,0)),ifelse(command="up"&&var(0)<200,40,ifelse(command="fwdup",41,ifelse(command="backup",42,var(53)))))

;エリアルスパイク
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = var(1)%4>=2
trigger1 = command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&P2bodydist X<=floor(85*const(size.xscale))&&P2statetype=A&&!(P2statetype=L&&enemynear,alive)
var(53) = 720

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = (command="x"||command="y"||command="z")
var(53) = ifelse(command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&var(1)%4>=2,720,ifelse(command="z",620,ifelse(command="y"&&0,610,ifelse(command="x"&&var(1)%4>=2,600,var(53)))))
;~~~~~~~~~~~
;Attack Lv.3
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
triggerall = var(1)%4<2
damage = floor(ifelse(floor(28*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),floor(28*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)))*1.22),floor(ceil(28*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+var(49)*6
ground.velocity = -12.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0012,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),30+12,16-ifelse(floor(var(14)/75)>7,7,floor(var(14)/75))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(30*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(30*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(30*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(30*fvar(0)/fvar(2)*.8*1.0/8)*1.250
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Medium
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
triggerall = var(1)%4>=2
damage = floor(ifelse(floor(28*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),floor(28*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)))*1.22),floor(ceil(14*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,9
ground.velocity = -12.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -9.0*const(size.xscale)-.0009,-9.0*((4-(floor(var(4)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))/100)*1.0)/4)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = 1.0*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),30+9,16-ifelse(floor(var(14)/75)>7,7,floor(var(14)/75))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(30*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(30*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(30*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(30*fvar(0)/fvar(2)*.8*1.0/8)*1.250
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Medium
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(138*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=5
value = 0

;エリアル中
[state -2]
type = varset
trigger1 = animelem=4,>=0&&animelem=5,<0&&!movecontact&&var(1)%2<1&&var(1)%8<4&&var(1)%4>=2&&floor(fvar(26))=91000
fvar(26) = ifelse((floor(var(4)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))/100)=0,floor(P2bodydist Y),90000)

[state -2]
type = targetbind
trigger1 = movecontact=1&&var(1)%2<1&&var(1)%8<4&&var(1)%4>=2&&(floor(var(4)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))/100)=0&&floor(fvar(26))<90000
pos = floor(P2dist X),floor(fvar(26))

[state -2]
type = VarAdd
trigger1 = var(1)%4>=2 && movecontact=1 && !var(2)
var(1) = -2
ignorehitpause=1

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && var(1)%2<1 && movecontact=1
y = -9.0*const(size.yscale)
ignorehitpause=1

[State 0, AfterImage]
type = AfterImage
trigger1 = Time = 0&&var(1)%4>=2
time=24
length = 5
palbright = 0,0,0
palcontrast = 256,256,256
palpostbright = -30,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 1
framegap = 2
trans = AddAlpha
alpha = 128,128

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(44*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),44*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=4
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = animelem=4,>=0&&animelem=5,<0
var(17) = floor(ifelse(P2dist X>152*const(size.xscale),142*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = animelem=4,>=0&&animelem=5,<0
var(18) = floor(-136*const(size.yscale))+ifelse(P2bodydist Y<0,ifelse(P2bodydist Y<-20*const(size.yscale),floor(-20*const(size.yscale)),floor(P2bodydist Y)),0)


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-16.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-12.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,12,14+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,12)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact) && !IsHelper
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;ジャンプ強
[statedef 620]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0+fvar(8),Vel X),vel Y
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 620

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 600]
type = VelSet
trigger1 = (prevstateno=[110,115])&&time<0
y = 0

[state 600]
type = VelAdd
trigger1 = !((prevstateno=[110,115])&&time<0)&&!(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2&&var(1)%2<1,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.08,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,.95,1.0)*ifelse(fvar(10)>0&&var(1)%2>=1,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElemNo(2)=7&&AnimElemNo(1)=6
value = 7300,3
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&AnimElemNo(2)=7&&AnimElemNo(1)=6
value = 10,5+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,14)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

;~~必殺技~~~
;集え根の夢
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<1000 && time>4 && roundstate=2 && !var(59)
var(53) = ifelse(command="Tsudoe",3050,var(53))

;惑え緋の羽・陰
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Madoe_b",1250,var(53))

;惑え緋の羽・陽
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Madoe_f",1200,var(53))
;~~~~~~~~~~~
;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,0))

;２段ジャンプ、２段ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
var(53) = ifelse(var(0)%ifelse(var(0)>=1000,1000,100)<10&&command="longjump",50+ifelse(command="holdfwd",1,ifelse(command="holdback",2,0)),ifelse(command="up",40,ifelse(command="fwdup",41,ifelse(command="backup",42,var(53)))))

;エリアルスパイク
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = var(1)%4>=2
trigger1 = command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&P2bodydist X<=floor(85*const(size.xscale))&&P2statetype=A&&!(P2statetype=L&&enemynear,alive)
var(53) = 720

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = (command="x"||command="y"||command="z")
var(53) = ifelse(command="z"&&0,620,ifelse(command="y"&&var(1)%4>=2,610,ifelse(command="x"&&var(1)%4>=2,600,var(53))))
;~~~~~~~~~~~
;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
trigger1 = var(1)%4<2
damage = floor(ifelse(floor(47*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),floor(47*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)))*1.22),floor(ceil(47*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7
ground.velocity = ifelse(var(49),0,-15.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)),ifelse(var(49),-13.5*const(size.yscale),0)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity=ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0||var(49),0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/45)>11,11,floor(var(14)/45))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(45*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(45*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(45*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(45*fvar(0)/fvar(2)*.8*1.0/8)*1.22
fall = ifelse(var(49),1,0)
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
trigger1 = var(1)%4<2&&var(49)
damage = floor(ifelse(floor(47*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),floor(47*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)))*1.22),floor(ceil(47*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7
ground.velocity = ifelse(var(49),0,-15.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)),ifelse(var(49),-13.5*const(size.yscale),0)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity=ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,0*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-13.5*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0||var(49),0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/45)>11,11,floor(var(14)/45))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(45*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(45*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(45*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(45*fvar(0)/fvar(2)*.8*1.0/8)*1.22
fall = ifelse(var(49),1,0)
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
trigger1 = var(1)%4>=2
damage = floor(ifelse(floor(47*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),floor(47*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)))*1.22),floor(ceil(23*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,9
ground.velocity = -15.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -9.0*const(size.xscale)-.0009,-9.0*((4-floor(var(4)/10000))*1.0/4)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = 1.0*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/45)>11,11,floor(var(14)/45))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(45*fvar(1)*fvar(3)*1.0/3)*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(45*fvar(3)*1.0/3/8)*1.250*fvar(16)))
givepower = floor(45*fvar(1)*fvar(0)/fvar(2)*.8*1.0/3)*1.250,floor(45*fvar(0)/fvar(2)*.8*1.0/3/8)*1.22
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(132*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=8
value = 0

;エリアル中
[state -2]
type = varset
trigger1 = animelem=7,>=0&&animelem=8,<0&&!movecontact&&var(1)%2<1&&var(1)%8<4&&var(1)%4>=2&&floor(fvar(26))=91000
fvar(26) = ifelse(floor(var(4)/10000)=0,floor(P2bodydist Y),90000)

[state -2]
type = targetbind
trigger1 = movecontact=1&&var(1)%2<1&&var(1)%8<4&&var(1)%4>=2&&floor(var(4)/10000)=0&&floor(fvar(26))<90000
pos = floor(P2dist X),floor(fvar(26))

[state -2]
type = VarAdd
trigger1 = var(1)%4>=2 && movecontact=1 && !var(2)
var(1) = -2
ignorehitpause=1

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && var(1)%2<1 && movecontact=1
y = -9.0*const(size.yscale)
ignorehitpause=1

[State 0, AfterImage]
type = AfterImage
trigger1 = Time = 0&&var(1)%4>=2
time=24
length = 5
palbright = 0,0,0
palcontrast = 256,256,256
palpostbright = -30,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 1
framegap = 2
trans = AddAlpha
alpha = 128,128

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*ifelse(floor(64*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),floor(64*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=7
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = animelem=7,>=0&&animelem=8,<0
var(17) = floor(ifelse((P2bodydist X+const(size.air.front))>172*const(size.xscale),172*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = animelem=7,>=0&&animelem=8,<0
var(18) = floor(ifelse(P2dist Y<-110*const(size.xscale),-110*const(size.yscale),ifelse(P2dist Y>-19*const(size.yscale),-19*const(size.yscale),P2dist Y-100*const(size.yscale))))

;Y座標
[state 240]
type = VarSet
trigger1 = animelem=7,>=0&&animelem=8,<0&&(P2bodydist X+const(size.air.front))>96*const(size.xscale)
var(18) = floor(ifelse(P2dist Y<-164*const(size.xscale),-164*const(size.yscale),ifelse(P2dist Y>-54*const(size.yscale),-54*const(size.yscale),P2dist Y-128*const(size.yscale))))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A&&var(6)%10<1,-21.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,14)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact) && !IsHelper
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;■■■■■■■
;エリアルスパイク
[statedef 720]
type = A
physics = N
movetype=A
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0+fvar(8),Vel X),vel Y
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 720

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 600]
type = VelSet
trigger1 = (prevstateno=[110,115])&&time<0
y = 0

[state 600]
type = VelAdd
trigger1 = !((prevstateno=[110,115])&&time<0)&&!(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2&&var(1)%2<1,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.08,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,.95,1.0)*ifelse(fvar(10)>0&&var(1)%2>=1,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElemNo(2)=7&&AnimElemNo(1)=6
value = 7300,3
channel = 10

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&AnimElemNo(2)=7&&AnimElemNo(1)=6
value = 10,5+(random<500)
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 9

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
damage = floor(ifelse(floor(34*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),floor(34*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)))*1.22),floor(ceil(34*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,9
ground.velocity = -15.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-15.0*const(size.xscale)-.0009,-10),6
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = 1.0*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),49+9,32-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(35*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(35*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(35*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(35*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(132*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=8
value = 0

;エリアル中
[state -2]
type = varset
trigger1 = animelem=7,>=0&&animelem=8,<0&&!movecontact&&var(1)%2<1&&var(1)%8<4&&var(1)%4>=2&&floor(fvar(26))=91000
fvar(26) = ifelse(floor(var(4)/10000)=0,floor(P2bodydist Y),90000)

[state -2]
type = targetbind
trigger1 = movecontact=1&&var(1)%2<1&&var(1)%8<4&&var(1)%4>=2&&floor(var(4)/10000)=0&&floor(fvar(26))<90000
pos = floor(P2dist X),floor(fvar(26))

[state -2]
type = VarAdd
trigger1 = var(1)%4>=2 && movecontact=1 && !var(2)
var(1) = -2
ignorehitpause=1

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && var(1)%2<1 && movecontact=1
y = -9.0*const(size.yscale)
ignorehitpause=1

[State 0, AfterImage]
type = AfterImage
trigger1 = Time = 0&&var(1)%4>=2
time=24
length = 5
palbright = 0,0,0
palcontrast = 256,256,256
palpostbright = -30,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 1
framegap = 2
trans = AddAlpha
alpha = 128,128

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*ifelse(floor(60*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),floor(60*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=7
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = animelem=7,>=0&&animelem=8,<0
var(17) = floor(ifelse(P2dist X>172*const(size.xscale),172*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = animelem=7,>=0&&animelem=8,<0
var(18) = floor(ifelse(P2bodydist Y<-40,-120,-50+ifelse(P2bodydist Y>0,0,P2bodydist Y))*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,13)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact) && !IsHelper
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;■■■■■■■
;通常投げ
;(発生7F)
[statedef 800]
type = S
physics = S
movetype=A
ctrl = 0
velset = ifelse(fvar(2),fvar(2),vel x),0
anim = 800

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = (P2stateno!=[150,155])
trigger1 = AnimElem=3,>=0&&AnimElem=4,<0
attr = S,NT
hitflag = M-
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=801
p1facing = ifelse((command="holdback"&&!var(59))||(ifelse(facing=1,-(helper(30005),pos x-pos x),helper(30000),pos x-pos x)<(160+const(size.ground.back))&&var(59)),-1,1)
p2facing=1
fall = 1
numhits = 0

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = (P2stateno!=[150,155])&&enemynear,anim=5300
trigger1 = AnimElem=3,>=0&&AnimElem=4,<0
attr = S,NT
hitflag = M
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=801
p1facing = ifelse((command="holdback"&&!var(59))||(ifelse(facing=1,-(helper(30005),pos x-pos x),helper(30000),pos x-pos x)<(160+const(size.ground.back))&&var(59)),-1,1)
p2facing=1
fall = 1
numhits = 0

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;戻り動作
[state 1000]
type = AttackDist
trigger1 = AnimElem=4
value = 0

[state 1000]
type = VarSet
trigger1 = AnimElem=3
var(16) = -1

[state 1000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;■■■■■■■
;通常投げ掴み
[statedef 801]
type = S
physics = S
movetype=A
ctrl = 0
velset = 0,0
anim = 801

[state 800]
type = varset
trigger1 = !time
fvar(8) = 0

[state 800]
type = varset
trigger1 = !time
fvar(9) = 0

[state 800]
type = varset
trigger1 = !time
fvar(10) = 0

;気絶値リセット
[state 801]
type = varset
trigger1 = !time
var(29) = 0

[state 801]
type = targetstate
trugger1 = numtarget
trigger1 = time=0||(target,stateno!=806&&animelemtime(2)<0)
value = 806

[state 801]
type = Width
trigger1 = numtarget
trigger1 = animelemtime(2)<0
edge = floor(100*const(size.xscale))+target,const(size.ground.back),0

[state 801]
type = Width
trigger1 = numtarget
trigger1 = animelemtime(11)=0
edge = floor(120*const(size.xscale)),0

[state 801]
type = targetbind
trigger1 = numtarget
trigger1 = animelemtime(2)<0
pos = floor(120*const(size.xscale)),0

[state 801]
type = targetbind
trigger1 = numtarget
trigger1 = animelemtime(11)=0
pos = floor(120*const(size.xscale)),ifelse(P2dist Y<-20,-20,P2Dist Y)

[state 801]
type = targetstate
trigger1 = numtarget
trigger1 = animelemtime(2)>=0
trigger1 = movehit=1||(target,stateno!=807&&animelemtime(11)<0)
value = 807

[state 801]
type = targetstate
trigger1 = numtarget
trigger1 = animelemtime(11)>=0 && movehit=1
value = 808

[state 801]
type = varset
trigger1 = numtarget
trigger1 = target,stateno=807 && target,anim=[5110,5111]
var(2) = 0
persistent=0

[state 801]
type = varadd
trigger1 = numtarget
trigger1 = target,stateno=807 && target,anim=[5110,5111]
var(6) = 1
persistent=0

[state 801]
type = varadd
trigger1 = numtarget
trigger1 = animelemtime(11)>=0 && movehit=1
var(6) = 1
persistent=0

[state 190]
type = MoveHitReset
triggerall = movecontact!=1
trigger1 = AnimElem=11

;ダウンほこり
[State 40, 1]
type = Helper
trigger1 = numtarget && enemynear,hitfall && P2stateno=807 && enemynear,Pos Y=0 && enemynear,anim>=5110
id = 6926
stateno = 6921
pos = floor(enemynear,Pos X-Pos X)*facing,-floor(Pos Y)
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999
ignorehitpause=1
persistent=0

;効果音
[State 5100, 10]
type = PlaySnd
trigger1 = numtarget && enemynear,hitfall && P2stateno=807 && enemynear,Pos Y=0 && enemynear,anim>=5110
value = 5100, 0
ignorehitpause=1
persistent=0

[state 190]
type = EnvShake
trigger1 = numtarget && enemynear,hitfall && P2stateno=807 && enemynear,Pos Y=0 && enemynear,anim>=5110
time = 8
ampl = 4
persistent=0

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=4
value = 10,8
channel = 1

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=10
value = 7300,0
channel = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(AnimElemTime(11)>=0,13,4)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0 
damage = floor(ifelse(floor(50*fvar(0))<1,1+(var(2)%5=4),floor(50*fvar(0)))*1.22),floor(ceil(50*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,4+var(49)*6
ground.velocity = -8.0*const(size.xscale),(-11.0-.9)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-8.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-2.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,4)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(50*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(50*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(50*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(50*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-50*const(size.xscale))
animtype = Hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
kill = 0

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=11,>=0&&AnimElem=12,<0
damage = floor(ifelse(floor(50*fvar(0))<1,1+(var(2)%5=4),floor(50*fvar(0)))*1.22),floor(ceil(50*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -8.0*const(size.xscale),(-11.0-.9)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-8.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-8.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(50*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(50*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(50*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(50*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-50*const(size.xscale))
animtype = Hard
ground.type = High
attr = S,NA
hitflag = AFD
guardflag = M

[state 200]
type = AttackDist
trigger1 = AnimElem=12
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(50*fvar(14)<1,1+(var(2)%5=1),50*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=2
trigger2 = AnimElem=11
var(16) = 5-(AnimElem=11)*2

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
var(17) = floor(ifelse(P2dist X>114*const(size.xscale),114*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=11,>=0&&AnimElem=12,<0
var(17) = floor(ifelse(P2dist X>74*const(size.xscale),74*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
trigger2 = AnimElem=11,>=0&&AnimElem=12,<0
var(18) = floor(-10*const(size.yscale))
;~~~~~~~~~~~

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

[state 1000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;■■■■■■■
;通常投げ食らい
[statedef 806]
type = A
physics = N
movetype=H
ctrl = 0
velset = 0,0
sprpriority = -1

[state 806]
type = ScreenBound
trigger1 = 1
value = 1

[state 806]
type = ChangeAnim2
trigger1 = time=0
value = 806

[state 806]
type = ChangeAnim
trigger1 = Anim=806&&AnimElemTime(2)>=0
trigger2 = !HitShakeOver
value = ifelse(!SelfAnimExist(5070),5050,5070)

[state 806]
type = VelSet
trigger1 = Time=11
x = 0
y = -3.5

[state 806]
type = VelAdd
trigger1 = Time>11 && Anim!=5110
y = .5

[state 806]
type = SelfState
trigger1 = Vel Y>0&&Pos Y>=-Vel Y
value = 5110

;■■■■■■■
;通常投げ食らい（吹き飛び）
[statedef 807]
type = A
physics = N
movetype=H
ctrl = 0
velset = 0,0
sprpriority = -2

[state 806]
type = ChangeAnim
trigger1 = !HitShakeOver
value = ifelse(SelfAnimExist(5070),5070,5050)

[state 806]
type = VelSet
trigger1 = Time=11
x = 1.0
y = -3.5

[state 806]
type = VelAdd
trigger1 = Time>11 && (Anim!=[5110,5111])
y = .5

[state 806]
type = ChangeAnim
trigger1 = Vel Y>0&&Pos Y>=-Vel Y
value = ifelse(SelfAnimExist(5111),5111,5110)
persistent=0

[state 806]
type = VelSet
trigger1 = (Anim=[5110,5111])
x = 0
y = 0

[state 806]
type = PosSet
trigger1 = (Anim=[5110,5111])
y = 0

[state 806]
type = SelfState
trigger1 = Time>60
value = 5110

;■■■■■■■
;通常投げ食らい（２段目）
[statedef 808]
type = A
physics = N
movetype=H
ctrl = 0
velset = 0,0
sprpriority = -2

[state 806]
type = ChangeAnim
trigger1 = !HitShakeOver
value = ifelse(SelfAnimExist(5081),5081,ifelse(SelfAnimExist(5080),5080,5050))

[state 806]
type = VelSet
trigger1 = Time=12
x = 0
y = -1.0

[state 806]
type = VelAdd
trigger1 = Time>12 && (Anim!=[5110,5111])
y = .5

[state 806]
type = ChangeAnim
trigger1 = Vel Y>0&&Pos Y>=-Vel Y
value = ifelse(SelfAnimExist(5111),5111,5110)
persistent=0

[state 806]
type = VelSet
trigger1 = (Anim=[5110,5111])
x = 0
y = 0
persistent=0

[state 806]
type = PosSet
trigger1 = (Anim=[5110,5111])
y = 0

[state 806]
type = VelAdd
trigger1 = (Anim=[5110,5111])
x = -.001

[state 806]
type = ChangeState
trigger1 = (Anim=[5110,5111]) && ifelse(life<=0,vel x<=-.024,Vel X<=-.012)
value = 15110

[state 806]
type = SelfState
trigger1 = (Anim=[5110,5111]) && ifelse(life<=0,vel x<=-.024,Vel X<=-.012)
value = 5110

;吹き飛ばし攻撃
[statedef 900]
type = S
movetype = A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(prevstateno=200&&movecontact)
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(prevstateno=200&&movecontact)
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(prevstateno=200&&movecontact)
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 900

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&(prevstateno!=[130,154])
var(7) = 0

[state 220]
type = varadd
trigger1 = var(7)<120&&((command="hold_y"&&command="hold_z"&&!var(59))||(random<0&&var(59)))
trigger1 = (anim=905&&var(7))||(animelemtime(4)=0&&!var(7))
var(7) = 1

[state 220]
type = ChangeAnim
trigger1 = anim=900&&animelemtime(4)=0&&var(7)&&var(7)<=120
trigger1 = ((command="hold_y"&&command="hold_z"&&!var(59))||(random<0&&var(59)))
value = 905
persistent=0

[state 220]
type = ChangeAnim
trigger1 = (command!="hold_y"||command!="hold_z"||var(7)>=120)&&var(7)
value = 900
elem = 4
persistent=0

;溜めエフェクト
[state -2]
type = Helper
trigger1 = var(7)%8=1 &&anim=905
id = 7770
stateno=7770
pos = 0,0
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

[state 220]
type = PalFX
trigger1 = anim=905&&(var(7)=[60,68])
add = 255-(var(7)-60)*30,255-(var(7)-60)*30,255-(var(7)-60)*30
time = 1
;~~~~~

[state 190]
type = PlaySND
trigger1 = AnimElemNo(2)=8&&AnimElemNo(1)=7
value = 7300,3
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElemNo(2)=8&&AnimElemNo(1)=7
value = 10,9+(var(7)>=60)
channel = 1

[state 900]
type = StatetypeSet
trigger1 = AnimElem=8
physics = N

[state 900]
type = VelSet
trigger1 = !fvar(9)&&AnimElem=8
x = 5.0

[state 900]
type = VelMul
trigger1 = AnimElem=8,>0
x = .9

;現在の速度取得
[state 900]
type = VarSet
trigger1 = AnimElem=8
fvar(8) = 5.0

[state 900]
type = VarSet
trigger1 = AnimElem=8,>0
fvar(8) = fvar(8)*.9

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13+(var(7)>=60)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
damage = floor(ifelse(60*fvar(0)<1,1+(var(2)%5=4),60*fvar(0))*1.22),floor(ceil(60*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -11.5,-11*const(size.yscale)
guard.velocity = -13.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%2>=1||var(1)%16<8,-11.5*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-15*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-5.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(70*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(70*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = High
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = var(7)>=60
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
damage = floor(ifelse(68*fvar(0)<1,1+(var(2)%5=4),68*fvar(0))*1.22),floor(ceil(68*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7
ground.velocity = -10,-11*const(size.yscale)
guard.velocity = -44*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(1)%16<8,-11.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-7*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/45)>10,10,floor(var(14)/45))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(70*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(70*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(70*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = High
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
ID = 920

;==壁ダウンに
[state 920]
type = varadd
trigger1 = movehit=1 && numtarget && var(6)%10=0
trigger1 = target,time=0
var(1) = ifelse(var(7)<60&&var(1)%2<1&&var(1)%16<8,4+8,ifelse(var(1)%2<1&&var(7)>=60,1,0))-(var(1)%16>=8&&var(1)%8>=4)*4
ignorehitpause=1
persistent=0

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && var(6)%10=0 && (var(1)%2>=1||var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(var(7)<60&&var(1)%2<1,938,928)
ignorehitpause=1
persistent=0

[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && var(52)>0 && time>4 && var(7)<60 && !var(59)
var(53) = ifelse(var(0)<10 && command="longjump",50,ifelse(command="holdup",40,var(53)))+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0))
ignorehitpause=1

;ブースト
[state 900]
type = VarSet
triggerall = (movehit||(moveguarded&&var(7)>=60)) && var(52)>0 && movecontact
trigger1 = command="holdfwd"&&command!="holdup"&&command!="holddown"&&!var(59)
var(53) = 2000+ifelse(var(53)=40||var(53)=50,var(53),0)

;ブースト
[state 900]
type = ChangeState
triggerall = (movehit||(moveguarded&&var(7)>=60))&&!(var(52)>0&&movecontact) && (var(1)%2>=1||var(1)%8>=4) && P2dist X>0
trigger1 = (command="holdfwd"||(var(53)=[2000,2050]))&&!var(59)
trigger2 = var(59)
value = 2000

;ジャンプ
[state 900]
type = ChangeState
triggerall = movecontact&&!(var(52)>0&&movecontact)
trigger1 = (command="up"||command="fwdup"||command="backup"||(var(53)=[40,42])||(var(53)=[50,52]))&&!var(59)
trigger2 = var(1)%2<1&&random%5<2&&var(51)%9<2&&(movecontact=[20,24])&&var(59)
value = 40

[state 200]
type = AttackDist
trigger1 = AnimElem=9
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(ifelse(var(7)>=60,68,60)*fvar(14)<1,1+(var(2)%5=1),ifelse(var(7)>=60,68,60)*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=8
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(17) = floor(ifelse(P2dist X>244*const(size.xscale),244*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(18) = floor(-120*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = (ifelse(var(7)>=60,-15.0,-13.5)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (ifelse(var(7)>=60,-15.0,-13.5)*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&var(6))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(var(7)>=60,ifelse(moveguarded,18,20+(P2statetype=C)),ifelse(moveguarded,15,17+(P2statetype=C)))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&var(6))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(7)>=60,14,13)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 2000]
type = ChangeState
trigger1 = Anim=900&&AnimTime=0
value = 0
ctrl = 1


;エリアル攻撃
[statedef 910]
type = S
movetype = A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 910

[state 190]
type = PlaySND
trigger1 = AnimElemNo(2)=5&&AnimElemNo(1)=4
value = 7300,3
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElemNo(2)=5&&AnimElemNo(1)=4
value = 10,6
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
damage = floor(ifelse(40*fvar(0)<1,1+(var(2)%5=4),40*fvar(0))*1.22),floor(ceil(40*fvar(3)*fvar(4)*1.0/5))*numexplod(6795)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,13+var(49)*7
ground.velocity = 0,(-18-.9)*const(size.yscale)
guard.velocity = -13.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,ifelse(var(6)%10>0,-8,0)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-18.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(55*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-160*const(size.xscale))
animtype  = diagup
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0

[state 200]
type = VarAdd
trigger1 = movehit=1&&numtarget&&var(1)%4<2&&var(6)%10<1
var(1) = 2
ignorehitpause=1

;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && var(52)>0 && movehit && !var(59)
trigger1 = command="holdup"
var(53) = 40+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0))

[state 200]
type = ChangeState
triggerall = movehit&&numtarget&&!(var(52)>0&&movecontact)
trigger1 = (command="holdup"||(var(53)=[40,42]))&&!var(59)
trigger2 = var(59)
value = 40

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(40*fvar(14)<1,1+(var(2)%5=1),40*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-100*const(size.yscale))

;現在の速度取得
[state 240]
type = varset
trigger1 = !time
fvar(8) = 0

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0&&(var(6)||moveguarded)
fvar(5) = (-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-13.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&(var(6)||moveguarded))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,8,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&(var(6)||moveguarded))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 2000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;護れ根の主・陽
[statedef 1000]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
sprpriority = 1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1000

[state 250]
type = varadd
trigger1 = !time
var(34) = 240

[state 1110]
type = Explod
trigger1 = AnimElem=1
id = 6100
anim = 6100
pos = 0,0
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
removetime=-1
bindtime=-1
pausemovetime=99
sprpriority = 1

[state 1110]
type = Explod
trigger1 = !numexplod(6110) && anim=stateno&& Animelem=2
id = 6110
anim = 6110
pos = 0,floor(10*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
bindtime=-1
removetime=-1
sprpriority = 1

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6000
stateno=6000
pos = floor(50*const(size.xscale)),-floor(70*const(size.yscale))
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.0
size.yscale = const(size.yscale)*1.0
pausemovetime=35
persistent=0

[state 1400]
type = Helper
triggerall = !numHelper(6060)
trigger1 = (var(52)<=0||var(52)=100)&& AnimElem=12
trigger2 = (var(52)<=0||var(52)=100)&& AnimElem=10&&!numhelper(6000)
id = 6060
stateno=6060
pos = floor(20*const(size.xscale)),floor(20*const(size.yscale))
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.125
size.yscale = const(size.yscale)*1.125
persistent=0

[state 190]
type = Pause
trigger1 = !time&&prevstateno!=stateno+5
time = 35-enemynear,hitpausetime
movetime=35-enemynear,hitpausetime

[state 190]
type = NotHitBy
trigger1 = time=[0,38]
value = ,AA,AP

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&animelem=1
value = 10,39
channel = 1

[state 200]
type = PlaySND
trigger1 = anim=stateno&&AnimElem=1
value = 30,3
channel = 2

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6000)
trigger1 = helper(6000),movecontact=2
var(19) = 13-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6000)
trigger1 = helper(6000),movecontact=2
var(52) = 13-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6020)
trigger1 = helper(6020),movecontact=2
var(19) = 8;-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6020)
trigger1 = helper(6020),movecontact=2
var(52) = 8;-1

;LV.3
[state 250]
type = varset
trigger1 = numhelper(6060)
trigger1 = helper(6060),movecontact=2
var(19) = 12-1

;LV.3
[state 250]
type = varset
trigger1 = numhelper(6060)
trigger1 = helper(6060),movecontact=2
var(52) = 12-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;溜め入力
[state -2]
type = varset
trigger1 = !time
var(7) = 0

;溜め入力
[state -2]
type = varadd
triggerall = Anim=stateno&&animelemtime(8)=0||Anim=1010
trigger1 = (command="hold_x"||command="hold_y"||command="hold_z") && !var(59)
trigger2 = ((var(7)=0&&var(40)!=1&&var(51)<700&&var(15)<=0&&P2bodydist X<80)||var(7))&&var(59)
var(7) = 1

;溜め入力
[state -2]
type = ChangeAnim
triggerall = Anim=stateno&&animelemtime(8)=0
trigger1 = var(7)=1
value = 1010

[state -2]
type = ChangeAnim
triggerall = anim=1010
trigger1 = var(7)>=267
trigger2 = command!="hold_x"&&command!="hold_y"&&command!="hold_z"&&!var(59)
trigger3 = var(7)>=30&&random%9=0&&var(59)
value = ifelse(var(7)>=11,1020,stateno)
elem = ifelse(var(7)>=11,1,9)

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)&&Anim=1020&&AnimElem=1
id = 6020
stateno=6020
pos = floor(30*const(size.xscale)),-floor(150*const(size.yscale))
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.0
size.yscale = const(size.yscale)*1.0
persistent=0

[state 200]
type = PlaySND
trigger1 = Anim=1010&&AnimElem=1
value = 30,1
channel = 2

[state 200]
type = StatetypeSet
trigger1 = Anim=[1010,1020]
statetype= A
physics = N

[state 200]
type = StatetypeSet
trigger1 = Anim!=[1010,1020]
statetype= S
physics = N

[state -2]
type = ChangeAnim
triggerall = anim=1020
trigger1 = AnimTime=0&&var(7)>=131
value = anim
elem = 2

[state -2]
type = ChangeAnim
triggerall = anim=1020
triggerall = numhelper(6020)
triggerall = helper(6020),var(2)>=ifelse(var(7)>=251,5,ifelse(var(7)>=191,4,ifelse(var(7)>=131,3,ifelse(var(7)>=71,2,1))))
trigger1 = var(7)<41&&animelem=3
trigger2 = (var(7)=[41,70])&&animelem=4
trigger3 = (var(7)=[71,100])&&animelem=6
trigger4 = (var(7)=[101,130])&&animelem=7
trigger5 = (var(7)=[131,160])&&animelem=9
trigger6 = (var(7)=[161,190])&&animelem=2
trigger7 = (var(7)=[191,220])&&animelem=4
trigger8 = (var(7)=[221,250])&&animelem=5
trigger9 = var(7)>=251&&animelem=7
value = stateno
elem = 9

[state 600]
type = VarSet
trigger1 = Anim=1020&&AnimElem=2
fvar(8) = 1.5*const(size.xscale)

[state 600]
type = VarSet
trigger1 = Anim!=1020
fvar(8) = 0

[state -2]
type = velset
trigger1 = fvar(8)>=0 && !fvar(9) && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
x = fvar(8)

[state -2]
type = RemoveExplod
trigger1 = anim=stateno&&animelem=8
id = 6100
;~~~~~

[state 1320]
type = ChangeState
trigger1 = anim=stateno && animtime=0
value = 0
ctrl = 1

;護れ根の主・陽(飛び道具判別用)
[statedef 1005]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
sprpriority = 1

[state 1000]
type = ChangeState
trigger1 = !time
value = 1000

;護れ根の主・陰
[statedef 1050]
type = S
movetype=I
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
sprpriority = 1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1050

[state 250]
type = varadd
trigger1 = !time
var(34) = 240

[state 1110]
type = Explod
trigger1 = AnimElem=1
id = 6100
anim = 6100
pos = 0,0
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
removetime=-1
bindtime=-1
pausemovetime=99

[state 1110]
type = Explod
trigger1 = !numexplod(6110) && anim=stateno&& Animelem=2
id = 6110
anim = 6110
pos = 0,floor(10*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
bindtime=-1
removetime=-1

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6000
stateno=6000
pos = floor(40*const(size.xscale)),0
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.0
size.yscale = const(size.yscale)*1.0
pausemovetime=35
persistent=0

[state 1400]
type = Helper
triggerall = !numHelper(6060)
trigger1 = (var(52)<=0||var(52)=100)&& AnimElem=12
trigger2 = (var(52)<=0||var(52)=100)&& AnimElem=10&&!numhelper(6000)
id = 6060
stateno=6060
pos = floor(40*const(size.xscale)),0
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 190]
type = Pause
trigger1 = !time
time = 35-enemynear,hitpausetime
movetime=35-enemynear,hitpausetime

[state 190]
type = NotHitBy
trigger1 = time=[0,38]
value = ,AA,AP

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&animelem=1
value = 10,39
channel = 1

[state 200]
type = PlaySND
trigger1 = anim=stateno&&AnimElem=1
value = 30,3
channel = 2

[state 190]
type = PlaySND
trigger1 = anim=stateno&&animelem=5
trigger2 = anim=stateno&&animelem=13
value = 7300,0
channel = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6000)
trigger1 = helper(6000),movecontact=2
var(19) = 13-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6000)
trigger1 = helper(6000),movecontact=2
var(52) = 13-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6020)
trigger1 = helper(6020),movecontact=2
var(19) = 8;-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6020)
trigger1 = helper(6020),movecontact=2
var(52) = 8;-1

;LV.3
[state 250]
type = varset
trigger1 = numhelper(6060)
trigger1 = helper(6060),movecontact=2
var(19) = 12-1

;LV.3
[state 250]
type = varset
trigger1 = numhelper(6060)
trigger1 = helper(6060),movecontact=2
var(52) = 12-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;溜め入力
[state -2]
type = varset
trigger1 = !time
var(7) = 0

;溜め入力
[state -2]
type = varadd
triggerall = Anim=stateno&&animelemtime(8)=0||Anim=1010
trigger1 = (command="hold_x"||command="hold_y"||command="hold_z") && !var(59)
trigger2 = ((var(7)=0&&var(40)!=1&&var(51)<700&&var(15)<=0&&P2bodydist X<80)||var(7))&&var(59)
var(7) = 1

;溜め入力
[state -2]
type = ChangeAnim
triggerall = Anim=stateno&&animelemtime(8)=0
trigger1 = var(7)=1
value = 1010

[state -2]
type = ChangeAnim
triggerall = anim=1010
trigger1 = var(7)>=267
trigger2 = command!="hold_x"&&command!="hold_y"&&command!="hold_z"&&!var(59)
trigger3 = var(7)>=30&&random%9=0&&var(59)
value = ifelse(var(7)>=27,1020,stateno)
elem = ifelse(var(7)>=27,1,9)

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)&&Anim=1020&&AnimElem=1
id = 6020
stateno=6020
pos = floor(30*const(size.xscale)),-floor(150*const(size.yscale))
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.0
size.yscale = const(size.yscale)*1.0
persistent=0

[state 200]
type = PlaySND
trigger1 = Anim=1010&&AnimElem=1
value = 30,1
channel = 2

[state 200]
type = StatetypeSet
trigger1 = Anim=[1010,1020]
statetype= A
physics = N

[state 200]
type = StatetypeSet
trigger1 = Anim!=[1010,1020]
statetype= S
physics = N

[state -2]
type = ChangeAnim
triggerall = anim=1020
trigger1 = AnimTime=0&&var(7)>=177
value = anim
elem = 2

[state -2]
type = ChangeAnim
triggerall = anim=1020
triggerall = numhelper(6020)
triggerall = helper(6020),var(2)>=ifelse(var(7)>=251,5,ifelse(var(7)>=191,4,ifelse(var(7)>=131,3,ifelse(var(7)>=71,2,1))))
trigger1 = var(7)<41&&animelem=3
trigger2 = (var(7)=[41,70])&&animelem=4
trigger3 = (var(7)=[71,100])&&animelem=6
trigger4 = (var(7)=[101,130])&&animelem=7
trigger5 = (var(7)=[131,160])&&animelem=9
trigger6 = (var(7)=[161,190])&&animelem=2
trigger7 = (var(7)=[191,220])&&animelem=4
trigger8 = (var(7)=[221,250])&&animelem=5
trigger9 = var(7)>=251&&animelem=7
value = stateno
elem = 9

[state 600]
type = VarSet
trigger1 = Anim=1020&&AnimElem=2
fvar(8) = 1.5*const(size.xscale)

[state 600]
type = VarSet
trigger1 = Anim!=1020
fvar(8) = 0

[state -2]
type = velset
trigger1 = fvar(8)>=0 && !fvar(9) && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
x = fvar(8)

[state -2]
type = RemoveExplod
trigger1 = anim=stateno&&animelem=8
id = 6100
;~~~~~

[state 1320]
type = ChangeState
trigger1 = anim=stateno && animtime=0
value = 0
ctrl = 1


;護れ根の主・陰(飛び道具判別用)
[statedef 1055]
type = S
movetype=I
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
sprpriority = 1

[state 1000]
type = ChangeState
trigger1 = !time
value = 1050

;護れ根の主(上段判別用)
[statedef 31000]
type = S
movetype=H
physics = S
ctrl = 0
velset = 0,0
sprpriority = 1
anim = root,anim

[state 1000]
type = HitBy
trigger1 = !time
value = SCA,AA,AP
time = -1

[state 1000]
type = ChangeState
trigger1 = !time
value = 120

;護れ根の主(下段判別用)
[statedef 31050]
type = C
movetype=H
physics = C
ctrl = 0
velset = 0,0
sprpriority = 1
anim = root,anim

[state 1000]
type = HitBy
trigger1 = !time
value = SCA,AA,AP
time = -1

[state 1000]
type = ChangeState
trigger1 = !time
value = 120

;護れ根の主　１段目
[Statedef 6000]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 90000
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1400]
type = ChangeAnim
trigger1 = Time=3
value = 6000+(root,stateno=1050)*5

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
damage = floor(floor(35*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(35*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+root,var(49)*7
ground.velocity = -3.0*const(size.xscale)/1.25,(-12.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -2.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale),ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-12.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0||(root,var(49)&&!root,var(2)),0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+13,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(35*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(35*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(35*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(35*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = S,SP
hitflag = MAFD
guardflag = M
sprpriority = 4
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = 480

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
damage = floor(floor(35*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(35*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+root,var(49)*7
ground.velocity = -3.0*const(size.xscale)/1.25,(-12.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0013,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-12.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+13,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(45*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(45*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(45*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(45*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = S,SP
hitflag = MAFD
guardflag = M
sprpriority = 4
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = 480

[state 6400]
type = AttackDist
trigger1 = AnimElem=1
value = floor(310*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=9
value = 0

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(35*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(ifelse(P2dist X>310*const(size.xscale),310*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(-60*const(size.yscale))+floor(P2dist Y)

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1
persistent=0

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;○○○○○
;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15902)&&IsHelper
trigger1 = time=1
id = 15902
stateno=15902
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15907)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15387)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;よろけ
[state 1400]
type = playsnd
trigger1 = moveguarded=1&&numtarget&&var(7)>=62
trigger1 = target,time=0
value = 5910,0

;エフェクト
[State 6100, Explod]
type = Explod
trigger1 = ifelse(var(7)>=62,movecontact=1,movehit=1)&&var(7)>=32&&numtarget
trigger1 = target,time=0
anim = 7750
id = 7750
postype = P1
pos = 10,-50
vel = -1,1
ownpal = 1
pausemovetime=9999
supermovetime=9999
ignorehitpause = 1
sprpriority = 5
scale = 1,1

;エフェクト
[State 6100, Explod]
type = Explod
trigger1 = ifelse(var(7)>=62,movecontact=1,movehit=1)&&var(7)>=32&&numtarget
trigger1 = target,time=0
anim = 7750
id = 7750
postype = P1
pos = 0,-65
vel = 1,1
ownpal = 1
pausemovetime=9999
supermovetime=9999
ignorehitpause = 1
sprpriority = 5
scale = 1,1

;エフェクト
[State 6100, Explod]
type = Explod
trigger1 = ifelse(var(7)>=62,movecontact=1,movehit=1)&&var(7)>=32&&numtarget
trigger1 = target,time=0
anim = 7750
id = 7750
postype = P1
pos = -10,-50
vel = -1,-1
ownpal = 1
pausemovetime=9999
supermovetime=9999
ignorehitpause = 1
sprpriority = 5
scale = 1,1

;エフェクト
[State 6100, Explod]
type = Explod
trigger1 = ifelse(var(7)>=62,movecontact=1,movehit=1)&&var(7)>=32&&numtarget
trigger1 = target,time=0
anim = 7750
id = 7750
postype = P1
pos = 5,-35
vel = 1,1
ownpal = 1
pausemovetime=9999
supermovetime=9999
ignorehitpause = 1
sprpriority = 5
scale = 1,1

;よろけ
[state 1400]
type = targetstate
trigger1 = movehit=1&&numtarget
trigger1 = target,time=0
value = 11400

;■状態異常付加
[state -2]
type = VarSet
trigger1 = 1
var(11) = 0
ignorehitpause=1

[state -2]
type = VarAdd
trigger1 = movehit=1 && numtarget
var(11) = 1
ignorehitpause=1
persistent=0

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = RemoveExplod
triggerall = movecontact!=1
trigger1 = AnimTime=0
trigger2 = root,movetype=H

[state 11455]
type = DestroySelf
triggerall = movecontact!=1
trigger1 = AnimTime=0
trigger2 = root,movetype=H

;---------------------------------------------------------------------------
;相手側よろけ（立ち）
[Statedef 11400]
statetype=S
movetype = H
physics=S
ctrl = 0
velset = 0,0
anim = 150

[state 11400]
type = PosSet
trigger1 = !time&&prevstateno=11405
y = 0

[state 11400]
type = ChangeState
trigger1 = !time&&pos y<0
value = 11405

[state 11400]
type = HitFallSet
trigger1 = !time
value = 0

[state 15910]
type = ChangeAnim
trigger1 = hitshakeover
value = 5002
persistent=0

[state 15910]
type = ChangeAnim
trigger1 = time>0&&animtime=-1&&(anim=[5000,5029])
value = anim
elem = AnimElemNo(0)

[state 15910]
type = ChangeAnim
trigger1 = time=109+12
value = 5007

[state 15910]
type = ChangeAnim
trigger1 = time=0
trigger1 = SelfAnimExist(5910)
value = 5910

[state 15910]
type = ChangeAnim
trigger1 = time=109+12
trigger1 = SelfAnimExist(5911)
value = 5911

[state 831]
type = PlaySND
trigger1 = time=0&&(authorname="rei"||authorname="gal129")&&(fvar(39)=1||fvar(39)=4)
value = 5910,1
channel = 1

[state 831]
type = PlaySND
trigger1 = time=0&&authorname="rei"&&name="cvsbalrog"
value = 5000,2
channel = 1

[state 831]
type = PlaySND
trigger1 = time=0&&authorname="rei"&&name="cvsurien"
value = 5950,0
channel = 1

[state 15910]
type = SelfState
trigger1 = time=120+12
value = 0
ctrl = 1

[state 15910]
type = SelfState
trigger1 = !alive
value = 5000
;---------------------------------------------------------------------------
;相手側よろけ（空中）
[Statedef 11405]
type    = A
movetype = H
physics = N
ctrl = 0
velset = 0,0
anim = 150

[state 15910]
type = ChangeAnim
trigger1 = hitshakeover
value = ifelse(selfanimexist(5910),5910,5002)
persistent=0

[state 15910]
type = ChangeAnim
trigger1 = time>0&&animtime=-1&&(anim=[5000,5029])
value = anim
elem = AnimElemNo(0)

[state 11400]
type = HitFallSet
trigger1 = !time
value = 0

[state 11405]
type = VelSet
trigger1 = hitshakeover
x = -3
y = -2
persistent=0

[state 15910]
type = VelAdd
trigger1 = hitshakeover
y = gethitvar(yaccel)

[state 15910]
type = ChangeState
trigger1 = time>0 && vel Y>0 && Pos Y>=-Vel Y
value = 11400

[state 15910]
type = SelfState
trigger1 = !alive
value = 5020

;護れ根の主・追加攻撃
[Statedef 6020]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 90000
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1110]
type = ChangeAnim
trigger1 = Time=5
value = 6020

[state 250]
type = ChangeAnim
trigger1 = root,var(7)>=71&&var(2)<2&&AnimElem=13
trigger2 = root,var(7)>=131&&var(2)<3&&AnimElem=13
trigger3 = root,var(7)>=191&&var(2)<4&&AnimElem=13
trigger4 = root,var(7)>=251&&var(2)<5&&AnimElem=13
value = anim
elem = 9

[state 1400]
type = PlaySND
trigger1 = AnimElem=9
value = 30,2
channel = 2

[state 1400]
type = PlaySND
trigger1 = AnimElem=9
value = 7300,0
channel = 10

[state 1400]
type = Explod
trigger1 = AnimElem=1
id = 6025
anim = 6025
removetime=-1
bindtime=-1
removeongethit=1
ignorehitpause=1
sprpriority = 4
scale = const(size.xscale),const(size.yscale)

[state 1400]
type = RemoveExplod
trigger1 = AnimElem=13
id = 6025

[state 6500]
type = SprPriority
trigger1 = 1
value = 4

[state 6500]
type = BindtoRoot
trigger1 = 1
pos = floor(30*const(size.xscale)),-floor(150*const(size.yscale))
time = 1

[state 250]
type = VarSet
trigger1 = AnimElem=1
var(2) = 0

[state 250]
type = VarAdd
trigger1 = AnimElem=9
var(2) = 1

[state 250]
type = varset
trigger1 = !time
var(1) = 0

[state 250]
type = varadd
trigger1 = movecontact=1
var(1) = 1

[state 6500]
type = MoveHitReset
triggerall = movecontact!=1
trigger1 = AnimElem=9
trigger2 = ((root,var(7)>=41&&var(2)=1)||(root,var(7)>=101&&var(2)=2)||(root,var(7)>=161&&var(2)=3)||(root,var(7)>=221&&var(2)=4))&&AnimElem=11

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 8

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = root,var(7)>=11&&AnimElem=9,>=0&&AnimElem=11,<0
trigger2 = ((root,var(7)>=41&&var(2)=1)||(root,var(7)>=101&&var(2)=2)||(root,var(7)>=161&&var(2)=3)||(root,var(7)>=221&&var(2)=4))&&AnimElem=11,>=0&&AnimElem=13,<0
damage = floor(floor(8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(8*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,8+root,var(49)*7
ground.velocity = -4.0*const(size.xscale)/1.0
guard.velocity = -4.0*const(size.xscale)/1.0
ground.cornerpush.veloff = 0
air.velocity = -3.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale),ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-8.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.0)
airguard.velocity = -6*const(size.xscale)/1.0,-2*const(size.yscale)/1.0
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.0
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+3,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(10*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(10*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(10*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(10*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,SP
hitflag = MAFD
guardflag = N
sprpriority = 4
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = 480

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = root,var(7)>=11&&AnimElem=9,>=0&&AnimElem=11,<0
trigger2 = ((root,var(7)>=41&&var(2)=1)||(root,var(7)>=101&&var(2)=2)||(root,var(7)>=161&&var(2)=3)||(root,var(7)>=221&&var(2)=4))&&AnimElem=11,>=0&&AnimElem=13,<0
damage = floor(floor(8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(8*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,8+root,var(49)*7
ground.velocity = -4.0*const(size.xscale)/1.0
guard.velocity = -4.0*const(size.xscale)/1.0
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0008,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-8.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.0)
airguard.velocity = -6*const(size.xscale)/1.0,-2*const(size.yscale)/1.0
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.0
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+3,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(10*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(10*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(10*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(10*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,SP
guardflag = N
hitflag = MAFD
sprpriority = 4
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = 480

[state 6400]
type = AttackDist
trigger1 = AnimElem=1
value = floor(202*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=8
value = floor(202*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=13
value = 0

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(ifelse(P2dist X>202*const(size.xscale),202*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(-120*const(size.yscale))+floor(P2dist Y)

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;○○○○○
;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15902)&&IsHelper
trigger1 = time=1
id = 15902
stateno=15902
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15907)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15387)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;■状態異常付加
[state -2]
type = VarSet
trigger1 = 1
var(11) = 0
ignorehitpause=1

;１ヒット毎に
[state -2]
type = VarAdd
trigger1 = movehit=1 && numtarget
var(11) = 1
ignorehitpause=1

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = RemoveExplod
trigger1 = AnimTime=0
trigger2 = root,movetype=H

[state 11455]
type = DestroySelf
trigger1 = AnimTime=0
trigger2 = root,movetype=H

;護れ根の主　２段目
[Statedef 6060]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 6060
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1400]
type = PlaySND
trigger1 = AnimElem=3
value = 30,2
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.3
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=3
damage = floor(floor(35*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(35*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+root,var(49)*6
ground.velocity = -6.0*const(size.xscale)/1.25,(-12.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -6.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale),ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-12.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0||(root,var(49)&&!root,var(2)),0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),30+12,16-ifelse(floor(root,var(14)/75)>7,7,floor(root,var(14)/75))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(35*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(35*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(35*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(35*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = S,SP
hitflag = MAFD
guardflag = M
sprpriority = 4

;Attack Lv.3
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=3
damage = floor(floor(35*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(35*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+root,var(49)*6
ground.velocity = -6.0*const(size.xscale)/1.25,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0012,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),30+12,16-ifelse(floor(root,var(14)/75)>7,7,floor(root,var(14)/75))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(45*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(45*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(45*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(45*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = S,SP
hitflag = MAFD
guardflag = M
sprpriority = 4

[state 6400]
type = AttackDist
trigger1 = AnimElem=1
value = floor(198*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=5
value = 0

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(35*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(ifelse(P2dist X>198*const(size.xscale),198*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(-60*const(size.yscale))+floor(P2dist Y)

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1
persistent=0

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;○○○○○
;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15902)&&IsHelper
trigger1 = time=1
id = 15902
stateno=15902
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15907)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15387)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = RemoveExplod
triggerall = movecontact!=1
trigger1 = AnimTime=0
trigger2 = root,movetype=H

[state 11455]
type = DestroySelf
triggerall = movecontact!=1
trigger1 = AnimTime=0
trigger2 = root,movetype=H

;開け根の国
[statedef 1100]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1100

[state 1320]
type = NotHitBy
trigger1 = 1
value = SCA

[state 1100]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1
value = 10,41
channel = 1

[state 1110]
type = Explod
trigger1 = AnimElem=3
id = 6100
anim = 6100
pos = 0,0
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
bindtime=-1

[state 190]
type = MoveHitReset
triggerall = movecontact!=1
trigger1 = AnimElem=3
trigger2 = AnimElem=6

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 0

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed
trigger1 = AnimElem=3
trigger2 = AnimElem=6
damage = floor(floor(88*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4))*1.22),floor(ceil(88*fvar(3)*fvar(4)*1.0/4))
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,0+var(49)*7
ground.velocity = -22*const(size.xscale),-10*const(size.yscale)
guard.velocity = -18.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(1)%16<8,-11.0*(1.0+ifelse(var(2)>31,31,var(2))*.1)-.0014,-6*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/45)>10,10,floor(var(14)/45))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(80*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(80*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(80*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA

;==壁ダウンに
[state 920]
type = varadd
trigger1 = movehit=1 && numtarget && var(6)%10=0
trigger1 = target,time=0
var(1) = ifelse(var(1)%2<1&&var(1)%8<4,1,0)-(var(1)%2>=1)*1
ignorehitpause=1

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && var(6)%10=0 && (var(1)%2>=1||var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(var(7)<60&&var(1)%2<1,936,926)
ignorehitpause=1

[state 1320]
type = AttackDist
trigger1 = AnimElem=9
value = floor(60*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 1320]
type = AttackDist
trigger1 = AnimElem=9
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(88*fvar(0)<1,1+(var(2)%5=4),88*fvar(0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=3
var(16) = 10
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=3,>=0&&AnimElem=8,<0
var(17) = floor(ifelse(P2dist X>60*const(size.xscale),60*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=3,>=0&&AnimElem=8,<0
var(18) = floor(-140*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-18.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-18.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (1-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
trigger1 = var(34) := 600
value = 1110
ctrl = 0

;開け根の国・通常
[statedef 1110]
type = C
movetype=I
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 200]
type = VarSet
trigger1 = P2dist X<0
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = P2dist X<0

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))&&Anim!=1110
value = 1110

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 200]
type = PlaySND
trigger1 = Time%60=16&&prevstateno=1100
value = 30,1
;channel = 2

[state 1110]
type = Explod
trigger1 = !time && !numexplod(6110)
id = 6110
anim = 6110
pos = 0,floor(10*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
bindtime=-1
removetime=-1

;~~~歩き~~~
[state 1100]
type = VelSet
triggerall = (var(52)!=[1,99])
trigger1 = command="holdfwd"&&command!="holddown"&&!var(59)
trigger1 = fvar(8):=2.0
x = 2.0

[state 1100]
type = VelSet
triggerall = (var(52)!=[1,99])
trigger1 = command="holdback"&&command!="holddown"&&!var(59)
trigger1 = fvar(8):=-2.0
x = -2.0

;~~~~~~~~~~~~~
;□□□□
;先行入力
[state -2]
type = varset
trigger1 = !time
trigger2 = var(53)%10>=5
var(53) = 0

;先行入力
[state -2]
type = varadd
trigger1 = var(53)>0
var(53) = 1

;先行入力
[state -2]
type = varset
triggerall = !var(53)
trigger1 = command="Yokutsui" && !var(59)
var(53) = 1520

;先行入力
[state -2]
type = varset
triggerall = !var(53)
trigger1 = command="Yokuhai" && !var(59)
var(53) = 1510

;先行入力
[state -2]
type = varset
triggerall = !var(53)
trigger1 = command="Yoku" && !var(59)
var(53) = 1500

;先行入力
[state -2]
type = varset
triggerall = !var(53)
trigger1 = command="z" && command="holddown" && !var(59)
var(53) = 1460

;先行入力
[state -2]
type = varset
triggerall = !var(53)
trigger1 = command="y" && command="holdfwd" && !var(59)
var(53) = 1450

;先行入力
[state -2]
type = varset
triggerall = !var(53)
trigger1 = command="z" && !var(59)
var(53) = 1420

;先行入力
[state -2]
type = varset
triggerall = !var(53)
trigger1 = command="y" && !var(59)
var(53) = 1410

;先行入力
[state -2]
type = varset
triggerall = !var(53)
trigger1 = command="x" && !var(59)
var(53) = 1400

;先行入力
[state -2]
type = varset
triggerall = !var(53)
trigger1 = command="Kaikoku" && !var(59)
var(53) = 1190
;~~~~~

[state 1320]
type = ChangeState
trigger1 = !var(34)
trigger2 = roundstate>=3
value = 1190

;開け根の国・上移動
[statedef 1120]
type = C
movetype=I
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
var(15) = 0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)&&var(7)=3
id = 6540
stateno=6540
pos = floor(20*const(size.xscale)),0
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)
size.yscale = const(size.yscale)
persistent=0

[state 1020]
type = ModifyExplod
trigger1 = numexplod(6110)
pos = 0,-floor(pos Y)
postype = p1
id = 6110

[state 250]
type = varadd
trigger1 = !time
var(34) = -20

;~~~歩き~~~
[state 1100]
type = VelSet
triggerall = (var(52)!=[1,99])
trigger1 = command="holdfwd"&&!var(59)
trigger1 = fvar(8):=1.5
trigger2 = P2bodydist X>=80&&var(51)%7<4&&!var(2)&&var(59)
trigger2 = fvar(8):=1.5
trigger3 = P2bodydist X>=20&&var(2)>=1&&var(59)
trigger3 = fvar(8):=1.5
x = 1.5

[state 1100]
type = VelSet
triggerall = (var(52)!=[1,99])
trigger1 = command="holdback"&&!var(59)
trigger1 = fvar(8):=-1.5
trigger2 = P2bodydist X<(80+(var(51)%7>=4)*40)&&!var(2)&&var(59)
trigger2 = fvar(8):=-1.5
x = -1.5

;~~~~~~~~~~~~~

;打撃無敵
[state 1400]
type = NotHitBy
trigger1 = var(7)=[0,5]
value = ,AA,AP

[state 1400]
type = PlaySND
trigger1 = var(7) = 10
value = 7300,0

[state 1400]
type = StatetypeSet
trigger1 = var(7)=6
statetype=A
physics = N

[state 1400]
type = PosAdd
trigger1 = var(7)=6
y = -floor(90*const(size.yscale))

[state 1400]
type = PosAdd
trigger1 = var(7)=8
y = -floor(50*const(size.yscale))

[state 1400]
type = PosAdd
trigger1 = var(7)=9
trigger2 = var(7)=10
y = -floor(80*const(size.yscale))

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6540)
trigger1 = helper(6540),movecontact=2
var(19) = 4-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6540)
trigger1 = helper(6540),movecontact=2
var(52) = 4-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;先行入力
[state -2]
type = varset
trigger1 = !time
trigger2 = var(53)%10>=5
var(53) = 0

;先行入力
[state -2]
type = varadd
trigger1 = var(53)>0
var(53) = 1

;先行入力
[state -2]
type = varset
triggerall = !var(53)
trigger1 = command="z" && !var(59)
var(53) = 1570

;先行入力
[state -2]
type = varset
triggerall = !var(53)
trigger1 = command="y" && !var(59)
var(53) = 1560

;先行入力
[state -2]
type = varset
triggerall = !var(53)
trigger1 = command="x" && !var(59)
var(53) = 1550
;~~~~~

[state 1320]
type = ChangeState
trigger1 = var(7) = 18
value = 1130

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国・上移動中
[statedef 1130]
type = A
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 200]
type = VarSet
trigger1 = P2dist X<0
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = P2dist X<0

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))&&Anim!=1110
value = 1110

;~~~歩き~~~
[state 1100]
type = VelSet
triggerall = (var(52)!=[1,99])
trigger1 = command="holdfwd"&&!var(59)
trigger1 = fvar(8):=1.5
trigger2 = P2bodydist X>=80&&var(51)%7<4&&var(59)
trigger2 = fvar(8):=1.5
x = 1.5

[state 1100]
type = VelSet
triggerall = (var(52)!=[1,99])
trigger1 = command="holdback"&&!var(59)
trigger1 = fvar(8):=-1.5
trigger2 = P2bodydist X<(80+(var(51)%7>=4)*40)&&var(59)
trigger2 = fvar(8):=-1.5
x = -1.5

;~~~~~~~~~~~~~

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.3
[state 250]
type = varset
trigger1 = prevstateno=1550&&numhelper(6550)
trigger1 = helper(6550),movecontact=2
trigger2 = prevstateno=1560&&numhelper(6560)
trigger2 = helper(6560),movecontact=2
trigger3 = prevstateno=1570&&numhelper(6570)
trigger3 = helper(6570),movecontact=2
var(19) = 4-1

;LV.3
[state 250]
type = varset
trigger1 = prevstateno=1550&&numhelper(6550)
trigger1 = helper(6550),movecontact=2
trigger2 = prevstateno=1560&&numhelper(6560)
trigger2 = helper(6560),movecontact=2
trigger3 = prevstateno=1570&&numhelper(6570)
trigger3 = helper(6570),movecontact=2
var(52) = 4-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

[state 1320]
type = ChangeState
trigger1 = !var(34)
trigger2 = roundstate>=3
trigger3 = command!="holdup"&&!var(59)
trigger4 = var(59)&&ifelse((prevstateno=[1550,1570]),time>=1,time>=24)&&random%ifelse((prevstateno=[1550,1570]),13,19)=0
trigger5 = var(59)&&ifelse((prevstateno=[1550,1570]),time>=1,time>=12 && enemynear,vel Y>-2 && enemynear,hitfall)&&var(2)>=1
value = 1140

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国・上移動終了
[statedef 1140]
type = A
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6545
stateno=6545
pos = floor(20*const(size.xscale)),floor(370*const(size.yscale))
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 200]
type = VarSet
trigger1 = P2dist X<0
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = P2dist X<0

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))&&Anim!=1110
value = 1110

[state 1400]
type = VelAdd
trigger1 = var(7)=(0,28]
y = .25

[state 1400]
type = VelSet
trigger1 = var(7)=28
y = 0

[state 1400]
type = PosSet
trigger1 = var(7)=28
y = -floor(110*const(size.yscale))

[state 1400]
type = PosSet
trigger1 = var(7)=35
y = -floor(55*const(size.yscale))

[state 1400]
type = PosSet
trigger1 = var(7)=36
y = floor(0*const(size.yscale))

[state 1400]
type = StatetypeSet
trigger1 = var(7)=36
Statetype=C
physics = C

[state 1020]
type = ModifyExplod
trigger1 = numexplod(6110)
pos = 0,-floor(pos Y)
postype = p1
id = 6110

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.3
[state 250]
type = varset
trigger1 = prevstateno=1550&&numhelper(6550)
trigger1 = helper(6550),movecontact=2
trigger2 = prevstateno=1560&&numhelper(6560)
trigger2 = helper(6560),movecontact=2
trigger3 = prevstateno=1570&&numhelper(6570)
trigger3 = helper(6570),movecontact=2
var(19) = 4-1

;LV.3
[state 250]
type = varset
trigger1 = prevstateno=1550&&numhelper(6550)
trigger1 = helper(6550),movecontact=2
trigger2 = prevstateno=1560&&numhelper(6560)
trigger2 = helper(6560),movecontact=2
trigger3 = prevstateno=1570&&numhelper(6570)
trigger3 = helper(6570),movecontact=2
var(52) = 4-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

[state 1320]
type = ChangeState
trigger1 = var(7) = 40
value = 1110

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国・前移動
[statedef 1150]
type = S
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
var(15) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1150

[state 250]
type = varadd
trigger1 = !time
var(34) = -30

[state 1400]
type = PlaySND
trigger1 = AnimElem=2
value = 30,2
channel = 1

;現在の速度取得
[state 900]
type = VarSet
trigger1 = AnimElem=2
fvar(8) = 15.0

[state 900]
type = VarSet
trigger1 = fvar(8)>=.5
fvar(8) = fvar(8)*.9

[state 900]
type = VarSet
trigger1 = fvar(8)<.5
fvar(8) = 0

[state -2]
type = velset
trigger1 = fvar(8)>0 && !fvar(9) && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
x = fvar(8)

[State 0, AfterImage]
type = AfterImage
trigger1 = AnimElem=1
time=24
length = 5
palbright = 0,0,0
palcontrast = 256,256,256
palpostbright = -30,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 1
framegap = 2
trans = AddAlpha
alpha = 128,128

[state 1320]
type = NotHitBy
trigger1 = AnimElemTime(3)<0
value = SCA

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 1110

;開け根の国・後移動
[statedef 1160]
type = S
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
var(15) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1160

[state 250]
type = varadd
trigger1 = !time
var(34) = -30

[state 1400]
type = PlaySND
trigger1 = AnimElem=2
value = 30,2
channel = 1

;現在の速度取得
[state 900]
type = VarSet
trigger1 = AnimElem=2
fvar(8) = -15.0

[state 900]
type = VarSet
trigger1 = fvar(8)<=-.5
fvar(8) = fvar(8)*.9

[state 900]
type = VarSet
trigger1 = fvar(8)>-.5
fvar(8) = 0

[state -2]
type = velset
trigger1 = fvar(8)<0 && !fvar(9) && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
x = fvar(8)

[State 0, AfterImage]
type = AfterImage
trigger1 = AnimElem=1
time=24
length = 5
palbright = 0,0,0
palcontrast = 256,256,256
palpostbright = -30,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 1
framegap = 2
trans = AddAlpha
alpha = 128,128

[state 1320]
type = NotHitBy
trigger1 = AnimElemTime(2)<0
value = SCA

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 1110

;開け根の国・解除
[statedef 1190]
type = S
movetype=I
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1190

[state 1110]
type = RemoveExplod
trigger1 = !time
id = 6110

[state 250]
type = varadd
trigger1 = !time&&roundstate<3
var(34) = -180

[state 1100]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1
value = 10,43
channel = 1

[state 1320]
type = NotHitBy
trigger1 = 1
value = SCA

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;開け根の国・虚
[statedef 1400]
type = C
movetype=I
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
sprpriority = 1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
var(15) = 0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6400
stateno=6400
pos = floor(20*const(size.xscale)),0
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 190]
type = PlaySND
trigger1 = var(7)=6
value = 7300,0
channel = 10

[state 250]
type = varadd
trigger1 = !time
var(34) = -60

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6400)
trigger1 = helper(6400),movecontact=2
var(19) = 13-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6400)
trigger1 = helper(6400),movecontact=2
var(52) = 13-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;先行入力
[state -2]
type = varset
trigger1 = !time
trigger2 = var(53)%10>=5
var(53) = 0

;先行入力
[state -2]
type = varadd
trigger1 = var(53)>0
var(53) = 1

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokutsui" && !var(59)
var(53) = 1520

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokuhai" && !var(59)
var(53) = 1510

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yoku" && !var(59)
var(53) = 1500

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && command="holddown" && !var(59)
var(53) = 1460

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && command="holdfwd" && !var(59)
var(53) = 1450

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && !var(59)
var(53) = 1420

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && !var(59)
var(53) = 1410

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="x" && !var(59)
var(53) = 1400

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Kaikoku" && !var(59)
var(53) = 1190
;~~~~~

[state 1320]
type = ChangeState
trigger1 = var(7) = 30
value = 1110

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国・膿
[statedef 1410]
type = C
movetype=I
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
var(15) = 0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6410
stateno=6410
pos = floor(20*const(size.xscale)),0
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)&&var(7)=19
id = 6415
stateno=6415
pos = floor(120*const(size.xscale)),-floor(140*const(size.yscale))
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 190]
type = PlaySND
trigger1 = var(7)=19
value = 7300,2
channel = 10

[state 250]
type = varadd
trigger1 = !time
var(34) = -50

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;先行入力
[state -2]
type = varset
trigger1 = !time
trigger2 = var(53)%10>=5
var(53) = 0

;先行入力
[state -2]
type = varadd
trigger1 = var(53)>0
var(53) = 1

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokutsui" && !var(59)
var(53) = 1520

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokuhai" && !var(59)
var(53) = 1510

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yoku" && !var(59)
var(53) = 1500

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && command="holddown" && !var(59)
var(53) = 1460

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && command="holdfwd" && !var(59)
var(53) = 1450

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && !var(59)
var(53) = 1420

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && !var(59)
var(53) = 1410

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="x" && !var(59)
var(53) = 1400
;~~~~~

[state 1320]
type = ChangeState
trigger1 = var(7) = 35
value = 1110

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国・触
[statedef 1420]
type = C
movetype=I
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
var(15) = 0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6420
stateno=6420
pos = floor(0*const(size.xscale)),0
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 190]
type = PlaySND
trigger1 = var(7)=16
value = 7300,3
channel = 10

[state 250]
type = varadd
trigger1 = !time
var(34) = -35

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6420)
trigger1 = helper(6420),movecontact=2
var(19) = 13-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6420)
trigger1 = helper(6420),movecontact=2
var(52) = 13-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;先行入力
[state -2]
type = varset
trigger1 = !time
trigger2 = var(53)%10>=5
var(53) = 0

;先行入力
[state -2]
type = varadd
trigger1 = var(53)>0
var(53) = 1

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokutsui" && !var(59)
var(53) = 1520

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokuhai" && !var(59)
var(53) = 1510

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yoku" && !var(59)
var(53) = 1500

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && command="holddown" && !var(59)
var(53) = 1460

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && command="holdfwd" && !var(59)
var(53) = 1450

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && !var(59)
var(53) = 1420

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && !var(59)
var(53) = 1410

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="x" && !var(59)
var(53) = 1400
;~~~~~

[state 1320]
type = ChangeState
trigger1 = var(7) = 39
value = 1110

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国・撲
[statedef 1450]
type = C
movetype=I
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6450
stateno=6450
pos = floor(10*const(size.xscale)),0
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 190]
type = PlaySND
trigger1 = var(7)=20
value = 7300,3
channel = 10

[state 250]
type = varadd
trigger1 = !time
var(34) = -35

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6450)
trigger1 = helper(6450),movecontact=2
var(19) = 13-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6450)
trigger1 = helper(6450),movecontact=2
var(52) = 13-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;先行入力
[state -2]
type = varset
trigger1 = !time
trigger2 = var(53)%10>=5
var(53) = 0

;先行入力
[state -2]
type = varadd
trigger1 = var(53)>0
var(53) = 1

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokutsui" && !var(59)
var(53) = 1520

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokuhai" && !var(59)
var(53) = 1510

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yoku" && !var(59)
var(53) = 1500

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && command="holddown" && !var(59)
var(53) = 1460

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && command="holdfwd" && !var(59)
var(53) = 1450

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && !var(59)
var(53) = 1420

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && !var(59)
var(53) = 1410

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="x" && !var(59)
var(53) = 1400
;~~~~~

[state 1320]
type = ChangeState
trigger1 = var(7) = 45
value = 1110

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国・嘆
[statedef 1460]
type = C
movetype=I
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6460
stateno=6460
pos = floor(10*const(size.xscale)),0
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 190]
type = PlaySND
trigger1 = var(7)=28
value = 7300,3
channel = 10

[state 250]
type = varadd
trigger1 = !time
var(34) = -80

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6460)
trigger1 = helper(6460),movecontact=2&&helper(6460),animelemtime(9)<0
var(19) = 25-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6460)
trigger1 = helper(6460),movecontact=2&&helper(6460),animelemtime(9)<0
var(52) = 25-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6460)
trigger1 = helper(6460),movecontact=2&&helper(6460),animelemtime(9)>=0
var(19) = 0

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6460)
trigger1 = helper(6460),movecontact=2&&helper(6460),animelemtime(9)>=0
var(52) = 0

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;先行入力
[state -2]
type = varset
trigger1 = !time
trigger2 = var(53)%10>=5
var(53) = 0

;先行入力
[state -2]
type = varadd
trigger1 = var(53)>0
var(53) = 1

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokutsui" && !var(59)
var(53) = 1520

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokuhai" && !var(59)
var(53) = 1510

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yoku" && !var(59)
var(53) = 1500

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && command="holddown" && !var(59)
var(53) = 1460

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && command="holdfwd" && !var(59)
var(53) = 1450

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && !var(59)
var(53) = 1420

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && !var(59)
var(53) = 1410

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="x" && !var(59)
var(53) = 1400
;~~~~~

[state 1320]
type = ChangeState
trigger1 = var(7) = 59
value = 1110

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国・沃
[statedef 1500]
type = C
movetype=I
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6500
stateno=6500
pos = floor(100*const(size.xscale)),-floor(180*const(size.yscale))
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 190]
type = PlaySND
trigger1 = var(7)=15
value = 7300,2
channel = 10

[state 250]
type = varadd
trigger1 = !time
var(34) = -55

[state 250]
type = null;varset
trigger1 = !time&&(var(52)=[1,9])
var(52) = -ifelse(var(52)<4,var(52),4)

[state 250]
type = varset
trigger1 = !time&&(var(52)=[3,99])
var(52) = 3

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6500)
trigger1 = helper(6500),movecontact=2
var(19) = 3-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6500)
trigger1 = helper(6500),movecontact=2
var(52) = 3-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;先行入力
[state -2]
type = varset
trigger1 = !time
trigger2 = var(53)%10>=5
var(53) = 0

;先行入力
[state -2]
type = varadd
trigger1 = var(53)>0
var(53) = 1

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokutsui" && !var(59)
var(53) = 1520

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokuhai" && !var(59)
var(53) = 1510

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yoku" && !var(59)
var(53) = 1500

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && command="holddown" && !var(59)
var(53) = 1460

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && command="holdfwd" && !var(59)
var(53) = 1450

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && !var(59)
var(53) = 1420

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && !var(59)
var(53) = 1410

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="x" && !var(59)
var(53) = 1400

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Kaikoku" && !var(59)
var(53) = 1190
;~~~~~

[state 1320]
type = ChangeState
trigger1 = var(7) = 50
value = 1110

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国・沃背
[statedef 1510]
type = C
movetype=I
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6510
stateno=6510
pos = floor(80*const(size.xscale)),-floor(90*const(size.yscale))
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 190]
type = PlaySND
trigger1 = var(7)=19
value = 7300,2
channel = 10

[state 250]
type = varadd
trigger1 = !time
var(34) = -55

[state 250]
type = null;varset
trigger1 = !time&&(var(52)=[1,9])
var(52) = -ifelse(var(52)<4,var(52),4)

[state 250]
type = varset
trigger1 = !time&&(var(52)=[3,99])
var(52) = 3

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6510)
trigger1 = helper(6510),movecontact=2
var(19) = 10-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6510)
trigger1 = helper(6510),movecontact=2
var(52) = 10-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;先行入力
[state -2]
type = varset
trigger1 = !time
trigger2 = var(53)%10>=5
var(53) = 0

;先行入力
[state -2]
type = varadd
trigger1 = var(53)>0
var(53) = 1

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokutsui" && !var(59)
var(53) = 1520

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokuhai" && !var(59)
var(53) = 1510

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yoku" && !var(59)
var(53) = 1500

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && command="holddown" && !var(59)
var(53) = 1460

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && command="holdfwd" && !var(59)
var(53) = 1450

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && !var(59)
var(53) = 1420

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && !var(59)
var(53) = 1410

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="x" && !var(59)
var(53) = 1400

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Kaikoku" && !var(59)
var(53) = 1190
;~~~~~

[state 1320]
type = ChangeState
trigger1 = var(7) = 48
value = 1110

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国・沃追
[statedef 1520]
type = C
movetype=I
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6520
stateno=6520
pos = floor(80*const(size.xscale)),-floor(90*const(size.yscale))
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 190]
type = PlaySND
trigger1 = var(7)=31
value = 7300,2
channel = 10

[state 250]
type = varadd
trigger1 = !time
var(34) = -55

[state 250]
type = null;varset
trigger1 = !time&&(var(52)=[1,9])
var(52) = -ifelse(var(52)<4,var(52),4)

[state 250]
type = varset
trigger1 = !time&&(var(52)=[3,99])
var(52) = 3

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.3
[state 250]
type = varset
trigger1 = numhelper(6520)
trigger1 = helper(6520),movecontact=2
var(19) = 3-1

;LV.3
[state 250]
type = varset
trigger1 = numhelper(6520)
trigger1 = helper(6520),movecontact=2
var(52) = 3-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;先行入力
[state -2]
type = varset
trigger1 = !time
trigger2 = var(53)%10>=5
var(53) = 0

;先行入力
[state -2]
type = varadd
trigger1 = var(53)>0
var(53) = 1

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokutsui" && !var(59)
var(53) = 1520

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yokuhai" && !var(59)
var(53) = 1510

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Yoku" && !var(59)
var(53) = 1500

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && command="holddown" && !var(59)
var(53) = 1460

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && command="holdfwd" && !var(59)
var(53) = 1450

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && !var(59)
var(53) = 1420

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && !var(59)
var(53) = 1410

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="x" && !var(59)
var(53) = 1400

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="Kaikoku" && !var(59)
var(53) = 1190
;~~~~~

[state 1320]
type = ChangeState
trigger1 = var(7) = 85
value = 1110

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国・沃(上移動中)A版
[statedef 1550]
type = A
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
var(15) = 0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6550
stateno=6550
pos = floor(120*const(size.xscale)),-floor(160*const(size.yscale))
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 190]
type = PlaySND
trigger1 = var(7)=14
value = 7300,2
channel = 10

[state 250]
type = varadd
trigger1 = !time
var(34) = -45

[state 250]
type = varset
trigger1 = !time&&(var(52)=[10,99])
var(52) = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.3
[state 250]
type = varset
trigger1 = numhelper(6550)
trigger1 = helper(6550),movecontact=2
var(19) = 4-1

;LV.3
[state 250]
type = varset
trigger1 = numhelper(6550)
trigger1 = helper(6550),movecontact=2
var(52) = 4-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;先行入力
[state -2]
type = varset
trigger1 = !time
trigger2 = var(53)%10>=5
var(53) = 0

;先行入力
[state -2]
type = varadd
trigger1 = var(53)>0
var(53) = 1

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && !var(59)
var(53) = 1570

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && !var(59)
var(53) = 1560

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="x" && !var(59)
var(53) = 1550
;~~~~~

[state 1320]
type = ChangeState
trigger1 = var(7) = 36
value = 1130

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国・沃(上移動中)B版
[statedef 1560]
type = A
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
var(15) = 0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6560
stateno=6550
pos = floor(120*const(size.xscale)),floor(0*const(size.yscale))
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 190]
type = PlaySND
trigger1 = var(7)=14
value = 7300,2
channel = 10

[state 250]
type = varadd
trigger1 = !time
var(34) = -45

[state 250]
type = varset
trigger1 = !time&&(var(52)=[10,99])
var(52) = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.3
[state 250]
type = varset
trigger1 = numhelper(6560)
trigger1 = helper(6560),movecontact=2
var(19) = 4-1

;LV.3
[state 250]
type = varset
trigger1 = numhelper(6560)
trigger1 = helper(6560),movecontact=2
var(52) = 4-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;先行入力
[state -2]
type = varset
trigger1 = !time
trigger2 = var(53)%10>=5
var(53) = 0

;先行入力
[state -2]
type = varadd
trigger1 = var(53)>0
var(53) = 1

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && !var(59)
var(53) = 1570

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && !var(59)
var(53) = 1560

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="x" && !var(59)
var(53) = 1550
;~~~~~

[state 1320]
type = ChangeState
trigger1 = var(7) = 36
value = 1130

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国・沃(上移動中)C版
[statedef 1570]
type = A
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
var(15) = 0

[state 1400]
type = varset
trigger1 = !time
var(7) = 0

[state 1400]
type = Helper
trigger1 = (var(52)<=0||var(52)=100)
id = 6570
stateno=6550
pos = floor(120*const(size.xscale)),floor(160*const(size.yscale))
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0

[state 190]
type = PlaySND
trigger1 = var(7)=14
value = 7300,2
channel = 10

[state 250]
type = varadd
trigger1 = !time
var(34) = -45

[state 250]
type = varset
trigger1 = !time&&(var(52)=[10,99])
var(52) = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.3
[state 250]
type = varset
trigger1 = numhelper(6570)
trigger1 = helper(6570),movecontact=2
var(19) = 4-1

;LV.3
[state 250]
type = varset
trigger1 = numhelper(6570)
trigger1 = helper(6570),movecontact=2
var(52) = 4-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;□□□□
;先行入力
[state -2]
type = varset
trigger1 = !time
trigger2 = var(53)%10>=5
var(53) = 0

;先行入力
[state -2]
type = varadd
trigger1 = var(53)>0
var(53) = 1

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="z" && !var(59)
var(53) = 1570

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="y" && !var(59)
var(53) = 1560

;先行入力
[state -2]
type = varset
triggerall = !var(53)&&time>0
trigger1 = command="x" && !var(59)
var(53) = 1550
;~~~~~

[state 1320]
type = ChangeState
trigger1 = var(7) = 36
value = 1130

[state 1400]
type = varadd
trigger1 = (var(52)!=[1,99])
var(7) = 1

;開け根の国（虚）
[Statedef 6400]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 6400
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1110]
type = Explod
trigger1 = !time && !numexplod(6405)
id = 6405
anim = 6405
pos = 0,0
postype = P1
removeongethit=1
ownpal = 1
bindtime=-1
removetime=-1
scale = const(size.xscale),const(size.yscale)

[state 1110]
type = RemoveExplod
trigger1 = AnimElem=3
trigger2 = AnimElem=3,>0&&AnimElem=4,<0&&movecontact
trigger3 = AnimElem=4
trigger4 = AnimElem=4,>0&&AnimElem=5,<0&&movecontact
trigger5 = AnimElem=5
trigger6 = AnimElem=5,>0&&AnimElem=6,<0&&movecontact
trigger7 = AnimElem=6
id = 6405

[state 1110]
type = Explod
trigger1 = AnimElem=3
trigger2 = AnimElem=3,>0&&AnimElem=4,<0&&movecontact
id = 6405
anim = 6406
pos = 0,0
postype = P1
removeongethit=1
ownpal = 1
bindtime=-1
removetime=-1
scale = const(size.xscale),const(size.yscale)

[state 1110]
type = Explod
trigger1 = AnimElem=4
trigger2 = AnimElem=4,>0&&AnimElem=5,<0&&movecontact
id = 6405
anim = 6407
pos = 0,0
postype = P1
removeongethit=1
ownpal = 1
bindtime=-1
removetime=-1
scale = const(size.xscale),const(size.yscale)

[state 1110]
type = Explod
trigger1 = AnimElem=5
trigger2 = AnimElem=5,>0&&AnimElem=6,<0&&movecontact
id = 6405
anim = 6408
pos = 0,0
postype = P1
removeongethit=1
ownpal = 1
bindtime=-1
removetime=-1
scale = const(size.xscale),const(size.yscale)

[state 1110]
type = Explod
trigger1 = AnimElem=6
id = 6405
anim = 6409
pos = 0,0
postype = P1
removeongethit=1
ownpal = 1
bindtime=-1
removetime=-1
scale = const(size.xscale),const(size.yscale)

[state 1400]
type = PlaySND
trigger1 = AnimElem=3
value = 30,2
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=3
damage = floor(floor(45*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(45*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+root,var(49)*7
ground.velocity = -3.0*const(size.xscale)/1.25,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -3.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)/1.25,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0||(root,var(49)&&!root,var(2)),0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),120+13,30-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(45*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(45*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(45*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(45*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = M
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=3
damage = floor(floor(45*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(45*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+root,var(49)*7
ground.velocity = -3.0*const(size.xscale)/1.25,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0013,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0||(root,var(49)&&!root,var(2)),0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),120+13,30-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(45*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(45*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(45*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(45*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = M
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

[state 6400]
type = AttackDist
trigger1 = AnimElem=1
value = floor(106*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=3
value = floor(124*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=4
value = floor(82*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(45*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElemtime(4)<0
var(17) = floor(ifelse(P2dist X>106*const(size.xscale),106*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElemtime(4)>=0 && AnimElemtime(5)<0
var(17) = floor(ifelse(P2dist X>124*const(size.xscale),124*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElemtime(5)>=0
var(17) = floor(ifelse(P2dist X>82*const(size.xscale),82*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElemtime(4)<0
var(18) = floor(ifelse(P2dist Y>20,0,ifelse(P2dist Y<-130*const(size.yscale),-130*const(size.yscale),-60*const(size.yscale)+floor(P2dist Y))))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElemtime(4)>=0 && AnimElemtime(5)<0
var(18) = floor(ifelse(P2dist Y>20,0,ifelse(P2dist Y<-200*const(size.yscale),-200*const(size.yscale),-60*const(size.yscale)+floor(P2dist Y))))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElemtime(5)>=0
var(18) = floor(ifelse(P2dist Y>20,0,ifelse(P2dist Y<-320*const(size.yscale),-320*const(size.yscale),-60*const(size.yscale)+floor(P2dist Y))))

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !(root,stateno=3120&&((root,AnimElemTime(7)>=0&&root,AnimElemTime(9)<0)||root,AnimElemTime(12)>=0&&root,AnimElemTime(14)<0||root,AnimElemTime(17)>=0&&root,AnimElemTime(19)<0)||root,AnimElemTime(22)>=0&&root,AnimElemTime(24)<0)
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1
persistent=0

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;○○○○○
;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15902)&&IsHelper
trigger1 = time=1
id = 15902
stateno=15902
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15907)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15387)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;■魔の手■
;魔の手モード中与えたダメージ
[state -2]
type = parentvaradd
trigger1 = numenemy=2
trigger1 = movehit=1&&enemynear(numenemy-1),gethitvar(damage)
var(36) = enemynear(numenemy-1),gethitvar(damage)
ignorehitpause=1

[state -2]
type = parentvaradd
trigger1 = movehit=1&&enemynear,gethitvar(damage)
var(37) = enemynear,gethitvar(damage)
ignorehitpause=1

;ヒット時ゲージ７割回復
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1
var(34) = 42
ignorehitpause=1

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;■状態異常付加
[state -2]
type = VarSet
trigger1 = 1
var(11) = 0
ignorehitpause=1

[state -2]
type = VarAdd
trigger1 = movehit=1 && numtarget
var(11) = 1
ignorehitpause=1
persistent=0

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = RemoveExplod
triggerall = movecontact!=1
trigger1 = AnimTime=0
trigger2 = ((root,stateno=[1120,1160])||(root,stateno=[1400,1590]))&&root,time=1&&(root,prevstateno=[1400,1590])&&time>1
trigger3 = root,movetype=H
id = 6405

[state 11455]
type = DestroySelf
triggerall = movecontact!=1
trigger1 = AnimTime=0
trigger2 = ((root,stateno=[1120,1160])||(root,stateno=[1400,1590]))&&root,time=1&&(root,prevstateno=[1400,1590])&&time>1
trigger3 = root,movetype=H

;開け根の国（膿）
[Statedef 6410]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 6410
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6050]
type = null;BindtoRoot
trigger1 = 1
pos = 0,0

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1400]
type = PlaySND
trigger1 = AnimElem=6
value = 30,2
channel = 1

[state 11455]
type = DestroySelf
trigger1 = AnimTime=0
trigger2 = ((root,stateno=[1120,1160])||(root,stateno=[1400,1590]))&&root,time=1&&(root,prevstateno=[1400,1590])&&time>5
trigger3 = root,movetype=H

;膿・飛び道具
[statedef 6415]
movetype=A
ctrl = 0
sprpriority = 2
velset = 0,0

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=ifelse(var(0),6490,stateno)
time = 1

[state 11455]
type = ChangeAnim
trigger1 = !time&&Anim!=6415
value = 6415

[state 11455]
type = ChangeAnim
trigger1 = movecontact=1
value = 6416

[state 6000]
type = velset
trigger1 = Anim=6416
x = 0

[state 11455]
type = DestroySelf
trigger1 = Anim=6416&&AnimTime=0

[state 6000]
type = velset
trigger1 = time=1||prevstateno=6415
x = 5

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = !(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = time>=1&&!movecontact&&!movereversed
damage = floor(floor(30*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),floor(ceil(30*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.hittime = 12+(P2statetype=C)
pausetime = 1,11+root,var(49)*6
ground.velocity = -10.5*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.04)*const(size.xscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity =  -4.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)/1.25,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-9.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),39+11,22-ifelse(floor(root,var(14)/60)>10,10,floor(root,var(14)/60))+11)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(40*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(40*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(40*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(40*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = Medium
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)
persistent=0

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = root,var(1)%8>=4||root,var(1)%2>=1
trigger1 = time>=1&&!movecontact&&!movereversed
damage = floor(floor(30*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),floor(ceil(30*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.hittime = 12+(P2statetype=C)
pausetime = 1,11+root,var(49)*6
ground.velocity = -10.5*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.04)*const(size.xscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity =  -7.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0011,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-9.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),39+11,22-ifelse(floor(root,var(14)/60)>10,10,floor(root,var(14)/60))+11)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(40*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(40*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(40*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(40*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = Medium
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)
persistent=0

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,time=0
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget&&root,var(3)
trigger1 = target,time=0
var(3) = 1
ignorehitpause=1

;ヒット判別
[state -2]
type = parentvarset
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,12,-12)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(30*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1
persistent=0

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1
persistent=0

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(ifelse(P2dist X>16*const(size.xscale),16*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(ifelse(P2dist Y>50*const(size.yscale),-50*const(size.yscale),ifelse(P2dist Y<-50*const(size.yscale),-150*const(size.yscale),-100*const(size.yscale)+floor(P2dist Y))))

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !(root,stateno=3120&&((root,AnimElemTime(7)>=0&&root,AnimElemTime(9)<0)||root,AnimElemTime(12)>=0&&root,AnimElemTime(14)<0||root,AnimElemTime(17)>=0&&root,AnimElemTime(19)<0)||root,AnimElemTime(22)>=0&&root,AnimElemTime(24)<0)
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1

;○○○○○
;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15902)&&IsHelper
trigger1 = time=1
id = 15902
stateno=15902
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15907)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15387)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;■魔の手■
;魔の手モード中与えたダメージ
[state -2]
type = parentvaradd
trigger1 = numenemy=2
trigger1 = movehit=1&&enemynear(numenemy-1),gethitvar(damage)
var(36) = enemynear(numenemy-1),gethitvar(damage)
ignorehitpause=1

[state -2]
type = parentvaradd
trigger1 = movehit=1&&enemynear,gethitvar(damage)
var(37) = enemynear,gethitvar(damage)
ignorehitpause=1

;ヒット時ゲージ７割回復
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1
var(34) = 35
ignorehitpause=1

;■状態異常付加
[state -2]
type = VarSet
trigger1 = 1
var(11) = 0
ignorehitpause=1

[state -2]
type = VarAdd
trigger1 = movehit=1 && numtarget
var(11) = 1
ignorehitpause=1
persistent=0

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = StatetypeSet
trigger1 = (Vel Y>0&&Pos Y>=-Vel Y)||FrontEdgedist<=-40||(ScreenPos Y<0&&Pos Y<=-250)
movetype=I

[state 11455]
type = RemoveExplod
trigger1 = (Vel Y>0&&Pos Y>=-Vel Y)||FrontEdgedist<=-40||(ScreenPos Y<0&&Pos Y<=-250)

[state 6900]
type = DestroySelf
trigger1 = (Vel Y>0&&Pos Y>=-Vel Y)||FrontEdgedist<=-40||(ScreenPos Y<0&&Pos Y<=-250)

;開け根の国（触）
[Statedef 6420]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 6420
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1400]
type = PlaySND
trigger1 = AnimElem=8
value = 30,2
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=8
damage = floor(floor(57*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(57*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+root,var(49)*7
ground.velocity = -2.0*const(size.xscale)/1.25,(-10.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -2.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)/1.25,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-10.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+13,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(55*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(55*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(55*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(55*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = L
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=8
damage = floor(floor(57*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(57*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+root,var(49)*7
ground.velocity = -2.0*const(size.xscale)/1.25,(-10.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0013,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-10.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+13,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(55*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(55*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(55*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(55*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = L
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

[state 6400]
type = AttackDist
trigger1 = AnimElem=1
value = floor(266*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=9
value = 0

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(57*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(ifelse(P2dist X>266*const(size.xscale),266*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(ifelse(P2dist Y>20,0,ifelse(P2dist Y<-110*const(size.yscale),-150*const(size.yscale),-40*const(size.yscale)+floor(P2dist Y))))

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !(root,stateno=3120&&((root,AnimElemTime(7)>=0&&root,AnimElemTime(9)<0)||root,AnimElemTime(12)>=0&&root,AnimElemTime(14)<0||root,AnimElemTime(17)>=0&&root,AnimElemTime(19)<0)||root,AnimElemTime(22)>=0&&root,AnimElemTime(24)<0)
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1
persistent=0

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;○○○○○
;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15902)&&IsHelper
trigger1 = time=1
id = 15902
stateno=15902
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15907)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15387)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;■魔の手■
;魔の手モード中与えたダメージ
[state -2]
type = parentvaradd
trigger1 = numenemy=2
trigger1 = movehit=1&&enemynear(numenemy-1),gethitvar(damage)
var(36) = enemynear(numenemy-1),gethitvar(damage)
ignorehitpause=1

[state -2]
type = parentvaradd
trigger1 = movehit=1&&enemynear,gethitvar(damage)
var(37) = enemynear,gethitvar(damage)
ignorehitpause=1

;ヒット時ゲージ７割回復
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1
var(34) = 25
ignorehitpause=1

;■状態異常付加
[state -2]
type = VarSet
trigger1 = 1
var(11) = 0
ignorehitpause=1

[state -2]
type = VarAdd
trigger1 = movehit=1 && numtarget
var(11) = 1
ignorehitpause=1
persistent=0

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = DestroySelf
trigger1 = AnimTime=0
trigger2 = ((root,stateno=[1120,1160])||(root,stateno=[1400,1590]))&&root,time=1&&(root,prevstateno=[1400,1590])&&time>5
trigger3 = root,movetype=H

;開け根の国（撲）
[Statedef 6450]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 6450
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1400]
type = PlaySND
trigger1 = AnimElem=7
value = 30,2
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&!(var(1)%2>=1||var(1)%8>=4)
trigger1 = AnimElem=7
damage = floor(floor(60*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(60*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+root,var(49)*7
ground.velocity = -10.0-.0013,(-10.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -10.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.040)/1.25-.0013,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-10.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+13,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(55*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(55*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(55*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(55*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = H
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

;壁剥がし
;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&(var(1)%2>=1||var(1)%8>=4)
trigger1 = AnimElem=7
damage = floor(floor(60*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(60*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+root,var(49)*7
ground.velocity = -7.0*const(size.xscale)/1.25,(-10.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)/1.25,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-10.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+13,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(55*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(55*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(55*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(55*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = H
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

[state 6400]
type = AttackDist
trigger1 = AnimElem=1
value = floor(184*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=10
value = 0

;壁バウンド
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(1) = ifelse(root,var(1)%8<4&&root,var(1)%16<8,4+8,0)-(root,var(1)%2>=1)*1-(root,var(1)%8>=4)*4
ignorehitpause=1

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(57*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(ifelse(P2dist X>ifelse(AnimElem=8,<0,172,ifelse(AnimElem=9,<0,198,208))*const(size.xscale),ifelse(AnimElem=8,<0,172,ifelse(AnimElem=9,<0,198,208))*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(ifelse(P2dist Y>20,0,ifelse(P2dist Y<-80*const(size.yscale),-160*const(size.yscale),-80*const(size.yscale)+floor(P2dist Y))))

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !(root,stateno=3120&&((root,AnimElemTime(7)>=0&&root,AnimElemTime(9)<0)||root,AnimElemTime(12)>=0&&root,AnimElemTime(14)<0||root,AnimElemTime(17)>=0&&root,AnimElemTime(19)<0)||root,AnimElemTime(22)>=0&&root,AnimElemTime(24)<0)
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1
persistent=0

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;○○○○○
;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15902)&&IsHelper
trigger1 = time=1
id = 15902
stateno=15902
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15907)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15387)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;■魔の手■
;魔の手モード中与えたダメージ
[state -2]
type = parentvaradd
trigger1 = numenemy=2
trigger1 = movehit=1&&enemynear(numenemy-1),gethitvar(damage)
var(36) = enemynear(numenemy-1),gethitvar(damage)
ignorehitpause=1

[state -2]
type = parentvaradd
trigger1 = movehit=1&&enemynear,gethitvar(damage)
var(37) = enemynear,gethitvar(damage)
ignorehitpause=1

;ヒット時ゲージ７割回復
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1
var(34) = 25
ignorehitpause=1

;■状態異常付加
[state -2]
type = VarSet
trigger1 = 1
var(11) = 0
ignorehitpause=1

[state -2]
type = VarAdd
trigger1 = movehit=1 && numtarget
var(11) = 1
ignorehitpause=1
persistent=0

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = DestroySelf
trigger1 = AnimTime=0
trigger2 = ((root,stateno=[1120,1160])||(root,stateno=[1400,1590]))&&root,time=1&&(root,prevstateno=[1400,1590])&&time>5
trigger3 = root,movetype=H

;開け根の国（嘆）
[Statedef 6460]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 6460
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1400]
type = PlaySND
trigger1 = AnimElem=8
value = 30,2
channel = 1

[state 1400]
type = PlaySND
trigger1 = AnimElem=9
value = 5100,1

[state 6500]
type = MoveHitReset
triggerall = movecontact!=1
trigger1 = AnimElem=8
trigger2 = AnimElem=9

[State 40, 1]
type = Helper
trigger1 = AnimElem=9
id = 6925
stateno = 6920
pos = floor(190*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = movecontact=1&&AnimElemTime(9)<0
var(52) = 25

;LV.4
[state 250]
type = varset
trigger1 = movecontact=1&&AnimElemTime(9)>=0
var(52) = 0

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=8
damage = floor(floor(57*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(57*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,25+root,var(49)*7
ground.velocity = -2.0*const(size.xscale)/1.25,(-20.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -2.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)/1.25,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-20.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+13,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(55*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(55*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(55*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(55*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = H
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=8
damage = floor(floor(57*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(57*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,25+root,var(49)*7
ground.velocity = -10.5*const(size.xscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0013,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-10.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+13,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(55*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(55*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(55*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(55*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = H
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=9
damage = floor(floor(57*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(57*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,0+root,var(49)*7
ground.velocity = -2.0*const(size.xscale)/1.25,(-20.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -2.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale),ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-20.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+13,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(55*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(55*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(55*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(55*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = L
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=9
damage = floor(floor(57*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(57*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,0+root,var(49)*7
ground.velocity = -2.0*const(size.xscale)/1.25,(-20.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0013,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-10.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+13,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(55*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(55*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(55*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(55*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = L
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

[state 6400]
type = AttackDist
trigger1 = AnimElem=1
value = floor(244*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=8
value = floor(304*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=9
value = floor(640*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=11
value = 0

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget&&root,var(3)
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(57*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(17) = floor(ifelse(P2dist X>244*const(size.xscale),244*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
var(17) = floor(ifelse(P2dist X>304*const(size.xscale),304*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0
var(17) = floor(P2dist X)-floor(20*const(size.xscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(18) = floor(ifelse(P2dist Y>20,0,ifelse(P2dist Y<-110*const(size.yscale),-170*const(size.yscale),-60*const(size.yscale)+floor(P2dist Y))))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
var(18) = floor(ifelse(P2dist Y>20,0,ifelse(P2dist Y<-50*const(size.yscale),-90*const(size.yscale),-40*const(size.yscale)+floor(P2dist Y))))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0
var(18) = -floor(20*const(size.yscale))

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !(root,stateno=3120&&((root,AnimElemTime(7)>=0&&root,AnimElemTime(9)<0)||root,AnimElemTime(12)>=0&&root,AnimElemTime(14)<0||root,AnimElemTime(17)>=0&&root,AnimElemTime(19)<0)||root,AnimElemTime(22)>=0&&root,AnimElemTime(24)<0)
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;○○○○○
;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15902)&&IsHelper
trigger1 = time=1
id = 15902
stateno=15902
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15907)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15387)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;■魔の手■
;魔の手モード中与えたダメージ
[state -2]
type = parentvaradd
trigger1 = numenemy=2
trigger1 = movehit=1&&enemynear(numenemy-1),gethitvar(damage)
var(36) = enemynear(numenemy-1),gethitvar(damage)
ignorehitpause=1

[state -2]
type = parentvaradd
trigger1 = movehit=1&&enemynear,gethitvar(damage)
var(37) = enemynear,gethitvar(damage)
ignorehitpause=1

;ヒット時ゲージ７割回復
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1
var(34) = 28
ignorehitpause=1

;■状態異常付加
[state -2]
type = VarSet
trigger1 = 1
var(11) = 0
ignorehitpause=1

[state -2]
type = VarAdd
trigger1 = movehit=1 && numtarget
var(11) = 1
ignorehitpause=1
persistent=0

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = DestroySelf
trigger1 = AnimTime=0
trigger2 = ((root,stateno=[1120,1160])||(root,stateno=[1400,1590]))&&root,time=1&&(root,prevstateno=[1400,1590])&&time>5
trigger3 = root,movetype=H

;開け根の国（沃）
[Statedef 6500]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 90000
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1110]
type = ChangeAnim
trigger1 = Time=6
value = 6500

[state 1110]
type = Explod
trigger1 = AnimElem=1
id = 6040
anim = 6040
pos = -floor(10*const(size.xscale)),-floor(10*const(size.yscale))
postype = P1
ignorehitpause=1
scale = const(size.xscale)*.8,const(size.yscale)*.8
ownpal = 1
bindtime=-1
sprpriority = 4

[state 1100]
type = ModifyExplod
trigger1 = Time<6||AnimTime>-6
id = 6040
scale = const(size.xscale)*(1.0-ifelse(time<6,6-time,6+animtime)*.15)*.8,const(size.yscale)*(1.0-ifelse(time<6,6-time,6+animtime)*.15)*.8

[state 1100]
type = ModifyExplod
trigger1 = !(Time<6||AnimTime>-6)
id = 6040
scale = const(size.xscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05)*.8,const(size.yscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05)*.8

[state 250]
type = SprPriority
trigger1 = 1
value = 4

[state 1400]
type = PlaySND
trigger1 = AnimElem=4
value = 30,2
channel = 1
persistent=0

[state 250]
type = varset
trigger1 = !time
var(1) = 0

[state 250]
type = varadd
trigger1 = movecontact=1
var(1) = 1

[state 6500]
type = MoveHitReset
triggerall = movecontact!=1
trigger1 = AnimElem=4
trigger2 = AnimElem=8
trigger3 = AnimElem=12

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 3

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=4
trigger2 = AnimElem=8
trigger3 = AnimElem=12
damage = floor(floor(43*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(43*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,3+root,var(49)*7
ground.velocity = -5.0*const(size.xscale)/1.25,(-8.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -5.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)/1.25,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-8.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.xvelocity = 1.5*ifelse(enemynear,facing!=facing,-1,1)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+3,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+3)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(45*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(45*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(45*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(45*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = M
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)
sprpriority = 4

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=4
trigger2 = AnimElem=8
trigger3 = AnimElem=12
damage = floor(floor(43*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(43*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,3+root,var(49)*7
ground.velocity = -5.0*const(size.xscale)/1.25,(-8.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0003,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-8.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.xvelocity = 1.5*ifelse(enemynear,facing!=facing,-1,1)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+3,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+3)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(45*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(45*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(45*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(45*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = M
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)
sprpriority = 4

[state 6400]
type = AttackDist
trigger1 = AnimElem=1
value = floor(128*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=3
value = floor(144*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=4
value = floor(174*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=5
value = floor(220*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=8
value = floor(242*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=13
value = 0

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(43*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(ifelse(P2dist X>242*const(size.xscale),242*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(ifelse(P2dist Y>160*const(size.yscale),40*const(size.yscale),ifelse(P2dist Y<80*const(size.yscale),-40*const(size.yscale),-120*const(size.yscale)+floor(P2dist Y))))

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !(root,stateno=3120&&((root,AnimElemTime(7)>=0&&root,AnimElemTime(9)<0)||root,AnimElemTime(12)>=0&&root,AnimElemTime(14)<0||root,AnimElemTime(17)>=0&&root,AnimElemTime(19)<0)||root,AnimElemTime(22)>=0&&root,AnimElemTime(24)<0)
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;○○○○○
;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15902)&&IsHelper
trigger1 = time=1
id = 15902
stateno=15902
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15907)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15387)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;■魔の手■
;魔の手モード中与えたダメージ
[state -2]
type = parentvaradd
trigger1 = numenemy=2
trigger1 = movehit=1&&enemynear(numenemy-1),gethitvar(damage)
var(36) = enemynear(numenemy-1),gethitvar(damage)
ignorehitpause=1

[state -2]
type = parentvaradd
trigger1 = movehit=1&&enemynear,gethitvar(damage)
var(37) = enemynear,gethitvar(damage)
ignorehitpause=1

;ヒット時ゲージ７割回復
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1
var(34) = 12
ignorehitpause=1

;■状態異常付加
[state -2]
type = VarSet
trigger1 = 1
var(11) = 0
ignorehitpause=1

[state -2]
type = VarAdd
trigger1 = movehit=1 && numtarget
var(11) = 1
ignorehitpause=1
persistent=0

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = RemoveExplod
trigger1 = AnimTime=0
trigger2 = root,movetype=H

[state 11455]
type = DestroySelf
trigger1 = AnimTime=0
trigger2 = root,movetype=H

;開け根の国（沃背）
[Statedef 6510]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 90000
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1400]
type = ChangeAnim
trigger1 = Time=10
value = 6510

[state 1400]
type = PosSet
trigger1 = time=2
x = floor(enemynear,pos x)+floor(80*const(size.xscale))*facing
y = -floor(80*const(size.yscale))

[state 1400]
type = Turn
trigger1 = Time=2

;ワープ先
[state 1110]
type = Explod
trigger1 = Time=2
id = 6042
anim = 6040
pos = -floor(0*const(size.xscale)),-floor(10*const(size.yscale))
postype = P1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
bindtime=-1
sprpriority = 2

[state 1100]
type = ModifyExplod
trigger1 = Time<6||(Anim=6510&&AnimElem=12,>0)
id = 6042
scale = const(size.xscale)*(1.0-ifelse(time<6,6-time,6-AnimElemTime(AnimElemNo(0))-(AnimElem=16)*2-(AnimElem=17)*2)*.15),const(size.yscale)*(1.0-ifelse(time<6,6-time,6-AnimElemTime(AnimElemNo(0))-(AnimElem=16)*2-(AnimElem=17)*2)*.15)

[state 1100]
type = ModifyExplod
trigger1 = !(time<21||(Anim=6520&&AnimElem=12,>0))
id = 6042
scale = const(size.xscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05),const(size.yscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05)

[state 1100]
type = RemoveExplod
trigger1 = Anim=6520&&AnimElem=13,>=6
id = 6042
;~~~
[state 250]
type = SprPriority
trigger1 = 1
value = 4

[state 1400]
type = PlaySND
trigger1 = AnimElem=4
value = 30,2
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 10

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=9
damage = floor(floor(40*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(40*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,10+root,var(49)*7
ground.velocity = -4.0*const(size.xscale)/1.25,(-8.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -4.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)/1.25,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-7.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+10,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+10)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(40*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(40*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(40*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(40*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = M
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)
sprpriority = 4

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=9
damage = floor(floor(40*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(40*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,10+root,var(49)*7
ground.velocity = -4.0*const(size.xscale)/1.25,(-10.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0010,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-7.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+10,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+10)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(40*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(40*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(40*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(40*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = C,SP
hitflag = MAFD
guardflag = M
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)
sprpriority = 4

[state 6400]
type = AttackDist
trigger1 = AnimElem=8
value = floor(242*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=9
value = floor(242*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=13
value = 0

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(40*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(ifelse(P2dist X>242*const(size.xscale),242*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(ifelse(P2dist Y>100*const(size.yscale),40*const(size.yscale),ifelse(P2dist Y<20*const(size.yscale),-40*const(size.yscale),-60*const(size.yscale)+floor(P2dist Y))))

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !(root,stateno=3120&&((root,AnimElemTime(7)>=0&&root,AnimElemTime(9)<0)||root,AnimElemTime(12)>=0&&root,AnimElemTime(14)<0||root,AnimElemTime(17)>=0&&root,AnimElemTime(19)<0)||root,AnimElemTime(22)>=0&&root,AnimElemTime(24)<0)
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;○○○○○
;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15902)&&IsHelper
trigger1 = time=1
id = 15902
stateno=15902
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15907)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15387)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;■魔の手■
;魔の手モード中与えたダメージ
[state -2]
type = parentvaradd
trigger1 = numenemy=2
trigger1 = movehit=1&&enemynear(numenemy-1),gethitvar(damage)
var(36) = enemynear(numenemy-1),gethitvar(damage)
ignorehitpause=1

[state -2]
type = parentvaradd
trigger1 = movehit=1&&enemynear,gethitvar(damage)
var(37) = enemynear,gethitvar(damage)
ignorehitpause=1

;ヒット時ゲージ７割回復
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1
var(34) = 39
ignorehitpause=1

;■状態異常付加
[state -2]
type = VarSet
trigger1 = 1
var(11) = 0
ignorehitpause=1

[state -2]
type = VarAdd
trigger1 = movehit=1 && numtarget
var(11) = 1
ignorehitpause=1
persistent=0

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = RemoveExplod
trigger1 = AnimTime=0
trigger2 = root,movetype=H

[state 11455]
type = DestroySelf
trigger1 = AnimTime=0
trigger2 = root,movetype=H

;開け根の国（沃追）
[Statedef 6520]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 90000
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6190
time = 1

;~~~ワープ前~~~~
;本体
[state 1110]
type = VarSet
trigger1 = Time=5
var(20) = floor(pos x)

;本体
[state 1110]
type = VarSet
trigger1 = Time=5
var(21) = floor(pos y)

;本体
[state 1110]
type = Explod
trigger1 = Time=5
id = 6525
anim = 6525
pos = -floor(0*const(size.xscale)),-floor(0*const(size.yscale))
postype = P1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
sprpriority = 3

;本体
[state 1110]
type = RemoveExplod
trigger1 = AnimElem=16
id = 6525

;本体
[state 1110]
type = Explod
trigger1 = AnimElem=16
id = 6525
anim = 6526
pos = (var(20)-floor(pos x))*facing,var(21)-floor(pos y)
postype = P1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
sprpriority = 3

[state 1110]
type = Explod
trigger1 = AnimElem=1
id = 6040
anim = 6040
pos = -floor(0*const(size.xscale)),-floor(10*const(size.yscale))
postype = P1
ignorehitpause=1
scale = const(size.xscale)*.8,const(size.yscale)*.8
ownpal = 1
sprpriority = 2

[state 1100]
type = ModifyExplod
trigger1 = time<6||AnimElem=16,>6
id = 6040
scale = const(size.xscale)*(1.0-ifelse(time<6,6-time,-6+animelemtime(animelemNo(0)))*.15)*.8,const(size.yscale)*(1.0-ifelse(time<6,6-time,-6+animelemtime(animelemNo(0)))*.15)*.8

[state 1100]
type = ModifyExplod
trigger1 = !(Time<6||AnimElem=16,>6)
id = 6040
scale = const(size.xscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05)*.8,const(size.yscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05)*.8


;ワープ元
[state 1110]
type = Explod
trigger1 = Time=11
id = 6041
anim = 6040
pos = floor(160*const(size.xscale)),-floor(30*const(size.yscale))
postype = P1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
sprpriority = 4

[state 1100]
type = ModifyExplod
trigger1 = (Time=[11,15])||(Anim=6520&&AnimElem=16,>=0)
id = 6041
scale = const(size.xscale)*(1.0-ifelse((Time=[11,15]),15-time,0+animelemtime(AnimElemNo(0)))*.15),const(size.yscale)*(1.0-ifelse((Time=[11,15]),15-time,0+animelemtime(AnimElemNo(0)))*.15)

[state 1100]
type = ModifyExplod
trigger1 = !((Time=[11,15])||(Anim=6520&&AnimElem=16,>=0))
id = 6041
scale = const(size.xscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05),const(size.yscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05)

[state 1100]
type = RemoveExplod
trigger1 = Anim=6520&&AnimElem=16,>=6
id = 6041


;~~~~ワープ
[state 1400]
type = ChangeAnim
trigger1 = Time=28
value = 6520

[state 1400]
type = PosSet
trigger1 = Time=25
x = enemynear,pos x-floor(140*const(size.xscale))*facing
y = -floor(190*const(size.yscale))+floor(P2dist Y)

;ワープ先
[state 1110]
type = Explod
trigger1 = Time=25
id = 6042
anim = 6040
pos = -floor(0*const(size.xscale)),-floor(10*const(size.yscale))
postype = P1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
bindtime=-1
sprpriority = 2

[state 1100]
type = ModifyExplod
trigger1 = Time<31||(Anim=6520&&AnimElem=16,>0&&AnimElem=16,<9)
id = 6042
scale = const(size.xscale)*(1.0-ifelse(time<31,31-time,2+AnimElemTime(AnimElemNo(0)))*.15),const(size.yscale)*(1.0-ifelse(time<31,31-time,2+AnimElemTime(AnimElemNo(0)))*.15)

[state 1100]
type = ModifyExplod
trigger1 = !(time<31||(Anim=6520&&AnimElem=16,>0&&AnimElem=16,<9))
id = 6042
scale = const(size.xscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05),const(size.yscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05)

[state 1100]
type = RemoveExplod
trigger1 = Anim=6520&&AnimElem=16,>=6
id = 6042
;~~~
[state 250]
type = SprPriority
trigger1 = 1
value = 4

[state 1400]
type = PlaySND
trigger1 = Anim=6520&&AnimElem=2
value = 30,2
channel = 1
persistent=0

[state 6500]
type = MoveHitReset
triggerall = movecontact!=1
trigger1 = AnimElem=2
trigger2 = AnimElem=7
trigger3 = AnimElem=12

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.3
[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 3

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=2,>=0&&AnimElem=7,<0
trigger2 = AnimElem=7,>=0&&AnimElem=12,<0
trigger3 = AnimElem=12,>=0&&AnimElem=14,<0
damage = floor(floor(52*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(52*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,3+root,var(49)*6
ground.velocity = 5.0*const(size.xscale)/1.25,(-6.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = 10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = 5.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)/1.25,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-6.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = 6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),30+3,16-ifelse(floor(root,var(14)/75)>7,7,floor(root,var(14)/75))+3)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(50*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(50*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(50*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(50*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = A,SP
hitflag = MAFD
guardflag = MA
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=2,>=0&&AnimElem=7,<0
trigger2 = AnimElem=7,>=0&&AnimElem=12,<0
trigger3 = AnimElem=12,>=0&&AnimElem=14,<0
damage = floor(floor(52*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(52*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,3+root,var(49)*6
ground.velocity = 5.0*const(size.xscale)/1.25,(-6.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = 10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0003,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-6.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = 6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),30+3,16-ifelse(floor(root,var(14)/75)>7,7,floor(root,var(14)/75))+3)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(50*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(50*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(50*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(50*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = A,SP
hitflag = MAFD
guardflag = MA
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

[state 6400]
type = AttackDist
trigger1 = AnimElem=1
value = floor(110*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=2
value = floor(172*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=15
value = 0

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(52*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(ifelse(P2dist X>364*const(size.xscale),364*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(ifelse(P2dist Y>60*const(size.yscale),-20*const(size.yscale),ifelse(P2dist Y<-60*const(size.yscale),-140*const(size.yscale),-80*const(size.yscale)+floor(P2dist Y))))

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !(root,stateno=3120&&((root,AnimElemTime(7)>=0&&root,AnimElemTime(9)<0)||root,AnimElemTime(12)>=0&&root,AnimElemTime(14)<0||root,AnimElemTime(17)>=0&&root,AnimElemTime(19)<0)||root,AnimElemTime(22)>=0&&root,AnimElemTime(24)<0)
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;○○○○○
;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15902)&&IsHelper
trigger1 = time=1
id = 15902
stateno=15902
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15907)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15387)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;■魔の手■
;魔の手モード中与えたダメージ
[state -2]
type = parentvaradd
trigger1 = numenemy=2
trigger1 = movehit=1&&enemynear(numenemy-1),gethitvar(damage)
var(36) = enemynear(numenemy-1),gethitvar(damage)
ignorehitpause=1

[state -2]
type = parentvaradd
trigger1 = movehit=1&&enemynear,gethitvar(damage)
var(37) = enemynear,gethitvar(damage)
ignorehitpause=1

;ヒット時ゲージ７割回復
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1
var(34) = 9
ignorehitpause=1

;■状態異常付加
[state -2]
type = VarSet
trigger1 = 1
var(11) = 0
ignorehitpause=1

[state -2]
type = VarAdd
trigger1 = movehit=1 && numtarget
var(11) = 1
ignorehitpause=1
persistent=0

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = RemoveExplod
trigger1 = AnimTime=0
trigger2 = root,movetype=H

[state 11455]
type = DestroySelf
trigger1 = AnimTime=0
trigger2 = root,movetype=H

;開け根の国（上移動）
[Statedef 6540]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 6540
sprpriority = 2

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1110]
type = Explod
trigger1 = !time && !numexplod(6545)
id = 6545
anim = 6545
pos = 0,0
postype = P1
removeongethit=1
ownpal = 1
bindtime=-1
removetime=-1
scale = const(size.xscale),const(size.yscale)

[state 1110]
type = RemoveExplod
trigger1 = AnimElem=5
trigger2 = AnimElem=5,>0&&AnimElem=6,<0&&movecontact
trigger3 = AnimElem=6
id = 6545

[state 1110]
type = Explod
trigger1 = AnimElem=5
trigger2 = AnimElem=5,>0&&AnimElem=6,<0&&movecontact
id = 6545
anim = 6546
pos = 0,0
postype = P1
removeongethit=1
ownpal = 1
bindtime=-1
removetime=-1
scale = const(size.xscale),const(size.yscale)

[state 1110]
type = Explod
trigger1 = AnimElem=6
id = 6545
anim = 6547
pos = 0,0
postype = P1
removeongethit=1
ownpal = 1
bindtime=-1
removetime=-1
scale = const(size.xscale),const(size.yscale)

[state 1400]
type = PlaySND
trigger1 = AnimElem=5
value = 30,2
channel = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 4

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=5
damage = floor(floor(26*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(26*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,4+root,var(49)*7
ground.velocity = -3.0*const(size.xscale)/1.25,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -3.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale),ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0||(root,var(49)&&!root,var(2)),0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+4,25-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+4)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(45*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(45*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(45*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(45*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = A,SP
hitflag = MAFD
guardflag = H
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=5
damage = floor(floor(26*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(26*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+root,var(49)*7
ground.velocity = -3.0*const(size.xscale)/1.25,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -10.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.040)-.0013,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),42+4,25-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+4)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(45*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(45*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(45*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(45*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = A,SP
hitflag = MAFD
guardflag = H
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

[state 6400]
type = AttackDist
trigger1 = AnimElem=1
value = floor(120*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(26*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(ifelse(P2dist X>120*const(size.xscale),120*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(ifelse(P2dist Y>0,-160*const(size.yscale),ifelse(P2dist Y<-180*const(size.yscale),-420*const(size.yscale),-160*const(size.yscale)+floor(P2dist Y))))

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !(root,stateno=3120&&((root,AnimElemTime(7)>=0&&root,AnimElemTime(9)<0)||root,AnimElemTime(12)>=0&&root,AnimElemTime(14)<0||root,AnimElemTime(17)>=0&&root,AnimElemTime(19)<0)||root,AnimElemTime(22)>=0&&root,AnimElemTime(24)<0)
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1
persistent=0

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;○○○○○
;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15902)&&IsHelper
trigger1 = time=1
id = 15902
stateno=15902
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15907)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15387)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 6450]
type = PosSet
trigger1 = 1
x = floor(root,pos x)+floor(20*const(size.xscale))*facing

;■魔の手■
;魔の手モード中与えたダメージ
[state -2]
type = parentvaradd
trigger1 = numenemy=2
trigger1 = movehit=1&&enemynear(numenemy-1),gethitvar(damage)
var(36) = enemynear(numenemy-1),gethitvar(damage)
ignorehitpause=1

[state -2]
type = parentvaradd
trigger1 = movehit=1&&enemynear,gethitvar(damage)
var(37) = enemynear,gethitvar(damage)
ignorehitpause=1

;ヒット時ゲージ７割回復
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1
var(34) = 12
ignorehitpause=1

;■状態異常付加
[state -2]
type = VarSet
trigger1 = 1
var(11) = 0
ignorehitpause=1

[state -2]
type = VarAdd
trigger1 = movehit=1 && numtarget
var(11) = 1
ignorehitpause=1
persistent=0

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = RemoveExplod
triggerall = movecontact!=1
trigger1 = 0;AnimTime=0
trigger2 = (root,stateno!=[1120,1130])&&(root,stateno!=[1550,1570])&&time>1
trigger3 = root,movetype=H
id = 6545

[state 11455]
type = DestroySelf
triggerall = movecontact!=1
trigger1 = 0;AnimTime=0
trigger2 = (root,stateno!=[1120,1130])&&(root,stateno!=[1550,1570])&&time>1
trigger3 = root,movetype=H

;開け根の国（上移動終了）
[Statedef 6545]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,0
anim = 6544
sprpriority = 2

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1110]
type = Explod
trigger1 = !time && !numexplod(6545)
id = 6545
anim = 6549
pos = 0,0
postype = P1
removeongethit=1
ownpal = 1
bindtime=-1
removetime=-1
scale = const(size.xscale),const(size.yscale)

[state 6450]
type = PosSet
trigger1 = 1
x = floor(root,pos x)+floor(20*const(size.xscale))*facing
y = 0;floor(370*const(size.yscale))

[state 11455]
type = RemoveExplod
triggerall = movecontact!=1
trigger1 = AnimTime=0
trigger2 = root,statetype!=A&&(root,stateno!=[1120,1140])&&time>1
trigger3 = root,movetype=H
id = 6545

[state 11455]
type = DestroySelf
triggerall = movecontact!=1
trigger1 = AnimTime=0
trigger2 = root,statetype!=A&&(root,stateno!=[1120,1140])&&time>1
trigger3 = root,movetype=H

;開け根の国（沃・上移動中）
[Statedef 6550]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 90000
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1400]
type = ChangeAnim
trigger1 = Time=4
value = 6550

[state 1110]
type = Explod
trigger1 = Time=0
id = 6040
anim = 6040
pos = -floor(10*const(size.xscale)),-floor(10*const(size.yscale))
postype = P1
ignorehitpause=1
scale = const(size.xscale)*.8,const(size.yscale)*.8
ownpal = 1
bindtime=-1
sprpriority = 4

[state 1100]
type = ModifyExplod
trigger1 = Time<6||AnimTime>-6
id = 6040
scale = const(size.xscale)*(1.0-ifelse(time<6,6-time,6+animtime)*.15)*.8,const(size.yscale)*(1.0-ifelse(time<6,6-time,6+animtime)*.15)*.8

[state 1100]
type = ModifyExplod
trigger1 = !(Time<6||AnimTime>-6)
id = 6040
scale = const(size.xscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05)*.8,const(size.yscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05)*.8

[state 1400]
type = PlaySND
trigger1 = AnimElem=12
value = 30,2
channel = 1

[state 250]
type = varset
trigger1 = !time
var(1) = 0

[state 250]
type = varadd
trigger1 = movecontact=1
var(1) = 1

[state 6500]
type = MoveHitReset
triggerall = movecontact!=1
trigger1 = AnimElem=5
trigger2 = AnimElem=11

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.3
[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 4

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=5
trigger2 = AnimElem=11
damage = floor(floor(36*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(36*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,4+root,var(49)*6
ground.velocity = -3.0*const(size.xscale)/1.25,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -3.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale),ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),30+4,16-ifelse(floor(root,var(14)/75)>7,7,floor(root,var(14)/75))+4)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(35*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(35*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(35*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(35*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = A,SP
hitflag = MAFD
guardflag = MA
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)
sprpriority = 4

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=5
trigger2 = AnimElem=11
damage = floor(floor(36*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),ceil(floor(36*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,4+root,var(49)*6
ground.velocity = -3.0*const(size.xscale)/1.25,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -10.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0003,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),30+4,16-ifelse(floor(root,var(14)/75)>7,7,floor(root,var(14)/75))+4)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(35*root,fvar(0)/root,fvar(2))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(35*root,fvar(0)/root,fvar(2)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(35*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(35*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = A,SP
hitflag = MAFD
guardflag = MA
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)
sprpriority = 4

[state 6400]
type = AttackDist
trigger1 = AnimElem=1
value = floor(128*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=4
value = floor(144*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=5
value = floor(174*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=6
value = floor(220*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=8
value = floor(242*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=13
value = 0

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(36*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(ifelse(P2dist X>242*const(size.xscale),242*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(ifelse(P2dist Y>60*const(size.yscale),-20*const(size.yscale),ifelse(P2dist Y<-60*const(size.yscale),-140*const(size.yscale),-80*const(size.yscale)+floor(P2dist Y))))

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !(root,stateno=3120&&((root,AnimElemTime(7)>=0&&root,AnimElemTime(9)<0)||root,AnimElemTime(12)>=0&&root,AnimElemTime(14)<0||root,AnimElemTime(17)>=0&&root,AnimElemTime(19)<0)||root,AnimElemTime(22)>=0&&root,AnimElemTime(24)<0)
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15909)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+1
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15380)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+6
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;■魔の手■
;魔の手モード中与えたダメージ
[state -2]
type = parentvaradd
trigger1 = numenemy=2
trigger1 = movehit=1&&enemynear(numenemy-1),gethitvar(damage)
var(36) = enemynear(numenemy-1),gethitvar(damage)
ignorehitpause=1

[state -2]
type = parentvaradd
trigger1 = movehit=1&&enemynear,gethitvar(damage)
var(37) = enemynear,gethitvar(damage)
ignorehitpause=1

;ヒット時ゲージ７割回復
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1
var(34) = 16
ignorehitpause=1

;■状態異常付加
[state -2]
type = VarSet
trigger1 = 1
var(11) = 0
ignorehitpause=1

[state -2]
type = VarAdd
trigger1 = movehit=1 && numtarget
var(11) = 1
ignorehitpause=1
persistent=0

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = RemoveExplod
trigger1 = AnimTime=0
trigger2 = root,movetype=H

[state 11455]
type = DestroySelf
trigger1 = AnimTime=0
trigger2 = root,movetype=H

;■■開国ゲージ■■
[statedef 6700]
ctrl = 0
anim = 90000
sprpriority = -2

[state 6355]
type = BindtoRoot
trigger1 = 1
pos = 0,-floor(ifelse(root,statetype=C,140,220)*const(size.yscale))
time=1

[state -2]
type = PlaySND
trigger1 = !numexplod(6725)&&root,var(34)>=600&&var(34)!=root,var(34)&&(root,stateno!=[1110,1190])&&(root,stateno!=[1400,1590])
value = 30,0

;背景
[state 8900]
type = Explod
trigger1 = !NumExplod(6700)
id = 6700
anim = 6700+(teamside=2)*1
pos = 67+floor(root,fvar(21)),237+floor(1000*ifelse(((root,fvar(21)-floor(root,fvar(21)))=(0,.001)),-1000,1)*(root,fvar(21)-floor(root,fvar(21))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 2
ontop = 1
bindtime = -1
ownpal = 1

;ゲージ
[state 8900]
type = Explod
trigger1 = !NumExplod(6710)
id = 6710
anim = 6710+(teamside=2)*1
pos = 67+4+floor(root,fvar(21)),237-14+floor(1000*ifelse(((root,fvar(21)-floor(root,fvar(21)))=(0,.001)),-1000,1)*(root,fvar(21)-floor(root,fvar(21))))
postype = back
removetime=-1
scale = .5*((root,var(34)*96.00/1000)),.5
sprpriority = 2
ontop = 1
sprpriority = -1
bindtime = -1
ownpal = 1

[state 8900]
type = ModifyExplod
trigger1 = 1
id = 6710
scale = (ifelse(root,var(34)<0,0,root,var(34))*1.00/600)*.5,.5

[state -2]
type = PalFX
trigger1 = !numexplod(6725)&&root,var(34)<600
add = -200+ceil((root,var(34)*1.0/600)*200),-200+ceil((root,var(34)*1.0/600)*200),-200+ceil((root,var(34)*1.0/600)*200)
time = 1

[state 801]
type = Explod
trigger1 = !NumExplod(6720)
id = 6720
anim = 6720
pos = 67+floor(root,fvar(21)),237+floor(1000*ifelse(((root,fvar(21)-floor(root,fvar(21)))=(0,.001)),-1000,1)*(root,fvar(21)-floor(root,fvar(21))))
postype = back
scale = .5,.5
sprpriority = 2
ontop = 1
bindtime=-1
pausemovetime=9999
supermovetime=9999

[state 801]
type = Explod
trigger1 = !NumExplod(6725)&&!NumExplod(6730)
trigger1 = root,var(34)>=600&&(root,stateno!=[1110,1190])&&(root,stateno!=[1400,1590])
id = 6730
anim = 6730
pos = 140+floor(root,fvar(21)),232+floor(1000*ifelse(((root,fvar(21)-floor(root,fvar(21)))=(0,.001)),-1000,1)*(root,fvar(21)-floor(root,fvar(21))))
postype = back
scale = .5,.5
sprpriority = 8
ontop = 1
bindtime=-1
pausemovetime=9999
supermovetime=9999

[state 801]
type = Explod
trigger1 = !NumExplod(6725)&&!NumExplod(6731)
trigger1 = root,var(34)>=600&&(root,stateno!=[1110,1190])&&(root,stateno!=[1400,1590])
id = 6731
anim = 6731
pos = 140+floor(root,fvar(21)),224+floor(1000*ifelse(((root,fvar(21)-floor(root,fvar(21)))=(0,.001)),-1000,1)*(root,fvar(21)-floor(root,fvar(21))))
postype = back
scale = .5,.5
sprpriority = 8
ontop = 1
bindtime=-1
pausemovetime=9999
supermovetime=9999

[state 801]
type = Explod
trigger1 = !NumExplod(6725)&&!NumExplod(6732)
trigger1 = root,var(34)>=600&&(root,stateno!=[1110,1190])&&(root,stateno!=[1400,1590])
id = 6732
anim = 6732
pos = 140+floor(root,fvar(21)),224+floor(1000*ifelse(((root,fvar(21)-floor(root,fvar(21)))=(0,.001)),-1000,1)*(root,fvar(21)-floor(root,fvar(21))))
postype = back
scale = .5,.5
sprpriority = 7
ontop = 1
bindtime=-1
pausemovetime=9999
supermovetime=9999

[state 801]
type = Explod
trigger1 = !NumExplod(6725)
trigger1 = root,var(34)>=600&&(root,stateno!=[1110,1190])&&(root,stateno!=[1400,1590])
id = 6725
anim = 6725
pos = 67+floor(root,fvar(21)),237+floor(1000*ifelse(((root,fvar(21)-floor(root,fvar(21)))=(0,.001)),-1000,1)*(root,fvar(21)-floor(root,fvar(21))))
postype = back
scale = .5,.5
sprpriority = 7
ontop = 1
bindtime=-1
pausemovetime=9999
supermovetime=9999
removetime=-1

[state 6740]
type = ModifyExplod
trigger1 = NumExplod(6730)
id = 6730
scale = 2.0-ifelse(var(3)>=36,var(3)-36,0)*.133,1.0

[state 801]
type = VarSet
trigger1 = !NumExplod(6730)
var(3) = 0

[state 801]
type = VarAdd
trigger1 = NumExplod(6730)
var(3) = 1

[state 8900]
type = RemoveExplod
trigger1 = root,var(34)<600
id = 6725

;状態異常付加エフェクト
[state -2]
type = Explod
trigger1 = numhelper(6400)
trigger1 = helper(6400),var(11)
trigger2 = numhelper(6415)
trigger2 = helper(6415),var(11)
trigger3 = numhelper(6420)
trigger3 = helper(6420),var(11)
trigger4 = numhelper(6450)
trigger4 = helper(6450),var(11)
trigger5 = numhelper(6460)
trigger5 = helper(6460),var(11)
trigger6 = numhelper(6500)
trigger6 = helper(6500),var(11)
trigger7 = numhelper(6510)
trigger7 = helper(6510),var(11)
trigger8 = numhelper(6520)
trigger8 = helper(6520),var(11)
trigger9 = numhelper(6540)
trigger9 = helper(6540),var(11)
trigger10 = numhelper(6550)
trigger10 = helper(6550),var(11)
trigger11 = numhelper(6560)
trigger11 = helper(6560),var(11)
trigger12 = numhelper(6570)
trigger12 = helper(6570),var(11)
trigger13 = numhelper(6000)
trigger13 = helper(6000),var(11)
trigger14 = numhelper(6020)
trigger14 = helper(6020),var(11)
id   = 6770+ifelse(!numexplod(6770),0,ifelse(!numexplod(6771),1,ifelse(!numexplod(6772),2,3)))
anim = 6770+ifelse(root,stateno=1050,ifelse(root,var(35)=0,9,ifelse(enemynear,selfanimexist(1010101)&&root,var(35)=4,10,root,var(35)-1)),ifelse(root,var(35)=9,0,ifelse(enemynear,selfanimexist(1010101)&&root,var(35)=3,10,root,var(35))))
pos = 0,floor(enemynear,const(size.head.pos.y)/2)
postype = p2
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
scale = .5,.5
facing=ifelse(enemynear,facing=-1,-1,1)
sprpriority = 5
ignorehitpause=1

[state -2]
type = Explod
trigger1 = numhelper(6400)
trigger1 = helper(6400),var(11)
trigger2 = numhelper(6415)
trigger2 = helper(6415),var(11)
trigger3 = numhelper(6420)
trigger3 = helper(6420),var(11)
trigger4 = numhelper(6450)
trigger4 = helper(6450),var(11)
trigger5 = numhelper(6460)
trigger5 = helper(6460),var(11)
trigger6 = numhelper(6500)
trigger6 = helper(6500),var(11)
trigger7 = numhelper(6510)
trigger7 = helper(6510),var(11)
trigger8 = numhelper(6520)
trigger8 = helper(6520),var(11)
trigger9 = numhelper(6540)
trigger9 = helper(6540),var(11)
trigger10 = numhelper(6550)
trigger10 = helper(6550),var(11)
trigger11 = numhelper(6560)
trigger11 = helper(6560),var(11)
trigger12 = numhelper(6570)
trigger12 = helper(6570),var(11)
trigger13 = numhelper(6000)
trigger13 = helper(6000),var(11)
trigger14 = numhelper(6020)
trigger14 = helper(6020),var(11)
id   = 6760+ifelse(!numexplod(6760),0,ifelse(!numexplod(6761),1,ifelse(!numexplod(6762),2,3)))
anim = 6760
pos = 0,floor(enemynear,const(size.head.pos.y)/2)
postype = p2
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
scale = 1.0,1.0
facing=ifelse(enemynear,facing=-1,-1,1)
sprpriority = 5
ignorehitpause=1

;10,40,80,200,260

[state -1]
type = VarSet
trigger1 = !time||var(6)>32
var(6)=0

[state -1]
type = VarAdd
trigger1 = numexplod(6770)
var(6)=1

[state -1]
type = ModifyExplod
trigger1 = var(6)<15
id = 6770
scale = .5-(14-var(6))*.0375,.5-(14-var(6))*.0375

[state -1]
type = ModifyExplod
trigger1 = var(6)<15
id = 6760
scale = 1-(14-var(6))*.075,1-(14-var(6))*.075

[state -1]
type = ModifyExplod
trigger1 = var(6)>=27
id = 6770
scale = .5-(var(6)-26)*.1,.5-(var(6)-26)*.1

[state -1]
type = ModifyExplod
trigger1 = var(6)>=27
id = 6760
scale = 1-(var(6)-26)*.2,1-(var(6)-26)*.2

[state -1]
type = VarSet
trigger1 = !time||var(7)>32
var(7)=0

[state -1]
type = VarAdd
trigger1 = numexplod(6771)
var(7)=1

[state -1]
type = ModifyExplod
trigger1 = var(7)<15
id = 6771
scale = .5-(14-var(7))*.0375,.5-(14-var(7))*.0375

[state -1]
type = ModifyExplod
trigger1 = var(7)<15
id = 6761
scale = 1-(14-var(7))*.075,1-(14-var(7))*.075

[state -1]
type = ModifyExplod
trigger1 = var(7)>=27
id = 6771
scale = .5-(var(7)-26)*.1,.5-(var(7)-26)*.1

[state -1]
type = ModifyExplod
trigger1 = var(7)>=27
id = 6761
scale = 1-(var(7)-26)*.2,1-(var(7)-26)*.2

[state -1]
type = VarSet
trigger1 = !time||var(8)>32
var(8)=0

[state -1]
type = VarAdd
trigger1 = numexplod(6772)
var(8)=1

[state -1]
type = ModifyExplod
trigger1 = var(8)<15
id = 6772
scale = .5-(14-var(8))*.0375,.5-(14-var(8))*.0375

[state -1]
type = ModifyExplod
trigger1 = var(8)<15
id = 6762
scale = 1-(14-var(8))*.075,1-(14-var(8))*.075

[state -1]
type = ModifyExplod
trigger1 = var(8)>=27
id = 6772
scale = .5-(var(8)-26)*.1,.5-(var(8)-26)*.1

[state -1]
type = ModifyExplod
trigger1 = var(8)>=27
id = 6762
scale = 1-(var(8)-26)*.2,1-(var(8)-26)*.2

[state -1]
type = VarSet
trigger1 = !time||var(9)>32
var(9)=0

[state -1]
type = VarAdd
trigger1 = numexplod(6773)
var(9)=1

[state -1]
type = ModifyExplod
trigger1 = var(9)<15
id = 6773
scale = .5-(14-var(9))*.0375,.5-(14-var(9))*.0375

[state -1]
type = ModifyExplod
trigger1 = var(9)<15
id = 6763
scale = 1-(14-var(9))*.075,1-(14-var(9))*.075

[state -1]
type = ModifyExplod
trigger1 = var(9)>=27
id = 6773
scale = .5-(var(9)-26)*.1,.5-(var(9)-26)*.1

[state -1]
type = ModifyExplod
trigger1 = var(9)>=27
id = 6763
scale = 1-(var(9)-26)*.2,1-(var(9)-26)*.2


;開国ゲージ回復速度
[state 6740]
type = VarSet
trigger1 = root,stateno=1100
var(10) = 100

[state 6740]
type = VarAdd
trigger1 = numhelper(6400)
trigger1 = helper(6400),movehit=2
trigger2 = numhelper(6415)
trigger2 = helper(6415),movehit=2
trigger3 = numhelper(6420)
trigger3 = helper(6420),movehit=2
trigger4 = numhelper(6450)
trigger4 = helper(6450),movehit=2
trigger5 = numhelper(6460)
trigger5 = helper(6460),movehit=2
trigger6 = numhelper(6500)
trigger6 = helper(6500),movehit=2
trigger7 = numhelper(6510)
trigger7 = helper(6510),movehit=2
trigger8 = numhelper(6520)
trigger8 = helper(6520),movehit=2
trigger9 = numhelper(6540)
trigger9 = helper(6540),movehit=2
trigger10 = numhelper(6550)
trigger10 = helper(6550),movehit=2
trigger11 = numhelper(6560)
trigger11 = helper(6560),movehit=2
trigger12 = numhelper(6570)
trigger12 = helper(6570),movehit=2
trigger13 = numhelper(6000)
trigger13 = helper(6000),movehit=2
trigger14 = numhelper(6020)
trigger14 = helper(6020),movehit=2
trigger15 = numhelper(6530)
trigger15 = helper(6530),movehit=2
trigger16 = numhelper(6531)
trigger16 = helper(6531),movehit=2
trigger17 = numhelper(6532)
trigger17 = helper(6532),movehit=2
trigger18 = numhelper(6533)
trigger18 = helper(6533),movehit=2
trigger19 = numhelper(6534)
trigger19 = helper(6534),movehit=2
var(10) = -1

[state 6740]
type = VarSet
trigger1 = var(10)<1
var(10) = 1

[state 100]
type = VarSet
trigger1 = 1
var(34) = root,var(34)

[state 6340]
type = DestroySelf
trigger1 = !numenemy&&time

;惑え緋の羽・陽
[statedef 1200]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0+fvar(8),0),0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1200

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

;ヒットバックリセット
[state 200]
type = VarSet
trigger1 = !Time
fvar(5) = 0

[state 190]
type = PlaySND
trigger1 = AnimElem=3
trigger2 = AnimElem=9
value = 30,5
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=4
value = 10,42
channel = 1

;~~~~エフェクト~~~~
[state 190]
type = Helper
trigger1 = AnimElem=3
id = 6200
stateno=6200
pos = 0,0
postype = p1
ownpal = 1
ignorehitpause=1

[state 600]
type = VelAdd
trigger1 = AnimElem=1,>=0&&AnimElem=3,<0&&(var(52)!=[1,99])
y = .075*2.0*const(size.yscale)

[state 600]
type = VelAdd
trigger1 = AnimElem=15,>=0
y = .3*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = AnimElem=15,=0
x = 0

[state 600]
type = VelSet
trigger1 = AnimElem=3,=1
x = 6.0*2.0*const(size.xscale)

[state 600]
type = VarSet
trigger1 = AnimElem=3,>=1&&AnimElem=6,<0
fvar(8) = 6.0*2.0*const(size.xscale)

[state 600]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=9,<0&&(var(52)!=[1,99])
fvar(8) = fvar(8)*.9

[state 600]
type = VarSet
trigger1 = AnimElem=15,=0
fvar(8) = 0

;==追加入力==
[state 200]
type = VarSet
trigger1 = AnimElem=3,>=0
var(7) = 0

[state 200]
type = VarSet
triggerall = AnimElem=3,>=0
trigger1 = command="holdup" && !var(59)
var(7) = 1

[state 200]
type = VarSet
triggerall = AnimElem=3,>=0
trigger1 = command="holddown" && !var(59)
var(7) = -1

[state 600]
type = VelAdd
trigger1 = AnimElem=3,>=1&&AnimElem=15,<0&&(var(52)!=[1,99])&&var(7)
y = ifelse(var(7)=1,-.075,.05)*2.0*const(size.yscale)

[state -2]
type = velset
trigger1 = fvar(8)>=0 && !fvar(9) && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
x = fvar(8)

[state 190]
type = MoveHitReset
triggerall = movecontact!=1
trigger1 = AnimElem=3
trigger2 = AnimElem=5
trigger3 = AnimElem=8
trigger4 = AnimElem=10
trigger5 = AnimElem=13

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,11)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed
triggerall = var(1)%4<2
trigger1 = AnimElem=3,>=0&&AnimElem=5,<0
trigger2 = AnimElem=5,>=0&&AnimElem=8,<0
trigger3 = AnimElem=8,>=0&&AnimElem=10,<0
trigger4 = AnimElem=10,>=0&&AnimElem=12,<0
trigger5 = AnimElem=13,>=0&&AnimElem=15,<0
damage = floor(floor(20*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4))*1.22),floor(ceil(20*fvar(3)*fvar(4)*1.0/4))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,11+var(49)*6
ground.velocity = -10.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale),(-14.0-.9)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0011,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-14.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(20*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(20*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = High
ground.type = High
attr = A,SA
hitflag = MAFD
guardflag = MA

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed
triggerall = var(1)%4>=2
trigger1 = AnimElem=3,>=0&&AnimElem=5,<0
trigger2 = AnimElem=5,>=0&&AnimElem=8,<0
trigger3 = AnimElem=8,>=0&&AnimElem=10,<0
trigger4 = AnimElem=10,>=0&&AnimElem=12,<0
trigger5 = AnimElem=13,>=0&&AnimElem=15,<0
damage = floor(ifelse(20*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=4),20*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,9
ground.velocity = -10.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale),(-14.0-.9)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0009,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-14.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+9,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(20*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(20*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = High
ground.type = High
attr = A,SA
hitflag = MAFD
guardflag = MA

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(64*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=4
value = floor(96*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=15
value = 0

[state -2]
type = VarAdd
trigger1 = var(1)%4>=2 && movecontact=1 && !var(2)
var(1) = -2
ignorehitpause=1

[State 0, AfterImage]
type = AfterImage
trigger1 = Time = 0&&var(1)%4>=2
time=24
length = 5
palbright = 0,0,0
palcontrast = 256,256,256
palpostbright = -30,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 1
framegap = 2
trans = AddAlpha
alpha = 128,128

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(20*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),20*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=3
var(16) = 10
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = animelem=3,>=0&&animelem=15,<0
var(17) = floor(ifelse(P2dist X>96*const(size.xscale),96*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = animelem=3,>=0&&animelem=15,<0
var(18) = floor(-136*const(size.yscale))+ifelse(P2bodydist Y<0,ifelse(P2bodydist Y<-20*const(size.yscale),floor(-20*const(size.yscale)),floor(P2bodydist Y)),0)


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse((var(3)&&target,statetype=A&&var(6)%10<1)||movehit,-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,11)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact)
value = 1247

;エフェクト
[statedef 6200]
type = A
physics = N
ctrl = 0
velset = 0,0
anim = 6200
sprpriority = 2

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6205]
type = AngleDraw
trigger1 = 1
value = -45
scale = 4*const(size.xscale),5*const(size.yscale)

[state 6205]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = posset
trigger1 = 1
x = floor(root,pos x)+floor(40*const(size.xscale))
y = floor(root,pos y)-floor(160*const(size.yscale))

[state 6200]
type = changeanim
trigger1 = 1
value = anim
elem = ifelse((var(0)%18=[0,2]),1,ifelse((var(0)%18=[3,5]),2,ifelse((var(0)%18=[6,14]),3,4)))

[state 6200]
type = varset
trigger1 = !time
var(0) = 0

[state 6200]
type = varadd
trigger1 = root,var(52)<=0||!root,movecontact
var(0) = 1

[state 6205]
type = destroyself
trigger1 = root,stateno!=1200
trigger2 = root,anim=1200&&root,animelemno(0)>=15

;惑え緋の羽・陰
[statedef 1250]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0+fvar(8),0),0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1250

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

;ヒットバックリセット
[state 200]
type = VarSet
trigger1 = !Time
fvar(5) = 0

[state 190]
type = PlaySND
trigger1 = AnimElem=3
trigger2 = AnimElem=8
trigger3 = AnimElem=13
value = 30,5
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=4
value = 10,45
channel = 1

;〜〜〜エフェクト〜〜〜
[state 190]
type = Helper
trigger1 = AnimElem=3
id = 6205
stateno=6205
pos = 0,0
postype = p1
ownpal = 1
ignorehitpause=1

[state 600]
type = VelAdd
trigger1 = AnimElem=1,>=0&&AnimElem=3,<0&&(var(52)!=[1,99])
y = .05*2.0*const(size.yscale)

[state 600]
type = VelAdd
trigger1 = AnimElem=18,>=0
y = .3*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = AnimElem=18,=0
x = 0

[state 600]
type = VelSet
trigger1 = AnimElem=3,=1
x = -6.0*2.0*const(size.xscale)

[state 600]
type = VarSet
trigger1 = AnimElem=3,>=1&&AnimElem=6,<0
fvar(8) = -6.0*2.0*const(size.xscale)

[state 600]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=9,<0&&(var(52)!=[1,99])
fvar(8) = fvar(8)*.9

[state 600]
type = VarSet
trigger1 = AnimElem=18,=0
fvar(8) = 0

;==追加入力==
[state 200]
type = VarSet
trigger1 = AnimElem=3,>=0
var(7) = 0

[state 200]
type = VarSet
triggerall = AnimElem=3,>=0
trigger1 = command="holdup" && !var(59)
var(7) = 1

[state 200]
type = VarSet
triggerall = AnimElem=3,>=0
trigger1 = command="holddown" && !var(59)
var(7) = -1

[state 600]
type = VelAdd
trigger1 = AnimElem=3,>=1&&AnimElem=18,<0&&(var(52)!=[1,99])&&var(7)
y = ifelse(var(7)=1,-.075,.05)*2.0*const(size.yscale)

[state -2]
type = velset
trigger1 = fvar(8)<=0 && !fvar(9) && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
x = fvar(8)

[state 190]
type = MoveHitReset
triggerall = movecontact!=1
trigger1 = AnimElem=3
trigger2 = AnimElem=5
trigger3 = AnimElem=8
trigger4 = AnimElem=10
trigger5 = AnimElem=13
trigger6 = AnimElem=15

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,11)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed
triggerall = var(1)%4<2
trigger1 = AnimElem=3,>=0&&AnimElem=5,<0
trigger2 = AnimElem=5,>=0&&AnimElem=8,<0
trigger3 = AnimElem=8,>=0&&AnimElem=10,<0
trigger4 = AnimElem=10,>=0&&AnimElem=12,<0
trigger5 = AnimElem=13,>=0&&AnimElem=15,<0
trigger6 = AnimElem=15,>=0&&AnimElem=18,<0
damage = floor(floor(20*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4))*1.22),floor(ceil(20*fvar(3)*fvar(4)*1.0/4))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,11+var(49)*6
ground.velocity = -10.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale),(-14.0-.9)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0009,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-14.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+9,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(20*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(20*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = High
ground.type = High
attr = A,SA
hitflag = MAFD
guardflag = MA

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed
triggerall = var(1)%4>=2
trigger1 = AnimElem=3,>=0&&AnimElem=5,<0
trigger2 = AnimElem=5,>=0&&AnimElem=8,<0
trigger3 = AnimElem=8,>=0&&AnimElem=10,<0
trigger4 = AnimElem=10,>=0&&AnimElem=12,<0
trigger5 = AnimElem=13,>=0&&AnimElem=15,<0
trigger6 = AnimElem=15,>=0&&AnimElem=18,<0
damage = floor(ifelse(20*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=4),20*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,9
ground.velocity = -10.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale),(-14.0-.9)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0011,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-14.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(20*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(20*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = High
ground.type = High
attr = A,SA
hitflag = MAFD
guardflag = MA

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(64*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=4
value = floor(96*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=18
value = 0

[state -2]
type = VarAdd
trigger1 = var(1)%4>=2 && movecontact=1 && !var(2)
var(1) = -2
ignorehitpause=1

[State 0, AfterImage]
type = AfterImage
trigger1 = Time = 0&&var(1)%4>=2
time=24
length = 5
palbright = 0,0,0
palcontrast = 256,256,256
palpostbright = -30,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 1
framegap = 2
trans = AddAlpha
alpha = 128,128

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(20*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),20*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=3
var(16) = 10
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = animelem=3,>=0&&animelem=18,<0
var(17) = floor(ifelse(P2dist X>96*const(size.xscale),96*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = animelem=3,>=0&&animelem=18,<0
var(18) = floor(-136*const(size.yscale))+ifelse(P2bodydist Y<0,ifelse(P2bodydist Y<-20*const(size.yscale),floor(-20*const(size.yscale)),floor(P2bodydist Y)),0)


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse((var(3)&&target,statetype=A&&var(6)%10<1)||movehit,-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,11)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact)
value = 1247

;惑え根の羽・陽(陰)　着地動作
[statedef 1247]
type = C
movetype=I
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0+fvar(8),0),0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1247

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = PosSet
trigger1 = Time=0
y = 0

[state 200]
type = VelSet
trigger1 = Time=0
x = 0
y = 0

[state 200]
type = CtrlSet
trigger1 = AnimElem=4
value = 1

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;エフェクト
[statedef 6205]
type = A
physics = N
ctrl = 0
velset = 0,0
anim = 6205
sprpriority = 2

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6205]
type = AngleDraw
trigger1 = 1
value = -60
scale = 4*const(size.xscale),5*const(size.yscale)

[state 6205]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = posset
trigger1 = 1
x = floor(root,pos x)+floor(40*const(size.xscale))
y = floor(root,pos y)-floor(160*const(size.yscale))

[state 6200]
type = changeanim
trigger1 = 1
value = anim
elem = ifelse((var(0)%13=[0,2]),1,ifelse((var(0)%13=[3,5]),2,ifelse((var(0)%13=[6,8]),3,4)))

[state 6200]
type = varset
trigger1 = !time
var(0) = 0

[state 6200]
type = varadd
trigger1 = root,var(52)<=0||!root,movecontact
var(0) = 1

[state 6205]
type = destroyself
trigger1 = root,stateno!=1250
trigger2 = root,anim=1250&&root,animelemno(0)>=18

;拒め根の渦・陽
[statedef 1300]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1300

[state 190]
type = PlaySND
triggerall = movecontact!=1
trigger1 = AnimElem=6
trigger2 = AnimElem=10
trigger3 = AnimElem=14
value = 30,6
channel = 10

[state 190]
type = PlaySND
triggerall = movecontact!=1
trigger1 = AnimElem=8
trigger2 = AnimElem=12
value = 30,6
channel = 11

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=6
value = 10,40
channel = 1

[state 1110]
type = RemoveExplod
trigger1 = AnimElem=16,>=0
trigger2 = AnimElemNo(0)!=AnimElemNo(-1)
id = 6210

[state 1110]
type = Explod
trigger1 = AnimElem=6,>=0&&AnimElem=16,<0&&!numExplod(6210)
id = 6210
anim = 6210+ifelse(AnimElemNo(0)%2=0,5,0)
pos = floor(140*const(size.xscale)),-floor(190*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*3,const(size.yscale)*2
ownpal = 1
bindtime=-1
sprpriority = 2

;エフェクト2
[state 1110]
type = Explod
trigger1 = AnimElem=6,>=0&&AnimElem=16,<0&&AnimElemNo(0)!=AnimElemNo(-1)&&random<350&&random<350&&(var(10)!=[1,99])
id = 6280
anim = 6280
pos = -floor(80*const(size.xscale)),-floor((260+random%3*20)*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2
ownpal = 1
vel = 10,0
sprpriority = 2

[state 1110]
type = Explod
trigger1 = AnimElem=6,>=0&&AnimElem=16,<0&&AnimElemNo(0)!=AnimElemNo(-1)&&random<350&&(var(10)!=[1,99])
id = 6281
anim = 6280
pos = -floor(80*const(size.xscale)),-floor((180+random%3*20)*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2
ownpal = 1
vel = 10,0
sprpriority = 2

[state 1110]
type = Explod
trigger1 = AnimElem=6,>=0&&AnimElem=16,<0&&AnimElemNo(0)!=AnimElemNo(-1)&&random<350&&(var(10)!=[1,99])
id = 6282
anim = 6280
pos = -floor(80*const(size.xscale)),-floor((100+random%3*20)*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2
ownpal = 1
vel = 10,0
sprpriority = 2

;~~~~飛び道具跳ね返し~~~~
[state 190]
type = Helper
trigger1 = animelemtime(6)>=0&&AnimElemTime(7)<0&&numHelper(11450)<1
trigger2 = animelemtime(7)>=0&&AnimElemTime(8)<0&&numHelper(11450)<2
trigger3 = animelemtime(8)>=0&&AnimElemTime(9)<0&&numHelper(11450)<3
trigger4 = animelemtime(9)>=0&&AnimElemTime(10)<0&&numHelper(11450)<1
trigger5 = animelemtime(10)>=0&&AnimElemTime(11)<0&&numHelper(11450)<2
trigger6 = animelemtime(11)>=0&&AnimElemTime(12)<0&&numHelper(11450)<3
trigger7 = animelemtime(12)>=0&&AnimElemTime(13)<0&&numHelper(11450)<1
trigger8 = animelemtime(13)>=0&&AnimElemTime(14)<0&&numHelper(11450)<2
trigger9 = animelemtime(14)>=0&&AnimElemTime(15)<0&&numHelper(11450)<3
id = 11450
stateno=11450
pos = 0,0
postype = p1
ownpal = 1
ignorehitpause=1

;飛び道具跳ね返し
[State 1000,Projectile]
type = Projectile
trigger1 =  animelemtime(6)>=0&&animelemtime(15)<0&&!(!numprojid(11460) && animelemtime(6)>0)&&!Numhelper(11460)&&!Numhelper(11470)&&!Numhelper(11480)
projanim = 11460
projID = 11460
projshadow = -1
velocity = 0, 0
projremovetime = 1
sprpriority = 5
; HitDefs
attr = S, SP
hitflag = P
getpower = 0,0
givepower = 0,0
ignorehitpause=1

;飛び道具跳ね返し
[State 1000,Projectile]
type = Projectile
trigger1 =  animelemtime(6)>=0&&animelemtime(15)<0&&!(!numprojid(11470) && animelemtime(6)>0)&&!Numhelper(11460)&&!Numhelper(11470)&&!Numhelper(11480)
projanim = 11470
projID = 11470
projshadow = -1
velocity = 0, 0
projremovetime = 1
sprpriority = 5
; HitDefs
attr = S, SP
hitflag = P
getpower = 0,0
givepower = 0,0
ignorehitpause=1

;飛び道具跳ね返し
[State 1000,Projectile]
type = Projectile
trigger1 =  animelemtime(6)>=0&&animelemtime(15)<0&&!(!numprojid(11480) && animelemtime(6)>0)&&!Numhelper(11460)&&!Numhelper(11470)&&!Numhelper(11480)
projanim = 11480
projID = 11480
projshadow = -1
velocity = 0, 0
projremovetime = 1
sprpriority = 5
; HitDefs
attr = S, SP
hitflag = P
getpower = 0,0
givepower = 0,0
ignorehitpause=1

;飛び道具跳ね返し
[state 1000]
type = Helper
trigger1 = animelemtime(6)>=0&&animelemtime(15)<0&&(!numprojid(11460)||!numprojid(11470)||!numprojid(11480))&&!Numhelper(11460)&&!Numhelper(11470)&&!Numhelper(11480)
stateno=11460
id = 11460+ifelse(!numprojid(11470),1,ifelse(!numprojid(11480),2,0))*10
name="shoot"
pos = floor(240*const(size.xscale)),-floor(ifelse(!numprojid(11470),140,ifelse(!numprojid(11480),80,200))*const(size.yscale))
postype = p1
ignorehitpause=1
persistent=0

;~~~~~~~~~~~~~~~~~

;相手押し返し
[state 1200]
type = helper
trigger1 = !NumHelper(6310)&&AnimElem=6
id = 6310
stateno= 6310
pos = floor(0*const(size.xscale)),-floor(0*const(size.xscale))
postype = p1
ownpal = 1
size.xscale = const(size.xscale)*ifelse(var(7),1.25,1.0)
size.yscale = const(size.yscale)*ifelse(var(7),1.25,1.0)
ignorehitpause=1
size.height = 240

;相手2用
[state 1200]
type = helper
triggerall = numenemy=2
trigger1 = !NumHelper(6311)&&AnimElem=6
id = 6311
stateno= 6310
pos = floor(0*const(size.xscale)),-floor(0*const(size.xscale))
postype = p1
ownpal = 1
size.xscale = const(size.xscale)*ifelse(var(7),1.25,1.0)
size.yscale = const(size.yscale)*ifelse(var(7),1.25,1.0)
ignorehitpause=1
size.height = 240

;ヒット数カウント
[state 190]
type = VarSet
trigger1 = !time
var(7) = 0

[state 190]
type = VarAdd
trigger1 = movecontact=1
var(7) = 1

[state 190]
type = MoveHitReset
triggerall = movecontact!=1
trigger1 = AnimElem=6
trigger2 = AnimElem=7
trigger3 = AnimElem=8
trigger4 = AnimElem=9
trigger5 = AnimElem=10
trigger6 = AnimElem=11
trigger7 = AnimElem=12
trigger8 = AnimElem=13
trigger9 = AnimElem=14
trigger10 = AnimElem=15

;終了
[state 900]
type = ChangeAnim
triggerall = AnimElemTime(10)>=0 && AnimElemTime(16)<0 && !(var(52)>2&&movecontact)
trigger1 = command!="hold_y"&&!var(59)
trigger2 = AnimElemNo(0)=AnimElemNo(3+random%3) && random%4=0 && var(59)
value = 1300
elem = 16

[state 900]
type = VarSet
trigger1 = AnimElem=16
var(52) = ifelse(var(52)=100,100,ifelse(var(52)>0,0,var(52)))

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 12

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&var(7)<6
trigger1 = AnimElemTime(6)>=0&&AnimElemTime(15)<0
damage = floor(floor(20*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4))*1.22),floor(ceil(20*fvar(3)*fvar(4)*1.0/4))
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+var(49)*6
ground.velocity = -4.0*const(size.xscale),(-4.0-.9)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0011,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-4.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.xvelocity = 1.5*ifelse(enemynear,facing!=facing,-1,1)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),34+ifelse(var(1)%4>=2,8,12),20-ifelse(floor(var(14)/75)>9,9,floor(var(14)/75))+ifelse(var(1)%4>=2,8,12))
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,4)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(20*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(20*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Hard
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = M

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(202*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=15
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(20*fvar(0)<1,1+(var(2)%5=4),20*fvar(0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(16) = 10
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=15,<0
var(17) = floor(ifelse(P2dist X>202*const(size.xscale),202*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=15,<0
var(18) = floor(-160*const(size.yscale))-floor(ifelse(floor(P2dist X)<(28+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(148*const(size.xscale)),20,(floor(P2dist X)-(20+enemynear,const(size.ground.front)))*.5)))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-6.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-12.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,12,14+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (11-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;拒め根の渦・陰
[statedef 1350]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1350

[state 190]
type = PlaySND
triggerall = movecontact!=1
trigger1 = AnimElem=6
trigger2 = AnimElem=10
trigger3 = AnimElem=14
value = 30,6
channel = 10

[state 190]
type = PlaySND
triggerall = movecontact!=1
trigger1 = AnimElem=8
trigger2 = AnimElem=12
value = 30,6
channel = 11

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=6
value = 10,44
channel = 1

[state 1110]
type = RemoveExplod
trigger1 = AnimElem=16,>=0
trigger2 = AnimElemNo(0)!=AnimElemNo(-1)
id = 6210

[state 1110]
type = Explod
trigger1 = AnimElem=6,>=0&&AnimElem=16,<0&&!numExplod(6210)
id = 6210
anim = 6210+ifelse(AnimElemNo(0)%2=0,5,0)
pos = floor(140*const(size.xscale)),-floor(190*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*3,const(size.yscale)*2
ownpal = 1
bindtime=-1
sprpriority = 2

;エフェクト2
[state 1110]
type = Explod
trigger1 = AnimElem=6,>=0&&AnimElem=16,<0&&AnimElemNo(0)!=AnimElemNo(-1)&&random<350&&(var(10)!=[1,99])
id = 6280
anim = 6280
pos = floor(400*const(size.xscale)),-floor((260+random%3*20)*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2
ownpal = 1
vel = -10,0
sprpriority = 2

[state 1110]
type = Explod
trigger1 = AnimElem=6,>=0&&AnimElem=16,<0&&AnimElemNo(0)!=AnimElemNo(-1)&&random<350&&(var(10)!=[1,99])
id = 6281
anim = 6280
pos = floor(400*const(size.xscale)),-floor((180+random%3*20)*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2
ownpal = 1
vel = -10,0
sprpriority = 2

[state 1110]
type = Explod
trigger1 = AnimElem=6,>=0&&AnimElem=16,<0&&AnimElemNo(0)!=AnimElemNo(-1)&&random<350&&(var(10)!=[1,99])
id = 6282
anim = 6280
pos = floor(400*const(size.xscale)),-floor((100+random%3*20)*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2
ownpal = 1
vel = -10,0
sprpriority = 2

;~~~~~~~
;引き寄せ判定
[state 1200]
type = helper
trigger1 = !NumHelper(6320)&&AnimElem=6
id = 6320
stateno= 6320
pos = floor(0*const(size.xscale)),-floor(0*const(size.xscale))
postype = p1
ownpal = 1
size.xscale = const(size.xscale)*ifelse(var(7),1.25,1.0)
size.yscale = const(size.yscale)*ifelse(var(7),1.25,1.0)
ignorehitpause=1
size.height = 240

;相手2用
[state 1200]
type = helper
triggerall = numenemy=2
trigger1 = !NumHelper(6321)&&AnimElem=6
id = 6321
stateno= 6320
pos = floor(0*const(size.xscale)),-floor(0*const(size.xscale))
postype = p1
ownpal = 1
size.xscale = const(size.xscale)*ifelse(var(7),1.25,1.0)
size.yscale = const(size.yscale)*ifelse(var(7),1.25,1.0)
ignorehitpause=1
size.height = 240

;ヒット数カウント
[state 190]
type = VarSet
trigger1 = !time
var(7) = 0

[state 190]
type = VarAdd
trigger1 = movecontact=1
var(7) = 1

[state 190]
type = MoveHitReset
triggerall = movecontact!=1
trigger1 = AnimElem=6
trigger2 = AnimElem=7
trigger3 = AnimElem=8
trigger4 = AnimElem=9
trigger5 = AnimElem=10
trigger6 = AnimElem=11
trigger7 = AnimElem=12
trigger8 = AnimElem=13
trigger9 = AnimElem=14
trigger10 = AnimElem=15

;終了
[state 900]
type = ChangeAnim
triggerall = AnimElemTime(10)>=0 && AnimElemTime(16)<0 && !(var(52)>2&&movecontact)
trigger1 = command!="hold_y"&&!var(59)
trigger2 = (var(7)>=6||(P2bodydist X>100&&random%5=0)) && var(59)
value = 1300
elem = 16

[state 900]
type = VarSet
trigger1 = AnimElem=16
var(52) = ifelse(var(52)=100,100,ifelse(var(52)>0,0,var(52)))

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 11

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&var(7)<6
trigger1 = AnimElemTime(6)>=0&&AnimElemTime(15)<0
damage = floor(floor(20*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4))*1.22),floor(ceil(20*fvar(3)*fvar(4)*1.0/4))
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,11+var(49)*6
ground.velocity = -4.0*const(size.xscale),(-4.0-.9)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0011,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-4.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.xvelocity = 1.5*ifelse(enemynear,facing!=facing,-1,1)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),34+ifelse(var(1)%4>=2,8,12),20-ifelse(floor(var(14)/75)>9,9,floor(var(14)/75))+ifelse(var(1)%4>=2,8,12))
fall.xvelocity = 0;-1.0*ifelse(enemynear,facing!=facing,-1,1)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,4)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.250*fvar(16))),floor(ifelse(var(9),0,ceil(20*fvar(0)/fvar(2)*1.0/8)*1.250*fvar(16)))
givepower = floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.250,floor(20*fvar(0)/fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Hard
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = M

[state 200]
type = AttackDist
trigger1 = AnimElem=1
value = floor(202*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = AnimElem=15
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(20*fvar(0)<1,1+(var(2)%5=4),20*fvar(0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(16) = 10
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=15,<0
var(17) = floor(ifelse(P2dist X>202*const(size.xscale),202*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=15,<0
var(18) = floor(-160*const(size.yscale))-floor(ifelse(floor(P2dist X)<(28+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(148*const(size.xscale)),20,(floor(P2dist X)-(20+enemynear,const(size.ground.front)))*.5)))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-6.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-12.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,12,14+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (11-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;押し合い判定
[statedef 6310]
type = S
movetype=I
physiscs = N
ctrl = 0
anim = 6310
sprpriority = 4

[state 6310]
type = VelSet
trigger1 = Time
x = 11.5

[state 6310]
type = PosFreeze
trigger1 = root,var(52)>0&&root,movecontact
value = 1

[state 6310]
type = NotHitBy
trigger1 = 1
value = SCA

[state 6310]
type = PlayerPush
trigger1 = 1
value = 1

[state 6310]
type = PosSet
trigger1 = !Time||p2dist X<0
x = floor(ifelse(ISHelper(6311),enemynear(numenemy-1),pos x,enemynear,pos x))-20*facing

[state 6310]
type = PosSet
trigger1 = 1
y = floor(ifelse(ISHelper(6311),enemynear(numenemy-1),pos y,enemynear,pos y))

[state 6310]
type = PosAdd
trigger1 = ifelse(ISHelper(6311),enemynear(numenemy-1),vel x,enemynear,vel x)>0
x = -floor(ifelse(ISHelper(6311),enemynear(numenemy-1),vel x,enemynear,vel x)*.5)

[state 6310]
type = ScreenBound
trigger1 = 1
value = 0

[state 6300]
type = DestroySelf
trigger1 = Root,Stateno!=1300
trigger2 = Root,Stateno=1300 && root,animelemTime(16)>=0

;押し合い判定
[statedef 6320]
type = S
movetype=I
physiscs = N
ctrl = 0
anim = 6310
sprpriority = 4

[state 6310]
type = VelSet
trigger1 = Time
x = -4.50

[state 6310]
type = PosFreeze
trigger1 = root,var(52)>0&&root,movecontact
trigger2 = Time>1&&rootDist X=[-40,40]
value = 1

[state 6310]
type = PosAdd
trigger1 = root,var(52)=1&&root,movecontact
x = ifelse(frontedgedist<=-15,frontedgedist+15,15)

[state 6310]
type = NotHitBy
trigger1 = 1
value = SCA

[state 6310]
type = PlayerPush
trigger1 = 1
value = 1

[state 6310]
type = PosSet
trigger1 = !Time
x = floor(ifelse(ISHelper(6321),enemynear(numenemy-1),pos x,enemynear,pos x))

[state 6310]
type = PosSet
trigger1 = 1
y = floor(ifelse(ISHelper(6321),enemynear(numenemy-1),pos y,enemynear,pos y))

[state 6310]
type = PosAdd
trigger1 = !Time
x = 20

[state 6310]
type = ScreenBound
trigger1 = 1
value = 0

[state 6300]
type = DestroySelf
trigger1 = Root,Stateno!=1350
trigger2 = Root,Stateno=1350 && root,animelemTime(16)>=0

;---------------------------------------------------------------------------
;飛び道具跳ね返し(Hitdef用)
[Statedef 11450]
type = A
movetype = A
physics = N
ctrl = 0
velset = 0,0
anim = 11450

[state 11450]
type = BindtoRoot
trigger1 = 0
pos = 0,0
time = 1

[state 11450]
type = ReversalDef
trigger1 = 1
pausetime = 1,1
reversal.attr = SCA,AP
sparkno = -1
p2stateno = 11455
p2facing = -1
numhits = 0
hitonce = 1
ignorehitpause=1

[state 11450]
type = ChangeState
trigger1 = numtarget
value = 11451

[state 11450]
type = DestroySelf
trigger1 = AnimTime=0||root,movetype=H||root,animelemtime(15)>=0
trigger1 = !numtarget

;反射飛び道具管理
[statedef 11451]
type = A
movetype = A
physics = N
ctrl = 0
anim = 90000

[state 11455]
type = VarSet
trigger1 = !time && numtarget
var(40) = target,id

;相手用飛び道具認識用
[state 6666]
type = HitDef
trigger1 = 1
attr = A,SP
ground.type = None
numhits = 0
guard.dist = 160
ignorehitpause = 1

;target維持
[state 6666]
type = ReversalDef
trigger1 = 1
attr = A,SP
reversal.attr = C,HT
numhits = 0
ground.type = None
ignorehitpause = 1

;相手用飛び道具速度認識用
[state 6666]
type = VelSet
trigger1 = numtarget
x = target,vel x
y = target,vel y
ignorehitpause = 1

;反射飛び道具に追従
[state 6666]
type = BindToTarget
trigger1 = numtarget
pos = 0,0
facing = 1
time = -1
ignorehitpause = 1

;ヒット・ガード効果音
[state 6666]
type = PlaySnd
trigger1 = numtarget
trigger1 = target,movecontact&&target,numtarget
value = s7000+(target,movehit>0)*100,1
ignorehitpause = 1
persistent = 0

[state 240]
type = poweradd
trigger1 = numtarget
trigger1 = target,movecontact&&target,numtarget
value = ceil(ifelse(target,movehit,50,50/8))
ignorehitpause = 1
persistent=0

;ヒットエフェクト種類
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10+random%6

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,20]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = 0

;ヒット・ガードエフェクト
[state 6666]
type = Helper
trigger1 = numtarget
trigger1 = target,movecontact&&target,numtarget
id = 7000
stateno=7000+(target,movehit>0)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5
ignorehitpause = 1
persistent = 0

;反射飛び道具が当たるか消滅により終了
[state 6666]
type = DestroySelf
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = target,stateno!=11455
trigger3 = time>20&&(frontedgebodydist<-20||backedgebodydist<-20)
ignorehitpause = 1

;飛び道具跳ね返し（相手飛び道具）
[Statedef 11455]
type = U
movetype = A
physics = N
ctrl = 0
velset = -vel x*1.5,vel y*1.5
movehitpersist = 0
hitcountpersist = 0
hitdefpersist = 0

[state 11455]
type = SelfState
trigger1 = !IsHelper
value = 5000

[state 11450]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AT
time = -1

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AP
slot = 0
stateno=11456
time = -1

[state 11455]
type = Hitdef
trigger1 = !movecontact && !movereversed
damage = 59,15
ground.slidetime = 14
ground.hittime = 14
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12
ground.velocity = -12
guard.velocity = -6
ground.cornerpush.veloff = 0
air.velocity = -5,-6
airguard.velocity = -3,-1
air.cornerpush.veloff = 0
yaccel = .45
fall.recover = 1
fall.recovertime = 16+12
hitsound = -1
guardsound = -1
getpower = 0,0
givepower = ceil(50*.8),ceil(50*.8/8)
air.fall = 1
sparkno = -1;3
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),0
animtype = hard
ground.type = High
attr = S,SP
hitflag = MAFDP
guardflag = MA
affectteam = F
guarddist = 0

[state 11455]
type = RemoveExplod
trigger1 = ScreenPos Y<0||ScreenPos Y>240||frontedgebodydist<-20||backedgebodydist<-20||(Vel Y>0 && Pos Y>=0 && time>20)
trigger2 = Vel X =0 && Vel Y =0 && time>60

[state 11455]
type = DestroySelf
trigger1 = ScreenPos Y<0||frontedgebodydist<-20||backedgebodydist<-20||(Vel Y>0 && Pos Y>=0 && time>20)
trigger2 = Vel X =0 && Vel Y =0 && time>60

[state 11455]
type = ChangeState
trigger1 = movecontact=2||movereversed=2
value = 11456

;飛び道具消滅
[statedef 11456]
type = A
movetype=I
physics = N
velset = 0,0

[state 11455]
type = NotHitBy
trigger1 = 1
value = SCA

[state 11450]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = RemoveExplod
trigger1 = !time

;反射飛び道具が当たるか消滅により終了
[state 6666]
type = hitadd
trigger1 = time=1
value = -1

[state 11455]
type = DestroySelf
trigger1 = time=1

;飛び道具跳ね返し(Proj)
[Statedef 11460]
type = A
movetype = A
physics = N
ctrl = 0
velset = 8,ifelse(IsHelper(11460),-4,0)
anim = 6415

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=11461
time = 1

;Attack Lv.3
[state 200]
type = Hitdef
trigger1 = 1
damage = floor(ifelse(49*root,fvar(0)<1,1+(root,var(2)%5=4),ceil(49*root,fvar(0)))*1.22),ceil(floor(49*root,fvar(0)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+root,var(49)*6
ground.velocity = -12.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.02)*const(size.xscale)
guard.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-11.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.1)-.0010,-10.0*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-13.0*(51-root,var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,2
guardsound = s7000,2
getpower = floor(ifelse(root,var(9),0,floor(55*root,fvar(1)*root,fvar(3))*1.250*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(55*root,fvar(3)*1.0/8)*1.250*root,fvar(16)))
givepower = floor(55*.8*root,fvar(1)*root,fvar(3))*1.250,floor(55*root,fvar(3)*.8*1.0/8)*1.250
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,SP
hitflag = MAFD
guardflag = MA

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget&&root,var(3)
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(49*root,fvar(0)<1,1+(root,var(2)%5=4),ceil(49*root,fvar(0)))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !(root,stateno=3120&&((root,AnimElemTime(7)>=0&&root,AnimElemTime(9)<0)||root,AnimElemTime(12)>=0&&root,AnimElemTime(14)<0||root,AnimElemTime(17)>=0&&root,AnimElemTime(19)<0)||root,AnimElemTime(22)>=0&&root,AnimElemTime(24)<0)
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state 11455]
type = DestroySelf
trigger1 = movecontact||ScreenPos Y<0||Pos Y>=-Vel Y||frontedgebodydist<=-20||backedgebodydist<=-20

;飛び道具消滅
[statedef 11461]
type = A
movetype=I
physics = N

[state 11455]
type = NotHitBy
trigger1 = 1
value = SCA

[state 11455]
type = DestroySelf
trigger1 = time

;ブースト(吹き飛ばし攻撃後)
[statedef 2000]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,ifelse(pos Y<0,vel Y,0)
anim = 2000

;ブーストエフェクト
[state 2000]
type = Helper
trigger1 = !time
id = 7720
stateno=7720
pos = 0,floor(-160*const(size.yscale))
postype = p1
pausemovetime=999
supermovetime=999
ownpal = 1
sprpriority = 2
ignorehitpause=1

[state 2000]
type = PlaySND
trigger1 = !time
value = 2000,0
volume = 255

[State 0, AfterImage]
type = AfterImage
trigger1 = !time
time=24
length = 5
palbright = 0,0,0
palcontrast = 256,256,256
palpostbright = -30,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 1
framegap = 2
trans = AddAlpha
alpha = 128,128

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = !time||(fvar(10)=[32,40])
time = 1
add = ifelse(fvar(10)<32,255,floor(fvar(10)-32)*32),ifelse(fvar(10)<32,255,floor(fvar(10)-32)*32),ifelse(fvar(10)<32,255,floor(fvar(10)-32)*32)

;ブースト
[state 2000]
type = varadd
trigger1 = !time
var(6) = 100*(!floor(var(6)%1000/100))+1000*(var(1)%2<1&&!floor(var(6)%10000/1000))

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = !time
var(9)=ifelse(var(9)>=10000,12000-floor(var(9)/100)*100,12000)

;ヒットバック0
[state 900]
type = VarSet
trigger1 = !time
fvar(5) = 0

[state 2000]
type = PosAdd
trigger1 = time=0
x = -13.0

[state 2000]
type = VelSet
trigger1 = time=0
x = 13.0
y = ifelse(vel Y<0,-4,0)

[state 2000]
type = StatetypeSet
trigger1 = Pos Y<0
statetype=A
physics = N

[state 2000]
type = StatetypeSet
trigger1 = Pos Y>=0
statetype=S
physics = N

[state 2000]
type = Gravity
trigger1 = time>=2&&statetype=A

;現在の速度
[state 2000]
type = VarSet
trigger1 = !time
fvar(8) = 0

;ブースト速度
[state 2000]
type = VarSet
trigger1 = !time
fvar(9) = 13.0

;ブースト時間
[state 2000]
type = VarSet
trigger1 = !time
fvar(10) = 40

[state 200]
type = VarAdd
trigger1 = !Time&&var(53)>2000
var(53) = -2000

[state 2000]
type = ChangeState
trigger1 = !time&&(var(53)=40||var(53)=50)
value = 40

[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 2000]
type = ChangeState
trigger1 = time>=4
trigger1 = !fvar(10)||(P2bodydist X<=0&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
trigger2 = time>=30
value = 0
ctrl = 1

;ガードキャンセル攻撃
[statedef 2500]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 2500
poweradd =-1000

;ガードゲージ減少
[state 2000]
type = VarAdd
trigger1 = Time=0
var(23)=ifelse(var(23)<=128,-var(23)+1,-128)

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = 1
var(9)=ifelse((var(9)=[1,999]),420-var(9),420)

[state 2000]
type = PalFX
trigger1 = Time=[0,7]
add = 255-32*time,255-32*time,255-32*time
time = 1

[state 900]
type = PlaySND
trigger1 = Time=0
value = 2500,0

[state 2000]
type = HitBy
trigger1 = Time=[0,13]
value = ,AT

[state 190]
type = PlaySND
trigger1 = AnimElemNo(2)=5&&AnimElemNo(1)=4
value = 7300,3
channel = 10

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElemNo(2)=5&&AnimElemNo(1)=4
value = 10,6
channel = 1

;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = AnimElem=5
damage = floor(ifelse(40*fvar(0)<1,1+(var(2)%5=4),40*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 15,14
ground.velocity = -18*const(size.xscale),-5*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -18*const(size.xscale),ifelse(var(6)%10>0,var(6)%10*1.5,-5*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.yvelocity = 0
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = High
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
kill = 0
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&hitpausetime=14
fvar(15) = .00005*floor(ifelse(40*fvar(14)<1,1+(var(2)%5=1),40*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(ifelse(P2dist X>244*const(size.xscale),244*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-120*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = (-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 2000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1


;集え根の夢
[statedef 3000]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = (prevstateno=[1000,1999])
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = (prevstateno=[1000,1999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = (prevstateno=[1000,1999])
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
triggerall = (Anim!=3000)
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3000
elem = ifelse(prevstateno=3050,4,1)

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = 1
var(9)=ifelse((var(9)=[1,999]),420-var(9),420)

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&(AnimElem=3||var(46)=6)&&prevstateno!=3050
value = ,AP
time=49

[state 200]
type = pause
trigger1 = !IsHelper&&(AnimElem=2,=2||var(46)=5)&&prevstateno!=3050
time = 49
movetime = 49

[state 200]
type = helper
trigger1 = !IsHelper&&(AnimElem=2,=2||var(46)=5)&&prevstateno!=3050
id = 7560
stateno = 7560
pos = floor(10*const(size.xscale)),-floor(160*const(size.yscale))
postype = P1
pausemovetime=49+999
ownpal = 1

[state -2]
type = poweradd
trigger1 = !IsHelper&&(AnimElem=3||var(46)=6)&&prevstateno!=3050
value = -1000
persistent=0

[state 5110]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&(AnimElem=3||var(46)=6)
value = 10,ifelse(random%2=0,70,46)
channel = 1

;KO
[state 3500]
type = explod
trigger1 = WinKO && !numexplod(60000)
id = 60000
anim = 90000
name="ko"
ownpal = 1
removetime=-1
facing=facing
ignorehitpause=1

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)&&var(46)
var(46) = 1

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=1&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[1,3]
value = 3000
elem = 1

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=2&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[4,6]
value = 3000
elem = 2

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=3&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[7,37]
value = 3000
elem = 3

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=4&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[38,40]
value = 3000
elem = 4

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=5&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[41,43]
value = 3000
elem = 5

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=6&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[44,46]
value = 3000
elem = 6

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=7&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[47,49]
value = 3000
elem = 7

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=8&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[50,52]
value = 3000
elem = 8

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=9&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[53,55]
value = 3000
elem = 9

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=10&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[56,58]
value = 3000
elem = 10

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=11&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[59,61]
value = 3000
elem = 11

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=12&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[62,64]
value = 3000
elem = 12

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=13&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[65,67]
value = 3000
elem = 13

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=14&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[68,71]
value = 3000
elem = 14

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=15&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[72,75]
value = 3000
elem = 15

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=16&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[76,79]
value = 3000
elem = 16

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=17&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[80,83]
value = 3000
elem = 17

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=18&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[84,87]
value = 3000
elem = 18

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=19&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[88,91]
value = 3000
elem = 19

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=20&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[92,95]
value = 3000
elem = 20

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=21&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[96,99]
value = 3000
elem = 21

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=22&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[100,103]
value = 3000
elem = 22

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=23&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[104,107]
value = 3000
elem = 23

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=24&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[108,111]
value = 3000
elem = 24

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=25&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[112,115]
value = 3000
elem = 25

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=26&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[116,119]
value = 3000
elem = 26

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=27&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[120,123]
value = 3000
elem = 27

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=28&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[124,127]
value = 3000
elem = 28

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=29&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[128,131]
value = 3000
elem = 29

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=30&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[132,135]
value = 3000
elem = 30

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=31&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[136,139]
value = 3000
elem = 31

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=32&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[140,143]
value = 3000
elem = 32

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=33&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[144,147]
value = 3000
elem = 33

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=34&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[148,151]
value = 3000
elem = 34

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=35&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[152,155]
value = 3000
elem = 35

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=36&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[156,159]
value = 3000
elem = 36

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=37&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[160,163]
value = 3000
elem = 37

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=38&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[164,167]
value = 3000
elem = 38

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=39&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[168,171]
value = 3000
elem = 39

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=40&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[172,175]
value = 3000
elem = 40

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=41&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[176,179]
value = 3000
elem = 41

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=42&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[180,183]
value = 3000
elem = 42

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=43&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=184
value = 3000
elem = 43

;経過時間
[state 1610]
type = varset
trigger1 = Time>=var(48)&&AnimElem=43,>=0
var(46) = 0

[state 1610]
type = null;ChangeAnim
trigger1 = Time<var(48) && (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = anim
elem = AnimElemNo(0)

[state 1610]
type = PosFreeze
trigger1 = Time<var(48) && (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = 1

;~~~~~

[state 1110]
type = Explod
trigger1 = !numexplod(6150) && AnimElem=3
id = 6150
anim = 6150
pos = 0,0
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
bindtime=-1
removetime=-1
pausemovetime=49

[state 1110]
type = Explod
trigger1 = !numexplod(6110) && AnimElem=2
id = 6110
anim = 6110
pos = 0,-floor(pos y)+floor(10*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
bindtime=-1
removetime=-1
pausemovetime=55

[state 1110]
type = ModifyExplod
trigger1 = time
id = 6110
pos = 0,-floor(pos y)+floor(10*const(size.yscale))
postype = P1

[state 1200]
type = StatetypeSet
trigger1 = AnimElem=4
statetype=A
physics = N

[state 1200]
type = VelSet
trigger1 = prevstateno!=3050&&AnimElem=4
x = 0
y = -4

[state 1200]
type = VelSet
trigger1 = AnimElem=9,>=0&&AnimElem=43,<0 && Time>=var(48)
x = .5+fvar(9)

[state 1200]
type = VarSet
trigger1 = prevstateno!=3050&&AnimElem=4
fvar(8) = 0

[state 1200]
type = VarSet
trigger1 = AnimElem=9&&AnimElem=43,<0 && Time>=var(48)
fvar(8) = .5

[state 1200]
type = VelAdd
trigger1 = prevstateno!=3050&&AnimElem=4,>0&&AnimElem=9,<0 && Time>=var(48)
y = .3

[state 1200]
type = StatetypeSet
trigger1 = AnimElem=43
movetype=I

[state 5110]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&(prevstateno!=[5000,5099])&&AnimElem=45
value = 10,71
channel = 1

[state 1200]
type = VelAdd
trigger1 = AnimElem=43,>0 && Time>=var(48)
y = .5

[state 1200]
type = VelSet
trigger1 = AnimElem=9
y = 0

[state 1200]
type = VelSet
trigger1 = AnimElem=43
x = 0

[state 1200]
type = VarSet
trigger1 = AnimElem=43
fvar(8) = 0

[state 1110]
type = RemoveExplod
trigger1 = AnimElem=43
id = 6150

[state 1110]
type = RemoveExplod
trigger1 = AnimElem=43
id = 6110

[state 1200]
type = PosSet
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
y = 0

[state 1200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
value = 3047

;上
[state 1200]
type = helper
trigger1 = !NumHelper(6530)&&AnimElem=9
trigger2 = !NumHelper(6530)&&AnimElem=22,>0&&AnimElem=30,<0
trigger3 = !NumHelper(6530)&&AnimElem=38,>0&&AnimElem=41,<0
id = 6530
stateno= 6530
pos = floor(70*const(size.xscale)),-floor(260*const(size.yscale))
postype = p1
ownpal = 1
size.xscale = const(size.xscale)
size.yscale = const(size.xscale)
ignorehitpause=1
pausemovetime=15

;左上
[state 1200]
type = helper
trigger1 = !NumHelper(6531)&&AnimElem=11
trigger2 = !NumHelper(6531)&&AnimElem=24,>0&&AnimElem=34,<0
id = 6531
stateno= 6530
pos = -floor(40*const(size.xscale)),-floor(200*const(size.yscale))
postype = p1
ownpal = 1
size.xscale = const(size.xscale)
size.yscale = const(size.xscale)
ignorehitpause=1
pausemovetime=15

;右下
[state 1200]
type = helper
trigger1 = !NumHelper(6532)&&AnimElem=13
trigger2 = !NumHelper(6532)&&AnimElem=26,>0&&AnimElem=36,<0
id = 6532
stateno= 6530
pos = floor(100*const(size.xscale)),-floor(60*const(size.yscale))
postype = p1
ownpal = 1
size.xscale = const(size.xscale)
size.yscale = const(size.xscale)
ignorehitpause=1
pausemovetime=15

;左下
[state 1200]
type = helper
trigger1 = !NumHelper(6533)&&AnimElem=15
trigger2 = !NumHelper(6533)&&AnimElem=28,>0&&AnimElem=38,<0
id = 6533
stateno= 6530
pos = -floor(70*const(size.xscale)),-floor(30*const(size.yscale))
postype = p1
ownpal = 1
size.xscale = const(size.xscale)
size.yscale = const(size.xscale)
ignorehitpause=1
pausemovetime=15

;下
[state 1200]
type = helper
trigger1 = !NumHelper(6534)&&AnimElem=17
trigger2 = !NumHelper(6534)&&AnimElem=30,>0&&AnimElem=40,<0
id = 6534
stateno= 6530
pos = floor(20*const(size.xscale)),floor(10*const(size.yscale))
postype = p1
ownpal = 1
size.xscale = const(size.xscale)
size.yscale = const(size.xscale)
ignorehitpause=1
pausemovetime=15

[state 200]
type = AttackDist
trigger1 = AnimElem=46
value = 0

;強制停止中に動かないように
[state -2]
type = PosFreeze
trigger1 = AnimElemTime(3)>=1&&AnimElemTime(4)<0
trigger2 = NumHelper(7560)
trigger2 = helper(7560),time<30
value = 1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&hitpausetime=14
fvar(15) = .00005*floor(4*fvar(14)*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1&&hitpausetime=14
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;集え根の夢(着地)
[statedef 3047]
type = S
movetype=I
physics = S
ctrl = 0
velset = 0,0
movehitpersist=1
anim = 3047

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;集え根の夢(空中)
[statedef 3050]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = (prevstateno=[1000,1999])
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = (prevstateno=[1000,1999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = (prevstateno=[1000,1999])
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3050

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = 1
var(9)=ifelse((var(9)=[1,999]),420-var(9),420)

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&(AnimElem=2||var(46)=3)
value = ,AP
time=49

[state 200]
type = pause
trigger1 = !IsHelper&&(AnimElem=1,=2||var(46)=2)
time = 49
movetime = 49

[state 200]
type = helper
trigger1 = !IsHelper&&(AnimElem=1,=2||var(46)=2)
id = 7560
stateno = 7560
pos = floor(10*const(size.xscale)),-floor(160*const(size.yscale))
postype = P1
pausemovetime=49+999
ownpal = 1

[state -2]
type = poweradd
trigger1 = !IsHelper&&(AnimElem=2||var(46)=3)
value = -1000
persistent=0

;KO
[state 3500]
type = explod
trigger1 = WinKO && !numexplod(60000)
id = 60000
anim = 90000
name="ko"
ownpal = 1
removetime=-1
facing=facing
ignorehitpause=1

[state 5110]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&(prevstateno!=[5000,5099])&&AnimElem=2&&!var(46)
value = 10,46
channel = 1

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)
var(46) = 1

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=1&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[1,3]
value = 3050
elem = 1

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=2&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[4,33]
value = 3050
elem = 2

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=3&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[34,37]
value = 3050
elem = 3

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=40&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=38
value = 3050
elem = 4

[state 1610]
type = null;ChangeAnim
trigger1 = Time<var(48) && (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = anim
elem = AnimElemNo(0)

[state 1610]
type = PosFreeze
trigger1 = Time<var(48) && (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = 1

;~~~~~

;ヒットバックリセット
[state 200]
type = VarSet
trigger1 = !Time
fvar(5) = 0

[state 1110]
type = Explod
trigger1 = !numexplod(6150) && AnimElem=2
id = 6150
anim = 6150
pos = 0,0
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
bindtime=-1
removetime=-1
pausemovetime=49

[state 1110]
type = Explod
trigger1 = !numexplod(6110) && AnimElem=2
id = 6110
anim = 6110
pos = 0,-floor(pos y)+floor(10*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
bindtime=-1
removetime=-1
pausemovetime=55

[state 1110]
type = ModifyExplod
trigger1 = time
id = 6110
pos = 0,-floor(pos y)+floor(10*const(size.yscale))
postype = P1

[state 1000]
type = ChangeState
trigger1 = animelem=4
value = 3000

;開け根の国（集え根の夢）
[Statedef 6530]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 90000
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 6050]
type = PosAdd
trigger1 = time&&fvar(5)!=root,pos x
x = (root,pos x-fvar(5))*facing

[state 6050]
type = VarSet
trigger1 = 1
fvar(5) = root,pos x;ifelse(root,pos x<0,ceil(root,pos x),floor(root,pos x))

[state 6050]
type = null;VelSet
trigger1 = 1
x = .5

[state 1110]
type = ChangeAnim
trigger1 = Time=3
value = 6530

[state 1110]
type = Explod
trigger1 = AnimElem=1
id = 6040
anim = 6040
pos = -floor(10*const(size.xscale)),-floor(10*const(size.yscale))
postype = P1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
bindtime=-1
sprpriority = 4

[state 1100]
type = ModifyExplod
trigger1 = Time<6||AnimTime>-6
id = 6040
scale = const(size.xscale)*(1.0-ifelse(time<6,6-time,6+animtime)*.15),const(size.yscale)*(1.0-ifelse(time<6,6-time,6+animtime)*.15)

[state 1100]
type = ModifyExplod
trigger1 = !(Time<6||AnimTime>-6)
id = 6040
scale = const(size.xscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05),const(size.yscale)*(1.0+(time%12<3)*.05+(time%12=[6,8])*.05)

[state 1400]
type = PlaySND
trigger1 = AnimElem=2
trigger2 = AnimElem=9
value = 7300,0
channel = 2

[state 1400]
type = PlaySND
trigger1 = AnimElem=2
trigger2 = AnimElem=9
value = 30,2
channel = 1

[state 250]
type = SprPriority
trigger1 = 1
value = 4

[state 250]
type = varset
trigger1 = !time
var(1) = 0

[state 250]
type = varadd
trigger1 = movecontact=1
var(1) = 1

[state 6500]
type = MoveHitReset
triggerall = movecontact!=1
trigger1 = AnimElem=2
trigger2 = AnimElem=5
trigger3 = AnimElem=8
trigger4 = AnimElem=12

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=2,>=0&&AnimElem=5,<0
trigger2 = AnimElem=5,>=0&&AnimElem=8,<0
trigger3 = AnimElem=8,>=0&&AnimElem=12,<0
trigger4 = AnimElem=12,>=0&&AnimElem=14,<0
damage = floor(floor(4*ifelse(root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)<.25,.25,root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)))*1.22),ceil(ceil(4*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,1+root,var(49)*7
ground.velocity = 1.0*const(size.xscale)/1.25,(-6.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -4.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = 1.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)/1.25,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-6.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = 0
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+3,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+3)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = floor(5*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(5*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = A,HP
hitflag = MAFD
guardflag = MA
sprpriority = 4
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed&&(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=2,>=0&&AnimElem=5,<0
trigger2 = AnimElem=5,>=0&&AnimElem=8,<0
trigger3 = AnimElem=8,>=0&&AnimElem=12,<0
trigger4 = AnimElem=12,>=0&&AnimElem=14,<0
damage = floor(floor(4*ifelse(root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)<.25,.25,root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)))*1.22),ceil(ceil(4*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,1+root,var(49)*7
ground.velocity = 1.0*const(size.xscale)/1.25,(-5.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -4.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.050)-.0003,ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-5.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = 0
fall.recovertime = ifelse(root,var(49)&&!root,var(2),37+3,20-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+3)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = floor(5*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(5*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = A,HP
hitflag = MAFD
guardflag = MA
sprpriority = 4
palfx.add = 96,16,80
palfx.sinadd = 96,16,80,32
palfx.time = ifelse(var(11)=0,480,0)

[state 6400]
type = AttackDist
trigger1 = AnimElem=1
value = floor(128*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=6
value = floor(144*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=7
value = floor(174*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=8
value = floor(220*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=11
value = floor(242*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=16
value = 0

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(4*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(ifelse(P2dist X>242*const(size.xscale),242*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(ifelse(P2dist Y>30*const(size.yscale),-50*const(size.yscale),ifelse(P2dist Y<-60*const(size.yscale),-180*const(size.yscale),-120*const(size.yscale)+floor(P2dist Y))))

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !(root,stateno=3120&&((root,AnimElemTime(7)>=0&&root,AnimElemTime(9)<0)||root,AnimElemTime(12)>=0&&root,AnimElemTime(14)<0||root,AnimElemTime(17)>=0&&root,AnimElemTime(19)<0)||root,AnimElemTime(22)>=0&&root,AnimElemTime(24)<0)
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;○○○○○
;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15902)&&IsHelper
trigger1 = time=1
id = 15902
stateno=15902
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15907)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15387)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = VarSet
trigger1 = 1
var(11) = 0
ignorehitpause=1

;■状態異常付加
[state -2]
type = Explod
trigger1 = movehit=1 && !var(11)
id   = 6760
anim = 6760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
scale = 1.0,1.0
facing=ifelse(facing=-1,-1,1)
sprpriority = 5
ignorehitpause=1

[state -2]
type = Explod
trigger1 = movehit=1 && !var(11)
id   = 6770
anim = 6770+ifelse(root,var(35)=9,0,ifelse(enemynear,selfanimexist(1010101)&&root,var(35)=3,10,root,var(35)))
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
scale = .5,.5
facing=ifelse(facing=-1,-1,1)
sprpriority = 5
ignorehitpause=1

[state -2]
type = VarAdd
triggerall = movehit=1 && numtarget
trigger1 = animelemtime(8)<0
var(11) = 1
ignorehitpause=1
persistent=0

[state -2]
type = VarAdd
triggerall = movehit=1 && numtarget
trigger1 = animelemtime(8)>=0
var(11) = 1
ignorehitpause=1
persistent=0

;■防御力1/2
[state -2]
type = AttackMulSet
trigger1 = root,numexplod(6792)
value = ifelse(enemynear,numpartner,1.5,2.0)
ignorehitpause=1

[state 11455]
type = RemoveExplod
trigger1 = AnimTime=0
trigger2 = root,movetype=H

[state 11455]
type = DestroySelf
trigger1 = AnimTime=0
trigger2 = root,movetype=H

;染れ緋の雨
[statedef 3100]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9),0),vel Y
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = (prevstateno=[1000,1999])
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = (prevstateno=[1000,1999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = (prevstateno=[1000,1999])
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time&&(prevstateno!=[5000,5099])

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
triggerall = Anim!=3100
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3100

[state 200]
type = VarSet
trigger1 = !IsHelper&&!Time
fvar(8) = 0

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = 1
var(9)=ifelse((var(9)=[1,999]),420-var(9),420)

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&((AnimElem=2,=0)||var(46)=5)&&Anim=3100
value = SCA
time=39

[state 200]
type = pause
trigger1 = !IsHelper&&((AnimElem=1,=4)||var(46)=4)&&Anim=3100
time = 40
movetime = 40

[state -2]
type = poweradd
trigger1 = !IsHelper&&((AnimElem=2,=0)||var(46)=5)&&Anim=3100
value = -1000
persistent=0

[state 200]
type = helper
trigger1 = !IsHelper&&((AnimElem=1,=4)||var(46)=4)&&Anim=3100
id = 7560
stateno = 7560
pos = -floor(46*const(size.xscale)),floor(-120*const(size.yscale))
postype = P1
pausemovetime=40+999
ownpal = 1

;KO
[state 3500]
type = explod
trigger1 = WinKO && !numexplod(60000)
id = 60000
anim = 90000
name="ko"
ownpal = 1
removetime=-1
facing=facing
ignorehitpause=1

[state 1100]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&((AnimElem=2,=0)||var(46)=5)&&Anim=3100
value = 10,47
channel = 1

;援軍アシスト
[state 3000]
type = VarSet
triggerall = (var(40)=1||(var(40)=[5,6]))&&Power>=1000&&animelemtime(2)>=0&&animelemtime(16)<0
trigger1 = command="a"&&!var(59)
var(40) = 7
ignorehitpause=1

;援軍アシスト
[state 3000]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&var(40)=7
value = 10,49
channel = 1

;援軍アタック・勝利(プレイヤーヘルパー削除時用)
[state -2]
type = Helper
triggerall = var(40)=7 && numhelper(10000) && !numhelper(11000)
triggerall = !(stateno=3000&&AnimElemTime(3)>=0&&AnimElemTime(10)<0)&&!(stateno=3050&&AnimElemTime(2)>=0&&AnimElemTime(10)<0)&&!(stateno=3100&&AnimElemTime(2)>=0&&AnimElemTime(5)<0)&&!(stateno=3500&&AnimElemTime(3)>=1&&AnimElemTime(11)<0)
trigger1 = (var(40)=[5,9])
name="Nagamasa"
id = 11000
stateno = 11000
pos = floor(helper(10000),pos x-pos x)*ifelse(helper(10000),facing!=facing,-1,1)*ifelse(teamside=2,-1,1),-floor(Pos Y)
postype = p1
ownpal = 1
size.xscale = const(size.xscale)
size.yscale = const(size.yscale)
size.ground.fwd = 20
size.ground.back = 20
size.head.pos = -10,-80
size.mid.pos = -5,-50
facing = helper(10000),facing
ignorehitpause=1
pausemovetime=ifelse(var(40)=7,99,14)

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)&&!(var(52)>0&&movecontact)&&var(46)
var(46) = 1

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = statetypeset
trigger1 = !time&&pos Y<0
statetype = A
physics = N

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=1&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[1,5]
value = 3100
elem = 1

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=2&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[6,38]
value = 3100
elem = 2

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=3&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[39,41]
value = 3100
elem = 3

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=4&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[42,44]
value = 3100
elem = 4

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=5&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[45,46]
value = 3100
elem = 5

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=6&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[47,48]
value = 3100
elem = 6

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=7&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[49,50]
value = 3100
elem = 7

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=8&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[51,52]
value = 3100
elem = 8

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=9&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[53,54]
value = 3100
elem = 9

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=10&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[55,56]
value = 3100
elem = 10

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=11&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[57,59]
value = 3100
elem = 11

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=12&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[60,61]
value = 3100
elem = 12

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=13&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[62,63]
value = 3100
elem = 13

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=14&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[64,65]
value = 3100
elem = 14

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=15&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[66,67]
value = 3100
elem = 15

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=16&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[68,69]
value = 3100
elem = 16

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=17&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[70,71]
value = 3100
elem = 17

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=18&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[72,73]
value = 3100
elem = 18

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=19&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[74,75]
value = 3100
elem = 19

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=20&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[76,77]
value = 3100
elem = 20

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=21&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[78,79]
value = 3100
elem = 21

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=22&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[80,81]
value = 3100
elem = 22

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=23&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[82,83]
value = 3100
elem = 23

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=24&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[84,85]
value = 3100
elem = 24

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=25&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[86,87]
value = 3100
elem = 25

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=26&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[88,89]
value = 3100
elem = 26

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=27&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[90,91]
value = 3100
elem = 27

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=28&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[92,93]
value = 3100
elem = 28

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=29&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[94,95]
value = 3100
elem = 29

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=30&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[96,97]
value = 3100
elem = 30

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=31&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[98,99]
value = 3100
elem = 31

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=32&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[100,101]
value = 3100
elem = 32

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=33&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[102,103]
value = 3100
elem = 33

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=34&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[104,105]
value = 3100
elem = 34

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=35&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[106,107]
value = 3100
elem = 35

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=36&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[108,109]
value = 3100
elem = 36

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=37&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[110,111]
value = 3100
elem = 37

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=38&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=112
value = 3100
elem = 38

;経過時間
[state 1610]
type = varset
trigger1 = Time>=var(48)&&AnimElem=39,>=0
var(46) = 0

[state 1610]
type = null;ChangeAnim
trigger1 = Time<var(48) && (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = anim
elem = AnimElemNo(0)

[state 1610]
type = PosFreeze
trigger1 = Time<var(48) && (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = 1

;~~~~~~~~
[state 3100]
type = NotHitBy
trigger1 = AnimElemTime(2)<0&&Anim=3100
value = SCA

[state 190]
type = PlaySND
triggerall = movecontact!=1
trigger1 = AnimElem=5
trigger2 = AnimElem=13
trigger3 = AnimElem=29
trigger4 = AnimElem=32
trigger5 = AnimElem=35
trigger6 = AnimElem=38
value = 30,9
channel = 10


[state 1110]
type = RemoveExplod
triggerall = (Var(52)<=0||var(52)=100)&&movecontact!=1
trigger1 = AnimElem=5,=0
trigger2 = AnimElem=6,=0
trigger3 = AnimElem=7,=0
trigger4 = AnimElem=8,=0
trigger5 = AnimElem=14,=0
trigger6 = AnimElem=15,=0
trigger7 = AnimElem=16,>=0&&AnimElem=29,<0
trigger8 = AnimElem=29,>=0&&AnimElemTime(AnimElemNo(0))=0
trigger9 = animelem=40
id = 6250

[state 1110]
type = RemoveExplod
triggerall = (Var(52)<=0||var(52)=100)&&movecontact!=1
trigger1 = AnimElem=29,>=0&&AnimElemTime(AnimElemNo(0))=0
trigger2 = animelem=40
id = 6260

[state 1110]
type = Explod
triggerall = !numExplod(6250)
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
trigger2 = AnimElem=13,>=0&&AnimElem=14,<0
id = 6250
anim = 6250
pos = floor(60*const(size.xscale)),-floor(160*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
ownpal = 1
removetime=-1
bindtime=-1
sprpriority = 2

[state 1110]
type = Explod
triggerall = !numExplod(6250)
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
trigger2 = AnimElem=14,>=0&&AnimElem=15,<0
id = 6250
anim = 6251
pos = floor(100*const(size.xscale)),-floor(160*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
ownpal = 1
removetime=-1
bindtime=-1
sprpriority = 2

[state 1110]
type = Explod
triggerall = !numExplod(6250)
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
trigger2 = AnimElem=15,>=0&&AnimElem=16,<0
id = 6250
anim = 6252
pos = floor(80*const(size.xscale)),-floor(160*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
ownpal = 1
removetime=-1
bindtime=-1
sprpriority = 2


[state 1110]
type = Explod
triggerall = !numExplod(6260)
trigger1 = AnimElem=29,>=0&&AnimElem=30,<0
trigger2 = AnimElem=32,>=0&&AnimElem=33,<0
trigger3 = AnimElem=35,>=0&&AnimElem=36,<0
trigger4 = AnimElem=38,>=0&&AnimElem=39,<0
trigger5 = AnimElem=31,>=0&&AnimElem=32,<0
trigger6 = AnimElem=37,>=0&&AnimElem=38,<0
id = 6250
anim = 6251
pos = floor(160*const(size.xscale)),-floor(160*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*1.75,const(size.yscale)*1.75
ownpal = 1
removetime=-1
bindtime=-1
sprpriority = 2

[state 1110]
type = Explod
triggerall = !numExplod(6260)
trigger1 = AnimElem=29,>=0&&AnimElem=30,<0
trigger2 = AnimElem=32,>=0&&AnimElem=33,<0
trigger3 = AnimElem=35,>=0&&AnimElem=36,<0
trigger4 = AnimElem=38,>=0&&AnimElem=39,<0
trigger5 = AnimElem=31,>=0&&AnimElem=32,<0
trigger6 = AnimElem=37,>=0&&AnimElem=38,<0
id = 6260
anim = 6260
pos = floor(0*const(size.xscale)),-floor(160*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*1.75,const(size.yscale)*1.75
ownpal = 1
removetime=-1
bindtime=-1
sprpriority = 2

[state 1110]
type = Explod
triggerall = !numExplod(6260)
trigger1 = AnimElem=30,>=0&&AnimElem=31,<0
trigger2 = AnimElem=34,>=0&&AnimElem=35,<0
trigger3 = AnimElem=36,>=0&&AnimElem=37,<0
id = 6250
anim = 6252
pos = floor(-40*const(size.xscale)),-floor(180*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*1.75,const(size.yscale)*1.75
ownpal = 1
removetime=-1
bindtime=-1
sprpriority = 2
facing=-1

[state 1110]
type = Explod
triggerall = !numExplod(6260)
trigger1 = AnimElem=30,>=0&&AnimElem=31,<0
trigger2 = AnimElem=34,>=0&&AnimElem=35,<0
trigger3 = AnimElem=36,>=0&&AnimElem=37,<0
id = 6260
anim = 6261
pos = floor(40*const(size.xscale)),-floor(150*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*1.75,const(size.yscale)*1.75
ownpal = 1
removetime=-1
bindtime=-1
sprpriority = 2
facing=-1

[state 1110]
type = Explod
triggerall = !numExplod(6260)
trigger1 = AnimElem=33,>=0&&AnimElem=34,<0
id = 6250
anim = 6252
pos = floor(120*const(size.xscale)),-floor(160*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*1.75,const(size.yscale)*1.75
ownpal = 1
removetime=-1
bindtime=-1
sprpriority = 2

[state 1110]
type = Explod
triggerall = !numExplod(6260)
trigger1 = AnimElem=33,>=0&&AnimElem=34,<0
id = 6260
anim = 6261
pos = floor(20*const(size.xscale)),-floor(120*const(size.yscale))
postype = P1
removeongethit=1
ignorehitpause=1
scale = const(size.xscale)*1.75,const(size.yscale)*1.75
ownpal = 1
removetime=-1
bindtime=-1
sprpriority = 2

[state 190]
type = Explod
trigger1 = AnimElem=5
trigger2 = AnimElem=13
id = 6915
anim = 6915
pos = floor(-40*const(size.xscale)),0
postype = P1
ownpal = 1
sprpriority = 3
bindtime=1
scale = const(size.xscale),const(size.yscale)

[state 190]
type = Explod
trigger1 = AnimElem=5
trigger2 = AnimElem=13
id = 6915
anim = 6915
pos = floor(40*const(size.xscale)),0
postype = P1
ownpal = 1
sprpriority = 3
bindtime=1
facing=-1
scale = const(size.xscale),const(size.yscale)

[state 3100]
type = PosAdd
triggerall = Anim=3100
trigger1 = AnimElem=3
trigger2 = AnimElem=12
x = floor(40*const(size.xscale))

[state 3100]
type = PosAdd
triggerall = Anim=3100
trigger1 = AnimElem=42
x = -floor(40*const(size.xscale))

[state 3100]
type = VelSet
triggerall = Anim=3100
trigger1 = AnimElem=3&&Statetype=S
trigger2 = AnimElem=11&&Statetype=S
x = ifelse((AnimElem=11),1.0,2.0)

[state 3100]
type = VarSet
triggerall = Anim=3100
trigger1 = AnimElem=3&&Statetype=S
trigger2 = AnimElem=11&&Statetype=S
fvar(8) = ifelse((AnimElem=11),1.0,2.0)

[state 3100]
type = VelSet
triggerall = Anim=3100
trigger1 = AnimElem=8&&Statetype=S
trigger2 = AnimElem=16&&Statetype=S
x = 0

[state 3100]
type = VarSet
triggerall = Anim=3100
trigger1 = AnimElem=8&&Statetype=S
trigger2 = AnimElem=16&&Statetype=S
fvar(8) = 0

[state 3100]
type = StatetypeSet
trigger1 = AnimElem=27
statetype = A
physiscs = N

[state 3100]
type = VelSet
trigger1 = (AnimElem=27,=1||var(46)=91)&&Statetype=A
x = 4.0
y = -10.0

[state 3100]
type = VelAdd
trigger1 = (AnimElem=27,>1||var(46)>=92)&&Statetype=A&&!(var(52)>0&&movecontact)&&time>=var(48)
y = .4

[state 3100]
type = VarSet
trigger1 = AnimElem=27&&Statetype=A
fvar(8) = 2.0

[state 3100]
type = StatetypeSet
trigger1 = AnimElem=27,>1&&Statetype=A&&Vel Y>0 && Pos Y>=-Vel Y
statetype=S
physics = S

[state 3100]
type = VarSet
trigger1 = AnimElem=27,>0&&Vel Y>0
fvar(8) = 0

[state 3100]
type = VarSet
trigger1 = AnimElem=27,>0&&Statetype=S
fvar(8) = 0

[state 3100]
type = VelSet
trigger1 = AnimElem=27,>0&&Statetype=S
x = 0
y = 0

[state 3100]
type = PosSet
trigger1 = AnimElem=27,>0&&Statetype=S
y = 0

[state 3100]
type = ChangeAnim
trigger1 = AnimElem=27,>0&&Statetype=S
value = 3147

[state 3100]
type = VelSet
trigger1 = !fvar(9) && !(fvar(5)&&!fvar(7)&&(enemynear,frontedgebodydist<=5||enemynear,backedgebodydist<=5))
x = fvar(8)

[state 190]
type = MoveHitReset
triggerall = movecontact!=1&&(var(52)<=0||var(52)=100)
trigger1 = AnimElem=5
trigger2 = AnimElem=7
trigger3 = AnimElem=13
trigger4 = AnimElem=15
trigger5 = AnimElem=29
trigger6 = AnimElem=32
trigger7 = AnimElem=35
trigger8 = AnimElem=38

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&(prevstateno!=[5000,5099])
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0&&time>=var(48)
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 4

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;>>>>>>>>>>><<<<<<<<<<<

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=5,>=0&&AnimElem=7,<0
trigger2 = AnimElem=7,>=0&&AnimElem=8,<0
trigger3 = AnimElem=13,>=0&&AnimElem=15,<0
damage = floor(30*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*1.22),floor(ceil(30*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.hittime = 18
pausetime = 1,3+var(49)*7
ground.velocity = 0
guard.veloctiy = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-4.0*(51-var(3))/51-.9)*const(size.yscale))
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = 0,0
givepower = 0,0
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = M

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=15,>=0&&AnimElem=16,<0
damage = floor(30*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*1.22),floor(ceil(30*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.hittime = 18
pausetime = 1,3+var(49)*7
ground.velocity = -2.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale),(-15-.9)*const(size.yscale)
guard.veloctiy = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -2.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale),ifelse(var(6)%10>0,var(6)%10*1.5,(-15.0-.9)*const(size.yscale))
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = M

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=29,>=0&&AnimElem=32,<0
trigger2 = AnimElem=32,>=0&&AnimElem=35,<0
trigger3 = AnimElem=35,>=0&&AnimElem=38,<0
trigger4 = AnimElem=38,>=0&&AnimElem=39,<0
damage = floor(30*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*1.22),floor(ceil(30*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.hittime = 18
pausetime = 1,3+var(49)*7
ground.velocity = -1.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale),(-16-.9)*const(size.yscale)
guard.veloctiy = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-8.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-1.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-16.0*(51-var(3))/51-.9)*const(size.yscale))
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = up
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = M

[state 200]
type = AttackDist
trigger1 = AnimElem=39
value = 0

[state 200]
type = StatetypeSet
trigger1 = AnimElem=39
movetype = I

;強制停止中に動かないように
[state -2]
type = PosFreeze
trigger1 = AnimElemTime(2)>=0&&AnimElemTime(2)<30
trigger2 = NumHelper(7560)
trigger2 = helper(7560),time<30
value = 1

;==壁ダウン解除
[state 920]
type = targetstate
trigger1 = movehit=1 && numtarget && var(6)%10=0 && animelemtime(15)>=0 && animelemtime(16)<0 && var(1)%2>=1
trigger1 = target,time=0
value = 5020
ignorehitpause=1
persistent=0

;==壁ダウン解除
[state 920]
type = varadd
trigger1 = movehit=1 && numtarget && var(6)%10=0 && animelemtime(15)>=0 && animelemtime(16)<0 && var(1)%2>=1
trigger1 = target,time=0
var(1) = -1-(var(1)%16>=8&&var(1)%8>=4)*4
ignorehitpause=1
persistent=0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(30*fvar(14)*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 10
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
trigger2 = AnimElem=13,>=0&&AnimElem=14,<0
var(17) = floor(ifelse(P2dist X>158*const(size.xscale),158*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=8,<0
trigger2 = AnimElem=14,>=0&&AnimElem=16,<0
var(17) = floor(ifelse(P2dist X>168*const(size.xscale),168*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
trigger2 = AnimElem=13,>=0&&AnimElem=14,<0
var(18) = floor(-140*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=8,<0
trigger2 = AnimElem=14,>=0&&AnimElem=16,<0
var(18) = floor(-160*const(size.yscale))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=29,>=0&&AnimElem=38,<0
trigger2 = AnimElem=38,>=0&&AnimElem=39,<0
var(17) = floor(ifelse(P2dist X>198*const(size.xscale),198*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=29,>=0&&AnimElem=38,<0
trigger2 = AnimElem=38,>=0&&AnimElem=39,<0
var(18) = floor(-160*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,1+(var(1)%2>=1||var(1)%8>=4)])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(movehit&&animelemtime(15)<0,0,ifelse(((var(3)&&target,statetype=A)||(movehit&&AnimElemTime(29)>=0)),-4.0*ifelse(var(6)%10>1,2,1)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060)))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (4-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;至れ死の淵
[statedef 3500]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0,0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3500

;一撃BASARA技使用不能時間
[state 195]
type = VarSet
trigger1 = !Time
var(45) = -1

[state 200]
type = pause
trigger1 = Anim=3500&&!IsHelper&&AnimElem=3,=1
time = 60
movetime = 60

[state 200]
type = NotHitBy
trigger1 = Anim=3500&&P2movetype=A&&inguarddist&&(prevstateno!=[5000,5099])&&!IsHelper&&AnimElem=3,=1
value = ,AP
time=60

[state 200]
type = helper
trigger1 = Anim=3500&&!IsHelper&&AnimElem=4
id = 7580
stateno = 7580
pos = 0,0
postype = P1
pausemovetime=68+999

[state 190]
type = PlayerPush
trigger1 = 1
value = 0

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = (!var(10)||var(10)>=1000)&&Anim=3500&&AnimElem=4
value = 10,48
channel = 1

[state 190]
type = PlaySND
trigger1 = Anim=3500&&AnimElem=14
value = 30,10
channel = 10
volume = 192

[state 3510]
type = StatetypeSet
trigger1 = Anim=3500&&AnimElem=15
physics = N

[state 3510]
type = ScreenBound
trigger1 = Anim=3500&&AnimElem=15,>=0&&AnimElem=16,<0
value = 1

[state 3510]
type = PosAdd
trigger1 = Anim=3500&&AnimElem=15
x = floor(90*const(size.xscale)*1.25)+ifelse(frontedgebodydist<floor(230*const(size.xscale)*1.25),frontedgebodydist-floor(230*const(size.xscale)*1.25),floor(40*const(size.xscale)))
y = -floor(200*const(size.yscale)*1.25)
persistent=0

[state 3510]
type = PosAdd
trigger1 = Anim=3500&&AnimElem=16
x = floor(40*const(size.xscale)*1.25)
y = -floor(40*const(size.yscale)*1.25)
persistent=0

[state 3510]
type = PosAdd
trigger1 = Anim=3500&&AnimElem=17
x = floor(100*const(size.xscale)*1.25)
y = floor(100*const(size.yscale)*1.25)
persistent=0

[state 3510]
type = StatetypeSet
trigger1 = Anim=3500&&AnimElem=18
statetype=S
physics = S
persistent=0

[state 3510]
type = PosSet
trigger1 = Anim=3500&&AnimElem=18
y = 0
persistent=0

[state 3510]
type = VelSet
trigger1 = Anim=3500&&AnimElem=18
x = 0
y = 0
persistent=0

[state 3510]
type = ChangeAnim
trigger1 = Anim=3500&&AnimTime=0&&Roundstate<3
value = 3550

;~~魔の手

[state 1400]
type = Explod
trigger1 = Anim=3500&&AnimElem=1
id = 6580
anim=6580
pos = floor(40*const(size.xscale)),floor(80*const(size.xscale))
postype = p1
ignorehitpause=1
ownpal = 1
scale = const(size.xscale)*1.25,const(size.yscale)*1.25
removeongethit=1
bindtime=-1
persistent=0
pausemovetime=74

[state 1400]
type = Explod
trigger1 = Anim=3500&&AnimElem=1
id = 6580
anim=6580
pos = floor(40*const(size.xscale))+1,floor(80*const(size.xscale))
postype = p1
ignorehitpause=1
ownpal = 1
facing=-1
scale = const(size.xscale)*1.25,const(size.yscale)*1.25
removeongethit=1
bindtime=-1
persistent=0
pausemovetime=74


[state 1400]
type = Helper
trigger1 = Anim=3500&&AnimElem=14
id = 6590
stateno=6590
pos = floor(40*const(size.xscale)),floor(80*const(size.xscale))
postype = p1
ignorehitpause=1
ownpal = 1
size.xscale = const(size.xscale)*1.25
size.yscale = const(size.yscale)*1.25
persistent=0
;~~

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = var(7)<=1&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0&&var(52)<100
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6590)
trigger1 = helper(6590),movecontact=2
var(19) = 25-1

;LV.4
[state 250]
type = varset
trigger1 = numhelper(6590)
trigger1 = helper(6590),movecontact=2
var(52) = 25-1

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

[state 200]
type = AttackDist
trigger1 = Anim=3500&&AnimElem=1
value = floor(146*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 200]
type = AttackDist
trigger1 = Anim=3500&&AnimElem=18
value = 0

;強制停止中に動かないように
[state -2]
type = PosFreeze
trigger1 = (AnimElem=3,=1)
trigger2 = NumHelper(7580)
trigger2 = helper(7580),time<30
value = 1


;~~~~一撃BASARA技成功後
[state 195]
type = VarSet
trigger1 = numhelper(6590)
trigger1 = helper(6590),Movehit=2
trigger1 = helper(6590),animelemtime(9)>=0
var(45) = 10000
ignorehitpause=1
persistent=0

[state 801]
type = AssertSpecial
trigger1 = var(45) = 10000
flag = NoMusic
flag2 = TimerFreeze

[state 801]
type = PlaySND
trigger1 = var(45) = 10000
value = 7900,0
loop = 1
channel = 30
lowpriority = 1
persistent=0

[state 3500]
type = NotHitBy
triggerall = roundstate=2
trigger1 = var(45) = 10000
value = SCA
ignorehitpause=1

;ヒット後の演出へ
[state 3500]
type = Pause
triggerall = roundstate=2
trigger1 = var(45) = 10000
time = 0
movetime=0

;ヒット後の演出へ
[state 3500]
type = ChangeState
triggerall = roundstate>=3
trigger1 = Anim=3500&&AnimTime=0
value = 182

[state 195]
type = ChangeAnim
trigger1 = Anim=3500 && AnimElemTime(16)>0 && NumHelper(6590)
trigger1 = Helper(6590),var(5)=1&&Helper(6590),time<420&&Helper(6590),stateno=6592
value = 3500
elem = 16

[state 195]
type = ChangeAnim
trigger1 = Anim=3500 && AnimElemTime(16)>=0 && NumHelper(6590)
trigger1 = Helper(6590),var(5)=1&&(Helper(6590),time=[420,466])&&Helper(6590),stateno=6592
value = 3500
elem = 18

[state 195]
type = PosSet
trigger1 = Anim=3500 && AnimElemTime(18)>0 && NumHelper(6590)
trigger1 = Helper(6590),stateno=6592&&Helper(6590),time>=466
x = floor(Helper(6590),pos x)
persistent=0

[state 195]
type = PosAdd
trigger1 = Anim=3500 && AnimElemTime(18)>0 && NumHelper(6590)
trigger1 = Helper(6590),stateno=6592&&Helper(6590),time>=466
x = floor(40*const(size.xscale))
persistent=0

;BASARA K.O.
[state 3510]
type = Helper
trigger1 = Anim=3500 && AnimElem=17,>=0 && numhelper(6590) && !numhelper(8850)
trigger1 = helper(6590),var(5)!=1||helper(6590),stateno=6592
id  = 8850
stateno=8850
pos = 0,0
postype = left
size.xscale = 1
size.yscale = 1
persistent=0
ignorehitpause=1
pausemovetime=999

[state 195]
type = ChangeAnim
trigger1 = Anim=3500 && AnimTime=0
value = 3550

[state 195]
type = AttackDist
trigger1 = Anim=3550 && AnimElem=1
value = 0

[state 195]
type = ChangeState
trigger1 = Anim=3550 && AnimTime=0
value = 0
ctrl = 1

;開け根の国（至れ死の淵）
[Statedef 6590]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 6590
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 11455]
type = NotHitBy
trigger1 = 1
value = ,AA,AT,AP

[state 11455]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
slot = 0
stateno=6490
time = 1

[state 1400]
type = PlaySND
trigger1 = AnimElem=1
value = 30,2
channel = 1

[state 1400]
type = PlaySND
trigger1 = AnimElem=10
value = 5100,1

[state 1400]
type = PosAdd
trigger1 = AnimElem=7
x = ifelse(root,frontedgebodydist<floor(230*root,const(size.xscale)*1.25),root,frontedgebodydist-floor(230*root,const(size.xscale)*1.25),0)
persistent=0

[state 6500]
type = MoveHitReset
triggerall = movecontact!=1
trigger1 = AnimElem=1
trigger2 = AnimElem=9

[State 40, 1]
type = Helper
trigger1 = AnimElem=10
id = 6925
stateno = 6920
pos = floor(260*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999


;ランダムオリジナル演出
[state 6500]
type = VarSet
trigger1 = !time
var(5) = random%3

[state 6500]
type = VarSet
trigger1 = !time&&var(5)=2
var(5) = 0

;ランダムオリジナル演出
[state 6500]
type = ParentVarSet
trigger1 = time&&movehit=1&&var(5)=1&&AnimElem=9,>=0
var(45) = 10000

;ランダムオリジナル演出
[state 6500]
type = ChangeState
trigger1 = time&&movehit=1&&var(5)=1&&AnimElem=9,>=0
value = 6592

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&var(52)<=0
var(52) = 100

[state 250]
type = varadd
trigger1 = var(52)>=0
var(52) = -1

;LV.4
[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 25

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=1
damage = floor(floor(57*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,25+root,var(49)*7
ground.velocity = -2.0*const(size.xscale)/1.25,(-4.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25
guard.velocity = -13.5*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -2.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale),ifelse(root,var(6)%10>0,root,var(6)%10*1.5,(-4.0*(51-root,var(3))/51-.9)*const(size.yscale)/1.25)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .09*const(size.yscale)/1.25
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0||1,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),107+25,90-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+25)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = floor(55*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(55*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = S,HP
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = !var(5)
trigger1 = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=9
damage = 999999
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,25+root,var(49)*7
ground.velocity = -3.0*const(size.xscale)/1.25,12.0
guard.velocity = -18.0*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -3.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale),ifelse(root,var(6)%10>0,root,var(6)%10*1.5,12.0)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = 0;ifelse(root,var(6)%10>0||root,var(28)>0||1,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),107+25,90-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+25)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = floor(60*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(60*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = A,HP
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = var(5)
trigger1 = !movecontact&&!movereversed&&!(root,var(1)%8>=4||root,var(1)%2>=1)
trigger1 = AnimElem=9
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,25+root,var(49)*7
ground.velocity = -3.0*const(size.xscale)/1.25,9.0
guard.velocity = -18.0*const(size.xscale)/1.25
ground.cornerpush.veloff = 0
air.velocity = -3.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale),ifelse(root,var(6)%10>0,root,var(6)%10*1.5,9.0)
airguard.velocity = -6*const(size.xscale)/1.25,-2*const(size.yscale)/1.25
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/1.25
fall.recover = 0;ifelse(root,var(6)%10>0||root,var(28)>0||1,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),107+25,90-ifelse(floor(root,var(14)/60)>9,9,floor(root,var(14)/60))+25)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = floor(60*ifelse(root,var(1)%4>=2,.5,1.0)*root,fvar(0)/root,fvar(2)*.8)*1.250,floor(60*root,fvar(0)/root,fvar(2)*.8*1.0/8)*1.250
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = A,HP
hitflag = MAFD
guardflag = MA
p2stateno=3517

[state 6400]
type = AttackDist
trigger1 = AnimElem=1
value = floor(156*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=8
value = floor(324*const(size.xscale))+40+enemynear,const(size.ground.front)

[state 6400]
type = AttackDist
trigger1 = AnimElem=10
value = 0

;壁コンボ引き剥がし
[state 12000]
type = ParentVarSet
trigger1 = movehit=1
var(1) = (var(1)%16>=8)
ignorehitpause=1

;ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1
var(19) = ifelse(movehit=1,14,-14)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(floor(ifelse(AnimElemTime(9)>=0,900,100)*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10;+random%4
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=1,>=0&&AnimElem=2,<0
var(17) = floor(ifelse(P2dist X>112*const(size.xscale),112*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
var(17) = floor(ifelse(P2dist X>324*const(size.xscale),324*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,30]),10,-10)+0))

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(P2dist X)-floor(20*const(size.xscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=1,>=0&&AnimElem=2,<0
var(18) = -floor(80*const(size.yscale))+floor(P2dist Y)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
var(18) = ifelse(P2dist Y<-floor(120*const(size.yscale)),-floor(220*const(size.yscale)),-floor(180*const(size.yscale))+floor(P2dist Y))

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !(root,stateno=3120&&((root,AnimElemTime(7)>=0&&root,AnimElemTime(9)<0)||root,AnimElemTime(12)>=0&&root,AnimElemTime(14)<0||root,AnimElemTime(17)>=0&&root,AnimElemTime(19)<0)||root,AnimElemTime(22)>=0&&root,AnimElemTime(24)<0)
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state 6400]
type = TargetState
trigger1 = AnimElem=9,>=0&&movehit=1&&numtarget
value = 15070
persistent=0
ignorehitpause=1

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && root,var(6)%10<1 && (root,var(1)%2>=1||root,var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(root,var(1)%8>=4,936,926)
ignorehitpause=1

[state 11455]
type = parentvarset
trigger1 = movehit=1&&!numtarget
fvar(25) = uniqhitcount-hitcount+1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15909)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+1
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15380)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+6
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 11455]
type = DestroySelf
trigger1 = AnimTime=0
trigger2 = root,movetype=H

;一撃BASARA技演出2
[statedef 6592]
type = A
movetype=A
physics = N
ctrl = 0
velset = 0,0
anim = 90000

[state -2]
type = assertspecial
trigger1 = time<450
flag = noBG
flag2 = noFG

[state 3000]
type = AllPalFX
trigger1 = time=[0,29]
time = 1
add = -time*8,-time*8,-time*8

[state 3000]
type = BGPalFX
trigger1 = time=[30,419]
time = 1
add = -255,-255,-255

[state 3000]
type = AllPalFX
trigger1 = time=[30,379]
trigger1 = (time%60=[0,19])||time%60=[30,59]
time = 1
add = -255,-255,-255

[state 3000]
type = Pause
trigger1 = time=29
time = 390-1
movetime=390-1

[state 1400]
type = Explod
trigger1 = time=1
id = 6580
anim=6582
pos = floor(40*const(size.xscale)),0
postype = p1
ignorehitpause=1
ownpal = 1
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
removeongethit=1
persistent=0
pausemovetime=999

[state 1400]
type = Explod
trigger1 = time=1
id = 6580
anim=6582
pos = floor(40*const(size.xscale))+1,0
postype = p1
ignorehitpause=1
ownpal = 1
facing=-1
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
removeongethit=1
persistent=0
pausemovetime=999

[state 1400]
type = Explod
trigger1 = time=1
id = 6580
anim=6582
pos = floor(40*const(size.xscale))+1,0
postype = p1
ignorehitpause=1
ownpal = 1
facing=-1
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
removeongethit=1
persistent=0
pausemovetime=999

[state 1400]
type = Explod
trigger1 = time=420
id = 6590
anim=6592
pos = floor(40*const(size.xscale))+1,0
postype = p1
ignorehitpause=1
ownpal = 1
facing=-1
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
removeongethit=1
persistent=0

[state 3000]
type = PlaySND
trigger1 = time=29
value = 10,163

[state 1400]
type = Explod
trigger1 = time=464||time=468
id = 3550;44
anim=3550;44
pos = floor(60*const(size.xscale)),-floor(60*const(size.yscale));-floor(80*const(size.yscale))
postype = p1
ignorehitpause=1
ownpal = 1
scale = const(size.xscale)*.8,const(size.yscale)*.8
;accel = 0,.45
removetime=4;8
removeongethit=1

[state 3000]
type = TargetBind
trigger1 = time=0
pos = 0,-80

[state 3000]
type = TargetState
trigger1 = time=29
value = 3517

[state 3000]
type = TargetLifeAdd
trigger1 = time=420
value = -9999999
absolute = 1

[state 3000]
type = DestroySelf
trigger1 = time>479

;一撃BASARA技演出2
[statedef 3517]
type = A
movetype=H
physics = N
ctrl = 0
velset = 0,0

[state 11455]
type = ChangeAnim2
trigger1 = !time&&prevstateno=3517
value = 5050

[state 11455]
type = AssertSpecial
trigger1 = time>0
flag = invisible

[state 11455]
type = NotHitBy
trigger1 = 1
value = SCA

[state 3517]
type = SelfState
trigger1 = time>=240&&Alive
value = 5050

[state 3516]
type = ChangeState
trigger1 = Time>=120 && !alive && roundstate>=3
trigger2 = Time>=120 && IsHelper
value = 5150

;一撃BASARA技ヒット後（相手）
[statedef 3518]
type = L
movetype=H
physics = N
ctrl = 0
velset = 0,0

[state 3516]
type = AssertSpecial
trigger1 = 1
flag = invisible

[state 3516]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3516]
type = StatetypeSet
trigger1 = (Time=[1,80]); && roundstate=4
movetype=I

[state 3516]
type = StatetypeSet
trigger1 = Time>=80; && roundstate=4
movetype=H

[state 3516]
type = ChangeState
trigger1 = Time>=80 && !alive && (enemynear(numenemy-1),stateno=0&&enemynear(0),stateno=0) && roundstate=3
value = 5150

;一撃BASARA技発動準備
[statedef 2900]
type = S
movetype=I
physics = S
ctrl = 0
velset = 0,0
anim = 2900
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;一撃BASARA技発動可能時間
[state 195]
type = VarSet
trigger1 = AnimElem=8
var(45) = 600+ifelse(Life*100/const(data.life)<40,600,(100-Life*100/const(data.life))*10)+1

[state 195]
type = PlaySND
trigger1 = AnimElem=8
value = 7400,0

[state 195]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=1
value = 10,11
channel = 1

[state 195]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

