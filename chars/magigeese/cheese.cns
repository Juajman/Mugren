; Geese's constants and state file.

[Data]
;Amount of life to start with
;体力ゲージの初期値
life = 1000
;Amount of power stocks to have (divided by 1000). Defaults to 3000
power = 3000
;attack power (more is stronger)
;攻撃ダメージ
attack = 100
;defensive power (more is stronger)
;体力パワー
defence = 100
;Percentage to increase defense everytime player is knocked down
fall.defence_up = 50
;Time which player lies down for, before getting up
liedown.time = 16
;Number of points for juggling
airjuggle = 1 ; yes, that "many" juggle points
;Default hit spark number for HitDefs
sparkno = S901
;Default guard spark number
guard.sparkno = 40
;1 to enable echo on KO
KO.echo = 0
;Volume offset (negative for softer)
volume = 0
;Variables with this index and above will not have their values
;reset to 0 between rounds or matches. There are 60 int variables,
;indexed from 0 to 59, and 40 float variables, indexed from 0 to 39.
;If omitted, then it defaults to 60 and 40 for integer and float
;variables repectively, meaning that none are persistent, i.e. all
;are reset. If you want your variables to persist between matches,
;you need to override state 5900 from common1.cns.
IntPersistIndex = 58
FloatPersistIndex = 40

[Size]
xscale = .5           ;Horizontal scaling factor.
yscale = .5           ;Vertical scaling factor.
ground.back = 26     ;Player width (back, ground)
ground.front = 26    ;Player width (front, ground)
air.back = 26        ;Player width (back, air)
air.front = 26       ;Player width (front, air)
height = 60          ;Height of player (for opponent to jump over)
attack.dist = 160    ;Default attack distance
proj.attack.dist = 90 ;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too
head.pos = -5, -105   ;Approximate position of head
mid.pos = -5, -60    ;Approximate position of midsection
shadowoffset = 0     ;Number of pixels to vertically offset the shadow
draw.offset = 0,0    ;Player drawing offset in pixels (x, y)

[Velocity]
walk.fwd  = 3      ;Walk forward
walk.back = -3     ;Walk backward
run.fwd  = 6.9, 0    ;Run forward (x, y)
run.back = -8,-6.7 ;Hop backward (x, y)
jump.neu = 0,-13    ;Neutral jumping velocity (x, y)
jump.back = -3.3    ;Jump back Speed (x, y)
jump.fwd = 3.3       ;Jump forward Speed (x, y)
runjump.back = -2.55,-8.1 ;Running jump speeds (opt)
runjump.fwd = 4,-8.1      ;.
airjump.neu = 0,-13.13      ;.
airjump.back = -3.55      ;Air jump speeds (opt)
airjump.fwd = 3.5         ;.
air.gethit.groundrecover = -.15,-3.5  ;Velocity for ground recovery state (x, y) **MUGEN 1.0**
air.gethit.airrecover.mul = .5,.2     ;Multiplier for air recovery velocity (x, y) **MUGEN 1.0**
air.gethit.airrecover.add = 0,-4.5    ;Velocity offset for air recovery (x, y) **MUGEN 1.0**
air.gethit.airrecover.back = -1       ;Extra x-velocity for holding back during air recovery **MUGEN 1.0**
air.gethit.airrecover.fwd = 0         ;Extra x-velocity for holding forward during air recovery **MUGEN 1.0**
air.gethit.airrecover.up = -2         ;Extra y-velocity for holding up during air recovery **MUGEN 1.0**
air.gethit.airrecover.down = 1.5      ;Extra y-velocity for holding down during air recovery **MUGEN 1.0**

[Movement]
airjump.num = 0      ;Number of air jumps allowed (opt)
airjump.height = 35  ;Minimum distance from ground before you can air jump (opt)
yaccel = .84         ;POTS was right, elecbyte's default gravity was floaty as fuck so I've changed that here
stand.friction = .85  ;Friction coefficient when standing
crouch.friction = .82 ;Friction coefficient when crouching
stand.friction.threshold = 2          ;If player's speed drops below this threshold while standing, stop his movement **MUGEN 1.0**
crouch.friction.threshold = .05       ;If player's speed drops below this threshold while crouching, stop his movement **MUGEN 1.0**
air.gethit.groundlevel = 25           ;Y-position at which a falling player is considered to hit the ground **MUGEN 1.0**
air.gethit.groundrecover.ground.threshold = -20 ;Y-position below which falling player can use the recovery command **MUGEN 1.0**
air.gethit.groundrecover.groundlevel = 10   ;Y-position at which player in the ground recovery state touches the ground **MUGEN 1.0**
air.gethit.airrecover.threshold = -1  ;Y-velocity above which player may use the air recovery command **MUGEN 1.0**
air.gethit.airrecover.yaccel = .35    ;Vertical acceleration for player in the air recovery state **MUGEN 1.0**
air.gethit.trip.groundlevel = 15      ;Y-position at which player in the tripped state touches the ground **MUGEN 1.0**
down.bounce.offset = 0, 10            ;Offset for player bouncing off the ground (x, y) **MUGEN 1.0**
down.bounce.yaccel = .4               ;Vertical acceleration for player bouncing off the ground **MUGEN 1.0**
down.bounce.groundlevel = 12          ;Y-position at which player bouncing off the ground touches the ground again **MUGEN 1.0**
down.friction.threshold = .05         ;If the player's speed drops below this threshold while lying down, stop his movement **MUGEN 1.0**

;Default language victory quotes (optional).  **MUGEN 1.0**
;If this section is included, the default language victory quotes must be in English.
[Quotes]
; Up to 100 victory quotes can be specified per language (victory0 - victory99)
victory0 = "Every little thing I do is magic"
victory1 = "Everything I do just turns me on"
victory2 = "Even though my life before was magic"
victory3 = "Now I know my love for me goes on"


;---------------------------------------------------------------------------
; Variable usage:
; This is a record of the variables that KFM uses. Keeping a record of your
; variable usage helps you avoid careless mistakes later.
; var(2)  - Used in Kung Fu Throw (state 800) to remember if fwd was being
;           held (remembered from state 800 through state 810).
;           Also used in jump init state (state 40) for jump attack buffer
; var(6) - superpause check
; var(8) - throw limiter
; var(9)  - Used in kfm.cmd for combo condition (updated every tick)
; var(19) - classic modo?
; var(21) - (movehit = 1) time, checked by the e.g. wallbounces
; var(31) - countah
; var(37) - message
; var(39) - lol
; vars 40-42 = NJS flags
; NJS's floor(exp(X*ln(2)) + 0.5) values (X for...)
; by the way, it may not be that reccomended to use more than 10 "flags" per var, once i tried a single-var NJS on Jango's Jones Entire moveset, things get a little screwy
; 40.0 - misc. attack
; 40.1 - S.LP
; 40.2 - S.MP
; 40.3 - S.HP
; 40.4 - S.LK
; 40.5 - S.MK
; 40.6 - S.HK
; 40.7 - C.LP
; 40.8 - C.MP
; 40.9 - C.HP
; 41.0 - C.LK
; 41.1 - C.MK
; 41.2 - C.HK
; 41.3 - J.LP
; 41.4 - J.MP
; 41.5 - J.HP
; 41.6 - J.LK
; 41.7 - J.MK
; 41.8 - J.HK
; 41.9 - F+LK
; 42.0 - BOOM
; 42.1 - Dive Punch
; 42.2 - Teleport Kick
; 42.3 - d4
; 42.4 - Krizalid
; 42.5 - Krizalid2
; 42.6 - SLAM
; var(48) - did the AI use the taunt?
; var(49) - denotes if a 1.0/post1.0 mugen def file is used
; var(50) - used by the AI
; var(51) - used by the AI
; fvar(35) - AIlevel simpilfer
; fvar(35) - simplifer
; var(56) - used by the XOR-ed commands method to detect recent custom states.
; var(57) - the GameTime variable, required by the helper and XOR methods.
; var(58) - the primary AI variable.
; var(12) - used by Vans's cornerpush system
; var(17) - used by the push
; fvar(5) - cornerpush?
; fvar(6) - cornerpush?
; fvar(13) - proration

;---------------------------------------------------------------------------
; KO Voice
[Statedef 179]
type = S
ctrl = 0
anim = 9741
velset = 0,0


[State WHAM Timer]
type = VarSet
trigger1 = (parent,var(33)=0)
v = 32
value = 0
ignorehitpause = 1
[State WHAM Timer]
type = VarAdd
trigger1 = (parent,var(33)=1)
v = 32
value = 1
ignorehitpause = 1
[State WHAM]
type = PlaySnd
trigger1 = var(32) = 1
value = S5,14
freqmul = 1.0
abspan = 0
ignorehitpause = 1

[State Hyper Combo Finish]
type = ParentVarSet
triggerall = winko
triggerall = roundstate = 3
trigger1 = parent,stateno = [3000,3700]
trigger1 = parent,numtarget
var(37) = (parent,var(37)) | floor(exp(6*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0

[State Perfect Finish]
type = ParentVarSet
trigger1 = winko
trigger1 = roundstate = 3
trigger1 = parent,life = lifemax
var(37) = (parent,var(37)) | floor(exp(4*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0

[State Low Life Bonus]
type = PowerAdd
trigger1 = roundstate = 2
trigger1 = parent,alive
trigger1 = parent,life <= (parent,lifemax * 0.25)
value = 500
ignorehitpause = 1
persistent = 0

[State Low Life Warning]
type = ParentVarSet
trigger1 = roundstate = 2
trigger1 = parent,alive
trigger1 = parent,life <= (parent,lifemax * 0.25)
var(37) = (parent,var(37)) | floor(exp(1*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0

[State SOVIET DAMAGE]
type = ParentVarSet
trigger1 =(p2movetype != H && p2stateno != [5000,5110]) || roundstate = 4
trigger1 = p2life - var(13) <= -380
var(37) = (parent,var(37)) | floor(exp(5*ln(2)) + 0.5)
ignorehitpause = 1

[State remember p2 life]
type = VarSet
trigger1 = (p2movetype != H && p2stateno != [5000,5110]) || roundstate = 4
var(13) = p2life
ignorehitpause = 1

[State GFYS]
type = ParentVarSet
triggerall = loseko
triggerall = var(12) = parent,lifemax
trigger1 = numenemy
trigger1 = enemynear,movecontact
trigger2 = p2movetype = A
var(37) = (parent,var(37)) | floor(exp(9*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0

[State remember p1 life]
type = VarSet
trigger1 = ((parent,movetype != H) && (parent,stateno != [5000,5110])) || roundstate = 4
var(12) = parent,life
ignorehitpause = 1

[State reset]
type = VarSet
trigger1 = parent,var(21) != 1
var(16) = -1
ignorehitpause = 1

[State reset]
type = VarSet
triggerall = parent,var(21) != 1
trigger1 = numenemy
trigger1 = enemynear,statetype = A
trigger1 = enemynear,movetype = H
trigger1 = enemynear,gethitvar(fall) = 1
trigger1 = enemynear,canrecover
var(16) = 1;(enemynear,canrecover)
ignorehitpause = 1

[State INVALID COMBO]
type = ParentVarSet
trigger1 = parent,var(21) = 1
trigger1 = var(16) = 1
var(37) = (parent,var(37)) | floor(exp(7*ln(2)) + 0.5)
ignorehitpause = 1


[State COUNTER]
type = Null
;trigger1 = var(10) != 0
trigger1 = !numexplod(947)
trigger1 = (parent,var(37) & floor(exp(0*ln(2)) + 0.5))
trigger1 = (var(22):=60)
trigger1 = (var(10):=1)
ignorehitpause = 1

[State DANGER]
type = Null
;trigger1 = var(10) != 0
trigger1 = !numexplod(947)
trigger1 = (parent,var(37) & floor(exp(1*ln(2)) + 0.5))
trigger1 = (var(22):=60)
trigger1 = (var(10):=2)
ignorehitpause = 1

[State FIRST ATTACK]
type = Null
;trigger1 = var(10) != 0
trigger1 = !numexplod(947)
trigger1 = (parent,var(37) & floor(exp(2*ln(2)) + 0.5))
trigger1 = (var(22):=60)
trigger1 = (var(10):=3)
ignorehitpause = 1

[State GUARD CANCEL]
type = Null
;trigger1 = var(10) != 0
trigger1 = !numexplod(947)
trigger1 = (parent,var(37) & floor(exp(3*ln(2)) + 0.5))
trigger1 = (var(22):=60)
trigger1 = (var(10):=4)
ignorehitpause = 1

[State PERFECT]
type = Null
;trigger1 = var(10) != 0
trigger1 = !numexplod(947)
trigger1 = (parent,var(37) & floor(exp(4*ln(2)) + 0.5))
trigger1 = (var(22):=60)
trigger1 = (var(10):=5)
ignorehitpause = 1

[State SUPER DAMAGE]
type = Null
;trigger1 = var(10) != 0
trigger1 = !numexplod(947)
trigger1 = (parent,var(37) & floor(exp(5*ln(2)) + 0.5))
trigger1 = (var(22):=60)
trigger1 = (var(10):=6)
ignorehitpause = 1

[State SUPER KO]
type = Null
;trigger1 = var(10) != 0
trigger1 = !numexplod(947)
trigger1 = (parent,var(37) & floor(exp(6*ln(2)) + 0.5))
trigger1 = (var(22):=60)
trigger1 = (var(10):=7)
ignorehitpause = 1

[State SLOPPY JUGGLE]
type = Null
;trigger1 = var(10) != 0
trigger1 = !numexplod(947)
trigger1 = (parent,var(37) & floor(exp(7*ln(2)) + 0.5))
trigger1 = (var(22):=60)
trigger1 = (var(10):=8)
ignorehitpause = 1

[State FUCK YOU]
type = Null
;trigger1 = var(10) != 0
trigger1 = !numexplod(947)
trigger1 = (parent,var(37) & floor(exp(8*ln(2)) + 0.5))
trigger1 = (var(22):=60)
trigger1 = (var(10):=10)
ignorehitpause = 1

[State 0, VarSet]
type = VarAdd
trigger1 = var(22) > 0
trigger1 = numexplod(947)
var(22) = -1
[State 0, VarSet]
type = VarSet
trigger1 = fvar(13) != 0
trigger1 = !numexplod(947)
fvar(13) = 0
[State 0, VarSet]
type = VarAdd
trigger1 = var(22) > 0
trigger1 = fvar(13) < 1
trigger1 = numexplod(947)
fvar(13) = 0.1
[State 0, VarSet]
type = VarAdd
trigger1 = fvar(13) > 0
trigger1 = numexplod(947)
trigger1 = var(22) <= 0
fvar(13) = -0.1
[State 0, VarSet]
type = VarSet
trigger1 = fvar(13) > 1
trigger1 = var(22) > 0
trigger1 = numexplod(947)
fvar(13) = 1

[State 0, ParentVarSet]
type = ParentVarSet
trigger1 = !numexplod(947)
trigger1 = var(10)
trigger1 = (parent,var(37) & floor(exp((var(10)-1)*ln(2)) + 0.5))
var(37) = parent,var(37) ^ floor(exp((var(10)-1)*ln(2)) + 0.5)
[State START MESSAGE]
type = Explod
trigger1 = !numexplod(947)
trigger1 = var(10)
anim = 4100+var(10)-1
ID = 947
pos = ifelse(teamside=1,50,270),100
postype = left
bindtime = -1
;removetime = 150
removetime = -1
supermovetime = 65535
pausemovetime = 65535
scale = fvar(13)/2,fvar(13)/2
sprpriority = 666
ontop = 1
ownpal = 1
ignorehitpause = 1
[State MAO]
type = ModifyExplod
trigger1 = numexplod(947)
ID = 947
supermovetime = 65535
pausemovetime = 65535
scale = fvar(13)/2,fvar(13)/2
sprpriority = 666
ontop = 1
ownpal = 1
ignorehitpause = 1
[State REM]
type = RemoveExplod
trigger1 = numexplod(947)
trigger1 = fvar(13) <= 0
trigger1 = var(22) <= 0
id = 947
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = var(10)
var(10) = 0
ignorehitpause = 1

[State 0, Turn]
type = Turn
;trigger1 = roundstate = [2,3]
;trigger1 = facing != enemynear,facing
trigger1 = facing != parent,facing

[State 0, Move to where the enemy is so I don't have to make another helper just to keep track of p2's position]
type = PosAdd
trigger1 = roundstate = [2,3]
x = p2dist x
y = p2dist y



; Stand
[Statedef 0]
type = S
physics = S
sprpriority = 0
velset = 0,0

[State 0, 1]
type = ChangeAnim
trigger1 = anim = 5
trigger1 = var(19)
value = 10005
[State 0, 1]
type = ChangeAnim
trigger1 = (Anim != [0+(10000*var(19)),5+(10000*var(19))])
trigger2 = Anim = 5+(10000*var(19)) && AnimTime = 0 ;Turn anim over
value = 0+(10000*var(19))

;[State 0, 1]
;type = ChangeAnim
;trigger1 = (Anim = [0,3]) && (animtime = 0)
;value = random%4

[State 0, 2]
type = VelSet
trigger1 = Time = 0
y = 0
[State 0, CtrlSet]
type = CtrlSet
triggerall = roundstate = 2
triggerall = prevstateno = 20||prevstateno=9000
trigger1 =1
value = 1

[State 0, 3] ;Stop moving if low velocity or 4 ticks pass
type = VelSet
triggerall = fvar(6) = 0 ;Cornerpush is over. :)
trigger1 = abs(vel x) < 2
trigger2 = Time = 4
trigger3 = Time = 0
x = 0

[State 0, 4] ;Are you dead?
type = ChangeState
trigger1 = !alive
value = 5050 + 100*((Anim = 5120) || (Anim = 5150))

;---------------------------------------------------------------------------
; Stand to Crouch
[Statedef 10]
type    = C
physics = C
anim = (10+(10000*var(19)))

[State 10, 1]
type = VelMul
trigger1 = Time = 0
x = .75

[State 10, 2] ;Stop moving if low velocity
type = VelSet
trigger1 = abs(vel x) < 0.05;Const(movement.crouch.friction.threshold)
x = 0

[State 10, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 11

;---------------------------------------------------------------------------
; Crouching
[Statedef 11]
type    = C
physics = C
anim = (11+(10000*var(19)))
sprpriority = 0

[State 0, 1]
type = ChangeAnim
trigger1 = anim = 6
trigger1 = var(19)
value = 10006
[State 11, 1] ;Change from turning animation
type = ChangeAnim
trigger1 = Anim = (6+(10000*var(19))) && AnimTime = 0
value = (11+(10000*var(19)))

[State 11, 2] ;Stop moving if low velocity
type = VelSet
trigger1 = abs(vel x) < 0.05;Const(movement.crouch.friction.threshold)
x = 0

;---------------------------------------------------------------------------
; Crouch to Stand
[Statedef 12]
type    = S
physics = S
anim = (12+(10000*var(19)))

[State 12, 1]
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; Walk
[Statedef 20]
type    = S
physics = S
sprpriority = 0

[State 20, 1]
type = VelSet
triggerall = fvar(35) >4.0 || !fvar(35)
trigger1 = command = "holdfwd"
x = const(velocity.walk.fwd.x)

[State 20, 2]
type = VelSet
triggerall = fvar(35) >4.0 || !fvar(35)
trigger1 = command = "holdback"
x = const(velocity.walk.back.x)

;LETS WALKING
[State 20, 1]
type = VelSet
triggerall = fvar(35) =[0.1,4.0]
trigger1 = helper(10003),var(25)
x = const(velocity.walk.fwd.x)

[State 20, 2]
type = VelSet
triggerall = fvar(35) =[0.1,4.0]
trigger1 =!helper(10003),var(25)
x = const(velocity.walk.back.x)

[State 20, 3]
type = ChangeAnim
triggerall = vel x > 0
trigger1 = Anim != (20+(10000*var(19))) && Anim != (5+(10000*var(19)))
trigger2 = Anim = (5+(10000*var(19))) && AnimTime = 0
value = (20+(10000*var(19)))

[State 20, 4]
type = ChangeAnim
triggerall = vel x < 0
trigger1 = Anim != (21+(10000*var(19))) && Anim != (5+(10000*var(19)))
trigger2 = Anim = (5+(10000*var(19))) && AnimTime = 0
value = (21+(10000*var(19)))

[State 0, CtrlSet]
type = CtrlSet
triggerall = fvar(35) =[0.1,4.0]
trigger1 = time > 20|| p2bodydist x < 35
value = 1

[State 0, CtrlSet]
type = CtrlSet
triggerall = fvar(35) =[0.1,4.0]
trigger1 = time = 0
value = 0
[State 0, ChangeState]
type = ChangeState
triggerall = fvar(35) =[0.1,4.0]
trigger1 = vel x =0
value =0
ctrl = 1



;---------------------------------------------------------------------------
; Jump Start
[Statedef 40]
type    = S
physics = S
anim = (40+(10000*var(19)))
ctrl = 0
sprpriority = 1
facep2 = 1

; Jump attack buffer
[State 40, 1]
type = VarSet
trigger1 = Time = 0
var(2) = 0
[State 40, 1]
type = VarSet
triggerall = command != "upper_what"
trigger1 = !fvar(35)
trigger1 = command = "x"
var(2) = ifelse(var(19),10600,600)
[State 40, 1]
type = VarSet
triggerall = command != "upper_what"
trigger1 = !fvar(35)
trigger1 = command = "y"
var(2) = ifelse(var(19),10600,610)
[State 40, 1]
type = VarSet
triggerall = command != "upper_what"
trigger1 = !fvar(35)
trigger1 = command = "z"
var(2) = ifelse(var(19),10600,620)
[State 40, 1]
type = VarSet
triggerall = command != "upper_what"
trigger1 = !fvar(35)
trigger1 = command = "a"
var(2) = ifelse(var(19),10600,630)
[State 40, 1]
type = VarSet
triggerall = command != "upper_what"
trigger1 = !fvar(35)
trigger1 = command = "b"
var(2) = ifelse(var(19),10600,640)
[State 40, 1]
type = VarSet
triggerall = command != "upper_what"
trigger1 = !fvar(35)
trigger1 = command = "c"
var(2) = ifelse(var(19),10600,650)

[State 40, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0
[State 40, 1]
type = VarSet
trigger1 = Time = 0
sysvar(2) = 0
[State 40, 1]
type = VarSet
trigger1 = Time = 0
sysvar(3) = 0

[State 40, 2]
type = VarSet
trigger1 = command = "holdfwd"
trigger2 = fvar(35) && (var(52) = 41 || var(52) = 44)
sysvar(1) = 1

[State 40, 3]
type = VarSet
trigger1 = command = "holdback"
trigger2 = fvar(35) && (var(52) = 42 || var(52) = 45)
sysvar(1) = -1
[State 40, 1]
type = VarSet
trigger1 = command = "SupahJump"
trigger1 = command != "ChargedSupahJump"
trigger2 = fvar(35) && (var(52) = [43,45])
sysvar(2) = 1
[State 40, 3]
type = VarAdd
triggerall = time
trigger1 = command = "holdup"
trigger2 = var(52) = [41,43]
sysvar(3) = 1
[State 40, 3]
type = VarAdd
triggerall = time
triggerall = sysvar(3) > 0
trigger1 = command = "holddown"
trigger2 = var(52) = [47,49]
sysvar(3) = -1
[State 40, 2]
type = VarSet
trigger1 = time = 0
trigger1 = prevstateno = [210,419]
sysvar(2) =1
[State 40, 2]
type = VarSet
trigger1 = time = 0
trigger1 = prevstateno = [210,419]
sysvar(3) =3


[State 0, AfterImage]
type = AfterImage
trigger1 = sysvar(2)
trigger1 = animtime = 0
time = 42
length = 15
palcolor = 40
paladd = 10,10,10
palmul = .74,.74,.74
timegap = 1
framegap = 4
trans = add

[State 40, 4]
type = VelSet
trigger1 = AnimTime = 0
x = ifelse(sysvar(1)=0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x))) * ifelse(sysvar(2),2.2,1)
y = const(velocity.jump.y) * ifelse(sysvar(3)<3,0.71,1) * ifelse(sysvar(2),1.06,1)

[State 40, 5]
type = VelSet
trigger1 = AnimTime = 0
trigger1 = prevstateno = 100 ;RUN_FWD
trigger1 = sysvar(1) = 1
x = const(velocity.runjump.fwd.x)

[State 40, 5] ; LAUNCHER
type = VelSet
triggerall = command != "holdback"
triggerall = prevstateno >= 200
trigger1 = numtarget
trigger1 = AnimTime = 0
;trigger1 = prevstateno = 100 ;RUN_FWD
trigger1 = sysvar(1) != -1
;trigger1 = sysvar(4) = 1
trigger1 = p2statetype = A
x = ifelse(abs(p2bodydist x / 10)>=4.5,ifelse(p2dist x>=0,4.5,-4.5),(p2bodydist x / 10))
y = -17.13

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !var(19)
trigger1 = animtime = 0
value = S0,ifelse(sysvar(2),8,7)

[State 0, PlaySnd]
type = PlaySnd
trigger1 = var(19)
trigger1 = animtime = 0
value = S30,5

[State 40, 1] ; Lol Buffer
type = Changestate
triggerall = command != "upper_what"
triggerall = animtime = 0
trigger1 = var(2) != 0
value = var(2)
ctrl = 0

[State 40, 6]
type = ChangeState
trigger1 = AnimTime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
; Jump Up
[Statedef 50]
type    = A
physics = A

[State 50, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State 50, 2]
type = ChangeAnim
trigger1 = Time = 0
value = ifelse((vel x)=0, 41, ifelse((vel x)>0, 42, 43))+(10000*var(19))

[State 50, 3]
type = ChangeAnim
trigger1 = Vel y > -2;Const720p(-8)
trigger1 = SelfAnimExist(anim + 3)
trigger1 = anim >= 41 && anim <= 43
persistent = 0
value = Anim + 3


;---------------------------------------------------------------------------
; Jump Land
[Statedef 52]
type    = S
physics = S
ctrl = 0
anim = 47+(10000*var(19))
facep2 = 1

[State 52, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, 3]
type = CtrlSet
trigger1 = Time = 3
value = 1

[State 52, Trip Guard]
type= changestate
trigger1= inguarddist
trigger1= ctrl && command="holdback"
value= 120

[State 52, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Run forward
[Statedef 100]
type    = S
physics = S;N
anim = 100
sprpriority = 1
ctrl = 0

[State 100, 1]
type = VelSet
trigger1 = anim = 100
x = const(velocity.run.fwd.x)

[State 100, 2] ;Prevent run from canceling into walk
type = AssertSpecial
trigger1 = 1
flag = NoWalk

[State 100, 3] ;Prevent from turning
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

[State 100, 4]
type = ChangeAnim
trigger1 = command != "holdfwd" && var(52) != 100
trigger1 = anim = 100
trigger1 = animelemtime(3) >= 0
value = 101

;[State 0, VelSet]
;type = VelMul
;trigger1 = anim = 101
;x = 0.90

[State 100, 4]
type = ChangeState
trigger1 = anim = 101
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Dash Bak
[Statedef 105]
type    = S
physics = S;N
anim = 105
sprpriority = 1
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,4

[State 100, 1]
type = VelSet
trigger1 = time = 0
x = const(velocity.run.back.x)

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 2
x = -26*const(size.xscale)

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 4
x = -38*const(size.xscale)

[State 100, 1]
type = VelSet
trigger1 = animelem = 5
x = 0

[State 100, 2] ;Prevent run from canceling into walk
type = AssertSpecial
trigger1 = 1
flag = NoWalk

[State 100, 3] ;Prevent from turning
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

[State 0, CtrlSet]
type = CtrlSet
trigger1 = animelem = 6
value = 1

[State 100, 4]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; GUARD (start)
[Statedef 120]
type = U    ;Leave state type unchanged
physics = U ;Leave physics unchanged

[State 120, 1]
type = ChangeAnim
trigger1 = Time = 0
value = (120+(10000*var(19))) + (statetype = C) + (statetype = A)*2

[State 120, 2]
type = StateTypeSet
trigger1 = Time = 0 && statetype = S
physics = S

[State 120, 3]
type = StateTypeSet
trigger1 = Time = 0 && statetype = C
physics = C

[State 120, 4]
type = StateTypeSet
trigger1 = Time = 0 && statetype = A
physics = A

[State 120, Hi to Lo]
type = StateTypeSet
trigger1 = statetype = S && command = "holddown"
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown"
statetype = S
physics = S

[State 120, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 130 + (statetype = C) + (statetype = A)*2

[State 120, Stop Guarding]
type = ChangeState
trigger1 = command != "holdback"
trigger2 = !inguarddist
value = 140


;---------------------------------------------------------------------------
; Stand guard (guarding)
[Statedef 130]
type    = S
physics = S

[State 130, 1]
type = ChangeAnim
trigger1 = Anim != (130+(10000*var(19)))
value = (130+(10000*var(19)))
[State 130, Hi to Lo]
type = ChangeState
triggerall = fvar(35)
triggerall = enemy,statetype=C  && enemynear,hitdefattr= C,AA,AP ||  helper(10003),var(7);standlow protection
trigger1 = 1
value = 131
[State 130, Hi to Lo]
type = ChangeState
triggerall = !fvar(35)
trigger1 = command = "holddown"
value = 131

[State 130, Stop Guarding]
type = ChangeState
triggerall = !fvar(35)
trigger1 = command != "holdback"
trigger2 = !inguarddist
value = 140
[State 120, Stop Guarding]
type = ChangeState
triggerall= fvar(35)
triggerall = p2movetype!=A
trigger1 = !inguarddist
value = 140

;---------------------------------------------------------------------------
; Crouch guard (guarding)
[Statedef 131]
type    = C
physics = C

[State 131, 1]
type = ChangeAnim
trigger1 = Anim != (131+(10000*var(19)))
value = (131+(10000*var(19)))
[State 131, Lo to Hi]
type = ChangeState
triggerall= fvar(35)
;triggerall = var(1)<50
trigger1 = (p2statetype!=C&&!helper(10003),var(7)) && p2movetype=A
value = 130
[State 131, Lo to Hi]
type = ChangeState
triggerall = !fvar(35)
trigger1 = command != "holddown"
value = 130

[State 131, Stop Guarding]
type = ChangeState
triggerall = !fvar(35)
trigger1 = command != "holdback"
trigger2 = !inguarddist
value = 140
[State 120, Stop Guarding]
type = ChangeState
triggerall= fvar(35)
triggerall = p2movetype!=A
trigger1 = !inguarddist
value = 140


;---------------------------------------------------------------------------
; Air guard (guarding)
[Statedef 132]
type    = A
physics = N

[State 132, 1]
type = ChangeAnim
trigger1 = Anim != 132
value = 132

[State 132, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 132, 3]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 132, 4]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 132, 5]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 132, 6]
type = ChangeState
trigger1 = sysvar(0)
trigger1 = command = "holdback"
trigger1 = inguarddist
value = 130

[State 132, 7]
type = ChangeState
trigger1 = sysvar(0)
value = 52

[State 132, Stop Guarding]
type = ChangeState
trigger1 = command != "holdback"
trigger2 = !inguarddist
value = 140

;---------------------------------------------------------------------------
; Guard (end)
[Statedef 140]
type = U    ;Leave state type unchanged
physics = U ;Leave physics unchanged
ctrl = 1

[State 140, 1]
type = ChangeAnim
trigger1 = Time = 0
value = (140+(10000*var(19))) + (statetype = C) + (statetype = A)*2

[State 140, 2]
type = StateTypeSet
trigger1 = Time = 0 && statetype = S
physics = S

[State 140, 3]
type = StateTypeSet
trigger1 = Time = 0 && statetype = C
physics = C

[State 140, 4]
type = StateTypeSet
trigger1 = Time = 0 && statetype = A
physics = A

[State 140, Hi to Lo]
type = StateTypeSet
trigger1 = statetype = S && command = "holddown"
statetype = C
physics = C

[State 140, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown"
statetype = S
physics = S

;[State 140, 5] ;Implemented within engine
;type = ChangeState
;trigger1 = AnimTime = 0
;value = (statetype = C)*11 + (statetype = A)*51

;---------------------------------------------------------------------------
; Stand guard hit (shaking)
[Statedef 150]
type    = S
movetype= H
physics = N
velset = 0,0

[State 150, 1]
type = ChangeAnim
trigger1 = 1
value = (150+(10000*var(19)))

[State 150, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2*(command = "holddown")

[State 150, Hi to Lo]
type = StateTypeSet
trigger1 = statetype = S && command = "holddown"
statetype = C
physics = C

[State 150, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown"
statetype = S
physics = S

[State 150, 3]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 3

;---------------------------------------------------------------------------
; Stand guard hit (knocked back)
[Statedef 151]
type    = S
movetype= H
physics = S
anim = (150+(10000*var(19)))

[State 151, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 151, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 151, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
value = 1

[State 151, Hi to Lo]
type = StateTypeSet
trigger1 = statetype = S && command = "holddown"
statetype = C
physics = C

[State 151, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown"
statetype = S
physics = S

[State 151, 4]
type = ChangeState
trigger1 = HitOver
value = 130
ctrl = 1

;---------------------------------------------------------------------------
; Crouch guard hit (shaking)
[Statedef 152]
type    = C
movetype= H
physics = N
velset = 0,0

[State 152, 1]
type = ChangeAnim
trigger1 = 1
value = (151+(10000*var(19)))

[State 152, 3]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2*(command = "holddown")

[State 152, Hi to Lo]
type = StateTypeSet
trigger1 = statetype = S && command = "holddown"
statetype = C
physics = C

[State 152, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown"
statetype = S
physics = S

[State 152, 4]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 4

;---------------------------------------------------------------------------
; Crouch guard hit (knocked back)
[Statedef 153]
type    = C
movetype= H
physics = C
anim = (151+(10000*var(19)))

[State 153, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 153, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 153, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
value = 1

[State 153, Hi to Lo]
type = StateTypeSet
trigger1 = statetype = S && command = "holddown"
statetype = C
physics = C

[State 153, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown"
statetype = S
physics = S

[State 153, 4]
type = ChangeState
trigger1 = HitOver
value = 131
ctrl = 1


;---------------------------------------------------------------------------
; Stand get-hit (shaking)
[Statedef 5000]
type    = S
movetype= H
physics = N
velset = 0,0

[State 5000, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(groundtype) = 1),5000,5010) + GetHitVar(animtype) + (10000*var(19))

[State 5000, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = (5030+(10000*var(19)))

[State 5000, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist((5047+(10000*var(19))) + GetHitVar(animtype)))
value = (5047+(10000*var(19))) + GetHitVar(animtype) ;5051 - 4 + type

[State 5000, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5000, 5] ;State type gets set to aerial if getting hit up
type = StateTypeSet
trigger1 = Time = 0
trigger1 = GetHitVar(yvel) != 0 || GetHitVar(fall)
trigger2 = Pos Y != 0
statetype = a

[State 5000, FFB Light]
type = ForceFeedback
trigger1 = anim = (5000+(10000*var(19)))
trigger2 = anim = (5010+(10000*var(19)))
persistent = 0
time = 6
waveform = square

[State 5000, FFB Medium]
type = ForceFeedback
trigger1 = anim = (5001+(10000*var(19)))
trigger2 = anim = (5011+(10000*var(19)))
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5000, FFB Hard]
type = ForceFeedback
trigger1 = anim = (5012+(10000*var(19)))
trigger2 = anim = (5002+(10000*var(19)))
trigger3 = anim = (5030+(10000*var(19)))
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

[State 5000, 6]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0 && !GetHitVar(fall)
value = 5001 ;Stand get-hit (knocked back)

[State 5000, 7]
type = ChangeState
trigger1 = HitShakeOver
value = 5030

;---------------------------------------------------------------------------
; Stand get-hit (knocked back)
[Statedef 5001]
type    = S
movetype= H
physics = S

[State 5001, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 5001, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
value = 5005 + GetHitVar(animtype) + (GetHitVar(groundtype)=2)*10 +(10000*var(19))
persistent = 0

[State 5001, 3] ;Stop sliding back
type = VelMul
trigger1 = Time >= GetHitVar(slidetime)
x = .6

[State 5001, 4]
type = VelSet
trigger1 = HitOver
x = 0

[State 5001, 5]
type = DefenceMulSet
trigger1 = HitOver
value = 1

[State 5001, 6]
type = ChangeState
trigger1 = HitOver
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Crouch get-hit (shaking)
[Statedef 5010]
type    = C
movetype= H
physics = N
velset = 0,0

[State 5010, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = (5020+(10000*var(19))) + GetHitVar(animtype)

[State 5010, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = (5030+(10000*var(19)))

[State 5010, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist((5047+(10000*var(19))) + GetHitVar(animtype)))
value = (5047+(10000*var(19))) + GetHitVar(animtype) ;5051 - 4 + type

[State 5010, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5010, 5] ;State type gets set to aerial if getting hit up
type = StateTypeSet
triggerall = Time = 0
trigger1 = GetHitVar(yvel) != 0 || GetHitVar(fall)
trigger2 = Pos Y != 0
statetype = a

[State 5010, 6]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0 && !GetHitVar(fall)
value = 5011 ;Crouch get-hit (knocked back)

[State 5010, 7]
type = ChangeState
trigger1 = HitShakeOver
value = 5030

[State 5010, FFB Light]
type = ForceFeedback
trigger1 = anim = (5020+(10000*var(19)))
persistent = 0
time = 6
waveform = square

[State 5010, FFB Medium]
type = ForceFeedback
trigger1 = anim = (5021+(10000*var(19)))
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5010, FFB Hard]
type = ForceFeedback
trigger1 = anim = (5022+(10000*var(19)))
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; Crouch get-hit (knocked back)
[Statedef 5011]
type    = C
movetype= H
physics = C

[State 5011, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 5011, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
value = (5025+(10000*var(19))) + GetHitVar(animtype)
persistent = 0

[State 5011, 3] ;Stop sliding back
type = VelMul
trigger1 = Time >= GetHitVar(slidetime)
x = .6

[State 5011, 4]
type = VelSet
trigger1 = HitOver
x = 0

[State 5011, 5]
type = DefenceMulSet
trigger1 = HitOver
value = 1

[State 5011, 6]
type = ChangeState
trigger1 = HitOver
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; Air get-hit (shaking)
[Statedef 5020]
type    = A
movetype= H
physics = N
velset = 0,0

[State 5020, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype) +(10000*var(19))

[State 5020, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = (5030+(10000*var(19)))

[State 5020, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist((5047+(10000*var(19))) + GetHitVar(animtype)))
value = (5047+(10000*var(19))) + GetHitVar(animtype) ;5051 - 4 + type

[State 5020, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5020, 5]
type = ChangeState
trigger1 = HitShakeOver
value = 5030

[State 5020, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000+(10000*var(19))
trigger2 = anim = 5010+(10000*var(19))
persistent = 0
time = 6
waveform = square

[State 5020, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001+(10000*var(19))
trigger2 = anim = 5011+(10000*var(19))
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5020, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012+(10000*var(19))
trigger2 = anim = 5002+(10000*var(19))
trigger3 = anim = 5030+(10000*var(19))
trigger4 = anim = [5051+(10000*var(19)),5059+(10000*var(19))]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; Air get-hit (knocked away)
[Statedef 5030]
type    = A
movetype= H
physics = N
ctrl = 0

[State 5030, 1]
type = ChangeAnim
trigger1 = Anim != [5000+(10000*var(19)), 5199+(10000*var(19))]
trigger1 = SelfAnimExist(5030+(10000*var(19)))
value = 5030+(10000*var(19))
persistent = 0

[State 5030, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5030, 3]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 5030, 4]
type = ChangeState
triggerall = !HitFall
triggerall = !var(19)
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= 25;Const(movement.air.gethit.groundlevel)
value = 5040 ;HITA_RECOV

[State 5030, 5]
type = ChangeState
triggerall = HitFall || var(19)
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= 25;Const(movement.air.gethit.groundlevel)
value = 5050 ;HITA_FALL

[State 5030, 6]
type = ChangeState
trigger1 = AnimTime = 0
value = 5035 ;Air get-hit (transition)

;---------------------------------------------------------------------------
; Air get-hit (transition)
[Statedef 5035]
type    = A
movetype= H
physics = N

[State 5035, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5035+(10000*var(19)))
trigger1 = Anim != [5051+(10000*var(19)),5059+(10000*var(19))] ;Not if in hit up anim
trigger1 = Anim != 5090+(10000*var(19)) ;Not if hit off ground anim
value = 5035+(10000*var(19))

[State 5035, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5035, 3]
type = ChangeState
triggerall = !HitFall
triggerall = !var(19)
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Animation over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= 25;Const(movement.air.gethit.groundlevel)
trigger4 = Time = 0     ;No transition anim
trigger4 = Anim != 5035+(10000*var(19)) ;.
value = 5040 ;Air get-hit (recovering in air, not falling)

[State 5035, 4]
type = ChangeState
triggerall = HitFall || var(19)
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Anim is over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= 25;Const(movement.air.gethit.groundlevel)
trigger4 = Time = 0     ;No transition anim
trigger4 = Anim != 5035+(10000*var(19)) ;.
value = 5050 ;Air get-hit (falling)

;---------------------------------------------------------------------------
; Air get-hit (falling)
[Statedef 5050]
type    = A
movetype= H
physics = N

[State 5050, 1] ;Change anim when done with transition
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035+(10000*var(19))
trigger2 = Time = 0     ;If no transition anim
trigger2 = Anim != 5035+(10000*var(19))
trigger2 = (Anim != [5051+(10000*var(19)), 5059+(10000*var(19))]) && (Anim != [5061+(10000*var(19)), 5069+(10000*var(19))])
trigger2 = Anim != 5090+(10000*var(19)) ;Not if hit off ground anim
value = 5050+(10000*var(19))


[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = anim = [5050+(10000*var(19)),5059+(10000*var(19))]
trigger1 = Vel Y >= ifelse(anim = 5050+(10000*var(19)), 1, -2)
;trigger1 = Vel Y >= ifelse(anim = 5050, Const720p(4), Const720p(-8))
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5050, 3] ;Gravity
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5050, 4] ;Recover near ground
type = ChangeState
triggerall = Vel Y > 0
triggerall = Pos Y >= -20;Const(movement.air.gethit.groundrecover.ground.threshold)
triggerall = alive
triggerall = CanRecover
triggerall = !var(19)
trigger1 = Command = "recovery"
value = 5200 ;Air get-hit (fall recovery on ground)

[State 5050, 5]; Recover in mid air
type = ChangeState
triggerall = Vel Y > -1;Const(movement.air.gethit.airrecover.threshold)
triggerall = alive
triggerall = CanRecover
triggerall = !var(19)
trigger1 = Command = "recovery"
value = 5210 ;Air get-hit (fall recovery in air)

[State 5050, 6]
type = ChangeState
triggerall = Vel Y > 0
trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
;trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, Const(movement.air.gethit.groundlevel))
value = 5100 ;Downed get-hit (hit ground from fall)

;---------------------------------------------------------------------------
; Tripped get-hit (shaking)
[Statedef 5070]
type    = A
movetype= H
physics = N
velset = 0,0

[State 5070, 1]
type = ChangeAnim
trigger1 = 1
value = 5070+(10000*var(19))

[State 5070, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 5071

[State 5070, 3]
type = ForceFeedback
trigger1 = time = 0
time = 12
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; Tripped get-hit (knocked away)
[Statedef 5071]
type    = A
movetype= H
physics = N

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
sysvar(0) = 0

[State 5071, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 5071, 2] ;Acceleration
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5071, 3] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 15;Const(movement.air.gethit.trip.groundlevel)
type = ChangeState
value = 5110

;---------------------------------------------------------------------------
; Downed get-hit (shaking)
[Statedef 5080]
type    = L
movetype= H
physics = N
velset = 0,0

[State 5080, 1] ;Set default anim
type = VarSet
trigger1 = time = 0
sysvar(2) = ifelse (GetHitVar(yvel) = 0, 5080+(10000*var(19)), 5090+(10000*var(19)))

[State 5080, 2]
type = VarAdd
trigger1 = time = 0
trigger1 = (anim = [5081+(10000*var(19)),5089+(10000*var(19))]) || (anim = [5111+(10000*var(19)),5119+(10000*var(19))])
trigger1 = SelfAnimExist(sysvar(2) + (anim % 10))
sysvar(2) = anim % 10

[State 5080, 3] ;If 5090 doesn't exist, default to 5030
type = VarSet
trigger1 = time = 0
trigger1 = sysvar(2) = 5090+(10000*var(19))
trigger1 = !SelfAnimExist(5090+(10000*var(19)))
sysvar(2) = 5030+(10000*var(19))

[State 5080, 3] ;Freeze
type = ChangeAnim
trigger1 = 1
value = sysvar(2)

[State 5080, 4]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0
value = 5081 ;Downed get-hit (knocked back)

[State 5080, 5]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) != 0
value = 5030 ;Air get-hit (knocked away)

;---------------------------------------------------------------------------
; Downed get-hit (knocked back)
[Statedef 5081]
type    = L
movetype= H
physics = C

[State 5081, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 5081, 2]
type = VelSet
trigger1 = HitOver
x = 0

[State 5081, 3] ;Don't show hit ground frame
type = VarSet
trigger1 = Time = 0
sysvar(0) = 1

[State 5081, 4]
type = ChangeState
trigger1 = HitOver
value = 5110 ;Downed get-hit (lying down)

;---------------------------------------------------------------------------
; Downed get-hit (hit ground from fall)
[Statedef 5100]
type    = L
movetype= H
physics = N

[State 5100, 2004.04.14 behavior]
type = null;VelSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
trigger1 = vel x < -1
x = -1

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = (anim != [5051+(10000*var(19)),5059+(10000*var(19))]) && (anim != [5061+(10000*var(19)),5069+(10000*var(19))])
trigger2 = !SelfAnimExist(5100+(10000*var(19)) + (anim % 10))
value = 5100+(10000*var(19))

[State 5100, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
trigger1 = time = 0
trigger1 = (anim = [5051+(10000*var(19)),5059+(10000*var(19))]) || (anim = [5061+(10000*var(19)),5069+(10000*var(19))])
trigger1 = SelfAnimExist(5100 + (anim % 10))
value = 5100+(10000*var(19)) + (anim % 10)

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5100, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.75

[State 5100, 7]
type = ChangeState
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
value = 5110 ;Downed get-hit (lying down)

[State 5100, 8]
type = Explod
trigger1 = Time = 1
anim = F(60 + (sysvar(1) > 6) + (sysvar(1) > 14))
pos = 0, 0
postype = p1
sprpriority = ifelse (sysvar(1) <= 14, -10, 10)

[State 5100, 9]
type = HitFallDamage
trigger1 = Time = 3

[State 5100, 10]
type = PlaySnd
trigger1 = Time = 1
trigger1 = !var(19)
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5100, 10]
type = PlaySnd
trigger1 = Time = 1
trigger1 = var(19)
value = 35,4

[State 5100, 11]
type = PosFreeze
trigger1 = 1

[State 5100, 12]
type = ChangeState
trigger1 = AnimTime = 0
value = 5101 ;Downed get-hit (bounce off ground)

[State 5100, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 20

;---------------------------------------------------------------------------
; Downed get-hit (bounce off ground)
[Statedef 5101]
type    = L
movetype= H
physics = N

[State 5101, 1] ;Coming hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5101,5109]
trigger2 = !SelfAnimExist(5160 + (anim % 10))
value = 5160+(10000*var(19))

[State 5101, 2] ;Coming hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5101,5109]
trigger1 = SelfAnimExist(5160 + (anim % 10))
value = 5160+(10000*var(19)) + (anim % 10)

[State 5101, 3]
type = HitFallVel
trigger1 = Time = 0

[State 5101, 4]
type = PosSet
trigger1 = Time = 0
y = 10;Const(movement.down.bounce.offset.y)

[State 5101, 5]
type = PosAdd
trigger1 = Time = 0
x = 0;Const(movement.down.bounce.offset.x)

[State 5101, 6] ;Acceleration
type = VelAdd
trigger1 = 1
y = .4;Const(movement.down.bounce.yaccel)

[State 5101, 7] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 12; Const(movement.down.bounce.groundlevel)
type = ChangeState
value = 5110

;---------------------------------------------------------------------------
; Downed get-hit (lying down)
[Statedef 5110]
type    = L
movetype= H
physics = N

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110+(10000*var(19)) + (anim % 10))
trigger1 = anim = [5081+(10000*var(19)),5089+(10000*var(19))]
value = 5110+(10000*var(19)) + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110+(10000*var(19)),5119+(10000*var(19))] ;Not already changed anim
trigger1 = anim != [5161+(10000*var(19)),5169+(10000*var(19))]
trigger2 = !SelfAnimExist(5170+(10000*var(19)) + (anim % 10))
value = 5170+(10000*var(19))

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110+(10000*var(19)),5119+(10000*var(19))] ;Not already changed anim
trigger1 = anim = [5161+(10000*var(19)),5169+(10000*var(19))]
trigger1 = SelfAnimExist(5170+(10000*var(19)) + (anim % 10))
value = 5170+(10000*var(19)) + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

[State 5110, 6]
type = PlaySnd
trigger1 = Time = 0
trigger1 = !SysVar(0)
trigger1 = !var(19)
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5100, 10]
type = PlaySnd
trigger1 = Time = 0
trigger1 = !SysVar(0)
trigger1 = var(19)
value = 35,4

[State 5110, 7]
type = Explod
trigger1 = Time = 0
trigger1 = !SysVar(0)
anim = F(60 + (sysvar(1) > 5) + (sysvar(1) > 14))
pos = 0, 0
postype = p1
sprpriority = ifelse (sysvar(1) <= 14, -10, 10)

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171+(10000*var(19)),5179+(10000*var(19))]
triggerall = SelfAnimExist(5110+(10000*var(19)) + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110+(10000*var(19)) + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111+(10000*var(19)),5119+(10000*var(19))]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110+(10000*var(19))

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110+(10000*var(19)),5119+(10000*var(19))]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 14] ;Friction
type = VelSet
trigger1 = abs(Vel x) < 0.05 ;Const(movement.down.friction.threshold)
persistent = 0
x = 0

[State 5110, 15]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 5110, 16]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine


;---------------------------------------------------------------------------
; Downed get-hit (getting up)
[Statedef 5120]
type    = L
movetype= I
physics = N

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
sysvar(0) = 0
ignorehitpause = 1

[State 5120, 1a] ;Get up anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5111+(10000*var(19)),5119+(10000*var(19))]
trigger2 = !SelfAnimExist(5120+(10000*var(19)) + (anim % 10))
value = 5120+(10000*var(19))

[State 5120, 1b] ;Get up anim (for hit up/diag-up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5111+(10000*var(19)),5119+(10000*var(19))]
trigger1 = SelfAnimExist(5120+(10000*var(19)) + (anim % 10))
value = 5120+(10000*var(19)) + (anim % 10)

[State 5120, 1a] ;Get up anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = !var(19)
trigger1 = command = "holdback"
trigger2 = command = "holdfwd"
value = 5125

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
trigger1 = anim = 5125
fvar(0) = ifelse(command="holdback",-1,1)

[State 5120, 2]
type = VelSet
trigger1 = Time = 0
x = 0

[State 0, PosAdd]
type = PosAdd
triggerall = anim = 5125
trigger1 = animelem = 4
x = ceil(250*const(size.xscale)*fvar(0))

[State 0, Turn]
type = Turn
triggerall = anim = 5125
trigger1 = animelem = 5
trigger1 = p2dist x < 0

[State 0, PlaySnd]
type = PlaySnd
triggerall = anim = 5125
trigger1 = animelem = 2
value = S0,12

[State 0, Explod]
type = Explod
triggerall = anim = 5125
trigger1 = animelem = 2
trigger2 = animelem = 4
anim = 1202
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
triggerall = anim = 5125
trigger1 = animelem = 3
anim = 1201
pos = 0,ceil(-32*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
vel = -2,-5
accel = 0.0416,0.2
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1
shadow = -1,-1,-1

[State 5120, 3]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 5120, 4]
type = HitFallSet
trigger1 = AnimTime = 0
value = 1

[State 5120, 5] ;Can't be thrown right after getting up
type = NotHitBy
trigger1 = AnimTime = 0
value = , NT,ST,HT
time = 12

[State 5120, 6] ;Can't be hit right after getting up (short time)
type = NotHitBy
trigger1 = AnimTime = 0
value2 = SCA
time = 3

[State 5120, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Downed get-hit (lying defeated)
[Statedef 5150]
type    = L
movetype= H
physics = N
sprpriority = -3
ctrl = 0

[State 5150, 1] ;Normal anim
type = ChangeAnim
triggerall = Time = 0
triggerall = SelfAnimExist(5140+(10000*var(19)))
trigger1 = (anim != [5111+(10000*var(19)),5119+(10000*var(19))]) && (anim != [5171+(10000*var(19)),5179+(10000*var(19))])
trigger2 = !SelfAnimExist(5140+(10000*var(19)) + (anim % 10))
value = 5140+(10000*var(19))

[State 5150, 3] ;Hit up type anim
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (anim = [5111+(10000*var(19)),5119+(10000*var(19))]) || (anim = [5171+(10000*var(19)),5179+(10000*var(19))])
trigger1 = SelfAnimExist(5140 + (anim % 10))
value = 5140+(10000*var(19)) + (anim % 10)

[State 5150, 4] ;Match over anim
type = ChangeAnim
persistent = 0
;trigger1 = Time = 0
trigger1 = MatchOver = 1
trigger1 = Anim = [5140+(10000*var(19)),5149+(10000*var(19))]
trigger1 = SelfAnimExist(anim+10)
value = anim+10

[State 5150, 5] ;Switch to 5110 if liedead anim does not exist
type = ChangeAnim
trigger1 = Time = 0
trigger1 = Anim != [5140+(10000*var(19)),5159+(10000*var(19))]
trigger1 = Anim != [5110+(10000*var(19)),5119+(10000*var(19))]
value = 5110+(10000*var(19))

[State 5150, 6] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5150, 7] ;Friction
type = VelSet
trigger1 = abs(Vel x) < 1;Const(movement.down.friction.threshold)
persistent = 0
x = 0

[State 5150, 8]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1


; Collapse
[Statedef 5130]
type = U
movetype = H
physics = S
anim = 5130; + (2 * (selfanimexist(5132) && statetype = C))
ctrl = 0

[State haha]
type = DefenceMulSet
trigger1 = 1
value = 1
ignorehitpause = 1

[State haha]
type = ChangeState
trigger1 = anim = 5130 || anim = 5132
trigger1 = animtime = 0
value = 5131

; Collapse (lying Down)
[Statedef 5131]
type = L
movetype = H
physics = C
anim = anim + 1
ctrl = 0

;[State haha]
;type = PosAdd
;trigger1 = AnimElem = 1
;x = 30 ; measure this from the original animation.
;If your character does not have a posadd in their collapse anim, you may remove this controller.

[State haha]
type = Varset
trigger1 = AnimTime = 0
sysvar(0) = 1

[State haha]
type = ChangeState
trigger1 = time >= 60
value = 5110 + IfElse(Alive, 0, 40) ;;HIT_BOUNCE


;---------------------------------------------------------------------------
; Lose by Time Over
; CNS difficulty: basic
; CNS レベル: 基本
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,120]
flag = roundnotover
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = 170,random%3
channel = 0

[State 170, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1


;---------------------------------------------------------------------------
; Win state decider
; CNS difficulty: basic
; CNS レベル: 基本
[Statedef 180]
type = S

[State 180, 1]
type = ChangeState
trigger1 = var(19)
value = 10181

[State 180, 1]
type = ChangeState
trigger1 = numexplod(3215)
value = 3225

[State 180, 1]
type = ChangeState
trigger1 = Time = 0
value = 181+random%2 ; ifelse(matchover&&random<250,189,181+random%6)

;---------------------------------------------------------------------------
; Win pose 4 - Cool I Win
; CNS difficulty: basic
; CNS レベル: 基本
[Statedef 181]
type = S
ctrl = 0
anim = 181
velset = 0,0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,320]
flag = roundnotover
ignorehitpause = 1

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 6
value = S181,random%9
channel = 0

; PARTY TIME
[Statedef 182]
type = S
ctrl = 0
anim = 3001
velset = 0,0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,420]
flag = roundnotover
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time >= 4
flag = nomusic
ignorehitpause = 1

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 4
value = 0,19
channel = 0
abspan = 0
loop = 1

[State 0, Explod]
type = Explod
trigger1 = !numexplod(3010)
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
anim = 3010
ID = 3010
pos = floor(3*const(size.xscale)), floor(-261*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
scale = const(size.xscale),const(size.yscale)
sprpriority = 5
ownpal = 1
removeongethit = 1
ignorehitpause = 1

[State 0, PalFXWiz]
type = PalFX
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (time%6)=0
time = 3
add = 200,32,64
mul = 400,256,256
sinadd = 32,32,32,4
invertall = 0
color = 100
[State 0, PalFXWiz]
type = PalFX
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (time%6)=3
time = 3
add = 64,32,200
mul = 256,256,400
sinadd = 32,32,32,4
invertall = 0
color = 100

[State 0, PalFXWiz]
type = BgPalFX
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (time%6)=0
time = 3
add = 32,16,100
mul = 256,256,300
sinadd = 16,16,16,4
invertall = 0
color = 100
[State 0, PalFXWiz]
type = BgPalFX
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (time%6)=3
time = 3
add = 100,16,32
mul = 300,256,256
sinadd = 16,16,16,4
invertall = 0
color = 100

[State 0, Explod]
type = Explod
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (time%36)=1
anim = 3012
ID = 3012
pos = floor(3*const(size.xscale)), floor(-261*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = const(size.xscale),const(size.yscale)
sprpriority = 3
ownpal = 1
removeongethit = 1
ignorehitpause = 1
[State 0, Explod]
type = Explod
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (time%36)=10
anim = 3013
ID = 3012
pos = floor(3*const(size.xscale)), floor(-261*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = const(size.xscale),const(size.yscale)
sprpriority = 3
ownpal = 1
removeongethit = 1
ignorehitpause = 1
[State 0, Explod]
type = Explod
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (time%36)=19
anim = 3014
ID = 3012
pos = floor(3*const(size.xscale)), floor(-261*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = const(size.xscale),const(size.yscale)
sprpriority = 3
ownpal = 1
removeongethit = 1
ignorehitpause = 1
[State 0, Explod]
type = Explod
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (time%36)=28
anim = 3015
ID = 3012
pos = floor(3*const(size.xscale)), floor(-261*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = const(size.xscale),const(size.yscale)
sprpriority = 3
ownpal = 1
removeongethit = 1
ignorehitpause = 1

;---------------------------------------------------------------------------
; Win pose 4 - Cool I Win
; CNS difficulty: basic
; CNS レベル: 基本
[Statedef 10181]
type = S
ctrl = 0
anim = 10181
velset = 0,0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,ifelse(var(39)=10,240,120)]
flag = roundnotover
ignorehitpause = 1

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 810, Grab Sound]
type = PlaySnd
trigger1 = time = 0
value = 30, 11
channel = 0

[State 810, Grab Sound]
type = PlaySnd
triggerall = matchover
trigger1 = var(39) >= 10
trigger1 = time = 120
value = 189, 0
abspan = 0

[State 0, Explod]
type = Explod
triggerall = matchover
trigger1 = var(39) >= 10
trigger1 = time = 120
anim = 10189
ID = 10189
pos = 160,100
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
pausemovetime = 65535
supermovetime = 65535
scale = 1,1
ontop = 1
ownpal = 1
ignorehitpause = 1



[Statedef 3225]
type = S
ctrl = 0
anim = 3225
velset = 0,0

[State 0, StopSnd]
type = StopSnd
trigger1 = time = 0
trigger2 = time = 210
channel = -1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time
trigger1 = numexplod(3215)
id = 3215

[State 0, Lines]
type = Explod
trigger1 = time = 0
anim = 3216
ID = 3216
pos = 160,0
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = 666,.5
sprpriority = 310
ownpal = 1
supermovetime = 65535
pausemovetime = 65535

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = .5,.5
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,240]
flag = roundnotover
ignorehitpause = 1

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time >= 210
flag = noFG
flag2 = noBG
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = time = 210
anim = 3226
ID = 3226
pos = 160,0
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
scale = .5,.5
sprpriority = 777
ontop = 1
ownpal = 1


[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 210
value = 0,25
abspan = 0
channel = 0


;---------------------------------------------------------------------------
; PREINTRO
[Statedef 190]
type = S
ctrl = 0
velset = 0,0

[State 190, 1]
type = ChangeAnim
trigger1 = SelfAnimExist(190)
value = 190

[State 190, 2] ;
type = ChangeState
trigger1 = p2name = "Robert Garcia"
trigger2 = p2name = "Robert"
trigger3 = p2name = "Robo-ert"
trigger4 = p2name = "Ryo Sakazaki"
trigger5 = p2name = "Ryo"
trigger6 = p2name = "F-Zeryo"
value = 196

[State 190, 2] ;
type = ChangeState
trigger1 = p2name = "Terry Bogard"
trigger2 = p2name = "Terry"
trigger3 = p2name = "CvsTerry"
trigger4 = p2name = "Ultimate Terry"
trigger5 = p2name = "Lone Wolf"
trigger6 = p2name = "Tevery Bogard"
trigger7 = p2name = "Terry_WLS"
value = 197

[State 190, 2] ;
type = ChangeState
trigger1 = p2name = "Sonic The Hedgehog"
trigger2 = p2name = "Super Sonic"
trigger3 = p2name = "Sonic"
trigger4 = p2name = "Neo-Sonic"
trigger5 = p2name = "Time Flux Sonic"
trigger6 = p2name = "Chris Redfield" ; lol
value = 198

[State 190, 2] ;Go straight to intro.
type = ChangeState
trigger1 = p2name = "Magic Geese"
trigger2 = p2name = "Geese Howard"
trigger3 = p2name = "Master Geese"
trigger4 = p2name = "Geese"
trigger5 = p2name = "Crazy Laughing Geese"
trigger6 = p2name = "geese_wls"
value = 199

[State 190, 2] ;Go straight to intro.
type = ChangeState
trigger1 = Time = 0
value = 191;+random%4


;---------------------------------------------------------------------------
; Introduction
; CNS difficulty: basic
; CNS レベル: 基本
[Statedef 191]
type = S
ctrl = 0
anim = 190
velset = 0,0

[State 191, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = 190

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 2
fvar(0) = -320
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = animelemtime(2) >= 0
fvar(0) = ifelse(fvar(0)>=-2,0,ifelse(fvar(0)>=-70,fvar(0) + 2,fvar(0) + 4))

[State 0, ScreenBound]
type = ScreenBound
trigger1 = fvar(0)
value = 0
movecamera = 0,0
ignorehitpause = 1

[State 0, Offset]
type = Offset
trigger1 = fvar(0)
y = fvar(0)

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = animelemtime(2) >= 0
trigger1 = animelemtime(4) < 0
trigger1 = fvar(0) < 0
value = anim
elem = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = S190,random%8
channel = 0

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; Introduction
; CNS difficulty: basic
; CNS レベル: 基本
[Statedef 196]
type = S
ctrl = 0
anim = 1960+random%2
velset = 0,0

[State 191, 1]
type = ChangeAnim
triggerall = Time = 0
trigger1 = p2name = "Robert"
trigger2 = p2name = "Robert Garcia"
trigger3 = p2name = "Robo-ert"
trigger4 = p2name = "Robert_wls"
trigger5 = p2name = "Lobaut"
value = 1960

[State 191, 1]
type = ChangeAnim
triggerall = Time = 0
trigger1 = p2name = "Ryo Sakazaki"
trigger2 = p2name = "Ryo"
trigger3 = p2name = "F-Zeryo"
trigger4 = p2name = "CCI Ryo"
trigger5 = p2name = "cvsRyo"
value = 1961


[State 191, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = anim

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 1960
trigger1 = animelem = 6
value = 0,43
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 1960
trigger1 = animelem = 9
trigger2 = anim = 1961
trigger2 = animelem = 8
value = S0,12

[State 0, Explod]
type = Explod
trigger1 = anim = 1960
trigger1 = animelem = 9
trigger2 = anim = 1961
trigger2 = animelem = 8
anim = 1202
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; Introduction
; CNS difficulty: basic
; CNS レベル: 基本
[Statedef 197]
type = S
ctrl = 0
anim = 197
velset = 0,0

[State 191, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = anim

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = S204,random%3
channel = 0
[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 8
value = S2,15
channel = 0
[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 17
value = S2,16
channel = 0

[State 0, Offset]
type = Offset
trigger1 = animelemtime(12) >= 0
trigger1 = animelemtime(52) < 0
x = -1+random%3
y = -1+random%3
ignorehitpause = 1

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; Introduction
; CNS difficulty: basic
; CNS レベル: 基本
[Statedef 198]
type = S
ctrl = 0
anim = 198
velset = 0,0

[State 191, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = anim

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 198
trigger1 = animelem = 4
value = S198,random%2
channel = 0

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; Introduction
; CNS difficulty: basic
; CNS レベル: 基本
[Statedef 199]
type = S
ctrl = 0
anim = ifelse(teamside=1,1990,1991)
velset = 0,0

[State 191, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = anim

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 1990
trigger1 = animelem = 8
trigger2 = anim = 1991
trigger2 = animelem = 12
value = S199,anim-1990
channel = 0

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; Taunt
; CNS difficulty: easy
[Statedef 195]
type = S
ctrl = 0
anim = 195
velset = 0,0
movetype = I
physics = S
sprpriority = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
trigger1 = var(19)
value = S0,12

[State 0, Explod]
type = Explod
trigger1 = time = 0
trigger1 = var(19)
anim = 1202
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(19) = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = S195,random%6
channel = 0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
trigger1 = roundstate >= 3
var(48) = 1

[State 195, 1]
type = CtrlSet
trigger1 = Time = 10
value = 1

[State 195, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Stand Light Punch
[Statedef 200]
type    = S
movetype= A
physics = S
juggle  = ifelse(var(40) & floor(exp(1*ln(2)) + 0.5) ,1,0)
velset = 0,0
ctrl = 0
anim = ifelse(p2bodydist x<=10&&anim!=201&&anim!=200,201,200)
poweradd = 10
sprpriority = 2
facep2 = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(40) = var(40) | floor(exp(1*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.9
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = anim = 200
trigger1 = animelem = 2
trigger2 = anim = 201
trigger2 = animelem = 2
value = 0, 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S200,random%4
channel = 0
lowpriority = 1

[State 200, 1]
type = HitDef
trigger1 = anim = 200
trigger1 = AnimElem = 2
attr = S, NA
damage = 20, 0
animtype = Light
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S900
guard.sparkno = S905
sparkxy = -10, ceil(-174 * const(size.yscale) )
hitsound = S5, 0
guardsound = S6, 0
ground.type = High
ground.slidetime = ceil(14*ifelse(var(31),1.2,1))
ground.hittime  = ceil(14*ifelse(var(31),1.2,1))
ground.velocity = -6
airguard.velocity = -5,-4.4
air.type = High
air.velocity = -5,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 12
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 200, 1]
type = HitDef
trigger1 = anim = 201
trigger1 = AnimElem = 3
attr = S, NA
damage = 25, 0
animtype = Light
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S900
guard.sparkno = S905
sparkxy = -10, ceil(-200 * const(size.yscale) )
hitsound = S5, 0
guardsound = S6, 0
ground.type = High
ground.slidetime = ceil(14*ifelse(var(31),1.2,1))
ground.hittime  = ceil(14*ifelse(var(31),1.2,1))
ground.velocity = -6
airguard.velocity = -5,-4.4
air.type = High
air.velocity = -5,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 12
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = anim = 200
trigger1 = animelem = 3
trigger2 = anim = 201
trigger2 = animelem = 4
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Stand Medium Punch
[Statedef 210]
type    = S
movetype= A
physics = S
juggle  = ifelse(var(40) & floor(exp(2*ln(2)) + 0.5) ,1,0)
;velset = 0,0
ctrl = 0
anim = ifelse(p2bodydist x<=15,211,210)
poweradd = 20
sprpriority = 2
facep2 = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(40) = var(40) | floor(exp(2*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.8
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = anim = 210
trigger1 = animelem = 4
trigger2 = anim = 211
trigger2 = animelem = 2
value = 0, 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S200,random%4
channel = 0
lowpriority = 1

[State 200, 1]
type = HitDef
trigger1 = anim = 210
trigger1 = AnimElem = 5
attr = S, NA
damage = 55, 0
animtype = medium
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S901
guard.sparkno = S905
sparkxy = -10, ceil(-151 * const(size.yscale) )
hitsound = S5, 1
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(20*ifelse(var(31),1.2,1))
ground.hittime  = ceil(20*ifelse(var(31),1.2,1))
ground.velocity = -7.8
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -2,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 14
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 200, 1]
type = HitDef
trigger1 = anim = 211
trigger1 = AnimElem = 3
attr = S, NA
damage = 45, 0
animtype = medium
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S901
guard.sparkno = S905
sparkxy = -10, ceil(-142 * const(size.yscale) )
hitsound = S5, 1
guardsound = S6, 0
ground.type = High
ground.slidetime = ceil(14*ifelse(var(31),1.2,1))
ground.hittime  = ceil(14*ifelse(var(31),1.2,1))
ground.velocity = -6.5
airguard.velocity = -5,-4.4
air.type = High
air.velocity = -2,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 13
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = anim = 210
trigger1 = animelem = 6
trigger2 = anim = 211
trigger2 = animelem = 4
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Stand Hard Punch
[Statedef 220]
type    = S
movetype= A
physics = S
juggle  = ifelse(var(40) & floor(exp(3*ln(2)) + 0.5) ,1,0)
;velset = 0,0
ctrl = 0
anim = ifelse(p2bodydist x<=12&&(anim!=[200,241]),221,220)
poweradd = 40
sprpriority = 2
facep2 = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(40) = var(40) | floor(exp(3*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = anim = 220
trigger1 = animelem = 4
trigger2 = anim = 221
trigger2 = animelem = 2
value = 0, 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S202,random%4
channel = 0
lowpriority = 1

[State 0, VelSet]
type = VelSet
trigger1 = anim = 220
trigger1 = animelemtime(3) >= 0
trigger1 = animelemtime(7) < 0
x = 1.5
[State 0, VelSet]
type = VelSet
trigger1 = anim = 220
trigger1 = animelemtime(7) = 0
x = 0

;[State 0, PosAdd]
;type = PosAdd
;trigger1 = anim = 220
;trigger1 = animelem = 3
;x = -8*const(size.xscale)
;[State 0, PosAdd]
;type = PosAdd
;trigger1 = anim = 220
;trigger1 = animelem = 4
;x = -60*const(size.xscale)
[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 220
trigger1 = animelem = 5
x = 50*const(size.xscale)
[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 220
trigger1 = animelem = 6
x = 36*const(size.xscale)
[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 220
trigger1 = animelem = 7
x = 8*const(size.xscale)
[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 220
trigger1 = animelem = 8
x = 8*const(size.xscale)
[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 221
trigger1 = animelem = 3
x = 26*const(size.xscale)

[State 200, 1]
type = HitDef
trigger1 = anim = 220
trigger1 = AnimElem = 7
attr = S, NA
damage = 75, 0
animtype = hard
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S902
guard.sparkno = S905
sparkxy = -10, ceil(-130 * const(size.yscale) )
hitsound = S5, 2
guardsound = S6, 0
ground.type = hard
ground.slidetime = ceil(26*ifelse(var(31),1.2,1))
ground.hittime  = ceil(26*ifelse(var(31),1.2,1))
ground.velocity = -12
airguard.velocity = -5,-4.4
air.type = hard
air.velocity = -5,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 200, 1]
type = HitDef
trigger1 = anim = 221
trigger1 = AnimElem = 3
attr = S, NA
damage = 70, 0
animtype = hard
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S902
guard.sparkno = S905
sparkxy = -10, ceil(-130 * const(size.yscale) )
hitsound = S5, 2
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(21*ifelse(var(31),1.2,1))
ground.hittime  = ceil(21*ifelse(var(31),1.2,1))
ground.velocity = -9.5
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -2,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = anim = 220
trigger1 = animelem = 8
trigger2 = anim = 221
trigger2 = animelem = 4
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Stand Light Kick
[Statedef 230]
type    = S
movetype= A
physics = S
juggle  = ifelse(var(40) & floor(exp(4*ln(2)) + 0.5) ,1,0)
;velset = 0,0
ctrl = 0
anim = ifelse(p2bodydist x<=10&&anim!=201&&anim!=200,231,230)
poweradd = 10
sprpriority = 2
facep2 = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(40) = var(40) | floor(exp(4*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.9
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = anim = 230
trigger1 = animelem = 3
trigger2 = anim = 231
trigger2 = animelem = 2
value = 0, 3

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S200,random%4
channel = 0
lowpriority = 1

[State 200, 1]
type = HitDef
trigger1 = anim = 230
trigger1 = AnimElem = 4
attr = S, NA
damage = 20, 0
animtype = Light
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S900
guard.sparkno = S905
sparkxy = -10, ceil(-66 * const(size.yscale) )
hitsound = S5, 3
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(14*ifelse(var(31),1.2,1))
ground.hittime  = ceil(14*ifelse(var(31),1.2,1))
ground.velocity = -6.5
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -5,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 12
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 200, 1]
type = HitDef
trigger1 = anim = 231
trigger1 = AnimElem = 2
attr = S, NA
damage = 25, 0
animtype = Light
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S900
guard.sparkno = S905
sparkxy = -10, ceil(-135 * const(size.yscale) )
hitsound = S5, 3
guardsound = S6, 0
ground.type = High
ground.slidetime = ceil(14*ifelse(var(31),1.2,1))
ground.hittime  = ceil(14*ifelse(var(31),1.2,1))
ground.velocity = -5.5
airguard.velocity = -5,-4.4
air.type = High
air.velocity = -5,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 12
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = anim = 230
trigger1 = animelem = 5
trigger2 = anim = 231
trigger2 = animelem = 3
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Stand Medium Kick
[Statedef 240]
type    = S
movetype= A
physics = S
juggle  = ifelse(var(40) & floor(exp(5*ln(2)) + 0.5) ,1,0)
;velset = 0,0
ctrl = 0
anim = ifelse(p2bodydist x<=13&&(anim!=[200,231]),241,240)
poweradd = 20
sprpriority = 2
facep2 = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(40) = var(40) | floor(exp(5*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.8
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = anim = 240
trigger1 = animelem = 2
trigger2 = anim = 241
trigger2 = animelem = 4 || animelem = 7
value = 0, 4

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S201,random%4
channel = 0
lowpriority = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 240
trigger1 = animelem = 2
x = 40*const(size.xscale);30*const(size.xscale)
[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 240
trigger1 = animelem = 4
x = 14*const(size.xscale)

[State 200, 1]
type = HitDef
trigger1 = anim = 240
trigger1 = AnimElem = 5
trigger2 = anim = 241
trigger2 = AnimElem = 7
attr = S, NA
damage = ifelse(movehit,35,52), 0
animtype = medium
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S901
guard.sparkno = S905
sparkxy = -10, ceil(-138 * const(size.yscale) )
hitsound = S5, 4
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(20*ifelse(var(31),1.2,1))
ground.hittime  = ceil(20*ifelse(var(31),1.2,1))
ground.velocity = -8.5
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -2,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 14
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 200, 1]
type = HitDef
trigger1 = anim = 241
trigger1 = AnimElem = 3
attr = S, NA
damage = 35, 0
animtype = medium
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S901
guard.sparkno = S905
sparkxy = -10, ceil(-206 * const(size.yscale) )
hitsound = S5, 4
guardsound = S6, 0
ground.type = High
ground.slidetime = ceil(16*ifelse(var(31),1.2,1))
ground.hittime  = ceil(16*ifelse(var(31),1.2,1))
ground.velocity = -4.5
airguard.velocity = -5,-4.4
air.type = High
air.velocity = -1,-7.7
air.hittime = 12
air.fall = 1
guard.ctrltime = 14
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = anim = 240
trigger1 = animelem = 6
trigger2 = anim = 241
trigger2 = animelem = 8
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Stand Hard Kick
[Statedef 250]
type    = S
movetype= A
physics = S
juggle  = ifelse(var(40) & floor(exp(6*ln(2)) + 0.5) ,1,0)
;velset = 0,0
ctrl = 0
anim = ifelse(p2bodydist x<=15,251,250)
poweradd = 40
sprpriority = 2
facep2 = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(40) = var(40) | floor(exp(6*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = anim = 250
trigger1 = animelem = 3
trigger2 = anim = 251
trigger2 = animelem = 2
value = 0, 5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 250
trigger1 = animelem = 3
trigger2 = anim = 251
trigger2 = animelem = 5
value = S202,random%4
channel = 0
lowpriority = 1



[State 200, 1]
type = HitDef
trigger1 = anim = 250
trigger1 = AnimElem = 4
attr = S, NA
damage = 70, 0
animtype = hard
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S902
guard.sparkno = S905
sparkxy = -10, ceil(-140 * const(size.yscale) )
hitsound = S5, 5
guardsound = S6, 0
ground.type = hard
ground.slidetime = ceil(27*ifelse(var(31),1.2,1))
ground.hittime  = ceil(27*ifelse(var(31),1.2,1))
ground.velocity = ifelse(var(31),-1,-7),ifelse(var(31),-13.9,-7.7)
guard.velocity = -12
airguard.velocity = -5,-4.4
air.type = hard
air.velocity = ifelse(var(31),-1,-7),ifelse(var(31),-13.9,-7.7)
air.hittime = 12
air.fall = 1
fall = 1
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 200, 1]
type = HitDef
trigger1 = anim = 251
trigger1 = AnimElem = 6
attr = S, NA
damage = 80, 0
animtype = hard
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S902
guard.sparkno = S905
sparkxy = -10, ceil(-130 * const(size.yscale) )
hitsound = S5, 5
guardsound = S6, 0
ground.type = hard
ground.slidetime = ceil(27*ifelse(var(31),1.2,1))
ground.hittime  = ceil(27*ifelse(var(31),1.2,1))
ground.velocity = ifelse(var(31),-1,-7),ifelse(var(31),-13.9,-7.7)
guard.velocity = -12
airguard.velocity = -5,-4.4
air.type = hard
air.velocity = ifelse(var(31),-1,-7),ifelse(var(31),-13.9,-7.7)
air.hittime = 12
air.fall = 1
fall = 1
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = anim = 250
trigger1 = animelem = 5
trigger2 = anim = 251
trigger2 = animelem = 7
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Crouch Light Punch
[Statedef 400]
type    = C
movetype= A
physics = C
juggle  = ifelse(var(40) & floor(exp(7*ln(2)) + 0.5) ,1,0)
;velset = 0,0
ctrl = 0
anim = 400
poweradd = 10
sprpriority = 2
facep2 = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(40) = var(40) | floor(exp(7*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.9
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 0, 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S200,random%4
channel = 0
lowpriority = 1

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 2
attr = C, NA
damage = 20, 0
animtype = Light
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S900
guard.sparkno = S905
sparkxy = -10, ceil(-140 * const(size.yscale) )
hitsound = S5, 0
guardsound = S6, 0
ground.type = High
ground.slidetime = ceil(12*ifelse(var(31),1.2,1))
ground.hittime  = ceil(12*ifelse(var(31),1.2,1))
ground.velocity = -5.5
airguard.velocity = -5,-4.4
air.type = High
air.velocity = -5,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 10
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 3
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; Crouch Medium Punch
[Statedef 410]
type    = C
movetype= A
physics = C
juggle  = ifelse(var(40) & floor(exp(8*ln(2)) + 0.5) ,1,0)
;velset = 0,0
ctrl = 0
anim = 410
poweradd = 20
sprpriority = 2
facep2 = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(40) = var(40) | floor(exp(8*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.8
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 3
value = 0, 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S201,random%4
channel = 0
lowpriority = 1

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 4
attr = C, NA
damage = 58, 0
animtype = up
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S902
guard.sparkno = S905
sparkxy = -10, ceil(-151 * const(size.yscale) )
hitsound = S5, 1
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(20*ifelse(var(31),1.2,1))
ground.hittime  = ceil(20*ifelse(var(31),1.2,1))
ground.velocity = -1,-18.13
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -5,-18.13
air.hittime = 12
fall = 1
air.fall = 1
guard.velocity = -8.8
guard.ctrltime = 14
fall.recovertime = 30
yaccel = .99
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 5
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; Crouch Hard Punch
[Statedef 420]
type    = C
movetype= A
physics = N
juggle  = ifelse(var(40) & floor(exp(9*ln(2)) + 0.5) ,1,0)
;velset = 0,0
ctrl = 0
anim = 420
poweradd = 40
sprpriority = 2
facep2 = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(40) = var(40) | floor(exp(9*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * ifelse(animelemtime(13)<0,0.97,0.75)
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 4
value = 0, 9

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(4) >= 0
trigger1 = animelemtime(13) < 0
x = 8.8
[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(13) = 0
x = 0
[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelemtime(13) = 0
physics = C

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 5
trigger2 = animelemtime(5) >= 0
trigger2 = animelemtime(13) < 0
trigger2 = movecontact > 2 || movereversed > 2
attr = C, NA
damage = 10, 0
animtype = medium
guardflag = MA
hitflag = MAF
pausetime = 4-var(49), 4
sparkno = S900
guard.sparkno = S905
sparkxy = -10, ceil(-39 * const(size.yscale) )
hitsound = S5, 6
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(18*ifelse(var(31),1.2,1))
ground.hittime  = ceil(18*ifelse(var(31),1.2,1))
ground.velocity = -2.2
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -2,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 13
attr = C, NA
damage = 70-hitcount, 0
animtype = hard
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S902
guard.sparkno = S905
sparkxy = -10, ceil(-39 * const(size.yscale) )
hitsound = S5, 2
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(18*ifelse(var(31),1.2,1))
ground.hittime  = ceil(18*ifelse(var(31),1.2,1))
ground.velocity = -8
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -5,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 14
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 14
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; Crouch Light Kick
[Statedef 430]
type    = C
movetype= A
physics = C
juggle  = ifelse(var(41) & floor(exp(0*ln(2)) + 0.5) ,1,0)
;velset = 0,0
ctrl = 0
anim = 430
poweradd = 10
sprpriority = 2
facep2 = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(41) = var(41) | floor(exp(0*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.9
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 0, 3

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S200,random%4
channel = 0
lowpriority = 1

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 2
attr = C, NA
damage = 20, 0
animtype = Light
guardflag = L
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S900
guard.sparkno = S905
sparkxy = -10, 0
hitsound = S5, 3
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(14*ifelse(var(31),1.2,1))
ground.hittime  = ceil(14*ifelse(var(31),1.2,1))
ground.velocity = -5.5
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -5,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 12
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 3
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; Crouch Medium Kick
[Statedef 440]
type    = C
movetype= A
physics = C
juggle  = ifelse(var(41) & floor(exp(1*ln(2)) + 0.5) ,1,0)
;velset = 0,0
ctrl = 0
anim = 440
poweradd = 20
sprpriority = 2
facep2 = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(41) = var(41) | floor(exp(1*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.8
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 0, 4

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S201,random%4
channel = 0
lowpriority = 1

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 3
attr = C, NA
damage = 45, 0
animtype = medium
guardflag = L
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S901
guard.sparkno = S905
sparkxy = -10, 0
hitsound = S5, 4
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(14*ifelse(var(31),1.2,1))
ground.hittime  = ceil(14*ifelse(var(31),1.2,1))
ground.velocity = -6.5
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -2,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 14
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 4
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; Crouch Hard Kick
[Statedef 450]
type    = C
movetype= A
physics = C
juggle  = ifelse(var(41) & floor(exp(2*ln(2)) + 0.5) ,1,0)
;velset = 0,0
ctrl = 0
anim = 450
poweradd = 40
sprpriority = 2
facep2 = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(41) = var(41) | floor(exp(2*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
;[State ProRation]
;type = VarSet
;trigger1 = var(21) = 1
;fvar(13) = fvar(13) * 0.75
;ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 0, 5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S202,random%4
channel = 0
lowpriority = 1

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 4
attr = C, NA
damage = 70, 0
animtype = hard
guardflag = L
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S902
guard.sparkno = S905
sparkxy = -10, ceil(-75 * const(size.yscale) )
hitsound = S5, 5
guardsound = S6, 0
ground.type = trip
ground.slidetime = ceil(21*ifelse(var(31),1.2,1))
ground.hittime  = ceil(21*ifelse(var(31),1.2,1))
ground.velocity = -5,-10.8
airguard.velocity = -5,-4.4
air.type = trip
air.velocity = -5,-10.8
air.hittime = 12
air.fall = 1
guard.velocity = -10
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 5
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1


;---------------------------------------------------------------------------
;Jump Light Punch
[Statedef 600]
type    = A
movetype= A
physics = A
juggle  = ifelse(var(41) & floor(exp(3*ln(2)) + 0.5) ,1,0)
poweradd= 10
ctrl = 0
anim = 600
sprpriority = 2

[State 600, AirCombo velset] ; this will have
type = VelSet
trigger1 = numtarget
trigger1 = time = 1
trigger1 = (prevstateno = [600,659])
trigger1 = p2statetype = A
trigger1 = p2movetype = H
;x = ifelse(abs(p2bodydist x / 8)>=4,4,abs(p2bodydist x / 8))
x = ifelse(abs(p2bodydist x / 8)>=3,ifelse(p2bodydist x>0,3,-3),(p2bodydist x / 8))
y = -8
[State 600, AirCombo Vellimit]
type = VelMul
trigger1 = prevstateno >= 200
trigger1 = abs(vel x) >= 3
trigger1 = (p2statetype != A) || (p2movetype != H)
x = 0.83

[State Neo-Juggle-System-Flag]
type = VarSet
;trigger1 = !(var(40) & floor(exp(1*ln(2)) + 0.5) )
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(41) = var(41) | floor(exp(3*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.9
ignorehitpause = 1

[State 600, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 0, 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S200,random%4
channel = 0
lowpriority = 1

[State 600, 2]
type = HitDef
trigger1 = animelem = 2
attr = A, NA
animtype = light
damage = 35-ifelse((prevstateno=[600,640]),20,0)
guardflag = HA
pausetime = 8-var(49),8
sparkno = S900
guard.sparkno = S905
sparkxy = -10,ceil(-100 * const(size.yscale) )
hitsound   = S5,0
guardsound = S6,0
ground.type = High
ground.slidetime = ceil(14*ifelse(var(31),1.25,1))
ground.hittime  = ceil(14*ifelse(var(31),1.25,1))
ground.velocity = -4
guard.ctrltime = 6
air.velocity = -2,-8.7+ifelse(var(31),-1.13,0)
air.fall = 1
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 3
movetype = I

[State 0, CtrlSet]
type = CtrlSet
trigger1 = animelem = 8
value = 1

;---------------------------------------------------------------------------
;Jump Medium Punch
[Statedef 610]
type    = A
movetype= A
physics = A
juggle  = ifelse(var(41) & floor(exp(4*ln(2)) + 0.5) ,1,0)
poweradd= 15
ctrl = 0
anim = 610
sprpriority = 2

[State 600, AirCombo velset] ; this will have
type = VelSet
trigger1 = numtarget
trigger1 = time = 1
trigger1 = (prevstateno = [600,659])
trigger1 = p2statetype = A
trigger1 = p2movetype = H
;x = ifelse(abs(p2bodydist x / 8)>=4,4,abs(p2bodydist x / 8))
x = ifelse(abs(p2bodydist x / 8)>=3,ifelse(p2bodydist x>0,3,-3),(p2bodydist x / 8))
y = -8
[State 600, AirCombo Vellimit]
type = VelMul
trigger1 = prevstateno >= 200
trigger1 = abs(vel x) >= 3
trigger1 = (p2statetype != A) || (p2movetype != H)
x = 0.83

[State Neo-Juggle-System-Flag]
type = VarSet
;trigger1 = !(var(40) & floor(exp(1*ln(2)) + 0.5) )
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(41) = var(41) | floor(exp(4*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.8
ignorehitpause = 1

[State 600, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 0, 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S201,random%4
channel = 0
lowpriority = 1

[State 600, 2]
type = HitDef
trigger1 = animelem = 2
attr = A, NA
animtype = medium
damage = 50-ifelse((prevstateno=[600,640]),20,0)
guardflag = HA
pausetime = 8-var(49),8
sparkno = S901
guard.sparkno = S905
sparkxy = -10,ceil(-196 * const(size.yscale) )
hitsound   = S5,1
guardsound = S6,0
ground.type = High
ground.slidetime = ceil(17*ifelse(var(31),1.25,1))
ground.hittime  = ceil(17*ifelse(var(31),1.25,1))
ground.velocity = -4
guard.ctrltime = 9
air.velocity = -2,-7.7+ifelse(var(31),-1.13,0)
air.fall = 1
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 3
movetype = I

[State 0, CtrlSet]
type = CtrlSet
trigger1 = animelem = 6
value = 1

;---------------------------------------------------------------------------
;Jump hard Punch
[Statedef 620]
type    = A
movetype= A
physics = A
juggle  = ifelse(var(41) & floor(exp(5*ln(2)) + 0.5) ,1,0)
poweradd= 15
ctrl = 0
anim = 620
sprpriority = 2

[State 600, AirCombo velset] ; this will have
type = VelSet
trigger1 = numtarget
trigger1 = time = 1
trigger1 = (prevstateno = [600,659])
trigger1 = p2statetype = A
trigger1 = p2movetype = H
;x = ifelse(abs(p2bodydist x / 8)>=4,4,abs(p2bodydist x / 8))
x = ifelse(abs(p2bodydist x / 8)>=3,ifelse(p2bodydist x>0,3,-3),(p2bodydist x / 8))
y = -8
[State 600, AirCombo Vellimit]
type = VelMul
trigger1 = prevstateno >= 200
trigger1 = abs(vel x) >= 3
trigger1 = (p2statetype != A) || (p2movetype != H)
x = 0.83

[State Neo-Juggle-System-Flag]
type = VarSet
;trigger1 = !(var(40) & floor(exp(1*ln(2)) + 0.5) )
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(41) = var(41) | floor(exp(5*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 600, 1]
type = PlaySnd
trigger1 = animelem = 4
value = 0, 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S202,random%4
channel = 0
lowpriority = 1

[State 600, 2]
type = HitDef
trigger1 = animelem = 5
attr = A, NA
animtype = hard
damage = 70-ifelse((prevstateno=[600,640]),20,0)
guardflag = HA
pausetime = 8-var(49),8
sparkno = S902
guard.sparkno = S905
sparkxy = -10,ceil(-99 * const(size.yscale) )
hitsound   = S5,2
guardsound = S6,0
ground.type = High
ground.slidetime = ceil(20*ifelse(var(31),1.25,1))
ground.hittime  = ceil(20*ifelse(var(31),1.25,1))
ground.velocity = -4
guard.ctrltime = 12
air.velocity = -7,7.7
air.fall = 1
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
id = 620
[State WHAMO]
type = TargetState
triggerall = numtarget(620)
trigger1 = !target(620),ishelper
trigger1 = target(620),statetype=A
trigger1 = var(21)=1
value = 625
ignorehitpause = 1
;persistent = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 6
movetype = I

[State 0, CtrlSet]
type = CtrlSet
trigger1 = animelem = 8
value = 1

;----------------------------------------------------------------------
; A custom state that just
[Statedef 625]
type = A
movetype = H
physics = N

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = time = 0
value = ifelse(selfanimexist(5061),5061,5050)
ignorehitpause = 1
[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = time = 0
value = anim
elem = animelemno(99)
ignorehitpause = 1
[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = !hitshakeover
value = anim
elem = animelemno(0)
ignorehitpause = 1

[State 0, HitVelSet]
type = HitVelSet
trigger1 = time = 0
x = 1
y = 1
ignorehitpause = 1
[State 0, HitFallSet]
type = HitFallSet
trigger1 = time = 0
value = 1
[State 0, PosFreeze]
type = PosFreeze
trigger1 = !hitshakeover
value = 1
ignorehitpause = 1

[State 821, 1] ;Gravity
type = VelAdd
Trigger1 = hitshakeover
y = gethitvar(yaccel)

[State 821, 4] ;Hit ground
type = SelfState;ChangeState
Trigger1 = hitshakeover
trigger1 = Vel Y > 0
trigger1 = vel y + Pos Y >= 0
value = 5100;616 ;Hit ground


;---------------------------------------------------------------------------
;Jump Light Kick
[Statedef 630]
type    = A
movetype= A
physics = A
juggle  = ifelse(var(41) & floor(exp(6*ln(2)) + 0.5) ,1,0)
poweradd= 10
ctrl = 0
anim = 630
sprpriority = 2

[State 600, AirCombo velset] ; this will have
type = VelSet
trigger1 = numtarget
trigger1 = time = 1
trigger1 = (prevstateno = [600,659])
trigger1 = p2statetype = A
trigger1 = p2movetype = H
;x = ifelse(abs(p2bodydist x / 8)>=4,4,abs(p2bodydist x / 8))
x = ifelse(abs(p2bodydist x / 8)>=3,ifelse(p2bodydist x>0,3,-3),(p2bodydist x / 8))
y = -8
[State 600, AirCombo Vellimit]
type = VelMul
trigger1 = prevstateno >= 200
trigger1 = abs(vel x) >= 3
trigger1 = (p2statetype != A) || (p2movetype != H)
x = 0.83

[State Neo-Juggle-System-Flag]
type = VarSet
;trigger1 = !(var(40) & floor(exp(1*ln(2)) + 0.5) )
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(41) = var(41) | floor(exp(6*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.9
ignorehitpause = 1

[State 600, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 0, 3

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S200,random%4
channel = 0
lowpriority = 1

[State 600, 2]
type = HitDef
trigger1 = animelem = 2
attr = A, NA
animtype = light
damage = 40-ifelse((prevstateno=[600,640]),20,0)
guardflag = HA
pausetime = 8-var(49),8
sparkno = S900
guard.sparkno = S905
sparkxy = -10,ceil(-47 * const(size.yscale) )
hitsound   = S5,3
guardsound = S6,0
ground.type = High
ground.slidetime = ceil(16*ifelse(var(31),1.25,1))
ground.hittime  = ceil(16*ifelse(var(31),1.25,1))
ground.velocity = -4
guard.ctrltime = 8
air.velocity = -2,-8.7+ifelse(var(31),-1.13,0)
air.fall = 1
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 7
movetype = I

[State 0, CtrlSet]
type = CtrlSet
trigger1 = animelem = 8
value = 1

;---------------------------------------------------------------------------
;Jump Medium Kick
[Statedef 640]
type    = A
movetype= A
physics = A
juggle  = ifelse(var(41) & floor(exp(7*ln(2)) + 0.5) ,1,0)
poweradd= 15
ctrl = 0
anim = 640
sprpriority = 2

[State 600, AirCombo velset] ; this will have
type = VelSet
trigger1 = numtarget
trigger1 = time = 1
trigger1 = (prevstateno = [600,659])
trigger1 = p2statetype = A
trigger1 = p2movetype = H
;x = ifelse(abs(p2bodydist x / 8)>=4,4,abs(p2bodydist x / 8))
x = ifelse(abs(p2bodydist x / 8)>=3,ifelse(p2bodydist x>0,3,-3),(p2bodydist x / 8))
y = -8
[State 600, AirCombo Vellimit]
type = VelMul
trigger1 = prevstateno >= 200
trigger1 = abs(vel x) >= 3
trigger1 = (p2statetype != A) || (p2movetype != H)
x = 0.83

[State Neo-Juggle-System-Flag]
type = VarSet
;trigger1 = !(var(40) & floor(exp(1*ln(2)) + 0.5) )
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(41) = var(41) | floor(exp(7*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.8
ignorehitpause = 1

[State 600, 1]
type = PlaySnd
trigger1 = animelem = 3
value = 0, 4

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S201,random%4
channel = 0
lowpriority = 1

[State 600, 2]
type = HitDef
trigger1 = animelem = 4
attr = A, NA
animtype = medium
damage = 55-ifelse((prevstateno=[600,640]),20,0)
guardflag = HA
pausetime = 8-var(49),8
sparkno = S901
guard.sparkno = S905
sparkxy = -10,ceil(-139 * const(size.yscale) )
hitsound   = S5,4
guardsound = S6,0
ground.type = High
ground.slidetime = ceil(18*ifelse(var(31),1.25,1))
ground.hittime  = ceil(18*ifelse(var(31),1.25,1))
ground.velocity = -4
guard.ctrltime = 10
air.velocity = -2,-7.7+ifelse(var(31),-1.13,0)
air.fall = 1
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 5
movetype = I

[State 0, CtrlSet]
type = CtrlSet
trigger1 = animelem = 8
value = 1

;---------------------------------------------------------------------------
;Jump hard Kick
[Statedef 650]
type    = A
movetype= A
physics = A
juggle  = ifelse(var(41) & floor(exp(8*ln(2)) + 0.5) ,1,0)
poweradd= 15
ctrl = 0
anim = 650
sprpriority = 2

[State 600, AirCombo velset] ; this will have
type = VelSet
trigger1 = numtarget
trigger1 = time = 1
trigger1 = (prevstateno = [600,659])
trigger1 = p2statetype = A
trigger1 = p2movetype = H
;x = ifelse(abs(p2bodydist x / 8)>=4,4,abs(p2bodydist x / 8))
x = ifelse(abs(p2bodydist x / 8)>=3,ifelse(p2bodydist x>0,3,-3),(p2bodydist x / 8))
y = -8
[State 600, AirCombo Vellimit]
type = VelMul
trigger1 = prevstateno >= 200
trigger1 = abs(vel x) >= 3
trigger1 = (p2statetype != A) || (p2movetype != H)
x = 0.83

[State Neo-Juggle-System-Flag]
type = VarSet
;trigger1 = !(var(40) & floor(exp(1*ln(2)) + 0.5) )
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(41) = var(41) | floor(exp(8*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 600, 1]
type = PlaySnd
trigger1 = animelem = 4
value = 0, 5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S202,random%4
channel = 0
lowpriority = 1

[State 600, 2]
type = HitDef
trigger1 = animelem = 6
attr = A, NA
animtype = hard
damage = 75-ifelse((prevstateno=[600,640]),25,0)
guardflag = HA
pausetime = 8-var(49),8
sparkno = S902
guard.sparkno = S905
sparkxy = -10,ceil(-110 * const(size.yscale) )
hitsound   = S5,5
guardsound = S6,0
ground.type = High
ground.slidetime = ceil(22*ifelse(var(31),1.25,1))
ground.hittime  = ceil(22*ifelse(var(31),1.25,1))
ground.velocity = -4
guard.ctrltime = 14
air.velocity = -1,13.7
air.fall = 1
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
id = 650
[State WHAMO]
type = TargetState
triggerall = numtarget
trigger1 = !target,ishelper
trigger1 = target,statetype=A
trigger1 = var(21)=1
value = 625
ignorehitpause = 1
;persistent = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 7
movetype = I

[State 0, CtrlSet]
type = CtrlSet
trigger1 = animelem = 9
value = 1



;---------------------------------------------------------------------------
; Dodge forward
[Statedef 700]
type    = S
physics = N
anim = 700
velset = 0,0
sprpriority = -2
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,4

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S204,random%3
channel = 0
lowpriority = 1

[State 0, PowerAdd]
type = PowerAdd
triggerall = time = 0
trigger1 = prevstateno = [150,156]
value = -1000


[State 0, AfterImage]
type = AfterImage
trigger1 = time = 0
time = 6
length = 20
palcolor = 0
palinvertall = 0
palbright = 30,30,30
palcontrast = 120,120,220
palpostbright = 0,0,0
paladd = 10,10,10
palmul = .65,.65,.65
timegap = 1
framegap = 4
trans = add
ignorehitpause = 1
[State 0, AfterImageTime]
type = AfterImageTime
trigger1 = animelemtime(7) < 0
time = 2
ignorehitpause = 1

[State 0, SprPriority]
type = SprPriority
trigger1 = animelem = 9
value = 1
ignorehitpause = 1
[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 2
x = 50*const(size.xscale)
;[State 0, PosAdd]
;type = PosAdd
;trigger1 = animelem = 3
;x = 40*const(size.xscale)
;[State 0, PosAdd]
;type = PosAdd
;trigger1 = animelem = 4
;x = 78*const(size.xscale)
;[State 0, PosAdd]
;type = PosAdd
;trigger1 = animelem = 8
;x = 70*const(size.xscale)
;[State 0, PosAdd]
;type = PosAdd
;trigger1 = animelem = 9
;x = 42*const(size.xscale)
;[State 100, 1]
;type = VelSet
;trigger1 = animelemtime(2) >= 0
;trigger1 = animelemtime(4) < 0
;x = 1
;[State 100, 1]
;type = VelSet
;trigger1 = animelemtime(2) = 0
;x = 5.6
;[State 100, 1]
;type = VelMul
;trigger1 = animelemtime(2) > 0
;trigger1 = animelemtime(6) < 0
;x = 0.93

[State 100, 1]
type = VelSet
trigger1 = animelemtime(2) < 0
x = 1
[State 100, 1]
type = VelSet
trigger1 = animelemtime(2) = 0
x = 8
[State 100, 1]
type = VelMul
trigger1 = animelemtime(2) > 0
trigger1 = animelemtime(8) < 0
x = ifelse(animelemtime(6)>=0,0.9,0.98)
[State 100, 1]
type = VelSet
trigger1 = animelemtime(8) = 0
x = 0
[State 0, PlayerPush]
type = PlayerPush
trigger1 = animelemtime(8) < 0
value = 0
ignorehitpause = 1
[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(9) < 0
;trigger2 = prevstateno = [150,456]
value = ,NA,SA,HA,NP,SP,HP
time = 1
ignorehitpause = 1

[State 100, 4]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Dodge in place
[Statedef 701]
type    = S
physics = N
anim = 701
velset = 0,0
sprpriority = -2
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S0,16
channel = 0

[State 0, AfterImage]
type = AfterImage
trigger1 = time = 0
time = 6
length = 20
palcolor = 0
palinvertall = 0
palbright = 30,30,30
palcontrast = 120,120,220
palpostbright = 0,0,0
paladd = 10,10,10
palmul = .65,.65,.65
timegap = 1
framegap = 4
trans = add
ignorehitpause = 1
[State 0, AfterImageTime]
type = AfterImageTime
trigger1 = animelemtime(4) < 0
time = 2
ignorehitpause = 1

[State 0, SprPriority]
type = SprPriority
trigger1 = animelem = 5
value = 1
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 1
[State 0, VarSet]
type = VarSet
trigger1 = time
trigger1 = animelemtime(4) < 0
fvar(0) = fvar(0) * 0.75
[State 0, VarSet]
type = VarSet
trigger1 = time
trigger1 = animelemtime(4) < 0
trigger1 = fvar(0) <= 0.1
fvar(0) = 0.1
[State 0, VarSet]
type = VarSet
trigger1 = time
trigger1 = animelemtime(4) >= 0
fvar(0) = ifelse(fvar(0)+0.123>=1,1,fvar(0)+0.123)

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = fvar(0),1
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = animelemtime(5) < 0
value = 0
ignorehitpause = 1
[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(5) < 0
trigger2 = prevstateno = [150,456]
value = ,NA,SA,HA,NP,SP,HP
time = 1
ignorehitpause = 1

[State 100, 4]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; HAH
[Statedef 702]
type    = S
movetype = A
physics = N
anim = 702
velset = 0,0
sprpriority = -2
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,4
channel = 0

[State 0, AfterImageTime]
type = AfterImageTime
trigger1 = animelemtime(6) < 0
time = 2
ignorehitpause = 1

[State 0, SprPriority]
type = SprPriority
trigger1 = animelem = 5
value = 1
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
triggerall = time
trigger1 = animelemtime(5) < 0
trigger2 = animelemtime(6) >= 0
fvar(0) = ifelse(fvar(0)+0.123>=1,1,fvar(0)+0.123)
[State 0, VarSet]
type = VarSet
triggerall = time
trigger1 = animelemtime(5) >= 0
trigger1 = animelemtime(6) < 0
fvar(0) = fvar(0) * 0.75
[State 0, VarSet]
type = VarSet
triggerall = time
triggerall = fvar(0) <= 0.1
trigger1 = animelemtime(5) >= 0
trigger1 = animelemtime(6) < 0
fvar(0) = 0.1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
trigger2 = animelem = 3
trigger3 = animelem = 4
value = S0,30
channel = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 2
trigger2 = animelem = 3
trigger3 = animelem = 4
anim = 703
ID = 703
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = const(size.xscale),const(size.yscale)
sprpriority = 3
ignorehitpause = 1

[State 0, Offset]
type = Offset
trigger1 = animelemtime(2) = [0,2]
trigger2 = animelemtime(3) = [0,2]
trigger3 = animelemtime(4) = [0,2]
x = -1+random%1
y = -1+random%1
ignorehitpause = 1

[State 0, Projectile]
type = Projectile
trigger1 = animelem = 2
trigger2 = animelem = 3
trigger3 = animelem = 4
ProjID = 704
projanim = 704
projscale = .5,.5
projremove = 0
projremovetime = 8
velocity = 0,0
remvelocity = 0,0
accel = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 990
projstagebound = 990
projheightbound = -480
offset = floor(80*const(size.xscale) + (animelemtime(2)*5) ), floor(-80*const(size.yscale) - (animelemtime(2)*3) )
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;supermove = 0
;pausemove = 0
attr = S,SP
hitflag = MAF
guardflag = MA
animtype = hard
damage = 25,0
;pausetime = 0,0
;guard.pausetime = 0,0
sparkno = S903
guard.sparkno = S905
;guard.sparkno = 20
sparkxy = 0,0
hitsound = S5,3
guardsound = S6,1
ground.type = low
ground.slidetime = ceil(30*ifelse(var(31),1.2,1))
ground.hittime = ceil(30*ifelse(var(31),1.2,1))
guard.ctrltime = 15
yaccel = 0.88
ground.velocity = -6
guard.velocity = -8
air.velocity = -2,-13.9
air.juggle = ifelse(var(42) & floor(exp(0*ln(2)) + 0.5) ,1,0)
sprpriority = 6
air.fall = 1
fall.recovertime = 40
palfx.time = 30
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,10
palfx.invertall = 0
palfx.color = 0
id = 700
;ignorehitpause = 0

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = fvar(0),1
ignorehitpause = 1


[State 100, 4]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Dodge backward
[Statedef 705]
type    = S
physics = N
anim = 705
velset = 0,0
sprpriority = -2
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,4

[State 0, Turn]
type = Turn
trigger1 = time = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S204,random%3
channel = 0
lowpriority = 1

[State 0, PowerAdd]
type = PowerAdd
triggerall = time = 0
trigger1 = prevstateno = [150,156]
value = -1000


[State 0, AfterImage]
type = AfterImage
trigger1 = time = 0
time = 6
length = 20
palcolor = 0
palinvertall = 0
palbright = 30,30,30
palcontrast = 120,120,220
palpostbright = 0,0,0
paladd = 10,10,10
palmul = .65,.65,.65
timegap = 1
framegap = 4
trans = add
ignorehitpause = 1
[State 0, AfterImageTime]
type = AfterImageTime
trigger1 = animelemtime(7) < 0
time = 2
ignorehitpause = 1

[State 0, SprPriority]
type = SprPriority
trigger1 = animelem = 9
value = 1
ignorehitpause = 1
;[State 0, PosAdd]
;type = PosAdd
;trigger1 = animelem = 3
;x = 40*const(size.xscale)
;[State 0, PosAdd]
;type = PosAdd
;trigger1 = animelem = 4
;x = 78*const(size.xscale)
;[State 0, PosAdd]
;type = PosAdd
;trigger1 = animelem = 8
;x = 70*const(size.xscale)
;[State 0, PosAdd]
;type = PosAdd
;trigger1 = animelem = 9
;x = 42*const(size.xscale)
;[State 100, 1]
;type = VelSet
;trigger1 = animelemtime(2) >= 0
;trigger1 = animelemtime(4) < 0
;x = 1
;[State 100, 1]
;type = VelSet
;trigger1 = animelemtime(2) = 0
;x = 5.6
;[State 100, 1]
;type = VelMul
;trigger1 = animelemtime(2) > 0
;trigger1 = animelemtime(6) < 0
;x = 0.93

[State 100, 1]
type = VelSet
trigger1 = animelemtime(2) < 0
x = 1
[State 100, 1]
type = VelSet
trigger1 = animelemtime(2) = 0
x = 8
[State 100, 1]
type = VelMul
trigger1 = animelemtime(2) > 0
trigger1 = animelemtime(8) < 0
x = ifelse(animelemtime(6)>=0,0.9,0.98)
[State 100, 1]
type = VelSet
trigger1 = animelemtime(8) = 0
x = 0
[State 0, PlayerPush]
type = PlayerPush
trigger1 = animelemtime(8) < 0
value = 0
ignorehitpause = 1
[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(9) < 0
;trigger2 = prevstateno = [150,456]
value = ,NA,SA,HA,NP,SP,HP
time = 1
ignorehitpause = 1

[State 100, 4]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Guard cancel dodge
[Statedef 706]
type    = S
physics = N
anim = 706
velset = 0,0
sprpriority = -2
ctrl = 0
poweradd = -1000

[State -2 Send the message]
type = Varset
trigger1 = time = 0
var(37) = var(37) | floor(exp(3*ln(2)) + 0.5)
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = ifelse(var(52)=707||command="holdback",-1,1)

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 4
x = ceil(255*const(size.xscale)*fvar(0))

[State 0, Turn]
type = Turn
trigger1 = animelem = 5
trigger1 = p2dist x < 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = S0,12

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = S0,17

[State 0, Explod]
type = Explod
trigger1 = animelem = 2
trigger2 = animelem = 4
anim = 1202
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 3
anim = 707
pos = 0,32
postype = p1
facing = ifelse(facing=-1,-1,1)
vfacing = 1
vel = 0,-5
accel = 0,0.27
bindtime = 1
removetime = -2
scale = 0.25,0.25
sprpriority = 4
ownpal = 1
;shadow = -1,-1,-1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = ,NA,SA,HA,NP,SP,HP
time = 2
ignorehitpause = 1

[State 0, CtrlSet]
type = CtrlSet
trigger1 = animelem = 7
value = 1

[State 100, 4]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Guard Counter
[Statedef 710]
type    = S
movetype = A
physics = S
anim = 710
sprpriority = -2
ctrl = 0
velset = 0,0
facep2 = 1

[State -2 Send the message]
type = Varset
trigger1 = time = 0
var(37) = var(37) | floor(exp(3*ln(2)) + 0.5)
ignorehitpause = 1


[State 0, PowerAdd]
type = PowerAdd
trigger1 = time = 0
value = -1000

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 1
[State 0, VarSet]
type = VarSet
trigger1 = animelemtime(13) < 0
fvar(0) = fvar(0) * 0.9
[State 0, VarSet]
type = VarSet
trigger1 = animelemtime(13) >= 0
fvar(0) = ifelse(fvar(0)+0.1>=1,1,fvar(0)+0.1)

[State 0, BGPalFX]
type = BGPalFX
trigger1 = 1
time = 2
;add = 0,0,0
mul = 100+ceil(156*fvar(0)),100+ceil(156*fvar(0)),100+ceil(156*fvar(0))
color = 100+ceil(156*fvar(0))
ignorehitpause =  1

[State 0, Explod]
type = Explod
trigger1 = animelem = 10
anim = 711
ID = 711
pos = 160,ceil(screenpos y)
postype = left
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
pausemovetime = 65535
supermovetime = 65535
scale = .5,.5
sprpriority = -64
ownpal = 1
removeongethit = 1
ignorehitpause = 1

[State 0, HitDef]
type = HitDef
trigger1 = animelem = 10
attr = S,HA
hitflag = MAF
guardflag =
getpower = 0,0
givepower = 0,0
animtype = diagup
priority = 3,Hit
damage = 100,0
pausetime = 0,20
;guard.pausetime = 0,0
sparkno = 3
sparkxy = -10, ceil(-158 * const(size.yscale) )
guard.sparkno = -1
hitsound = S5,13
guardsound = -1
ground.type = High
ground.slidetime = 40
ground.hittime = 40
yaccel = 0.88
ground.velocity = -5,-9.9
air.velocity = -5,-9.9
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
fall.damage = 1
kill = 0
fall.kill = 1
getpower = 0,0
envshake.time = 15
envshake.freq = 255
envshake.ampl = -8

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 11
movetype = I

[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(12) < 0
value = ,AA,AP,AT
time = 1
ignorehitpause = 1

[State 100, 4]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Focus Attack
[Statedef 730]
type    = S
movetype= A
physics = S
juggle  = ifelse(var(40) & floor(exp(0*ln(2)) + 0.5) ,1,0)
;velset = 0,0
ctrl = 0
anim = 730
poweradd = 0
sprpriority = 2
facep2 = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = 0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(0) = 0
[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(1) = (var(40) & floor(exp(0*ln(2)) + 0.5))
[State 0, VarSet]
type = VarAdd
triggerall = anim = 731
trigger1 = animelemtime(2) >= 0
trigger1 = animelemtime(5) < 0
var(0) = 1
[State 0, VarSet]
type = VarSet
trigger1 = time
fvar(0) = var(0)

[State 0, Start Charging]
type = ChangeAnim
triggerall = anim = 730
triggerall = animelemtime(2) >= 0
triggerall = animelemtime(3) <= 0
trigger1 = command = "holdz" && command = "holdc"
trigger1 = fvar(35) <= 4
trigger2 = var(52) = 731
value = 731
elem = animelemno(0)
ignorehitpause = 1

[State 0, Stop Charging]
type = ChangeAnim
triggerall = anim = 731
triggerall = animelemtime(2) >= 0
triggerall = animelemtime(5) < 0
trigger1 = command != "holdz" && command != "holdc"
;trigger1 = fvar(35) <= 4
trigger1 = var(52) != 731
value = 732
elem = animelemno(0)
ignorehitpause = 1

[State 0, PalFX]
type = PalFX
triggerall = anim = 731
trigger1 = animelemtime(2) >= 0
trigger1 = animelemtime(5) < 0
time = 2
add = var(0)*2,var(0)*2,0
mul = 256,256,256
invertall = 0
color = 256-var(0)
ignorehitpause = 1

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = (movehit = [1,2]) || ((moveguarded = [1,2]) && var(0) >= 40)
trigger1 = numtarget
;trigger1 = (target,statetype = A) || (target,statetype = L)
trigger1 = !(var(40) & floor(exp(0*ln(2)) + 0.5))
var(40) = 1 + (var(41):=0) + (var(42):=0)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 6
value = 0, 4

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = S203,random%3
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 6
value = S202,random%4
channel = 0

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 5
x = 32*const(size.xscale)
persistent = 0
[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 10
x = 32*const(size.xscale)

[State 0, ReversalDef]
type = ReversalDef
triggerall = !movehit
trigger1 = animelemtime(2) >= 0
trigger1 = animelemtime(6)< 0
reversal.attr = SCA,AA,AP
sparkno = 40
hitsound = S6,9
pausetime = 4-var(49), 16
numhits = 0
guard.dist = 0

[State 200, 1]
type = HitDef
trigger1 = var(1) != 1
trigger1 = AnimElem = 6
attr = S, SA
damage = 80+var(0), 0
animtype = hard
guardflag = M
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S902
sparkxy = -10, ceil(-130 * const(size.yscale) )
hitsound = S5, ifelse(var(0)>=40,99,ifelse(var(0)>=15,5,2))
guardsound = S6,ifelse(var(0)>=40,99,1)
ground.type = hard
ground.slidetime = ceil(25*ifelse(var(31),1.2,1))
ground.hittime  = ceil(25*ifelse(var(31),1.2,1))
ground.velocity = -10-ceil(fvar(0)/10)
guard.velocity = -10-ceil(fvar(0)/10)
airguard.velocity = -5,-4.4
air.type = hard
air.velocity = -5,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
envshake.time = 8
envshake.freq = 255
envshake.ampl = 0-ceil(fvar(0)/5)
id = 730
[State 200, 1]
type = HitDef
trigger1 = var(1) = 1
trigger1 = AnimElem = 6
attr = S, SA
damage = 80+var(0), 0
animtype = hard
guardflag = M
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S902
sparkxy = -10, ceil(-130 * const(size.yscale) )
hitsound = S5, 5
guardsound = S6,1
ground.type = hard
ground.slidetime = ceil(25*ifelse(var(31),1.2,1))
ground.hittime  = ceil(25*ifelse(var(31),1.2,1))
ground.velocity = -7,-7.7
guard.velocity = -10-ceil(fvar(0)/10)
airguard.velocity = -5,-4.4
air.type = hard
air.velocity = -7,-7.7
air.hittime = 12
fall = 1
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
envshake.time = 8
envshake.freq = 255
envshake.ampl = 0-ceil(fvar(0)/5)
id = 731

[State this method is superior]
type = TargetState
triggerall = var(1) != 1
triggerall = numtarget(730)
triggerall = !(target(730),ishelper) || (PlayerIDExist((target(730),id)) )
triggerall = target(730),statetype != A
trigger1 = var(21) = 1
trigger1 = var(0) >= 15
trigger2 = var(22) = 1
trigger2 = var(0) >= 40
value = 735
ID = 730
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
triggerall = var(1) != 1
triggerall = numtarget(730)
triggerall = !(target(730),ishelper) || (PlayerIDExist((target(730),id)) )
triggerall = var(0) >= 40
trigger1 = var(21) = 1
trigger2 = var(22) = 1
value = S5,12
abspan = 0
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 7
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Ground hit slide
[Statedef 735]
type    = U
movetype= H
physics = N
ctrl = 0

[State 5000, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim2
trigger1 = !selfanimexist(5912)
trigger1 = Time < 30
trigger2 = !selfanimexist(5955)
trigger2 = time = 30
value = 735
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
trigger1 = selfanimexist(5912)
value = 5912
ignorehitpause = 1
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 30
trigger1 = selfanimexist(5955)
value = 5955
ignorehitpause = 1

[State 0, HitFallSet]
type = HitFallSet
trigger1 = time = 0
value = 0
[State 0, HitVelSet]
type = HitVelSet
trigger1 = time = 0
x = 1
y = 0
ignorehitpause = 1
[State 0, VelSet]
type = VelSet
trigger1 = time = 0
x = vel x * 0.5
[State 0, VelSet]
type = VelSet
trigger1 = time = [1,30]
x = vel x * 0.9

[State 5001, 4]
type = VelSet
trigger1 = Time >= 30
x = 0

[State 0, VarSet]
type = VarSet
trigger1 = time = 31
sysvar(0) = (anim = 5955)

[State 5001, 6]
type = SelfState
trigger1 = anim = 735 || anim = 5955
trigger1 = animtime = 0
value = 5110
ctrl = 0


;---------------------------------------------------------------------------
;Kung Fu Throw - Attempt
; CNS difficulty: medium-advanced
; Description: Throws are not difficult to make, although then can be
;     tedious at times. Throw attempt states have a HitDef of a
;     special format. The key parameters in a throw are p1stateno
;     and p2stateno. If the HitDef successfully connects, then
;     the attacker will change to the state number specified by
;     p1stateno, and the opponent will be change to the state
;     number assigned to p2stateno. The special thing about p2stateno
;     is that the opponent will be temporarily brought into the
;     attacker's state file. In this case, no matter who the
;     opponent is, he will be taken to state 820 of this file (kfm.cns)
;     and remain here until the end of the throw (look at his debug
;     information when he is being thrown; the text changes to yellow
;     to mean that he is in another player's state file).
[Statedef 800]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 800
sprpriority = 2

[State 800, 1]
type = HitDef
Trigger1 = Time = 0
attr = S, NT          ;Attributes: Standing, Normal Throw
hitflag = M-          ;Affect only ground people who are not being hit
priority = 1, Miss    ;Throw has low priority, must be miss or dodge type.
sparkno = -1          ;No spark
p1sprpriority = 1     ;Draw p1's sprite in front of p2
                      ;p2's sprite priority is set to 0 by default
p1facing = 1
p2facing = 1          ;Force p2 to face KFM
p1stateno = 810       ;On success, KFM changes to state 810
;p2stateno = 820       ;Ignore this parm. Within the "actually getting someone to throw" states you'd have to resort to targetstate for putting opponents into custom states
guard.dist = 0        ;This prevents p2 from going into a guard state if close
fall = 1              ;Force p2 into falling down

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = 5000,ifelse(random<500,99,1)
channel = 0
lowpriority = 1

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Kung Fu Throw - Throwing the opponent
; Description: In this state, KFM throws the opponent by binding him to
;     various offsets based on his current frame of animation. For
;     example, [State 810, Bind 1] binds the opponent to an offset of
;     28 pixels in front of KFM. That puts him around where KFM's hand
;     is at. Is is important to keep the opponent bound using a
;     TargetBind controller at all times, until you let him go. This
;     is especially important if your player has a Clsn2 box that
;     allows him to get hit while throwing someone. Each time a player
;     gets hit, all his bound targets will be set to a fall state. If
;     the opponent is not bound, then he may get stuck in his thrown
;     state when his attacker is knocked out of the throw halfway.
; Notes: There is a TargetLifeAdd controller to decrease the opponent's
;     life, and a TargetState controller to change his state to a
;     falling state when KFM lets go of him.
[Statedef 810]
type    = S
movetype= A
physics = N
anim = 810
poweradd = 60

[State 810, TargetState] ; This is the sctrl you'd use to put victims into custom states
type = TargetState
trigger1 = time = 0
value = 820

[State 810, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 2
value = 1, 1

[State 0, EnvShake]
type = EnvShake
trigger1 = AnimElem = 3
trigger2 = AnimElem = 6
time = 25
freq = 222
ampl = -4

[State 810, Throw Sound]
type = PlaySnd
trigger1 = AnimElem = 3
trigger2 = AnimElem = 6
value = 0, 11

[State 0, Explod]
type = Explod
trigger1 = AnimElem = 3
trigger2 = AnimElem = 6
anim = 805
ID = 805
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
pausemovetime = 0
scale = const(size.xscale),const(size.yscale)
sprpriority = 2
ownpal = 1
ignorehitpause = 1

[State 0, SprPriority]
type = SprPriority
trigger1 = time = 0
value = -2

[State 0, SprPriority]
type = SprPriority
trigger1 = animelem = 4
value = 2

[State 810, Bind 4]
type = TargetBind
trigger1 = animelemtime(2) < 0
pos = floor(73*const(size.xscale)), 0

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(4) < 0
pos = floor(80*const(size.xscale)), floor(-249*const(size.yscale))

[State 810, Bind 5]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = floor(80*const(size.xscale)), floor(-231*const(size.yscale))

[State 810, Bind 6]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
pos = floor(77*const(size.xscale)), floor(-165*const(size.yscale))

[State 0, PalFXWiz]
type = PalFX
trigger1 = animelem = 6
time = 40
add = 100,100,180
mul = 256,256,256
sinadd = -80,-80,-80,4
invertall = 1
color = 0

[State 810, Throw 11]
type = TargetState
trigger1 = AnimElem = 6
value = 821

[State 810, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 6
value = -95
persistent = 0

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(6) = 1
x = -4
y = -6

[State 0, VelSet]
type = VelAdd
trigger1 = animelemtime(6) >= 1
y = 0.66

[State 0, ChangeState]
type = ChangeState
trigger1 = animelemtime(6) >= 1
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 10
value = 5100
ctrl = 0



;[State 810, State End]
;type = ChangeState
;trigger1 = AnimElemTime(9) >= 0
;trigger1 = fvar(0) >= 90
;value = 811
;ctrl = 0



;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw
; (a custom gethit state)
; Description: This is the state that the opponent changes to after being
;     hit by KFM's throw HitDef. The important thing here is to use a
;     ChangeAnim2 controller. The difference between ChangeAnim2 and
;     ChangeAnim is that ChangeAnim2 changes the player's animation to
;     an action in the AIR file of the attacker (in this case, kfm.air),
;     whereas ChangeAnim always changes the player to an action in his
;     own AIR file. Look at Action 820 in kfm.air for some extra
;     comments.
[Statedef 820]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,0
ignorehitpause = 1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 820

;In case attacker loses binding on player for any reason, this controller
;guarantees that the player will never get stuck in this thrown state.
[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
; (a custom gethit state)
; Description: This state has the opponent flying through the air and
;     falling down onto the ground. The SelfState controller sets the
;     opponent back using to his own state file when he his the ground.
;     Controllers 821,2 and 821,3 allow the opponent to recover by
;     hitting his recovery command when he is falling.
[Statedef 821]
type    = A
movetype= H
physics = N
velset = -4,-6

[State 0, PalFXWiz]
type = PalFX
trigger1 = time = 0
time = 40
add = 100,100,180
mul = 256,256,256
sinadd = -80,-80,-80,4
invertall = 1
color = 0

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = 0-const(size.mid.pos.x)
y = 0-const(size.mid.pos.y)

[State 0, VelAdd]
type = VelAdd
trigger1 = time
y = 0.48

[State 5100, 2]
type = ChangeAnim
trigger1 = time = 0
value = ifelse(selfanimexist(5052),5052,5030)
[State 5100, 2]
type = ChangeAnim
trigger1 = anim = [5030,5039]
trigger1 = animtime = 0
value = ifelse(anim=5030&&selfanimexist(5035),5035,5050)

[State 5100, 7]
type = SelfState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 10
value = 5100 ;HIT_LIEDOWN



[Statedef 830]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 800
sprpriority = 2

[State 800, 1]
type = HitDef
Trigger1 = Time = 0
attr = S, NT          ;Attributes: Standing, Normal Throw
hitflag = M-          ;Affect only ground people who are not being hit
priority = 1, Miss    ;Throw has low priority, must be miss or dodge type.
sparkno = -1          ;No spark
p1sprpriority = 3     ;Draw p1's sprite in front of p2
                      ;p2's sprite priority is set to 0 by default
p1facing = 1
p2facing = 1          ;Force p2 to face KFM
p1stateno = 840       ;On success, KFM changes to state 810
;p2stateno = 820       ;Ignore this parm. Within the "actually getting someone to throw" states you'd have to resort to targetstate for putting opponents into custom states
guard.dist = 0        ;This prevents p2 from going into a guard state if close
fall = 1              ;Force p2 into falling down

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = 5000,ifelse(random<500,99,1)
channel = 0
lowpriority = 1

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1


[Statedef 840]
type    = A
movetype= A
physics = N
anim = 840
poweradd = 60

[State 0, Helper]
type = Helper
trigger1 = time = 0
helpertype = normal
name = "Camera acting stupid"
ID = 849
stateno = 849
pos = 0,0
postype = p1
facing = 1
ownpal = 1

[State 0, PosAdd]
type = PosAdd
triggerall = anim = 840
trigger1 = animelem = 3
x = -36 * const(size.xscale)
[State 0, PosAdd]
type = PosAdd
triggerall = anim = 840
trigger1 = animelem = 4
trigger2 = animelem = 5
x = -32 * const(size.xscale)
[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 840
trigger1 = animelem = 4
x = -32 * const(size.xscale)

[State 0, Width]
type = Width
trigger1 = anim = 840
trigger1 = animelemtime(6) < 0
edge = 0,45
player = 0,0
ignorehitpause = 1


[State 810, Bind 3]
type = TargetBind
trigger1 = anim = 840
trigger1 = animelemtime(2) < 0
pos = floor(50*const(size.xscale)), 0

[State 810, Bind 3]
type = TargetBind
trigger1 = anim = 840
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
pos = floor(13*const(size.xscale)), 0

[State 810, Bind 3]
type = TargetBind
trigger1 = anim = 840
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 0
pos = floor(18*const(size.xscale)), floor(-176*const(size.yscale))

[State 810, Bind 3]
type = TargetBind
trigger1 = anim = 840
trigger1 = animelemtime(4) >= 0 && animelemtime(5) < 0
pos = floor(10*const(size.xscale)), floor(-132*const(size.yscale))

[State 810, Bind 3]
type = TargetBind
trigger1 = anim = 840
trigger1 = animelemtime(5) >= 0
pos = 0,0


[State 810, TargetState] ; This is the sctrl you'd use to put victims into custom states
type = TargetState
trigger1 = time = 0
value = 850

[State 810, Grab Sound]
type = PlaySnd
trigger1 = anim = 840
trigger1 = AnimElem = 2
value = 1, 1

[State 810, Grab Sound]
type = PlaySnd
trigger1 = anim = 840
trigger1 = AnimElem = 5
value = F7, 1

[State 0, Explod]
type = Explod
triggerall = anim = 840
trigger1 = animelem = 5
anim = F60
pos = 0, 0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = -4
ownpal = 1

[State 0, PlaySnd]
type = PlaySnd
triggerall = anim = 840
trigger1 = animelem = 8
trigger2 = animelem = 12
value = S5,ifelse(random<500,0,3)+random%2
channel = 1

[State 0, EnvShake]
type = EnvShake
triggerall = anim = 840
trigger1 = animelem = 8
trigger2 = animelem = 12
time = 4
freq = 255
ampl = -4

[State 0, HitAdd]
type = HitAdd
trigger1 = anim = 840
trigger1 = animelem = 8
trigger2 = anim = 840
trigger2 = animelem = 12
trigger3 = anim = 841
trigger3 = animelem = 7
value = 1

[State 810, TargetState] ; This is the sctrl you'd use to put victims into custom states
type = TargetState
triggerall = anim = 840
trigger1 = animelem = 8
trigger2 = animelem = 12
value = 851

[State 810, Hurt 11]
type = TargetLifeAdd
triggerall = anim = 840
trigger1 = animelem = 8
trigger2 = animelem = 12
value = -8
kill = 0

[State 0, Explod]
type = Explod
triggerall = anim = 840
trigger1 = animelem = 8 || animelem = 12
anim = 900
pos = floor(ifelse(animelemtime(9)<=0,-99,99)*const(size.xscale)), 0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
;pausemovetime = 65535
scale = 1,1
sprpriority = 9
ownpal = 1


[State 0, EnvShake]
type = EnvShake
trigger1 = anim = 841
trigger1 = animelem = 7
time = 8
freq = 255
ampl = -8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 841
trigger1 = animelem = 7
value = S5,7

[State 810, Hurt 11]
type = TargetLifeAdd
trigger1 = anim = 841
trigger1 = animelem = 7
value = -25

[State 0, Explod]
type = Explod
trigger1 = anim = 841
trigger1 = animelem = 7
anim = 902
pos = floor(-16*const(size.xscale)), floor(-49*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
;pausemovetime = 65535
scale = 1,1
sprpriority = 1
ownpal = 1

[State 810, TargetState]
type = TargetFacing
trigger1 = anim = 841
trigger1 = animelem = 7
trigger1 = (target,facing) = facing
value = -1

[State 810, TargetState]
type = TargetState
trigger1 = anim = 841
trigger1 = animelem = 7
value = 852

[State 810, State End]
type = Changeanim
trigger1 = time >= 60
trigger1 = anim = 840
trigger1 = animtime = 0
value = 841

[State 810, State End]
type = ChangeState
trigger1 = anim = 841
trigger1 = animtime = 0
value = 0
ctrl = 1


; Camera Panning for no reason
[Statedef 849]
type    = A
movetype= I
physics = N
anim = 9741
velset = 0,-4

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time >= 80


;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw
; (a custom gethit state)
; Description: This is the state that the opponent changes to after being
;     hit by KFM's throw HitDef. The important thing here is to use a
;     ChangeAnim2 controller. The difference between ChangeAnim2 and
;     ChangeAnim is that ChangeAnim2 changes the player's animation to
;     an action in the AIR file of the attacker (in this case, kfm.air),
;     whereas ChangeAnim always changes the player to an action in his
;     own AIR file. Look at Action 820 in kfm.air for some extra
;     comments.
[Statedef 850]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,0
ignorehitpause = 1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 850

[State 820, 1]
type = ChangeAnim
Trigger1 = Time = 13
value = ifelse(selfanimexist(5101),5101,5100)

[State 820, 1]
type = ChangeAnim
Trigger1 = anim = 5100
trigger1 = animtime = 0
value = 5110

[State 820, 1]
type = ChangeAnim
Trigger1 = anim = 5101
trigger1 = animtime = 0
value = ifelse(selfanimexist(5111),5111,5110)

[State 0, Turn]
type = Turn
trigger1 = anim = 5100
Trigger1 = Time = 13

[State 820, 2]
type = SelfState
;trigger1 = time < 4
;trigger1 = !gethitvar(isbound)
trigger1 = time >= 300
value = 5050

[Statedef 851]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 820, 1]
type = ChangeAnim
Trigger1 = Time = 0
value = ifelse(selfanimexist(5081),5081,5080)

[State 820, 2]
type = SelfState
trigger1 = time >= 150
value = 5110

[Statedef 852]
type    = A
movetype= H
physics = N
velset = 6,-13.3

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
sysvar(0) = 0

[State 820, 1]
type = ChangeAnim
Trigger1 = Time = 0
value = ifelse(selfanimexist(5091),5091,5090)

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = 1
x = vel x * 0.99
y = vel y + 0.88

[State 820, 2]
type = SelfState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 15
value = 5110


;---------------------------------------------------------------------------
; BOOM
[Statedef 1000]
type    = S
movetype= A
physics = S
;juggle  = ifelse(var(42) & floor(exp(0*ln(2)) + 0.5) ,1,0)
poweradd= 100
velset = 0,0
anim = 1010
ctrl = 0
sprpriority = 2
facep2 = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = S0,10

[State 0, EnvShake]
type = EnvShake
trigger1 = animelem = 5
time = 8
freq = 222
ampl = -4

[State 0, Helper]
type = Helper
trigger1 = animelem = 5
helpertype = normal
name = "Boom"
ID = 1001
stateno = 1001
pos = floor(130*const(size.xscale)), floor(-135*const(size.yscale))
postype = p1
facing = 1
ownpal = 1
ignorehitpause = 1

[State 0, Projectile]
type = Projectile
trigger1 = animelem = 5
ProjID = 1000
projanim = 1012
projscale = .5,.5
projremove = 0
projremovetime = 8
velocity = 0,0
remvelocity = 0,0
accel = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 990
projstagebound = 990
projheightbound = -480
offset = floor(130*const(size.xscale)), floor(-135*const(size.yscale))
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;supermove = 0
;pausemove = 0
attr = S,SP
hitflag = MAF
guardflag = MA
animtype = hard
damage = 100,10
;pausetime = 0,0
;guard.pausetime = 0,0
sparkno = S903
guard.sparkno = S905
;guard.sparkno = 20
sparkxy = 0,0
hitsound = S5,7
guardsound = S6,1
ground.type = low
ground.slidetime = ceil(34*ifelse(var(31),1.2,1))
ground.hittime = ceil(34*ifelse(var(31),1.2,1))
guard.ctrltime = 15
yaccel = 0.88
ground.velocity = -13.5
guard.velocity = -13.5
air.velocity = -6,-15.9
air.juggle = ifelse(var(42) & floor(exp(0*ln(2)) + 0.5) ,1,0)
sprpriority = 6
air.fall = 1
fall.recovertime = 40
palfx.time = 30
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,10
palfx.invertall = 0
palfx.color = 0
id = 1000
;ignorehitpause = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = projhittime(1000) = 0
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(42) = var(42) | floor(exp(0*ln(2)) + 0.5)
ignorehitpause = 1
[State ProRation]
type = VarSet
trigger1 = projhittime(1000) = 0
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 7
movetype = I

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; BOOM
[Statedef 1010]
type    = S
movetype= A
physics = S
;juggle  = ifelse(var(42) & floor(exp(0*ln(2)) + 0.5) ,1,0)
poweradd= 100
velset = 0,0
anim = 1010
ctrl = 0
sprpriority = 2
facep2 = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = S0,10

[State 0, EnvShake]
type = EnvShake
trigger1 = animelem = 5
time = 8
freq = 222
ampl = -4

[State 0, Helper]
type = Helper
trigger1 = animelem = 5
helpertype = normal
name = "Boom"
ID = 1001
stateno = 1001
pos = floor(170*const(size.xscale)), floor(-135*const(size.yscale))
postype = p1
facing = 1
ownpal = 1
ignorehitpause = 1

[State 0, Projectile]
type = Projectile
trigger1 = animelem = 5
ProjID = 1000
projanim = 1012
projscale = .5,.5
projremove = 0
projremovetime = 8
velocity = 0,0
remvelocity = 0,0
accel = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 990
projstagebound = 990
projheightbound = -480
offset = floor(170*const(size.xscale)), floor(-135*const(size.yscale))
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;supermove = 0
;pausemove = 0
attr = S,SP
hitflag = MAF
guardflag = MA
animtype = hard
damage = 85,8
;pausetime = 0,0
;guard.pausetime = 0,0
sparkno = S903
guard.sparkno = S905
;guard.sparkno = 20
sparkxy = 0,0
hitsound = S5,7
guardsound = S6,1
ground.type = low
ground.slidetime = ceil(34*ifelse(var(31),1.2,1))
ground.hittime = ceil(34*ifelse(var(31),1.2,1))
guard.ctrltime = 15
yaccel = 0.88
ground.velocity = -13.5
guard.velocity = -13.5
air.velocity = -6,-15.9
air.juggle = ifelse(var(42) & floor(exp(0*ln(2)) + 0.5) ,1,0)
sprpriority = 6
air.fall = 1
fall.recovertime = 40
palfx.time = 30
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,10
palfx.invertall = 0
palfx.color = 0
id = 1000
;ignorehitpause = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = projhittime(1000) = 0
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(42) = var(42) | floor(exp(0*ln(2)) + 0.5)
ignorehitpause = 1
[State ProRation]
type = VarSet
trigger1 = projhittime(1000) = 0
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 7
movetype = I

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; BOOM
[Statedef 1020]
type    = S
movetype= A
physics = S
;juggle  = ifelse(var(42) & floor(exp(0*ln(2)) + 0.5) ,1,0)
poweradd= 100
velset = 0,0
anim = 1010
ctrl = 0
sprpriority = 2
facep2 = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = S0,10

[State 0, EnvShake]
type = EnvShake
trigger1 = animelem = 5
time = 8
freq = 222
ampl = -4

[State 0, Helper]
type = Helper
trigger1 = animelem = 5
helpertype = normal
name = "Boom"
ID = 1001
stateno = 1001
pos = floor(195*const(size.xscale)), floor(-135*const(size.yscale))
postype = p1
facing = 1
ownpal = 1
ignorehitpause = 1

[State 0, Projectile]
type = Projectile
trigger1 = animelem = 5
ProjID = 1000
projanim = 1012
projscale = .5,.5
projremove = 0
projremovetime = 8
velocity = 0,0
remvelocity = 0,0
accel = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 990
projstagebound = 990
projheightbound = -480
offset = floor(195*const(size.xscale)), floor(-135*const(size.yscale))
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;supermove = 0
;pausemove = 0
attr = S,SP
hitflag = MAF
guardflag = MA
animtype = hard
damage = 70,7
;pausetime = 0,0
;guard.pausetime = 0,0
sparkno = S903
guard.sparkno = S905
;guard.sparkno = 20
sparkxy = 0,0
hitsound = S5,7
guardsound = S6,1
ground.type = low
ground.slidetime = ceil(34*ifelse(var(31),1.2,1))
ground.hittime = ceil(34*ifelse(var(31),1.2,1))
guard.ctrltime = 15
yaccel = 0.88
ground.velocity = -13.5
guard.velocity = -13.5
air.velocity = -6,-15.9
air.juggle = ifelse(var(42) & floor(exp(0*ln(2)) + 0.5) ,1,0)
sprpriority = 6
air.fall = 1
fall.recovertime = 40
palfx.time = 30
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,10
palfx.invertall = 0
palfx.color = 0
id = 1000
;ignorehitpause = 0

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = projhittime(1000) = 0
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(42) = var(42) | floor(exp(0*ln(2)) + 0.5)
ignorehitpause = 1
[State ProRation]
type = VarSet
trigger1 = projhittime(1000) = 0
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 7
movetype = I

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Explosion
[Statedef 1001]
type    = A
movetype= I
physics = N
velset = 0,0
anim = 1013
ctrl = 0
sprpriority = 6

[State 0, VarSet]
type = VarSet
triggerall = var(2) = 0
trigger1 = parent,stateno != [1000,1020]
trigger1 = parent,stateno != [1150,1170]
var(2) = -1

[State 0, ChangeState]
type = ChangeState
trigger1 = var(2) = 0
trigger1 = parent,stateno = [1150,1170]
trigger1 = parent,animelemtime(4) >= 0
value = 1154
ctrl = 0

[State 0, DestroySelf]
type = DestroySelf
trigger1 = animtime = 0



;---------------------------------------------------------------------------
; Lol Krizalid
[Statedef 1050]
type    = S
movetype= A
physics = N
juggle  = ifelse(var(42) & floor(exp(5*ln(2)) + 0.5) ,1,0)
velset = 0,0
ctrl = 0
anim = 1050
poweradd = 40
sprpriority = 2
;facep2 = 1

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(42) = var(42) | floor(exp(5*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.97
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 5
value = 0, 13

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(5) >= 0
x = 8
[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(6) >= 0
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 6
trigger2 = animelemtime(6) >= 0
trigger2 = movecontact > 2 || movereversed > 2
attr = S, SA
damage = 13, 1
animtype = hard
guardflag = M
hitflag = MAF
pausetime = 4-var(49), 4
sparkno = S903
guard.sparkno = S905
sparkxy = -10, ceil(-100 * const(size.yscale) )
hitsound = S0, 15
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(18*ifelse(var(31),1.2,1))
ground.hittime  = ceil(18*ifelse(var(31),1.2,1))
ground.velocity = -1.2
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -2,-6.6
air.hittime = 12
air.fall = 1
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
palfx.time = 30
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,10
palfx.invertall = 0
palfx.color = 0
;ignorehitpause = 0

[State 200, 7]
type = ChangeState
trigger1 = time >= 21
trigger1 = AnimTime = 0
value = 1055
ctrl = 0

;---------------------------------------------------------------------------
; Lol Krizalid
[Statedef 1051]
type    = S
movetype= A
physics = N
juggle  = ifelse(var(42) & floor(exp(5*ln(2)) + 0.5) ,1,0)
velset = 0,0
ctrl = 0
anim = 1050
poweradd = 40
sprpriority = 2
;facep2 = 1

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(42) = var(42) | floor(exp(5*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.97
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 5
value = 0, 13

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(5) >= 0
x = 11
[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(6) >= 0
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 6
trigger2 = animelemtime(6) >= 0
trigger2 = movecontact > 2 || movereversed > 2
attr = S, SA
damage = 13, 1
animtype = hard
guardflag = M
hitflag = MAF
pausetime = 4-var(49), 4
sparkno = S903
guard.sparkno = S905
sparkxy = -10, ceil(-100 * const(size.yscale) )
hitsound = S0, 15
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(18*ifelse(var(31),1.2,1))
ground.hittime  = ceil(18*ifelse(var(31),1.2,1))
ground.velocity = -1.2
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -2,-6.6
air.hittime = 12
air.fall = 1
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
palfx.time = 30
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,10
palfx.invertall = 0
palfx.color = 0
;ignorehitpause = 0

[State 200, 7]
type = ChangeState
trigger1 = time >= 24
trigger1 = AnimTime = 0
value = 1055
ctrl = 0

;---------------------------------------------------------------------------
; Lol Krizalid
[Statedef 1052]
type    = S
movetype= A
physics = N
juggle  = ifelse(var(42) & floor(exp(5*ln(2)) + 0.5) ,1,0)
velset = 0,0
ctrl = 0
anim = 1050
poweradd = 40
sprpriority = 2
;facep2 = 1

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(42) = var(42) | floor(exp(5*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.97
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 5
value = 0, 13

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(5) >= 0
x = 14
[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(6) >= 0
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 6
trigger2 = animelemtime(6) >= 0
trigger2 = movecontact > 2 || movereversed > 2
attr = S, SA
damage = 13, 1
animtype = hard
guardflag = M
hitflag = MAF
pausetime = 4-var(49), 4
sparkno = S903
guard.sparkno = S905
sparkxy = -10, ceil(-100 * const(size.yscale) )
hitsound = S0, 15
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(18*ifelse(var(31),1.2,1))
ground.hittime  = ceil(18*ifelse(var(31),1.2,1))
ground.velocity = -1.2
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -2,-6.6
air.hittime = 12
air.fall = 1
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
palfx.time = 30
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,10
palfx.invertall = 0
palfx.color = 0
;ignorehitpause = 0

[State 200, 7]
type = ChangeState
trigger1 = time >= 27
trigger1 = AnimTime = 0
value = 1055
ctrl = 0

;---------------------------------------------------------------------------
; BOOM
[Statedef 1055]
type    = S
movetype= A
physics = S
;juggle  = ifelse(var(42) & floor(exp(0*ln(2)) + 0.5) ,1,0)
poweradd= 100
;velset = 0,0
anim = 1055
ctrl = 0
sprpriority = 2
;facep2 = 1

[State 0, PalFXWiz]
type = PalFX
trigger1 = animelem = 5
time = 10
add = 0,0,0
mul = 255,255,255
sinadd = 256,105,0,20
invertall = 0
color = 255

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 5
x = 0

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 5
x = ceil(40*const(size.xscale))

[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(5) < 0
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = S0,14

[State 0, Projectile]
type = Projectile
trigger1 = animelem = 5
ProjID = 1055
projanim = 1056
projscale = .5,.5
projremove = 0
projremovetime = 26
velocity = 0,0
remvelocity = 0,0
accel = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 990
projstagebound = 990
projheightbound = -480
offset = ceil(-40*const(size.xscale)),0
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;supermove = 0
;pausemove = 0
attr = S,SP
hitflag = MAF
guardflag = M
animtype = diagup
damage = 100,5
;pausetime = 0,0
;guard.pausetime = 0,0
sparkno = S903
guard.sparkno = S905
;guard.sparkno = 20
sparkxy = floor(150*const(size.xscale)), floor(-124*const(size.yscale))
hitsound = -1
guardsound = -1
ground.type = low
ground.slidetime = ceil(30*ifelse(var(31),1.2,1))
ground.hittime = ceil(30*ifelse(var(31),1.2,1))
guard.ctrltime = 15
yaccel = 0.88
ground.velocity = -2.4,-14.9
guard.velocity = -12
air.velocity = -2.4,-14.9
air.juggle = ifelse(var(42) & floor(exp(6*ln(2)) + 0.5) ,1,0)
sprpriority = 6
fall = 1
fall.recovertime = 50
palfx.time = 30
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,10
palfx.invertall = 0
palfx.color = 0
;ignorehitpause = 0
ownpal = 1

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = projhittime(1055) = 0
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(42) = var(42) | floor(exp(0*ln(2)) + 0.5)
ignorehitpause = 1
[State ProRation]
type = VarSet
trigger1 = projhittime(1055) = 0
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 7
movetype = I

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; COME ON AND SLAM
[Statedef 1150]
type    = S
movetype= A
physics = S
poweradd= 40
velset = 0,0
anim = 1150
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = S0,2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = S1,1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 7
value = S0,3
[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 7
value = S202,random%4
channel = 0
lowpriority = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 9
x = 54*const(size.xscale)
y = 0
[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 10
x = 16*const(size.xscale)
y = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 13
movetype = I

[State 1000, 7]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; COME ON AND SLAM
[Statedef 1160]
type    = S
movetype= A
physics = S
poweradd= 40
velset = 0,0
anim = 1150
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = S0,2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = S1,1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 7
value = S0,3
[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 7
value = S202,random%4
channel = 0
lowpriority = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 9
x = 54*const(size.xscale)
y = 0
[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 10
x = 16*const(size.xscale)
y = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 13
movetype = I

[State 1000, 7]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; COME ON AND SLAM
[Statedef 1170]
type    = S
movetype= A
physics = S
poweradd= 40
velset = 0,0
anim = 1150
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = S0,2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = S1,1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 7
value = S0,3
[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 7
value = S202,random%4
channel = 0
lowpriority = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 9
x = 54*const(size.xscale)
y = 0
[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 10
x = 16*const(size.xscale)
y = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 13
movetype = I

[State 1000, 7]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1


; Land
[Statedef 1151]
type    = S
movetype = I
physics = S
velset = 0,0
ctrl = 0
anim = 1151

[State 200, 1]
type = PlaySnd
trigger1 = time = 0
value = 40, 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Caught Explosion
[Statedef 1154]
type    = A
movetype= I
physics = N
velset = 0,0
ctrl = 0
sprpriority = 6

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = 1
value =  anim
elem = animelemno(0)
ignorehitpause = 1

;[State 0, VelSet]
;type = VelSet
;trigger1 = time = 0
;y = -5.5

;[State 0, VelSet]
;type = VelSet
;trigger1 = parent,stateno = [1150,1170]
;trigger1 = parent,animelemtime(6) >= 0
;y = 0

[State 0, VelSet]
type = PosAdd
trigger1 = parent,stateno = [1150,1170]
trigger1 = parent,animelemtime(5) < 0
x = (parentdist x + (7*const(size.xscale))) * 0.22
y = (parentdist y + (-288*const(size.xscale))) * 0.22


[State 0, VelSet]
type = PosAdd
trigger1 = parent,stateno = [1150,1170]
trigger1 = parent,animelemtime(5) >= 0
trigger1 = parent,animelemtime(6) < 0
x = parentdist x + (7*const(size.xscale))
y = parentdist y + (-289*const(size.xscale))

[State 0, VelSet]
type = PosAdd
trigger1 = parent,stateno = [1150,1170]
trigger1 = parent,animelemtime(6) >= 0
trigger1 = parent,animelemtime(7) < 0
x = parentdist x + (7*const(size.xscale))
y = parentdist y + (-293*const(size.xscale))

[State 0, VelSet]
type = PosAdd
trigger1 = parent,stateno = [1150,1170]
trigger1 = parent,animelemtime(7) >= 0
;trigger1 = parent,animelemtime(8) < 0
x = parentdist x + (19*const(size.xscale))
y = parentdist y + (-268*const(size.xscale))

;[State 0, VelSet]
;type = PosAdd
;trigger1 = parent,stateno = [1150,1170]
;trigger1 = parent,animelemtime(8) >= 0
;x = parentdist x + (73*const(size.xscale))
;y = parentdist y + (-237*const(size.xscale))

[State 0, ChangeState]
type = ChangeState
trigger1 = parent,stateno = [1150,1170]
trigger1 = parent,animelemtime(7) >= 0
value = 1155
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = parent,stateno != [1150,1170]
value = 1159
ctrl = 0

;---------------------------------------------------------------------------
; Tossed Explosion
[Statedef 1155]
type    = A
movetype= I
physics = N
velset = 0,0
ctrl = 0
sprpriority = 6

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,37

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
x = ifelse((parent,stateno=1170),24,ifelse((parent,stateno=1160),17,10))
y = -2

[State 0, VelSet]
type = VelSet
trigger1 = time
x = vel x * 0.99
y = vel y + 2.4

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = 1
value =  anim
elem = animelemno(0)
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= -10
value = 1156
ctrl = 0

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
;value = 1
;scale =
ignorehitpause = 1
[State 0, AngleAdd]
type = AngleAdd
trigger1 = 1
value = vel x * -2

;---------------------------------------------------------------------------
; DESTRUCTION
[Statedef 1156]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
juggle  = ifelse((parent,var(42)) & floor(exp(6*ln(2)) + 0.5) ,1,0)
anim = 1014
sprpriority = 6

[State 0, EnvShake]
type = EnvShake
trigger1 = time = 0
time = 8
freq = 222
ampl = -4

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time = 0
value = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,14

[State 0, PosSet]
type = PosSet
trigger1 = time = 0
y = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AttackMulSet]
type = AttackMulSet
trigger1 = 1
value = parent,fvar(13)
ignorehitpause = 1

[State Neo-Juggle-System-Flag]
type = ParentVarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(42) = (parent,var(42)) | floor(exp(6*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = ParentVarSet
trigger1 = movehit
fvar(13) = (parent,fvar(13)) * 0.75
ignorehitpause = 1
persistent = 0

[State 200, 1]
type = HitDef
trigger1 = time
trigger1 = animelemtime(6) <= 0
trigger1 = !movecontact
trigger1 = !movereversed
attr = A, SP
damage = 111, 11
animtype = diagup
guardflag = H
hitflag = MAF
pausetime = 0,0
sparkno = S903
guard.sparkno = S905
sparkxy = 0, ceil(-64 * const(size.yscale) )
hitsound = S5, 7
guardsound = S6, 1
ground.type = low
ground.slidetime = ceil(32*ifelse(var(31),1.2,1))
ground.hittime  = ceil(32*ifelse(var(31),1.2,1))
ground.velocity = -4,-20.13
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-20.13
air.hittime = 12
fall = 1
air.fall = 1
guard.velocity = -8.8
guard.ctrltime = 14
fall.recovertime = 50
yaccel = .99
ground.cornerpush.veloff = 0
palfx.time = 30
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,10
palfx.invertall = 0
palfx.color = 0
sprpriority = 6


[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 6
movetype = I


[State 0, DestroySelf]
type = DestroySelf
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; Explosion
[Statedef 1159]
type    = A
movetype= I
physics = N
velset = 0,0
ctrl = 0
sprpriority = 6

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(2) = -1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = animtime = 0


;---------------------------------------------------------------------------
; Low Counter
[Statedef 1100]
type    = C
movetype= A
physics = C
poweradd= 100
velset = 0,0
anim = 1100
ctrl = 0
sprpriority = 2
facep2 = 1

[State 0, ReversalDef]
type = ReversalDef
trigger1 = animelemtime(3) < 0
attr = S,ST
reversal.attr = SC,NA,SA,HA
hitflag = MAF
id = 1100
sparkno = -1
hitsound = -1
p1stateno = 1101
;pausetime = 2,2
p2stateno = 1102
ignorehitpause = 1
numhits = 0
priority = 5
guard.dist = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S4,random%6
channel = 0
abspan = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 3
movetype = I

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 4
statetype = S
physics = S

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; >:)
[Statedef 1101]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1101
ctrl = 0
sprpriority = -2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,38
channel = 0
abspan = 0

;[State 0, TargetState]
;type = TargetState
;trigger1 = time = 0
;value = 1102

[State 0, EnvShake]
type = EnvShake
trigger1 = numtarget
trigger1 = target,stateno = 5100
time = 12
freq = 255
ampl = -6

[State 0, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = numtarget
trigger1 = target,stateno = 5100
value = -111
kill = 1
;absolute = 0
ignorehitpause = 1
persistent = 0

[State 0, TargetVelSet]
type = TargetVelSet
trigger1 = numtarget
trigger1 = target,stateno = 5101
x = -4
y = -5
ID = 1100
ignorehitpause = 1
persistent = 0

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; o_o
[Statedef 1102]
type    = A
movetype= H
physics = N
velset = 0,-6
ctrl = 0

[State 0, HitFallSet]
type = HitFallSet
trigger1 = time = 0
value = 1
xvel = -6
yvel = -4
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = pos y > 0
flag = noshadow
ignorehitpause = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,0
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = 1
value = anim
elem = animelemno(0)

[State 0, VelAdd]
type = VelAdd
trigger1 = 1
y = 1.123

[State 0, DestroySelf]
type = DestroySelf
trigger1 = vel y > 0
trigger1 = pos y >= 32-const(size.head.pos.y)
trigger1 = ishelper && !playeridexist(id)
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y >= 32-const(size.head.pos.y)
value = 1103
ctrl = 0

;---------------------------------------------------------------------------
; O_O
[Statedef 1103]
type    = A
movetype= H
physics = N
ctrl = 0

[State 0, PosAdd]
type = PosSet
trigger1 = time = 0
y = -320

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,0
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 0
value = 5070
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 0
value = anim
elem = animelemno(99)

[State 0, VelAdd]
type = VelAdd
trigger1 = 1
y = 1.123

[State 0, ChangeState]
type = Selfstate
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 10
value = 5100
ctrl = 0

;---------------------------------------------------------------------------
; Mid Counter
[Statedef 1110]
type    = S
movetype= A
physics = S
poweradd= 100
velset = 0,0
anim = 1110
ctrl = 0
sprpriority = 2
facep2 = 1

[State 0, ReversalDef]
type = ReversalDef
trigger1 = animelemtime(3) < 0
attr = S,ST
reversal.attr = SC,NA,SA,HA
hitflag = MAF
id = 1100
sparkno = -1
hitsound = -1
p1stateno = 1111
;pausetime = 2,2
p2stateno = 1112
ignorehitpause = 1
numhits = 0
priority = 5
guard.dist = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S4,random%6
channel = 0
abspan = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 3
movetype = I

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; >:)
[Statedef 1111]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1111
ctrl = 0
sprpriority = -2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,42
channel = 0
abspan = 0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 1
[State 0, VarSet]
type = VarSet
trigger1 = time
fvar(0) = ifelse(fvar(0) * 0.9<0.1,0.1,fvar(0) * 0.9)

;[State 0, TargetState]
;type = TargetState
;trigger1 = time = 0
;value = 1102

[State 0, AfterImage]
type = AfterImage
trigger1 = time = 0
time = 15
length = 20
palcolor = 256
palinvertall = 0
palbright = 0,0,0
palcontrast = 255,255,255
palpostbright = 0,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 2
framegap = 4
trans = none
ignorehitpause = 1

[State 0, AfterImageTime]
type = AfterImageTime
trigger1 = animelemtime(8) < 0
time = 2
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 12
value = S0,36

[State 0, TargetState]
type = TargetState
trigger1 = animelem = 12
value = 1113

[State 0, PlaySnd]
type = PlaySnd
trigger1 = numtarget
trigger1 = target,stateno = 1114
value = S5,5
abspan = 0
ignorehitpause = 1
persistent = 0

[State 0, EnvShake]
type = EnvShake
trigger1 = numtarget
trigger1 = target,stateno = 1114
time = 12
freq = 255
ampl = -6
ignorehitpause = 1
persistent = 0

[State 0, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = numtarget
trigger1 = target,stateno = 1114
value = -111
kill = 1
absolute = 0
ignorehitpause = 1
persistent = 0

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
[Statedef 1112]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,0
ignorehitpause = 1

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = time = 0
value = 1112

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = time*-6
scale = (enemynear,fvar(0)),(enemynear,fvar(0))
ignorehitpause = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = 0+const(size.mid.pos.x)
y = 0+const(size.mid.pos.y)

[State 0, PosAdd]
type = PosAdd
trigger1 = time < 38
x = (p2dist x) * 0.1
y = (p2dist y - 81) * 0.1

[State 0, PosAdd]
type = PosAdd
trigger1 = time >= 38
x = (p2dist x - 25) * 0.1
y = (p2dist y - 60) * 0.1

[State 0, SelfState]
type = SelfState
trigger1 = time >= 120
value = 5050

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
[Statedef 1113]
type    = A
movetype= H
physics = N
velset = -12,0

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 1026, No scroll]
type = ScreenBound
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist < 65
trigger2 = FrontEdgeBodyDist < 65
value = 1
movecamera = 0,1

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = time = 0
value = 1113

[State 1026, Hit wall]
type = ChangeState
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 1114

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = time*13
scale = 1/const(size.xscale),1/const(size.xscale)
ignorehitpause = 1

;------------------
; hit wall
[Statedef 1114]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time = 0
value = 0
scale = 1,1
ignorehitpause = 1

[State 1027, Anim]
type = ChangeAnim2
trigger1 = Time = 0
value = 1114

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = 0-const(size.mid.pos.x)
y = 0-const(size.mid.pos.y)

[State 1027, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 1027, Pos]
type = PosAdd
trigger1 = Time = 0
x = 0 - BackEdgeBodyDist

[State 1027, Stop moving]
type = PosFreeze
trigger1 = animelemtime(7) < 0
x = 1
y = 1

[State 1027, No scroll]
type = ScreenBound
trigger1 = animelemtime(7) < 0
value = 1
movecamera = 0,1

[State 1027, Spark]
type = Explod
trigger1 = Time = 0
anim = F72
pos = 0, floor (screenpos y) - 50
postype = back
sprpriority = 3

[State 1028, Gravity]
type = VelSet
trigger1 = animelemtime(7) = 0
;x = 1.13
y = -4

[State 1028, Gravity]
type = VelSet
trigger1 = animelemtime(7) > 0
trigger1 = animelemtime(8) < 0
x = vel x + 0.09

[State 1028, Gravity]
type = VelSet
trigger1 = animelemtime(7) > 0
;x = vel x; + 0.09
y = vel y+.44

[State 1028, Hit ground]
type = SelfState
trigger1 = animelemtime(7) >= 0
trigger1 = (Vel y > 0) && (Pos y >= 20)
value = 5100



;---------------------------------------------------------------------------
; High Counter
[Statedef 1120]
type    = S
movetype= A
physics = S
poweradd= 100
velset = 0,0
anim = 1120
ctrl = 0
sprpriority = 2
facep2 = 1

[State 0, ReversalDef]
type = ReversalDef
trigger1 = animelemtime(3) < 0
attr = S,ST
reversal.attr = SA,NA,SA,HA
hitflag = MAF
id = 1100
sparkno = -1
hitsound = -1
p1stateno = 1121
;pausetime = 2,2
p2stateno = 1122
ignorehitpause = 1
numhits = 0
priority = 5
guard.dist = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S4,random%6
channel = 0
abspan = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 3
movetype = I

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; NEW YORK POLICE
[Statedef 1121]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1121
ctrl = 0
sprpriority = -2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S2,3
channel = 0
abspan = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S1,1
abspan = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = 0,4

;[State 0, TargetState]
;type = TargetState
;trigger1 = time = 0
;value = 1102

[State 0, Turn]
type = Turn
trigger1 = animelem = 2

[State 810, Bind 4]
type = TargetBind
trigger1 = animelemtime(2) < 0
pos = floor(-4*const(size.xscale)), floor(-276*const(size.yscale))

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = floor(-15*const(size.xscale)), floor(-261*const(size.yscale))

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = floor(-8*const(size.xscale)), floor(-261*const(size.yscale))

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = floor(-9*const(size.xscale)), floor(-67*const(size.yscale))

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(5) = 0
pos = floor(95*const(size.xscale)), floor(-265*const(size.yscale))

[State 0, TargetState]
type = TargetState
trigger1 = animelem = 5
value = 1123

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 10
x = 26*const(size.xscale)

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 10
trigger2 = animelem = 14
trigger3 = animelem = 18
value = S0,41
channel = 1

[State 0, HitAdd]
type = HitAdd
trigger1 = animelem = 10
trigger2 = animelem = 14
trigger3 = animelem = 18
value = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 10
trigger2 = animelem = 14
trigger3 = animelem = 18
anim = 1129
ID = 1129
pos = ceil(31*const(size.xscale)),ceil(-304*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 3
ownpal = 1
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 10
trigger2 = animelem = 14
trigger3 = animelem = 18
anim = 902
pos = ceil(31*const(size.xscale)),ceil(p2dist y)
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 12
ontop = 1
ownpal = 1
ignorehitpause = 1

[State 0, TargetState]
type = TargetState
trigger1 = animelem = 10
trigger2 = animelem = 14
trigger3 = animelem = 18
value = ifelse(animelemtime(17)>=0,1125,1124)

[State 0, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = animelem = 10
trigger2 = animelem = 14
trigger3 = animelem = 18
value = -37
kill = (animelemtime(17)>=0)
ignorehitpause = 1

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
[Statedef 1122]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,0
ignorehitpause = 1

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = time = 0
value = 1122

[State 0, SelfState]
type = SelfState
trigger1 = time >= 120
value = 5050

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
[Statedef 1123]
type    = A
movetype= H
physics = N
velset = 0,-16

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = 0-const(size.mid.pos.x)
y = 0-const(size.mid.pos.y)

[State 0, VelAdd]
type = VelAdd
trigger1 = 1
y = 0.88

[State 0, SelfState]
type = SelfState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 0
value = 5100

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
[Statedef 1124]
type    = A
movetype= H
physics = N
velset = 1,-5

[State 0, NotHitBy]
type = NotHitBy
trigger1 = time = [0,30]
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = time = 0
value = 5090

;[State 0, PosAdd]
;type = PosAdd
;trigger1 = time = 0
;x = 0+const(size.mid.pos.x)
;y = 0+const(size.mid.pos.y)

[State 0, VelAdd]
type = VelSet
trigger1 = 1
x = vel x * 0.99
y = vel y + 0.88

[State 0, SelfState]
type = SelfState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 20
value = 5100

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
[Statedef 1125]
type    = A
movetype= H
physics = N
velset = 4,-5

[State 0, NotHitBy]
type = NotHitBy
trigger1 = time = [0,30]
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = time = 0
value = 5090

;[State 0, PosAdd]
;type = PosAdd
;trigger1 = time = 0
;x = 0+const(size.mid.pos.x)
;y = 0+const(size.mid.pos.y)

[State 0, VelAdd]
type = VelSet
trigger1 = 1
x = vel x * 0.99
y = vel y + 0.88

[State 0, SelfState]
type = SelfState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 20
value = 5100

;---------------------------------------------------------------------------
; Poof Divepunch
[Statedef 1200]
type    = S
movetype= I
physics = S
;juggle  = ifelse(var(42) & floor(exp(0*ln(2)) + 0.5) ,1,0)
poweradd= 100
velset = 0,0
anim = 1200
ctrl = 0
sprpriority = 2
facep2 = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = S0,12

[State 0, Explod]
type = Explod
trigger1 = animelem = 5
anim = 1202
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(5) >= 0
trigger1 = animelemtime(7) < 0
value = ,NA,SA,HA,NP,SP,HP
time = 2
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 6
anim = 1201
pos = 0,ceil(-32*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
vel = -2,-5
accel = 0.0416,0.2
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1
shadow = -1,-1,-1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 7
statetype = A
movetype = A
physics = N

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 7
x = 0
y = ceil(-150*const(size.yscale))

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 1251
ctrl = 0

;---------------------------------------------------------------------------
; Poof Divepunch
[Statedef 1210]
type    = S
movetype= I
physics = S
;juggle  = ifelse(var(42) & floor(exp(0*ln(2)) + 0.5) ,1,0)
poweradd= 100
velset = 0,0
anim = 1200
ctrl = 0
sprpriority = 2
facep2 = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = S0,12

[State 0, Explod]
type = Explod
trigger1 = animelem = 5
anim = 1202
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(5) >= 0
trigger1 = animelemtime(7) < 0
value = ,NA,SA,HA,NP,SP,HP
time = 2
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 6
anim = 1201
pos = 0,ceil(-32*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
vel = -2,-5
accel = 0.0416,0.2
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1
shadow = -1,-1,-1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 7
statetype = A
movetype = A
physics = N

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 7
x = 0
y = ceil(-250*const(size.yscale))

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 1251
ctrl = 0

;---------------------------------------------------------------------------
; Poof Divepunch
[Statedef 1220]
type    = S
movetype= I
physics = S
;juggle  = ifelse(var(42) & floor(exp(0*ln(2)) + 0.5) ,1,0)
poweradd= 100
velset = 0,0
anim = 1200
ctrl = 0
sprpriority = 2
facep2 = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = S0,12

[State 0, Explod]
type = Explod
trigger1 = animelem = 5
anim = 1202
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(5) >= 0
trigger1 = animelemtime(7) < 0
value = ,NA,SA,HA,NP,SP,HP
time = 2
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 6
anim = 1201
pos = 0,ceil(-32*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
vel = -2,-5
accel = 0.0416,0.2
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1
shadow = -1,-1,-1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 7
statetype = A
movetype = A
physics = N

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 7
x = 0
y = ceil(-350*const(size.yscale))

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 1251
ctrl = 0

;---------------------------------------------------------------------------
;Standalone Dive Punch
[Statedef 1250]
type    = A
movetype= I
physics = N
poweradd= 100
ctrl = 0
anim = 1250
sprpriority = 2
velset = 1,-1

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 1251
ctrl = 0


;---------------------------------------------------------------------------
; Dive Punch
[Statedef 1251]
type    = A
movetype= A
physics = N
juggle  = ifelse(var(42) & floor(exp(1*ln(2)) + 0.5) ,1,0)
poweradd= 0
ctrl = 0
anim = 1251
sprpriority = 2
velset = 10,8

[State 0, VelSet]
type = VelSet
trigger1 = 1
x = ifelse((movecontact=[1,2]),5.5,11)
y = ifelse((movecontact=[1,2]),4,8)
ignorehitpause = 1

[State Neo-Juggle-System-Flag]
type = VarSet
;trigger1 = !(var(40) & floor(exp(1*ln(2)) + 0.5) )
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(42) = var(42) | floor(exp(1*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.97
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = movecontact || movereversed
trigger1 = anim = 1251
value = 1253
elem = ifelse(animelemtime(5)<0,3,1)
ignorehitpause = 0

[State 600, 1]
type = PlaySnd
trigger1 = anim = 1251
trigger1 = animelem = 2 || animelem = 6
trigger2 = anim = 1253
trigger2 = animelem = 2 || animelem = 4
value = 0, 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 1251
trigger1 = animelem = 2 || animelem = 6
trigger2 = anim = 1253
trigger2 = animelem = 2 || animelem = 4
value = S2,9
channel = 0

[State 600, 2]
type = HitDef
trigger1 = anim = 1251
trigger1 = animelem = 2 || animelem = 6
trigger2 = anim = 1253
trigger2 = animelem = 2 || animelem = 4
attr = A, SA
damage = ceil(ifelse(movehit,25,50) / (1 + hitcount) ),2
guardflag = HA
pausetime = 6-var(49),6
sparkno = S903
guard.sparkno = S905
sparkxy = -10,ceil(-99 * const(size.yscale) )
hitsound   = S5,9
guardsound = S6,0
ground.type = High
ground.slidetime = ceil(25*ifelse(var(31),1.25,1))
ground.hittime  = ceil(25*ifelse(var(31),1.25,1))
ground.velocity = -4
guard.ctrltime = 12
air.velocity = -2,-7.7+ifelse(var(31),-1.13,0)
air.fall = 1
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 10
value = 1252
ctrl = 0


; Land
[Statedef 1252]
type    = S
movetype = I
physics = S
ctrl = 0
anim = 1252
movehitpersist = 1

[State 52, 1]
type = PosAdd
trigger1 = Time = 0
x = 24*const(size.xscale)

[State 200, 1]
type = PlaySnd
trigger1 = time = 0
value = 40, 0

[State 52, 1]
type = VelSet
trigger1 = Time = 0
x = 0
y = 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; SMACK
[Statedef 1255]
type    = S
movetype= A
physics = S
juggle  = ifelse(var(42) & floor(exp(3*ln(2)) + 0.5) ,1,0)
velset = 0,0
ctrl = 0
anim = 1255
poweradd = 50
sprpriority = 2
facep2 = 1

[State 52, 1]
type = PosAdd
trigger1 = Time = 0
x = 26*const(size.xscale)

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(42) = var(42) | floor(exp(3*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 0, 2

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 2
attr = S, SA
damage = 75, 0
animtype = diagup
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S903
guard.sparkno = S905
sparkxy = -10, ceil(-151 * const(size.yscale) )
hitsound = S5, 2
guardsound = S6, 0
ground.type = high
ground.slidetime = ceil(20*ifelse(var(31),1.2,1))
ground.hittime  = ceil(20*ifelse(var(31),1.2,1))
ground.velocity =  -4,-13.13
airguard.velocity = -5,-4.4
air.type = high
air.velocity = -4,-13.13
air.hittime = 12
fall = 1
air.fall = 1
guard.velocity = -11.8
guard.ctrltime = 14
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 3
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Teleport Kick
[Statedef 1300]
type    = S
movetype= A
physics = N
juggle  = ifelse(var(42) & floor(exp(2*ln(2)) + 0.5) ,1,0)
velset = 0,0
ctrl = 0
anim = 1300;ifelse(p2bodydist x<=15,251,250)
poweradd = 40
sprpriority = 2
facep2 = 1

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(42) = var(42) | floor(exp(6*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = S0,12

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 7
value = 0, 5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 7
value = S2,10+random%4
channel = 0
lowpriority = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 14
value = 40, 0

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 5
x = ceil(200*const(size.xscale))

[State 0, Turn]
type = Turn
trigger1 = animelem = 6
trigger1 = p2dist x < 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(2) >= 1
trigger1 = animelemtime(7) < 0
value = ,NA,SA,HA,NP,SP,HP
time = 2
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 3
trigger2 = animelem = 5
anim = 1202
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 4
anim = 1201
pos = 0,ceil(-32*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
vel = -2,-5
accel = 0.0416,0.2
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1
shadow = -1,-1,-1

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(6) >= 0
trigger1 = animelemtime(10) < 0
x = 8
[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(10) >= 0
trigger1 = animelemtime(14) < 0
x = vel x * 0.93
[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(14) = 0
x = 0
[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelemtime(14) = 0
physics = S

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 10
attr = S, SA
damage = 80, 0
animtype = hard
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S903
guard.sparkno = S905
sparkxy = -10, ceil(-130 * const(size.yscale) )
hitsound = S5, 5
guardsound = S6, 0
ground.type = hard
ground.slidetime = ceil(25*ifelse(var(31),1.2,1))
ground.hittime  = ceil(25*ifelse(var(31),1.2,1))
guard.velocity = -12.5
ground.velocity = -15,-8.8
airguard.velocity = -5,-4.4
air.type = hard
air.velocity = -15,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
id = 1300
p2facing = 1
[State this method is superior]
type = TargetState
trigger1 = numtarget(1300)
trigger1 = var(21) = 1
trigger1 = !(target(1300),ishelper) || (PlayerIDExist((target(1300),id)) )
value = 1305
ID = 1300
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 11
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Teleport Kick
[Statedef 1310]
type    = S
movetype= A
physics = N
juggle  = ifelse(var(42) & floor(exp(2*ln(2)) + 0.5) ,1,0)
velset = 0,0
ctrl = 0
anim = 1300;ifelse(p2bodydist x<=15,251,250)
poweradd = 40
sprpriority = 2
facep2 = 1

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(42) = var(42) | floor(exp(6*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = S0,12

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 7
value = 0, 5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 7
value = S2,10+random%4
channel = 0
lowpriority = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 14
value = 40, 0

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 5
x = ceil(325*const(size.xscale))

[State 0, Turn]
type = Turn
trigger1 = animelem = 6
trigger1 = p2dist x < 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(2) >= 1
trigger1 = animelemtime(7) < 0
value = ,NA,SA,HA,NP,SP,HP
time = 2
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 3
trigger2 = animelem = 5
anim = 1202
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 4
anim = 1201
pos = 0,ceil(-32*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
vel = -2,-5
accel = 0.0416,0.2
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1
shadow = -1,-1,-1

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(6) >= 0
trigger1 = animelemtime(10) < 0
x = 8
[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(10) >= 0
trigger1 = animelemtime(14) < 0
x = vel x * 0.93
[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(14) = 0
x = 0
[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelemtime(14) = 0
physics = S

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 10
attr = S, SA
damage = 80, 0
animtype = hard
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S903
guard.sparkno = S905
sparkxy = -10, ceil(-130 * const(size.yscale) )
hitsound = S5, 5
guardsound = S6, 0
ground.type = hard
ground.slidetime = ceil(25*ifelse(var(31),1.2,1))
ground.hittime  = ceil(25*ifelse(var(31),1.2,1))
guard.velocity = -12.5
ground.velocity = -15,-8.8
airguard.velocity = -5,-4.4
air.type = hard
air.velocity = -15,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
id = 1300
p2facing = 1
[State this method is superior]
type = TargetState
trigger1 = numtarget(1300)
trigger1 = var(21) = 1
trigger1 = !(target(1300),ishelper) || (PlayerIDExist((target(1300),id)) )
value = 1305
ID = 1300
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 11
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Teleport Kick
[Statedef 1320]
type    = S
movetype= A
physics = N
juggle  = ifelse(var(42) & floor(exp(2*ln(2)) + 0.5) ,1,0)
velset = 0,0
ctrl = 0
anim = 1300;ifelse(p2bodydist x<=15,251,250)
poweradd = 40
sprpriority = 2
facep2 = 1

[State Neo-Juggle-System-Flag]
type = VarSet
trigger1 = movehit = [1,2]
trigger1 = numtarget
trigger1 = (target,statetype = A) || (target,statetype = L)
var(42) = var(42) | floor(exp(6*ln(2)) + 0.5)
ignorehitpause = 1
persistent = 0
[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = S0,12

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 7
value = 0, 5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 7
value = S2,10+random%4
channel = 0
lowpriority = 1


[State 200, 1]
type = PlaySnd
trigger1 = animelem = 14
value = 40, 0

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 5
x = ceil(450*const(size.xscale))

[State 0, Turn]
type = Turn
trigger1 = animelem = 6
trigger1 = p2dist x < 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(2) >= 1
trigger1 = animelemtime(7) < 0
value = ,NA,SA,HA,NP,SP,HP
time = 2
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 3
trigger2 = animelem = 5
anim = 1202
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 4
anim = 1201
pos = 0,ceil(-32*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
vel = -2,-5
accel = 0.0416,0.2
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1
shadow = -1,-1,-1

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(6) >= 0
trigger1 = animelemtime(10) < 0
x = 8
[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(10) >= 0
trigger1 = animelemtime(14) < 0
x = vel x * 0.93
[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(14) = 0
x = 0
[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelemtime(14) = 0
physics = S

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 10
attr = S, SA
damage = 80, 0
animtype = hard
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S903
guard.sparkno = S905
sparkxy = -10, ceil(-130 * const(size.yscale) )
hitsound = S5, 5
guardsound = S6, 0
ground.type = hard
ground.slidetime = ceil(25*ifelse(var(31),1.2,1))
ground.hittime  = ceil(25*ifelse(var(31),1.2,1))
guard.velocity = -12.5
ground.velocity = -15,-8.8
airguard.velocity = -5,-4.4
air.type = hard
air.velocity = -15,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 16
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
id = 1300
p2facing = 1
[State this method is superior]
type = TargetState
trigger1 = numtarget(1300)
trigger1 = var(21) = 1
trigger1 = !(target(1300),ishelper) || (PlayerIDExist((target(1300),id)) )
value = 1305
ID = 1300
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 11
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;------------------
; Hit by Fast Kung Fu Palm - shaking from the hit
; (a custom gethit state)
; See State 1020 for details
[Statedef 1305]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,0
ignorehitpause = 1

[State 1025, Anim] ;Custom animation
type = ChangeAnim2
trigger1 = 1
value = 1305

[State 1025, State]
type = ChangeState
trigger1 = HitShakeOver = 1
value = 1306

;------------------
; Hit by Fast Kung Fu Palm - flying through the air
; (a custom gethit state)
[Statedef 1306]
type    = A
movetype= H
physics = N

[State 1026, Velocity]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 1026, Gravity]
type = VelAdd
trigger1 = 1
y = gethitvar(yaccel);.88

[State 1026, No scroll]
type = ScreenBound
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist < 65
trigger2 = FrontEdgeBodyDist < 65
value = 1
movecamera = 0,1

[State 1026, Hit wall]
type = ChangeState
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 1307

[State 1026, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;------------------
; Hit by Fast Kung Fu Palm - hit wall
; (a custom gethit state)
[Statedef 1307]
type    = A
movetype= H
physics = N
velset = 0,0

[State 1027, Sound]
type = PlaySnd
trigger1 = Time = 0
value = F7,0

[State 1027, Anim]
type = ChangeAnim2
trigger1 = Time = 0
value = 1307

[State 1027, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 1027, Pos]
type = PosAdd
trigger1 = Time = 0
x = 0 - BackEdgeBodyDist

[State 1027, Stop moving]
type = PosFreeze
trigger1 = animelemtime(7) < 0
x = 1
y = 1

[State 1027, No scroll]
type = ScreenBound
trigger1 = animelemtime(7) < 0
value = 1
movecamera = 0,1

[State 1027, Spark]
type = Explod
trigger1 = Time = 0
anim = F72
pos = 0, floor (screenpos y) - 50
postype = back
sprpriority = 3

[State 1028, Gravity]
type = VelSet
trigger1 = animelemtime(7) = 0
;x = 1.13
y = -4

[State 1028, Gravity]
type = VelSet
trigger1 = animelemtime(7) > 0
trigger1 = animelemtime(8) < 0
x = vel x + 0.09

[State 1028, Gravity]
type = VelSet
trigger1 = animelemtime(7) > 0
;x = vel x; + 0.09
y = vel y+.44

[State 1028, Hit ground]
type = SelfState
trigger1 = animelemtime(7) >= 0
trigger1 = (Vel y > 0) && (Pos y >= 20)
value = 5100





; 360 Throw
[Statedef 1350]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 1350
sprpriority = 2

[State 800, 1]
type = HitDef
Trigger1 = Time = 0
attr = S, ST
hitflag = M-
priority = 2, Miss
sparkno = -1
p1sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1351
;p2stateno = 820
guard.dist = 0
fall = 1
numhits = 0

[State 800, 1]
type = HitDef
Trigger1 = Time = 1
attr = S, ST
hitflag = M
guardflag = M
priority = 3, Miss
sparkno = -1
guard.sparkno = -1
p1sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1351
guard.velocity = -5
guard.hittime = 10
guard.slidetime = 10
guard.ctrltime = 10
;p2stateno = 820
;guard.dist = 0
fall = 1
numhits = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 3
movetype = I
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = 5000,1
channel = 0
lowpriority = 1

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; >:)
[Statedef 1351]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1351
ctrl = 0
sprpriority = -2

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(0) = 0
[State 0, VarSet]
type = VarAdd
trigger1 = time != 0
trigger1 = (time%6) = 0
var(0) = 1
[State 0, Helper]
type = Helper
trigger1 = var(0) = [0,4]
trigger1 = (time%6) = 5
helpertype = normal ;player
name = "EDGE"
ID = 1360
stateno = 1360+var(0)
pos = 0,0
postype = p1
facing = 1
ownpal = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S0,31
abspan = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 2
value = S2,0
channel = 0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 0

[State 0, VarSet]
type = VarAdd
trigger1 = animelemtime(9) < 0
fvar(0) = -2

[State 0, HitAdd]
type = HitAdd
trigger1 = animelem = 9
value = 1
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 9
fvar(0) = 100

[State 0, VarSet]
type = VarSet
trigger1 = animelemtime(9) > 0
fvar(0) = fvar(0) * 0.9

[State 0, BGPalFX]
type = BGPalFX
trigger1 = animelemtime(9) < 0
time = 2
add = 0+floor(fvar(0)),0+floor(fvar(0)),0+floor(fvar(0))
mul = 256+floor(fvar(0)),256+floor(fvar(0)),256+floor(fvar(0))
color = 256+floor(fvar(0))

[State 0, BGPalFX]
type = AllPalFX
trigger1 = animelemtime(9) >= 0
time = 2
add = 0+floor(fvar(0)),0+floor(fvar(0)),0+floor(fvar(0))

[State 0, TargetState]
type = TargetState
trigger1 = time = 0
value = 1352

[State 0, AfterImage]
type = AfterImage
trigger1 = time = 0
time = 15
length = 20
palcolor = 256
palinvertall = 0
palbright = 0,0,0
palcontrast = 255,255,255
palpostbright = 0,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 2
framegap = 4
trans = none
ignorehitpause = 1

[State 0, AfterImageTime]
type = AfterImageTime
trigger1 = animelemtime(9) < 0
time = 2
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 9
value = S0,10

[State 0, Explod]
type = Explod
trigger1 = animelem = 9
anim = 1011
ID = 1011
pos = 0,-180
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = const(size.xscale),const(size.yscale)
sprpriority = 6
ontop = 0
shadow = 0,0,0
ownpal = 1

[State 0, TargetState]
type = TargetState
trigger1 = animelem = 9
value = 1353

[State 0, EnvShake]
type = EnvShake
trigger1 = animelem = 9
time = 20
freq = 255
ampl = -8
ignorehitpause = 1
persistent = 0

[State 0, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = animelem = 9
value = ceil(-155 * fvar(13))
kill = 1
absolute = 0
ignorehitpause = 1
persistent = 0

[State 0, Turn]
type = Turn
trigger1 = animtime = 0

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
[Statedef 1352]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 3

[State 0, AfterImage]
type = AfterImage
trigger1 = time = 0
time = 15
length = 20
palcolor = 256
palinvertall = 0
palbright = 0,0,0
palcontrast = 255,255,255
palpostbright = 0,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 2
framegap = 4
trans = none
ignorehitpause = 1

[State 0, AfterImageTime]
type = AfterImageTime
trigger1 = 1
time = 2
ignorehitpause = 1


;[State 0, ScreenBound]
;type = ScreenBound
;trigger1 = 1
;value = 0
;movecamera = 1,0
;ignorehitpause = 1

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = time = 0
value = 1352

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = time*-6
scale = 1,1
ignorehitpause = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = 0+const(size.mid.pos.x)
y = 0+const(size.mid.pos.y)

[State 0, PosAdd]
type = PosAdd
trigger1 = 1
x = (p2dist x) * 0.1
y = (p2dist y - 190) * 0.1

[State 0, SelfState]
type = SelfState
trigger1 = time >= 120
value = 5050

[Statedef 1353]
type    = A
movetype= H
physics = N
velset = 6.6,-9.9

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = 0-const(size.mid.pos.x)
y = 0-const(size.mid.pos.y)

[State 0, VelAdd]
type = VelSet
trigger1 = time
x = vel x * 0.99
y = vel y + 0.88

[State 0, Turn]
type = Turn
trigger1 = time = 0
[State 5100, 2]
type = ChangeAnim
trigger1 = time = 0
value = ifelse(selfanimexist(5052),5052,5030)
[State 5100, 2]
type = ChangeAnim
trigger1 = anim = [5030,5039]
trigger1 = animtime = 0
value = ifelse(anim=5030&&selfanimexist(5035),5035,5050)

[State 5100, 2]
type = ChangeAnim
trigger1 = time = 0
trigger1 = selfanimexist(7697)
value = 7697

[State 0, PalFXWiz]
type = PalFX
trigger1 = time = 0
trigger1 = anim != 7697
time = 40
add = 40,-70,-200
mul = 256,256,256
sinadd = 40,30,0,10
invertall = 1
color = 0
;ignorehitpause = 0

[State 5100, 7]
type = SelfState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 10
value = 5100 ;HIT_LIEDOWN

[Statedef 1360]
type    = A
movetype= I
physics = N
anim = 1360
velset = 0,0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 70
[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(1) = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = parentdist x
y = parentdist y - 100

[State 0, ChangeState]
type = ChangeState
trigger1 = 1
value = 1370
ctrl = 0

[Statedef 1361]
type    = A
movetype= I
physics = N
anim = 1360
velset = 0,0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 110
[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(1) = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = parentdist x
y = parentdist y - 100

[State 0, ChangeState]
type = ChangeState
trigger1 = 1
value = 1370
ctrl = 0

[Statedef 1362]
type    = A
movetype= I
physics = N
anim = 1360
velset = 0,0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 0
[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(1) = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = parentdist x - 90
y = parentdist y - 170

[State 0, ChangeState]
type = ChangeState
trigger1 = 1
value = 1370
ctrl = 0


[Statedef 1363]
type    = A
movetype= I
physics = N
anim = 1360
velset = 0,0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = -35
[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(1) = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = parentdist x - 60
y = parentdist y - 270

[State 0, ChangeState]
type = ChangeState
trigger1 = 1
value = 1370
ctrl = 0

[Statedef 1364]
type    = A
movetype= I
physics = N
anim = 1360
velset = 0,0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = -35
[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(1) = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = parentdist x + 60
y = parentdist y - 270
[State 0, Turn]
type = Turn
trigger1 = time = 0


[State 0, ChangeState]
type = ChangeState
trigger1 = 1
value = 1370
ctrl = 0


[Statedef 1370]
type    = A
movetype= I
physics = N
anim = 1360
velset = 0,0
sprpriority = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,34

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(2) = 1
[State 0, VarSet]
type = VarAdd
trigger1 = parent,stateno != 1351
fvar(2) = -0.05

[State 0, PalFX]
type = PalFX
trigger1 = fvar(2) < 1
time = 2
mul = ceil(256*fvar(2)),ceil(256*fvar(2)),ceil(256*fvar(2))
color = 256
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = fvar(0)
scale = fvar(1),fvar(1)
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time
trigger1 = fvar(2) <= 0.1

;---------------------------------------------------------------------------
; SUPER BG
[Statedef 2990]
type    = A
movetype= I
physics = N
velset = 0,0
anim = 9741
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,33
abspan = 0
[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 1
[State 0, VarSet]
type = VarSet
trigger1 = time
fvar(0) = fvar(0) * 0.6

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(2) = 0.25
[State 0, VarSet]
type = VarSet
trigger1 = time = 10
fvar(2) = 0.5
[State 0, VarSet]
type = VarSet
trigger1 = time = 20
fvar(2) = 1
[State 0, VarSet]
type = VarSet
trigger1 = time = 30
fvar(2) = 2

[State 0, VarSet]
type = VarSet
trigger1 = (time%10) = 0
fvar(12) = 0.1
[State 0, VarSet]
type = VarSet
trigger1 = time
fvar(12) = fvar(12) * 0.4

[State 0, VarSet]
type = VarSet
trigger1 = 1
fvar(10) = -640+random%1280
[State 0, VarSet]
type = VarSet
trigger1 = 1
fvar(11) = -640+random%1280

[State 0, Explod]
type = Explod
trigger1 = time = 0
anim = 2990+random%3
ID = 2990
pos = ceil(160+(fvar(10)*fvar(12))+(-320*fvar(0)*facing ) ),ceil(120+(fvar(11)*fvar(12)) )
postype = left
facing = 1
vfacing = 1
bindtime = 1
removetime = 38
pausemovetime = 65535
supermovetime = 65535
scale = fvar(2),fvar(2)
sprpriority = -64
ownpal = 1
ignorehitpause = 1
[State 0, Explod]
type = ModifyExplod
trigger1 = numexplod(2990)
ID = 2990
pos = ceil(160+(fvar(10)/10)+(-320*fvar(0) ) ),ceil(120+(fvar(11)/10) )
postype = left
facing = 1
vfacing = 1
bindtime = 1
scale = fvar(2),fvar(2)
sprpriority = -64
ownpal = 1
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = time = 34
anim = 2995
ID = 2995
pos = 160,120
postype = left
facing = 1
vfacing = 1
bindtime = 1
removetime = 4
pausemovetime = 65535
supermovetime = 65535
scale = .5,.5
sprpriority = -60
ownpal = 1
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !numexplod(2990)



;---------------------------------------------------------------------------
; THE LASER SHOW
[Statedef 3000]
type    = S
movetype= A
physics = S
poweradd= -1000
velset = 0,0
anim = 3000
ctrl = 0
sprpriority = 2
facep2 = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 3000
trigger1 = animelem = 2
value = S2,ifelse(random<500,1,8)
channel = 0
lowpriority = 1

[State 0, VarSet]
type = VarSet
trigger1 = anim = 3000
trigger1 = animelem = 2
var(6) = 38
[State 0, Helper]
type = Helper
trigger1 = anim = 3000
trigger1 = animelem = 2
helpertype = normal
name = "Super BG"
ID = 2990
stateno = 2990
pos = 0,0
postype = p1
facing = 1
ownpal = 1
supermovetime = 65535
pausemovetime = 65535
ignorehitpause = 1
[State 0, SuperPause]
type = SuperPause
trigger1 = anim = 3000
trigger1 = animelem = 2
time = 38
movetime = 38
anim = -1
sound = -1
pos = -11,-64
darken = 0
p2defmul = 1
endcmdbuftime = 6
unhittable = 1
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 40
value = 3001

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 128
value = 3002

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(0) = 0
[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(1) = 1

[State 0, Explod]
type = Explod
trigger1 = !numexplod(3010)
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
anim = 3010
ID = 3010
pos = floor(3*const(size.xscale)), floor(-261*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
scale = const(size.xscale),const(size.yscale)
sprpriority = 3
ownpal = 0;1
removeongethit = 1
ignorehitpause = 1
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = numexplod(3010)
trigger1 = anim = 3002
id = 3010
ignorehitpause = 1
[State 0, Explod]
type = Explod
trigger1 = !numexplod(3010)
trigger1 = anim = 3002
anim = 3011
ID = 3010
pos = floor(3*const(size.xscale)), floor(-261*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = const(size.xscale),const(size.yscale)
sprpriority = 3
ownpal = 1
removeongethit = 0
ignorehitpause = 1
persistent = 0

[State 0, VarSet]
type = VarAdd
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
var(0) = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (var(0)%9)=1
value = S0,18

[State 0, PalFXWiz]
type = PalFX
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (var(0)%4)=1
time = 2
add = 200,32,64
mul = 400,256,256
sinadd = 32,32,32,4
invertall = 0
color = 100

[State 0, PalFXWiz]
type = PalFX
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (var(0)%4)=3
time = 2
add = 64,32,200
mul = 256,256,400
sinadd = 32,32,32,4
invertall = 0
color = 100

[State 0, Projectile]
type = Projectile
triggerall = time <= 108
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (var(0)%36)=1
ProjID = 3000
projanim = 3012
projscale = .5,.5
projremove = 0
projremovetime = 26
velocity = 0,0
remvelocity = 0,0
accel = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 990
projstagebound = 990
projheightbound = -480
offset = floor(3*const(size.xscale)), floor(-261*const(size.yscale))
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;supermove = 0
;pausemove = 0
attr = S,HP
hitflag = MAF
guardflag = M
animtype = diagup
damage = ceil(111 / var(1)),5
;pausetime = 0,0
;guard.pausetime = 0,0
sparkno = S903
guard.sparkno = S905
sparkxy = floor(p2dist x),floor(133*const(size.yscale))
hitsound = S5,4
guardsound = S6,1
ground.type = low
ground.slidetime = ceil(30*ifelse(var(31),1.2,1))
ground.hittime = ceil(30*ifelse(var(31),1.2,1))
guard.ctrltime = 15
yaccel = 0.88
ground.velocity = 6,-10.9
guard.velocity = -13.5
air.velocity = 6,-10.9
air.juggle = 0
sprpriority = 6
fall = 1
fall.recovertime = 64
getpower = 0
;ignorehitpause = 0

[State 0, Projectile]
type = Projectile
triggerall = time <= 108
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (var(0)%36)=10
ProjID = 3000
projanim = 3013
projscale = .5,.5
projremove = 0
projremovetime = 26
velocity = 0,0
remvelocity = 0,0
accel = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 990
projstagebound = 990
projheightbound = -480
offset = floor(3*const(size.xscale)), floor(-261*const(size.yscale))
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;supermove = 0
;pausemove = 0
attr = S,HP
hitflag = MAF
guardflag = M
animtype = diagup
damage = ceil(111 / var(1)),5
;pausetime = 0,0
;guard.pausetime = 0,0
sparkno = S903
guard.sparkno = S905
sparkxy = floor(p2dist x),floor(-133*const(size.yscale))
hitsound = S5,4
guardsound = S6,1
ground.type = low
ground.slidetime = ceil(30*ifelse(var(31),1.2,1))
ground.hittime = ceil(30*ifelse(var(31),1.2,1))
guard.ctrltime = 15
yaccel = 0.88
ground.velocity = 6,-10.9
guard.velocity = -13.5
air.velocity = 6,-10.9
air.juggle = 0
sprpriority = 6
fall = 1
fall.recovertime = 64
getpower = 0
;ignorehitpause = 0

[State 0, Projectile]
type = Projectile
triggerall = time <= 108
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (var(0)%36)=19
ProjID = 3000
projanim = 3014
projscale = .5,.5
projremove = 0
projremovetime = 26
facing = -1
velocity = 0,0
remvelocity = 0,0
accel = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 990
projstagebound = 990
projheightbound = -480
offset = floor(3*const(size.xscale)), floor(-261*const(size.yscale))
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;supermove = 0
;pausemove = 0
attr = S,HP
hitflag = MAF
guardflag = M
animtype = diagup
damage = ceil(111 / var(1)),5
;pausetime = 0,0
;guard.pausetime = 0,0
sparkno = S903
guard.sparkno = S905
sparkxy = floor(p2dist x),floor(-133*const(size.yscale))
hitsound = S5,4
guardsound = S6,1
ground.type = low
ground.slidetime = ceil(30*ifelse(var(31),1.2,1))
ground.hittime = ceil(30*ifelse(var(31),1.2,1))
guard.ctrltime = 15
yaccel = 0.88
ground.velocity = -6,-10.9
guard.velocity = -13.5
air.velocity = -6,-10.9
air.juggle = 0
sprpriority = 6
fall = 1
fall.recovertime = 64
getpower = 0
;ignorehitpause = 0

[State 0, Projectile]
type = Projectile
triggerall = time <= 108
trigger1 = anim = 3001
trigger1 = animelemtime(2) >= 0
trigger1 = (var(0)%36)=28
ProjID = 3000
projanim = 3015
projscale = .5,.5
projremove = 0
projremovetime = 26
facing = -1
velocity = 0,0
remvelocity = 0,0
accel = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 990
projstagebound = 990
projheightbound = -480
offset = floor(3*const(size.xscale)), floor(-261*const(size.yscale))
postype = p1
projshadow = 0,0,0
supermovetime = 0
pausemovetime = 0
;supermove = 0
;pausemove = 0
attr = S,HP
hitflag = MAF
guardflag = M
animtype = diagup
damage = ceil(111 / var(1)),5
;pausetime = 0,0
;guard.pausetime = 0,0
sparkno = S903
guard.sparkno = S905
sparkxy = floor(p2dist x),floor(133*const(size.yscale))
hitsound = S5,4
guardsound = S6,1
ground.type = low
ground.slidetime = ceil(30*ifelse(var(31),1.2,1))
ground.hittime = ceil(30*ifelse(var(31),1.2,1))
guard.ctrltime = 15
yaccel = 0.88
ground.velocity = -6,-10.9
guard.velocity = -13.5
air.velocity = -6,-10.9
air.juggle = 0
sprpriority = 6
fall = 1
fall.recovertime = 64
getpower = 0
;ignorehitpause = 0

[State ProRation]
type = VarSet
trigger1 = projhittime(3000) = 0
fvar(13) = fvar(13) * 0.95
ignorehitpause = 1
[State 0, VarSet]
type = VarAdd
trigger1 = projhittime(3000) = 0
var(1) = 1
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = anim = 3002
trigger1 = movetype = A
movetype = I

[State 1000, 7]
type = ChangeState
trigger1 = anim = 3002
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; DEDLI RAVE
[Statedef 3050]
type    = S
movetype= A
physics = N
poweradd= -1000
velset = 0,0
anim = 3050
ctrl = 0
juggle = 0
sprpriority = 2
facep2 = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 3050
trigger1 = animelem = 11
value = S0,35
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 3050
trigger1 = animelem = 2
value = S2,2
channel = 0
lowpriority = 1

[State 0, VarSet]
type = VarSet
trigger1 = anim = 3050
trigger1 = animelem = 2
var(6) = 38
[State 0, Helper]
type = Helper
trigger1 = anim = 3050
trigger1 = animelem = 2
helpertype = normal
name = "Super BG"
ID = 2990
stateno = 2990
pos = 0,0
postype = p1
endcmdbuftime = 6
facing = 1
ownpal = 1
supermovetime = 65535
pausemovetime = 65535
ignorehitpause = 1
[State 0, SuperPause]
type = SuperPause
trigger1 = anim = 3050
trigger1 = animelem = 2
time = 38
movetime = 38
anim = -1
sound = -1
pos = -11,-64
darken = 0
p2defmul = 1
unhittable = 1
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = anim = 3050
trigger1 = time >= 60
value = 101
;ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(1) = 0

[State 0, Helper]
type = Helper
trigger1 = anim = 3050
trigger1 = animelemtime(11) >= 0
trigger1 = (time%2)=0
helpertype = normal
name = "Trail"
ID = 3056
stateno = 3056
pos = ceil(49 * const(size.xscale) ),ceil(-121 * const(size.yscale) )
postype = p1
facing = 1
ownpal = 1
supermovetime = 65535
pausemovetime = 65535
;ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = anim = 3050
trigger1 = animelemtime(11) >= 0
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = anim = 3050
trigger1 = animelemtime(11) >= 0
x = 15
[State 0, VelSet]
type = VelSet
trigger1 = anim = 101
trigger1 = animelemtime(3) < 0
x = vel x * 0.89
[State 0, VelSet]
type = VelSet
trigger1 = anim = 101
trigger1 = animelemtime(3) = 0
x = 0
[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = anim = 101
trigger1 = animelemtime(3) = 0
physics = S

[State 200, 1]
type = HitDef
trigger1 = anim = 3050
trigger1 = animelemtime(11) >= 0
trigger1 = !movecontact
trigger1 = !movereversed
attr = S, HA
damage = 50, 5
animtype = hard
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S903
guard.sparkno = S905
sparkxy = -10, ceil(-130 * const(size.yscale) )
hitsound = S5, 2
guardsound = S6, 0
ground.type = hard
ground.slidetime = ceil(25*ifelse(var(31),1.2,1))
ground.hittime  = ceil(25*ifelse(var(31),1.2,1))
guard.velocity = -12.5
ground.velocity = -2
airguard.velocity = -5,-4.4
air.type = hard
air.velocity = -1,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 10
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
id = 3050
p2facing = 1
getpower = 0
kill = 0
[State 0, ChangeState]
type = ChangeState
trigger1 = numtarget(3050)
trigger1 = movehit
trigger1 = !(target(3050),ishelper) || (PlayerIDExist((target(3050),id)) )
value = 3051
ctrl = 0

;[State this method is superior]
;type = TargetState
;trigger1 = numtarget(3050)
;trigger1 = var(21) = 1
;trigger1 = !(target(3050),ishelper) || (PlayerIDExist((target(3050),id)) )
;value = 3080
;ID = 3050
;ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
;trigger1 = numtarget(3050)
trigger1 = moveguarded
trigger2 = movereversed
value = 3058
ctrl = 0
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = anim = 101
movetype = I

[State 1000, 7]
type = ChangeState
trigger1 = anim = 101
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; DEDLI RAVE
[Statedef 3051]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 3060+var(1)
ctrl = 0
juggle = 0
sprpriority = 2

[State 0, Width]
type = Width
trigger1 = time = 0
trigger1 = anim = 3060
edge = 50,0
player = 0,0
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 3061
trigger1 = time = 1
value = S203,random%3
channel = 0

[State 0, TargetState]
type = TargetState
triggerall = prevstateno = 3050
trigger1 = time = 0
trigger1 = !(target(3050),ishelper) || (PlayerIDExist((target(3050),id)) )
value = 3059
id = 3050
ignorehitpause = 1
persistent = 0
[State 0, TargetState]
type = TargetBind
triggerall = prevstateno = 3050
trigger1 = time = 0
trigger1 = !(target(3050),ishelper) || (PlayerIDExist((target(3050),id)) )
pos = 50,0;ceil(ifelse(p2dist x<50,50,p2dist x)),0
id = 3050
ignorehitpause = 1
persistent = 0


[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.99
ignorehitpause = 1

[State 0, VarSet]
type = VarAdd
trigger1 = time = 0
;trigger1 = prevstateno = 3051
var(1) = 1
[State 0, VarSet]
type = Null
trigger1 = anim = 3061
trigger1 = (fvar(0):=-132)
trigger2 = anim = 3062
trigger2 = (fvar(0):=-58)
trigger3 = anim = 3063
trigger3 = (fvar(0):=-70)
trigger4 = anim = 3064
trigger4 = (fvar(0):=-200)
trigger5 = anim = 3065
trigger5 = (fvar(0):=-134)
trigger6 = anim = 3066
trigger6 = (fvar(0):=-139)
trigger7 = anim = 3067
trigger7 = (fvar(0):=-214)
trigger8 = anim = 3068
trigger8 = (fvar(0):=0)

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
x = 2.48

[State 200, 1]
type = HitDef
trigger1 = anim = 3061
trigger1 = animelem = 2
trigger2 = anim = 3062
trigger2 = animelem = 4
trigger3 = anim = 3063
trigger3 = animelem = 4
trigger4 = anim = 3064
trigger4 = animelem = 4
trigger5 = anim = 3065
trigger5 = animelem = 3
trigger6 = anim = 3066
trigger6 = animelem = 4
trigger7 = anim = 3067
trigger7 = animelem = 4
trigger8 = anim = 3068
trigger8 = animelem = 6
attr = S, HA
damage = 11, 1
animtype = hard
guardflag = MA
hitflag = MAF
pausetime = 4-var(49), 4
sparkno = S903
guard.sparkno = S905
sparkxy = -10, ceil(fvar(0) * const(size.yscale) )
hitsound = S5, 1
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(25*ifelse(var(31),1.2,1))
ground.hittime  = ceil(25*ifelse(var(31),1.2,1))
guard.velocity = -12.5
ground.velocity = -1
airguard.velocity = -5,-4.4
air.type = hard
air.velocity = -1,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 10
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
id = 3050
p2facing = 1
getpower = 0
kill = 0
envshake.time = 8
envshake.freq = 255
envshake.ampl = -1-var(1)
;[State this method is superior]
;type = TargetState
;trigger1 = numtarget(3050)
;trigger1 = var(21) = 1
;trigger1 = !(target(3050),ishelper) || (PlayerIDExist((target(3050),id)) )
;value = 3080
;ID = 3050
;ignorehitpause = 1

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

; ZIUUUU
[Statedef 3056]
type    = A
movetype= I
physics = N
velset = 0,0
anim = 3056
ctrl = 0
sprpriority = 10

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 1

[State 0, VarSet]
type = VarAdd
trigger1 = time
fvar(0) = -0.1

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 2
add = 0,0,0
mul = ceil(256*fvar(0)),ceil(256*fvar(0)),ceil(256*fvar(0))
color = 256
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = sub
;alpha = 256,256
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = fvar(0) <= 0
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = .5+(1-fvar(0)),.5+(1-fvar(0))
ignorehitpause =  1



; DAMMIT
[Statedef 3058]
type    = S
movetype= I
physics = S
;velset = 0,0
anim = 3058
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S5000,99
channel = 0

[State 0, VelMul]
type = VelMul
trigger1 = time = 0
x = -0.5

[State 5071, 3]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

; Just in case
[Statedef 3059]
type    = S
movetype= H
physics = S
velset = 0,0
ctrl = 0

[State 0, HitFallSet]
type = HitFallSet
trigger1 = 1
value = 0
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = 1
statetype = S
physics = S
ignorehitpause = 1

[State 5070, 1]
type = ChangeAnim
trigger1 = time = 0
value = 5000
ignorehitpause = 1

[State 5070, 1]
type = ChangeAnim
trigger1 = anim = 5000
trigger1 = animtime = 0
value = 5005
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0
ignorehitpause = 1

[State 5070, 3]
type = ForceFeedback
trigger1 = time = 0
time = 12
waveform = sinesquare
ampl = 140

[State 5000, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim2
trigger1 = !selfanimexist(5955)
trigger1 = time = 25
value = 735
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 25
trigger1 = selfanimexist(5955)
value = 5955
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 26
sysvar(0) = (anim = 5955)

[State 5001, 6]
type = SelfState
trigger1 = anim = 735 || anim = 5955
trigger1 = animtime = 0
value = 5110
ctrl = 0


;---------------------------------------------------------------------------
; DEDLI RAVE
[Statedef 3070]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 3070
ctrl = 0
juggle = 0
sprpriority = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1
[State 200, 1]
type = HitDef
trigger1 = animelem = 6
attr = S, HA
damage = 100, 1
animtype = hard
guardflag = MA
hitflag = MAF
pausetime = 0,0
sparkno = S902
guard.sparkno = S905
sparkxy = -10, ceil(-117 * const(size.yscale) )
hitsound = S35, 3
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(25*ifelse(var(31),1.2,1))
ground.hittime  = ceil(25*ifelse(var(31),1.2,1))
guard.velocity = -12.5
ground.velocity = -1
airguard.velocity = -5,-4.4
air.type = hard
air.velocity = -1,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 10
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
id = 3050
p2facing = 1
getpower = 0
envshake.time = 8
envshake.freq = 255
envshake.ampl = -1-var(1)

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 5
x = 32*const(size.xscale)
persistent = 0
[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 10
x = 32*const(size.xscale)

[State this method is superior]
type = ChangeState
trigger1 = numtarget(3050)
trigger1 = movehit
trigger1 = !(target(3050),ishelper) || (PlayerIDExist((target(3050),id)) )
value = 3071
ID = 3050
ignorehitpause = 1

;[State this method is superior]
;type = TargetState
;trigger1 = numtarget(3050)
;trigger1 = var(21) = 1
;trigger1 = !(target(3050),ishelper) || (PlayerIDExist((target(3050),id)) )
;value = 3080
;ID = 3050
;ignorehitpause = 1

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; DEDLI RAVE
[Statedef 3071]
type    = S
movetype= A
physics = N
velset = -16,0
;anim = 3070
ctrl = 0
sprpriority = 2

[State 0, TargetState]
type = TargetState
trigger1 = time = 0
value = 3075
ID = 3050
;ignorehitpause =
;persistent =

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(19) = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 1
[State 0, VarSet]
type = VarSet
trigger1 = time
fvar(0) = fvar(0) * 0.9

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 2
add = floor(512*(1-fvar(0))),floor(512*(1-fvar(0))),floor(512*(1-fvar(0)))
mul = 256,256,256
color = 256
ignorehitpause = 1

[State 0, Helper]
type = Helper
trigger1 = !numhelper(3072)
helpertype = normal
name = "FLASH"
ID = 3072
stateno = 3072
pos = 0,0
postype = p1
facing = 1
ownpal = 1
supermovetime = 65535
pausemovetime = 65535

[State 0, ChangeState]
type = ChangeState
trigger1 = time >= 130
value = 3073
ctrl = 0

[Statedef 3073]
type    = A
movetype= I
physics = N
velset = 3.5,0
ctrl = 0
anim = 10041
sprpriority = 4

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 6
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = (backedgebodydist>=4&&frontedgebodydist>=4),0
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = time = 0
y = -123
[State 0, PosSet]
type = PosAdd
trigger1 = time = 0
x = -32 - backedgedist
[State 0, VelMul]
type = VelMul
trigger1 = time
x = 0.99
[State 0, VelAdd]
type = VelAdd
trigger1 = time
y = 0.44

[State 0, CtrlSet]
type = CtrlSet
trigger1 = time = 16
value = 1
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 0
value = 52
ctrl = 0

;---------------------------------------------------------------------------
; WHOAH
[Statedef 3072]
type    = S
movetype= I
physics = N
velset = 0,0
anim = 9741
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,32
abspan = 0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 1
[State 0, VarSet]
type = VarSet
trigger1 = time
fvar(0) = fvar(0) * 0.9
[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(1) = 1
[State 0, VarSet]
type = VarSet
trigger1 = time
fvar(1) = fvar(1) * 0.95
[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(2) = 1
[State 0, VarSet]
type = VarSet
trigger1 = time >= 100
fvar(2) = fvar(2) * 0.94

[State 0, PalFX]
type = BGPalFX
trigger1 = time < 100
time = 2
add = floor(512*(1-fvar(0))),floor(512*(1-fvar(0))),floor(512*(1-fvar(0)))
mul = 256,256,256
color = 256
ignorehitpause = 1
[State 0, PalFX]
type = BGPalFX
trigger1 = time >= 100
time = 2
add = floor(512*(fvar(2))),floor(512*(fvar(2))),floor(512*(fvar(2)))
mul = 256,256,256
color = 256
ignorehitpause = 1
[State 0, PalFX]
type = PalFX
trigger1 = time >= 100
time = 2
mul = floor(256*(fvar(2))),floor(256*(fvar(2))),floor(256*(fvar(2)))
color = 256
ignorehitpause = 1

[State 0, EnvColor]
type = EnvColor
trigger1 = time <= 100
value = 255,255,255
time = 2
under = 1
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = time = 0
anim = 3680
ID = 3680
pos = 160,120
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
pausemovetime = 65535
supermovetime = 65535
scale = 1,1
sprpriority = -64
;ownpal = 1
removeongethit = 1
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = time = 0
anim = 3681
ID = 3681
pos = 160-floor(3800*fvar(1)),120
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
pausemovetime = 65535
supermovetime = 65535
scale = 1,1
sprpriority = -70
ownpal = 1
removeongethit = 1
;trans = addalpha
;alpha = 256,0
ignorehitpause = 1

[State 0, Explod]
type = ModifyExplod
trigger1 = numexplod(3681)
ID = 3681
pos = 160-floor(3800*fvar(1)),120
postype = left
facing = 1
vfacing = 1
scale = 1,fvar(2)
bindtime = -1
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = fvar(2) <= 0.1
trigger1 = numexplod(3680)
id = 3680
ignorehitpause = 1
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = fvar(2) <= 0.1
trigger1 = numexplod(3681)
id = 3681
ignorehitpause = 1
[State 0, DestroySelf]
type = DestroySelf
trigger1 = fvar(2) <= 0.1
trigger1 = !numexplod(3680)
trigger1 = !numexplod(3681)

[Statedef 3075]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 1

[State 0, PosAdd]
type = PosSet
trigger1 = time = 0
y = 0
[State 0, PosAdd]
type = PosSet
trigger1 = time = [0,110]
x = pos x * 0.99

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = [0,110]
value = ifelse(selfanimexist(5101),5101,5100)

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim = [5100,5109]
trigger1 = animtime = 0
value = ifelse(selfanimexist(5111)&&anim=5101,5111,5110)

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1

[State 0, SelfState]
type = SelfState
trigger1 = time >= 120
value = 5110

;---------------------------------------------------------------------------
; DEDLI RAVE
[Statedef 3080]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 3080
ctrl = 0
juggle = 0
sprpriority = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = 2,7
channel = 0

[State 0, VarSet]
type = VarSet
trigger1 = movehit
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1
[State 200, 1]
type = HitDef
trigger1 = animelem = 5
attr = S, HA
damage = 100, 1
animtype = up
guardflag = MA
hitflag = MAF
pausetime = 0,0
sparkno = S902
guard.sparkno = S905
sparkxy = -10, ceil(-167 * const(size.yscale) )
hitsound = S5, 13
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(32*ifelse(var(31),1.2,1))
ground.hittime  = ceil(32*ifelse(var(31),1.2,1))
guard.velocity = -12.5
ground.velocity = 0,-24
airguard.velocity = -5,-4.4
air.type = hard
air.velocity = 0,-24
air.hittime = 32
fall = 1
guard.ctrltime = 10
fall.recovertime = 40
fall.recover = 0
yaccel = .88
ground.cornerpush.veloff = 0
id = 3050
p2facing = 1
getpower = 0
envshake.time = 8
envshake.freq = 255
envshake.ampl = -1-var(1)

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 2
x = 2*const(size.xscale)
[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 5
x = 10*const(size.xscale)
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = numtarget(3050)
trigger1 = target(3050) , stateno = 3086
value = 5,14
abspan = 0
persistent = 0

[State this method is superior]
type = TargetState
trigger1 = numtarget(3050)
trigger1 = var(21) = 1
trigger1 = !(target(3050),ishelper) || (PlayerIDExist((target(3050),id)) )
value = 3085
ID = 3050
ignorehitpause = 1

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; DEDLI RAVE
[Statedef 3081]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 3081
ctrl = 0
juggle = 0
sprpriority = -2

[State 0, VarSet]
type = VarSet
trigger1 = movehit
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 4
x = 26*const(size.xscale)

[State 0, PlaySnd]
type = PlaySnd
trigger1 = movehit
value = S0,10
abspan = 0
ignorehitpause = 1
persistent = 0

[State 0, Explod]
type = Explod
trigger1 = movehit
anim = 1011
ID = 1011
pos = ceil(76*const(size.xscale)),ceil(-127*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = const(size.xscale),const(size.yscale)
sprpriority = 9
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 200, 1]
type = HitDef
trigger1 = animelem = 4
attr = S, HA
damage = 100, 1
animtype = up
guardflag = MA
hitflag = MAF
pausetime = 0,0
sparkno = S902
guard.sparkno = S905
sparkxy = -10, ceil(-120 * const(size.yscale) )
hitsound = S5, 13
guardsound = S6, 0
ground.type = low
ground.slidetime = ceil(32*ifelse(var(31),1.2,1))
ground.hittime  = ceil(32*ifelse(var(31),1.2,1))
guard.velocity = -12.5
ground.velocity = -24,-10
airguard.velocity = -5,-4.4
air.type = hard
air.velocity = -24,-10
air.hittime = 32
fall = 1
guard.ctrltime = 10
fall.recovertime = 40
fall.recover = 0
yaccel = .88
ground.cornerpush.veloff = 0
id = 3050
p2facing = 1
getpower = 0
envshake.time = 12
envshake.freq = 255
envshake.ampl = -6
sprpriority = -2

;[State 0, PlaySnd]
;type = PlaySnd
;trigger1 = numtarget(3050)
;trigger1 = target(3050) , stateno = 3086
;value = 5,14
;abspan = 0
;persistent = 0

[State this method is superior]
type = TargetState
trigger1 = numtarget(3050)
trigger1 = var(21) = 1
trigger1 = !(target(3050),ishelper) || (PlayerIDExist((target(3050),id)) )
value = 1305
ID = 3050
ignorehitpause = 1

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; O_O
[Statedef 3085]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0
juggle = 0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,0
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = selfanimexist(5051)
trigger1 = time = 0
trigger2 = !hitshakeover
value = 5051

[State 0, ChangeAnim]
type = ChangeAnim2
triggerall = !selfanimexist(5051)
trigger1 = time = 0
trigger2 = !hitshakeover
value = 3085

[State 0, Offset]
type = Offset
trigger1 = !hitshakeover
x = (time%3)-0
y = 0

[State 0, HitVelSet]
type = HitVelSet
trigger1 = hitshakeover
x = 1
y = 1
ignorehitpause = 1
persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = screenpos y <= -8-const(size.head.pos.y)
value = 3086
ctrl = 0


[Statedef 3086]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0
juggle = 0

[State 0, Explod]
type = Explod
trigger1 = time = 0
anim = F62
pos = ceil(screenpos x),0
postype = left
facing = 1
vfacing = -1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 10
ontop = 0
shadow = 0,0,0
ownpal = 1
ignorehitpause = 1

[State 0, EnvShake]
type = EnvShake
trigger1 = time = 0
time = 7
freq = 255
ampl = -4

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,0
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim2
trigger1 = time = 0
value = 3086

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = selfanimexist(5061)
trigger1 = time = 12
value = 5061

[State 0, VelSet]
type = VelSet
trigger1 = time >= 12
y = vel y + 0.44
[State 0, SelfState]
type = SelfState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 0
value = 5100


;---------------------------------------------------------------------------
; ROCKET LAWNCHAIR
[Statedef 3100]
type    = A
movetype= A
physics = N
juggle  = 0
poweradd= -1000
ctrl = 0
anim = 3100
sprpriority = 2

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
sysvar(0) = 0
ignorehitpause = 1

[State 600, Slow]
type = VelMul
trigger1 = animelemtime(5) <= 0
x = 0.9
y = 0.9
[State 600, Stop]
type = VelSet
trigger1 = vel y >= 0
trigger1 = pos y >= -8
trigger1 = animelemtime(5) <= 0
y = 0
[State 600, Stop]
type = PosSet
trigger1 = vel y >= 0
trigger1 = pos y >= -8
trigger1 = animelemtime(5) <= 0
y = -8

[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.85
ignorehitpause = 1

[State 600, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 0, 1

[State 600, 2]
type = HitDef
trigger1 = animelem = 3
attr = A, HA
damage = 50,5
animtype = hard
guardflag = HA
pausetime = 8-var(49),8
sparkno = S903
guard.sparkno = S905
sparkxy = -10,ceil(-120 * const(size.yscale) )
hitsound   = S5,1
guardsound = S6,0
ground.type = High
ground.slidetime = ceil(20*ifelse(var(31),1.25,1))
ground.hittime  = ceil(20*ifelse(var(31),1.25,1))
ground.velocity = -9.9,9.9
guard.ctrltime = 15
air.velocity = -9.9,9.9
air.fall = 1
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
getpower = 0
id = 3100
[State WHAMO]
type = TargetState
triggerall = numtarget(3100)
trigger1 = !target(3100),ishelper
;trigger1 = target(3100),statetype=A
trigger1 = var(21)=1
value = 3125
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = 2,4
channel = 0

[State 600, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 0, 1

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 4
var(6) = 38
[State 0, Helper]
type = Helper
trigger1 = animelem = 4
helpertype = normal
name = "Super BG"
ID = 2990
stateno = 2990
pos = 0,0
postype = p1
endcmdbuftime = 6
facing = 1
ownpal = 1
supermovetime = 65535
pausemovetime = 65535
ignorehitpause = 1
[State 0, SuperPause]
type = SuperPause
trigger1 = animelem = 4
time = 38
movetime = 38
anim = -1
sound = -1
pos = -11,-64
darken = 0
p2defmul = 1
unhittable = 1
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 5
x = -4
y = -8
[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(5) > 0
x = vel x * 0.99
y = vel y + 0.79

[State 0, Explod]
type = Explod
trigger1 = animelem = 5
anim = 704
ID = 704
pos = ceil(165*const(size.xscale)),ceil(-115*const(size.yscale))
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1


[State 0, Helper]
type = Helper
trigger1 = animelem = 5
helpertype = normal
name = "Rawktez"
ID = 3101
stateno = 3101
pos = ceil(165*const(size.xscale)),ceil(-115*const(size.yscale))
postype = p1    ;p2,front,back,left,right
facing = 1
ownpal = 1
size.ground.back = 8
size.ground.front = 8
size.air.back = 8
size.air.front = 8
ignorehitpause = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 6
helpertype = normal
name = "Whoops"
ID = 3109
stateno = 3109
pos = ceil(-18*const(size.xscale)),ceil(-218*const(size.yscale))
postype = p1
facing = 1
ownpal = 1
size.ground.back = 8
size.ground.front = 8
size.air.back = 8
size.air.front = 8
size.xscale = const(size.xscale)*2
size.yscale = const(size.yscale)*2
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 8
movetype = I

[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 12
y = -50*const(size.yscale)

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelemtime(5) > 0
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 15
value = S5000,random%2
channel = 0
lowpriority = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = animelemtime(5) > 0
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 15
value = 5100;1151
ctrl = 0

;---------------------------------------------------------------------------
; DESTRUCTION
[Statedef 3101]
type    = A
movetype= A
physics = N
velset = 15,12
ctrl = 0
juggle  = 0
anim = 3101
sprpriority = 6

[State 0, Explod]
type = Explod
trigger1 = 1;(time%2) = 0
anim = 3102
ID = 3102
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
vel = 0,-2
accel = 0,0.0625
removetime = -2
scale = const(size.xscale),const(size.yscale)
sprpriority = 5
ownpal = 1
;ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = time = 0
attr = SCA,AA,AP,AT
slot = 0
stateno = 3102
time = -1
forceair = 1
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -35

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,40

[State 0, AttackMulSet]
type = AttackMulSet
trigger1 = 1
value = .25 + (parent,fvar(13) * .75)
ignorehitpause = 1

[State 200, 1]
type = HitDef
trigger1 = time
trigger1 = !movecontact
trigger1 = !movereversed
attr = A, HP
damage = 50, 5
animtype = diagup
guardflag = H
hitflag = MAF
pausetime = 0,8
sparkno = S903
guard.sparkno = S905
sparkxy = 0, ceil(-64 * const(size.yscale) )
hitsound = S5, 5
guardsound = S6, 1
ground.type = low
ground.slidetime = ceil(32*ifelse(var(31),1.2,1))
ground.hittime  = ceil(32*ifelse(var(31),1.2,1))
ground.velocity = -4,-20.13
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-20.13
air.hittime = 12
fall = 1
air.fall = 1
guard.velocity = -8.8
guard.ctrltime = 14
fall.recovertime = 50
yaccel = .99
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = 0
sprpriority = 6
numhits = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = movecontact
trigger2 = movereversed
trigger3 = vel y + pos y >= 0
trigger4 = frontedgedist < 0
value = 3102
ctrl = 0


;---------------------------------------------------------------------------
; DESTRUCTION
[Statedef 3102]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
juggle  = 0
anim = 1011
sprpriority = 7

[State 0, EnvShake]
type = EnvShake
trigger1 = time = 0
time = 30
freq = 255
ampl = -5

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time = 0
value = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,10

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AttackMulSet]
type = AttackMulSet
trigger1 = 1
value = .25 + (parent,fvar(13) * .75)
ignorehitpause = 1

[State ProRation]
type = ParentVarSet
trigger1 = movehit
fvar(13) = (parent,fvar(13)) * 0.75
ignorehitpause = 1
persistent = 0

[State 200, 1]
type = HitDef
trigger1 = time
trigger1 = animelemtime(6) <= 0
trigger1 = !movecontact
trigger1 = !movereversed
attr = A, HP
damage = 200, 20
animtype = diagup
guardflag = M
hitflag = MAFD
pausetime = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0, ceil(-64 * const(size.yscale) )
hitsound = -1
guardsound = -1
ground.type = low
ground.slidetime = ceil(32*ifelse(var(31),1.2,1))
ground.hittime  = ceil(32*ifelse(var(31),1.2,1))
ground.velocity = -4,-20.13
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-20.13
air.hittime = 12
fall = 1
air.fall = 1
guard.velocity = -8.8
guard.ctrltime = 14
fall.recovertime = 50
yaccel = .99
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
palfx.time = 30
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,10
palfx.invertall = 0
palfx.color = 0
getpower = 0
sprpriority = 7

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 6
movetype = I

[State 0, DestroySelf]
type = DestroySelf
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; Dropped
[Statedef 3109]
type    = A
movetype= I
physics = N
juggle  = 0
velset = -4,-4
ctrl = 0
anim = 3109
sprpriority = 3

[State 0, VelSet]
type = VelSet
trigger1 = 1
x = vel x * 0.99
y = vel y + 0.37

[State 0, AngleAdd]
type = AngleAdd
trigger1 = 1
value = vel x * -2
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
;value = 1
;scale =
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = animtime = 0

;----------------------------------------------------------------------
; A custom state that just
[Statedef 3125]
type = A
movetype = H
physics = N

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = time = 0
value = ifelse(selfanimexist(5061),5061,5050)
ignorehitpause = 1
[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = time = 0
value = anim
elem = animelemno(99)
ignorehitpause = 1
[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = !hitshakeover
value = anim
elem = animelemno(0)
ignorehitpause = 1

[State 0, HitVelSet]
type = HitVelSet
trigger1 = time = 0
x = 1
y = 1
ignorehitpause = 1
[State 0, HitFallSet]
type = HitFallSet
trigger1 = time = 0
value = 1
[State 0, PosFreeze]
type = PosFreeze
trigger1 = !hitshakeover
value = 1
ignorehitpause = 1

[State 821, 1] ;Gravity
type = VelAdd
Trigger1 = hitshakeover
y = gethitvar(yaccel)

[State 821, 4] ;Hit ground
type = ChangeState
Trigger1 = hitshakeover
trigger1 = Vel Y > 0
trigger1 = vel y + Pos Y >= 0
value = 3126 ;Hit ground

;---------------------------------------------------------------------------
; THIS PARTY'S GETTING BOUNCY!
[Statedef 3126]
type    = A
movetype= H
physics = N


[State COLLISION DAMAGE]
type = EnvShake
trigger1 = time = 0
time = 12
freq = 255
ampl = -7
[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)
[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = !selfanimexist(5101)
value = 5100
[State 5100, 3]
type = ChangeAnim
trigger1 = time = 0
trigger1 = selfanimexist(5101)
value = 5101

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0
[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0
[State 5100, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.75

[State 5100, 8]
type = Explod
trigger1 = Time = 1
anim = F60
pos = 0, 0
postype = p1
sprpriority = -2
supermovetime = 65535
pausemovetime = 65535
scale = 0.5,3
[State 5100, 8]
type = Explod
trigger1 = Time = 1
anim = F61
pos = 0, 0
postype = p1
sprpriority = -2
supermovetime = 65535
pausemovetime = 65535
scale = 1,2
[State 5100, 8]
type = Explod
trigger1 = Time = 1
anim = F62
pos = 0, 0
postype = p1
sprpriority = -2
supermovetime = 65535
pausemovetime = 65535
scale = 2,2

[State 5100, 10]
type = PlaySnd
trigger1 = Time = 1
value = F7, 2
[State 5100, 11]
type = PosFreeze
trigger1 = 1
[State 5100, 12]
type = ChangeState
trigger1 = AnimTime = 0
value = 3127

[State 5100, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 20

;---------------------------------------------------------------------------
; HIT_BOUNCE (bounce into air)
[Statedef 3127]
type    = A
movetype= H
physics = N

[State 5101, 1] ;Coming hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5101,5109]
trigger2 = !SelfAnimExist(5160 + (anim % 10))
value = 5160
[State 5101, 2] ;Coming hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5101,5109]
trigger1 = SelfAnimExist(5160 + (anim % 10))
value = 5160 + (anim % 10)

[State 5101, 3]
type = VelSet
trigger1 = Time = 0
;x = -1
y = -9
[State 5101, 5] ;Acceleration
type = VelAdd
trigger1 = 1
y = gethitvar(yaccel)

[State 5101, 6] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 20;const(movement.down.bounce.groundlevel)
type = SelfState
value = 5110


;---------------------------------------------------------------------------
; Super Counter
[Statedef 3200]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 3200
sprpriority = 2
facep2 = 1
poweradd = -2000

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
trigger2 = animelem = 12
fvar(0) = 2
[State 0, VarSet]
type = VarSet
trigger1 = time
trigger1 = animelemtime(12) < 0
fvar(0) = ifelse(fvar(0) * 0.9<=0.05,0,fvar(0) * 0.9)
[State 0, VarSet]
type = VarSet
trigger1 = time
trigger1 = animelemtime(12) >= 0
fvar(0) = ifelse(fvar(0) * 0.8<=0.05,0,fvar(0) * 0.8)
[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = abs(1-fvar(0)),1
ignorehitpause = 1


[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = S0,20
channel = 0

[State 0, ReversalDef]
type = ReversalDef
trigger1 = animelemtime(12) <= 0
reversal.attr = SCA,NA,SA,HA,NP,SP,HP
pausetime = 0,0
sparkno = S905
hitsound = -1
p1stateno = 3201
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 12
movetype = I

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; PAWNCH
[Statedef 3201]
type    = S
movetype= A
physics = S
velset = 0,0
juggle  = 0
ctrl = 0
anim = 3201
sprpriority = 0
poweradd = 0

[State 0, VarSet]
type = VarSet
trigger1 = 1
fvar(0) = ifelse(fvar(0) * 0.9<=0.05,0,fvar(0) * 0.9)
[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = abs(1-fvar(0)),1
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = animelemtime(11) < 0
flag = nomusic
flag2 = timerfreeze
[State 0, StopSnd]
type = StopSnd
trigger1 = time = 0
channel = -1
[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = 6,9
volume = 255
[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = 0,21
channel = 0

[State 0, TargetState]
type = TargetState
triggerall = numtarget
triggerall = time = 0
trigger1 = !(target,ishelper)
;trigger2 = PlayerIDExist(target,ID)
value = 3209
ignorehitpause = 1

[State 0, SuperPause]
type = SuperPause
trigger1 = time = 0
time = 43
movetime = 43
anim = -1
sound = -1
pos = 34,-102
darken = 0
p2defmul = 1
poweradd = 0
unhittable = 1
;endcmdbuftime = (winmugen only)
pausebg = 0
;ignorehitpause =
;persistent =

[State 0, NotHitBy]
type = NotHitBy
trigger1 = time < 160
value = SCA,NA,NP
time = 2
ignorehitpause = 1

[State 800, 1]
type = HitDef
Trigger1 = animelem = 9
attr = S, HT
hitflag = MAFD
priority = 7, Miss
sparkno = -1
p1sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 3210
;p2stateno = 820
guard.dist = 0
fall = 1
hitonce = 0
numhits = 0

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; SKREEEEEEEE
[Statedef 3210]
type    = S
movetype= A
physics = N
velset = 0,0
juggle  = 0
ctrl = 0
sprpriority = 2
poweradd = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nobardisplay
flag2 = noBG
flag3 = noFG
ignorehitpause =1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = globalnoshadow
flag2 = nomusic
ignorehitpause = 1

[State 0, Bonnie]
type = Explod
trigger1 = time = 0
anim = 3210
ID = 3210
pos = 160,0
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
scale = .5,.5
sprpriority = 300
ownpal = 1
supermovetime = 65535
pausemovetime = 65535

[State 0, Camera Puting Down]
type = Explod
trigger1 = time = 0
trigger2 = time
trigger2 = !numexplod(3211)
trigger2 = numexplod(3212)
trigger2 = numtarget
trigger2 = target,alive
trigger2 = target,command = "a" || target,command = "b" || target,command = "c"
trigger2 = var(2) >= 20
anim = 3211
ID = 3211
pos = 160,0
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = .5,.5
sprpriority = 310
ownpal = 1
supermovetime = 65535
pausemovetime = 65535
[State 0, PUT DAT COOKIE DOWN]
type = RemoveExplod
trigger1 = numexplod(3211)
trigger1 = numexplod(3212)
id = 3212
ignorehitpause = 1
[State 0, PUT DAT COOKIE DOWN]
type = RemoveExplod
trigger1 = numexplod(3211)
trigger1 = numexplod(3213)
id = 3213
ignorehitpause = 1
[State 0, PUT DAT COOKIE DOWN]
type = RemoveExplod
trigger1 = numexplod(3211)
trigger1 = numexplod(3214)
id = 3214
ignorehitpause = 1
[State 0, Camera Puting Up]
type = Explod
triggerall = time
triggerall = !numexplod(3211)
triggerall = !numexplod(3212)
trigger1 = numtarget
trigger1 = target,alive
trigger1 = target,command = "x" || target,command = "y" || target,command = "z"
anim = 3212
ID = 3212
pos = 160,0
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
scale = .5,.5
sprpriority = 310
ownpal = 1
supermovetime = 65535
pausemovetime = 65535
[State Defailt]
type = Explod
triggerall = !numexplod(3213)
trigger1 = var(2) = 19
anim = 3213
ID = 3213
pos = 160,0
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
scale = .5,.5
sprpriority = 312
ownpal = 1
supermovetime = 65535
pausemovetime = 65535
[State Defailt]
type = Explod
trigger1 = var(2) = 19
anim = 3216
ID = 3214
pos = 160,0
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = 666,.5
sprpriority = 312
ownpal = 1
supermovetime = 65535
pausemovetime = 65535

[State 0, VarSet]
type = VarSet
trigger1 = 1
var(1) = ifelse(numexplod(3211),var(1)+1,0)
ignorehitpause = 1
[State 0, VarSet]
type = VarSet
trigger1 = 1
var(2) = ifelse(numexplod(3212),var(2)+1,0)
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
trigger2 = var(1) = 2
var(0) = 0
ignorehitpause = 1
[State 0, VarSet]
type = VarAdd
trigger1 = time
trigger1 = var(1) != 1
var(0) = 1
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
trigger2 = var(1) = 1
trigger3 = var(2) = 1
value = 0,24
channel = 1
abspan = 0

[State 0, PlaySnd]
type = PlaySnd
;trigger1 = time = 0
trigger1 = var(0) = 6
value = 0,22
channel = 0
abspan = 0

[State 0, TargetState]
type = TargetState
trigger1 = time = 0
trigger2 = var(0) = 1
value = 3229

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 0
value = 9741

[State 0, ChangeState]
type = ChangeState
trigger1 = lose
;trigger2 = draw
value = 3230
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = var(0) >= 50
value = 3211
ctrl = 0

;---------------------------------------------------------------------------
; RIP
[Statedef 3211]
type    = S
movetype= A
physics = N
velset = 0,0
juggle  = 0
ctrl = 0
sprpriority = 2
poweradd = 0

[State 0, StopSnd]
type = StopSnd
trigger1 = time = 0
channel = -1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = 0,23
channel = 1
abspan = 0

[State 0, TargetState]
type = TargetState
trigger1 = time = 0
value = 3229

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nobardisplay
flag2 = noBG
flag3 = noFG
ignorehitpause =1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = globalnoshadow
flag2 = nomusic
flag3 = timerfreeze
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nokoslow
flag2 = nokosnd
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = numexplod(3210)
id = 3210
ignorehitpause = 1
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = numexplod(3211)
id = 3211
ignorehitpause = 1
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = numexplod(3212)
id = 3212
ignorehitpause = 1
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = numexplod(3213)
id = 3213
ignorehitpause = 1
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = numexplod(3214)
id = 3214
ignorehitpause = 1

[State 0, Static]
type = Explod
trigger1 = time = 0
anim = 3215
ID = 3215
pos = 160,0
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
scale = .5,.5
sprpriority = 300
ownpal = 1
supermovetime = 65535
pausemovetime = 65535

[State 0, Lines]
type = Explod
trigger1 = time = 0
anim = 3216
ID = 3216
pos = 160,0
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = 666,.5
sprpriority = 310
ownpal = 1
supermovetime = 65535
pausemovetime = 65535

[State 0, HitAdd]
type = HitAdd
trigger1 = time%9=0
trigger1 = time <= 100
value = 1

[State 0, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = time = 100
value = -444
kill = 1
absolute = 1
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = time >= 101
;trigger1 = !winko
value = ifelse(winko,3223,3222)
ctrl = 0

;---------------------------------------------------------------------------
; JAM
[Statedef 3222]
type    = S
movetype= A
physics = N
anim = 3205
velset = 0,0
juggle  = 0
ctrl = 0
sprpriority = 2
poweradd = 0

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = numexplod(3215)
id = 3215
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = time = 0
x = 0
y = -32


[State 0, Static]
type = Explod
trigger1 = time = 0
anim = 3209
ID = 3209
pos = 160,0
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = .5,.5
sprpriority = -32
ownpal = 1
supermovetime = 65535
pausemovetime = 65535
[State 0, Lines]
type = Explod
trigger1 = time = 0
anim = 3216
ID = 3216
pos = 160,0
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = 666,.5
sprpriority = 310
ownpal = 1
supermovetime = 65535
pausemovetime = 65535

[State 0, YIKES]
type = Explod
trigger1 = time = 0
anim = 3206
ID = 3206
pos = 0,-60
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = .5,.5
sprpriority = -24
ownpal = 1
supermovetime = 65535
pausemovetime = 65535

[State 0, PosSet]
type = TargetBind
trigger1 = time = 0
pos = 80,-32

[State 0, TargetState]
type = TargetState
trigger1 = time = 0
value = 821

[State 0, PosSet]
type = VelSet
trigger1 = time = 0
x = 4
y = -2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S5,12
channel = 1

[State 0, PosSet]
type = VelSet
trigger1 = time
x = vel x * 0.99
y = vel y + 0.22

[State 0, ChangeState]
type = ChangeState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 0
value = 52
ctrl = 0
;anim =
;ignorehitpause =
;persistent =

;---------------------------------------------------------------------------
; TRULY RIP
[Statedef 3223]
type    = S
movetype= A
physics = N
anim = 9741
velset = 0,0
juggle  = 0
ctrl = 0
sprpriority = 2
poweradd = 0

[State 0, PosSet]
type = TargetBind
trigger1 = time = 0
pos = 0,9999

[State 0, TargetState]
type = TargetState
trigger1 = time = 0
value = 3228

[State 0, ChangeState]
type = ChangeState
trigger1 = time
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; PPPFT
[Statedef 3227]
type    = L
movetype= H
physics = N
velset = 0,0
ctrl = 0
poweradd = 0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
sysvar(0) = 0

[State 0, PosSet]
type = PosSet
trigger1 = time = 0
y = 0

[State 0, ChangeAnim]
type = ChangeAnim2
trigger1 = 1
value = 9741

[State 0, SelfState]
type = SelfState
trigger1 = 1
value = 5110



;---------------------------------------------------------------------------
; OOPS
[Statedef 3228]
type    = A
movetype= H
physics = N
velset = 0,9999
juggle  = 0
ctrl = 0
poweradd = 0

[State 0, ChangeAnim]
type = ChangeAnim2
trigger1 = 1
value = 9741

[State 0, SelfState]
type = SelfState
trigger1 = time
value = 5150


;---------------------------------------------------------------------------
; OOPS
[Statedef 3229]
type    = A
movetype= H
physics = N
velset = 0,0
juggle  = 0
ctrl = 0
poweradd = 0

[State 0, ChangeAnim]
type = ChangeAnim2
trigger1 = 1
value = 9741

[State 0, SelfState]
type = SelfState
trigger1 = time >= 666
value = 5050

;---------------------------------------------------------------------------
; OOPS
[Statedef 3209]
type    = A
movetype= H
physics = N
velset = 0,0
juggle  = 0
ctrl = 0
sprpriority = 2
poweradd = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 0
value = anim
elem = animelemno(0)

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 1
value = 5002

[State 0, SelfState]
type = SelfState
trigger1 = time >= 6
value = 5050

;---------------------------------------------------------------------------
; LUCKY SUNAVABITCH
[Statedef 3230]
type    = S
movetype= A
physics = N
velset = 0,0
juggle  = 0
ctrl = 0
sprpriority = 2
poweradd = 0

[State 0, TargetState]
type = TargetState
trigger1 = time = 0
value = 3229

[State 0, StopSnd]
type = StopSnd
trigger1 = time = 0
channel = -1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = 0,27
channel = 1
abspan = 0
[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 360
value = 0,29
abspan = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nobardisplay
flag2 = noBG
flag3 = noFG
ignorehitpause =1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = globalnoshadow
flag2 = nomusic
flag3 = timerfreeze
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nokoslow
flag2 = nokosnd
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = numexplod(3210)
id = 3210
ignorehitpause = 1
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = numexplod(3211)
id = 3211
ignorehitpause = 1
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = numexplod(3212)
id = 3212
ignorehitpause = 1
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = numexplod(3213)
id = 3213
ignorehitpause = 1
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = numexplod(3214)
id = 3214
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 1
[State 0, VarSet]
type = VarSet
trigger1 = time
fvar(0) = ifelse(fvar(0) * 0.99<0.05,0,fvar(0)* 0.99)

[State 0, PalFX]
type = AllPalFX
trigger1 = 1
time = 2
add = 0,0,0
mul = ceil(256*(1-fvar(0)) ),ceil(256*(1-fvar(0)) ),ceil(256*(1-fvar(0)) )
color = 256
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(1) = 1
[State 0, VarSet]
type = VarSet
trigger1 = time >= 200
fvar(1) = ifelse(fvar(1) * 0.98<0.05,0,fvar(1)* 0.98)


[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = numexplod(3231)
trigger1 = time >= 200
ID = 3231
pos = 160,120+floor(36*(1-fvar(1)) )
postype = left
bindtime = -1

[State 0, Static]
type = Explod
trigger1 = time = 0
anim = 3231
ID = 3231
pos = 160,120
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
scale = .5,.5
sprpriority = 290
ownpal = 1
supermovetime = 65535
pausemovetime = 65535
[State 0, Static]
type = Explod
trigger1 = time = 0
anim = 3230
ID = 3230
pos = 160,120
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
scale = .5,.5
sprpriority = 300
ownpal = 1
supermovetime = 65535
pausemovetime = 65535



[State 0, Lines]
type = Explod
trigger1 = time = 0
trigger2 = time = 660
anim = 3216
ID = 3216
pos = 160,0
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = 666,.5
sprpriority = 310
ownpal = 1
supermovetime = 65535
pausemovetime = 65535

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time >= 660
trigger1 = numexplod(3230)
id = 3230
ignorehitpause = 1
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time >= 660
trigger1 = numexplod(3231)
id = 3231
ignorehitpause = 1

[State 0, TargetState]
type = TargetState
trigger1 = time = 660
value = 3227

[State 0, ChangeState]
type = ChangeState
trigger1 = time >= 660
value = 3227
ctrl = 0

;---------------------------------------------------------------------------
; MICHAEL BAY SATSU
[Statedef 3400]
type    = S
movetype= A
physics = S
poweradd= -3000
velset = 0,0
anim = 3400
ctrl = 0
sprpriority = 2
facep2 = 1

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 2
var(6) = 38
[State 0, Helper]
type = Helper
trigger1 = animelem = 2
helpertype = normal
name = "Super BG"
ID = 2990
stateno = 2990
pos = 0,0
postype = p1
facing = 1
ownpal = 1
supermovetime = 65535
pausemovetime = 65535
ignorehitpause = 1
[State 0, SuperPause]
type = SuperPause
trigger1 = animelem = 2
time = 38
movetime = 38
anim = -1
sound = -1
pos = -11,-64
endcmdbuftime = 6
darken = 0
p2defmul = 1
unhittable = 1
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = 2,6
channel = 0
[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 12
value = 0,7
persistent = 0
[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 12
value = 2,14
channel = 0
persistent = 0
[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 12
statetype = A
physics = N
[State 0, VelSet]
type = VelSet
trigger1 = animelem = 12
x = 14
y = -4
persistent = 0
[State 0, VelSet]
type = VelAdd
trigger1 = animelemtime(12) >= 0
y = 0.44

[State 0, VelSet]
type = VelSet
trigger1 = moveguarded
x = -2
y = -3
ignorehitpause = 1
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 8
value = 0, 12

[State 0, Explod]
type = Explod
trigger1 = animelem = 8
anim = 1202
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1
supermovetime = 40
pausemovetime = 40

[State 200, 1]
type = HitDef
trigger1 = animelemtime(12) >= 0
trigger1 = !movecontact
trigger1 = !movereversed
attr = A, HA
damage = 25, 0
animtype = Light
guardflag = MA
hitflag = MAF
pausetime = 8-var(49), 8
sparkno = S900
guard.sparkno = S905
sparkxy = -10, ceil(-133 * const(size.yscale) )
hitsound = S5, 3
guardsound = S6, 0
ground.type = High
ground.slidetime = ceil(24*ifelse(var(31),1.2,1))
ground.hittime  = ceil(24*ifelse(var(31),1.2,1))
guard.velocity = -10
ground.velocity = -1
airguard.velocity = -5,-4.4
air.type = High
air.velocity = -1,-8.8
air.hittime = 12
air.fall = 1
guard.ctrltime = 12
fall.recovertime = 40
yaccel = .88
ground.cornerpush.veloff = 0
getpower = 0
kill = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 0
value = 3401
ctrl = 0

[Statedef 3401]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 3401
sprpriority = 2

[State 200, 1]
type = PlaySnd
trigger1 = time = 0
value = 40, 0

[State 52, 1]
type = VelSet
trigger1 = Time = 0
x = 0
y = 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 800, 1]
type = HitDef
Trigger1 = Time = 0
attr = S, HT
hitflag = MAF
priority = 3, Miss
sparkno = -1
p1sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 3410
;p2stateno = 820
guard.dist = 0
fall = 1
numhits = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 4
movetype = I
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = 5000,1
channel = 0
lowpriority = 1

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

[Statedef 3410]
type    = S
movetype= A
physics = N
anim = 3410

[State 0, StopSnd]
type = StopSnd
trigger1 = time = 0
channel = 0

[State 810, TargetState] ; This is the sctrl you'd use to put victims into custom states
type = TargetState
trigger1 = time = 0
value = 3420

[State 810, Grab Sound]
type = PlaySnd
trigger1 = time = 0
value = 1, 1

[State 0, SprPriority]
type = SprPriority
trigger1 = time = 0
value = -2

[State 0, Explod]
type = Explod
trigger1 = animelem = 3
anim = 3440+random%5
ID = 3440
pos = 160,0
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = .5,.5
sprpriority = 500
ontop = 1
shadow = 0,0,0
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelemtime(3) >= 0
trigger1 = animelemtime(4) < 0
trigger1 = animelemtime(3)%9 = 1
anim = 3411
ID = 3411
pos = random%320,random%240
postype = left
facing = ifelse(random<500,1,-1)
vfacing = ifelse(random<500,1,-1)
bindtime = 1
removetime = -2
scale = .25,.25
sprpriority = 600
ontop = 1
shadow = 0,0,0
ownpal = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelemtime(3) >= 0
trigger1 = animelemtime(4) < 0
trigger1 = animelemtime(3)%9 = 1
value = S5,7
channel = 1

[State 0, HitAdd]
type = HitAdd
trigger1 = animelemtime(3) >= 0
trigger1 = animelemtime(4) < 0
trigger1 = animelemtime(3)%9 = 1
trigger2 = animelem = 2
value = 1

[State 0, EnvShake]
type = EnvShake
trigger1 = animelemtime(3) >= 0
trigger1 = animelemtime(4) < 0
trigger1 = animelemtime(3)%9 = 1
time = 12
freq = 255
ampl = -4

[State 0, Explod]
type = Explod
trigger1 = animelem = 4
anim = 3415
ID = 3415
pos = 100,160
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
scale = 2.5,2.5
sprpriority = 999
ontop = 1
shadow = 0,0,0
ownpal = 1


[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = numexplod(3440)
ignorehitpause = 1
flag = nomusic
flag2 = globalnoshadow

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = numexplod(3440)
ignorehitpause = 1
flag = nobardisplay
flag2 = noBG
flag3 = noFG

[State 0, EnvColor]
type = EnvColor
trigger1 = animelemtime(5) = [0,1]
trigger2 = animelemtime(5) = [4,5]
trigger3 = animelemtime(5) = [8,9]
value = 255,0,0
time = 2
under = (animelemtime(5)>=6)

[State 0, EnvColor]
type = EnvColor
trigger1 = animelemtime(5) = [2,3]
trigger2 = animelemtime(5) = [6,7]
trigger3 = animelemtime(5) = [10,11]
value = 255,255,255
time = 2
under = (animelemtime(5)>=6)

[State 810, Bind 4]
type = TargetBind
trigger1 = animelemtime(2) < 0
pos = floor(73*const(size.xscale)), 0

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(5) < 0
pos = floor(80*const(size.xscale)), floor(-249*const(size.yscale))

[State 810, Bind 5]
type = TargetBind
trigger1 = animelemtime(5) = 0
pos = 0, floor(-249*const(size.yscale))

[State 810, Throw 11]
type = TargetState
trigger1 = animelemtime(5) = 0
value = 3421

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = S0,26

[State 0, Explod]
type = Explod
trigger1 = animelem = 5
anim = 1011
ID = 1011
pos = 0,-50
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = const(size.xscale)*2,const(size.yscale)*2
sprpriority = 6
ontop = 0
shadow = 0,0,0
ownpal = 1

[State 0, EnvShake]
type = EnvShake
trigger1 = animelem = 5
time = 20
freq = 255
ampl = -14
ignorehitpause = 1
persistent = 0

[State 810, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 5
value = ceil( -666 * ( .25 + (fvar(13)*.75)) )
persistent = 0

[State 0, Turn]
type = Turn
trigger1 = animtime = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1





;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw
; (a custom gethit state)
; Description: This is the state that the opponent changes to after being
;     hit by KFM's throw HitDef. The important thing here is to use a
;     ChangeAnim2 controller. The difference between ChangeAnim2 and
;     ChangeAnim is that ChangeAnim2 changes the player's animation to
;     an action in the AIR file of the attacker (in this case, kfm.air),
;     whereas ChangeAnim always changes the player to an action in his
;     own AIR file. Look at Action 820 in kfm.air for some extra
;     comments.
[Statedef 3420]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,0
ignorehitpause = 1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 3420

;In case attacker loses binding on player for any reason, this controller
;guarantees that the player will never get stuck in this thrown state.
[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

[Statedef 3421]
type    = A
movetype= H
physics = N
velset = -4,-6

[State 5100, 2]
type = ChangeAnim2
trigger1 = time = 0
trigger1 = !selfanimexist(7697)
value = 3421

[State 5100, 2]
type = ChangeAnim
trigger1 = time = 0
trigger1 = selfanimexist(7697)
value = 7697

[State 0, PalFXWiz]
type = PalFX
trigger1 = time = 0
trigger1 = anim != 7697
time = 40
add = 40,-70,-200
mul = 256,256,256
sinadd = 40,30,0,10
invertall = 1
color = 0

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = 0+const(size.mid.pos.x)
y = 0+const(size.mid.pos.y)

[State 0, VelAdd]
type = VelAdd
trigger1 = time
y = 0.48

[State 5100, 7]
type = SelfState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 0
value = 5100 ;HIT_LIEDOWN

;---------------------------------------------------------------------------
; Dash Bak
[Statedef 10105]
type    = S
physics = N
anim = 10105
sprpriority = 1
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S30,4

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 2
statetype = A
movetype = I
physics = A
ignorehitpause = 1
[State 100, 1]
type = VelSet
trigger1 = animelem = 2
x = -8
y = -4.4

[State 100, 2] ;Prevent run from canceling into walk
type = AssertSpecial
trigger1 = 1
flag = NoWalk

[State 100, 3] ;Prevent from turning
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn



;---------------------------------------------------------------------------
; Classic Fast Attack
[Statedef 10200]
type    = S
movetype= A
physics = S
juggle  = 4
velset = 0,0
ctrl = 0
anim = ifelse(p2bodydist x<=15,10200,ifelse(p2bodydist x<=35,10201,10202))
sprpriority = 2
facep2 = 1

[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = time = 1
value = 30, 5

[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 10202
trigger1 = animelem = 2
x = 22*const(size.xscale)
[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 10202
trigger1 = animelem = 3
x = 18*const(size.xscale)
[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 10202
trigger1 = animelem = 5
x = 38*const(size.xscale)

[State 200, 1]
type = HitDef
trigger1 = anim = 10200
trigger1 = AnimElem = 2
attr = S, HA
damage = 100, 0
animtype = medium
guardflag = M
hitflag = MAF
pausetime = 12-var(49), 12
sparkno = S960
guard.sparkno = S961
sparkxy = -10, ceil(-158 * const(size.yscale) )
hitsound = S35, 2
guardsound = S36, 0
ground.type = low
ground.slidetime = ceil(16*ifelse(var(31),1.2,1))
ground.hittime  = ceil(16*ifelse(var(31),1.2,1))
ground.velocity = -11
guard.velocity = -11
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-4.4
air.hittime = 12
air.fall = 1
guard.ctrltime = 14
fall.recover = 0
yaccel = .44
ground.cornerpush.veloff = 0
getpower = 0
[State 200, 1]
type = HitDef
trigger1 = anim = 10201
trigger1 = AnimElem = 2
attr = S, HA
damage = 100, 0
animtype = medium
guardflag = M
hitflag = MAF
pausetime = 12-var(49), 12
sparkno = S960
guard.sparkno = S961
sparkxy = -10, ceil(-131 * const(size.yscale) )
hitsound = S35, 1
guardsound = S36, 0
ground.type = low
ground.slidetime = ceil(16*ifelse(var(31),1.2,1))
ground.hittime  = ceil(16*ifelse(var(31),1.2,1))
ground.velocity = -11
guard.velocity = -11
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-4.4
air.hittime = 12
air.fall = 1
guard.ctrltime = 14
fall.recover = 0
yaccel = .44
ground.cornerpush.veloff = 0
getpower = 0
[State 200, 1]
type = HitDef
trigger1 = anim = 10202
trigger1 = AnimElem = 5
attr = S, HA
damage = 100, 0
animtype = medium
guardflag = M
hitflag = MAF
pausetime = 12-var(49), 12
sparkno = S960
guard.sparkno = S961
sparkxy = -10, ceil(-140 * const(size.yscale) )
hitsound = S35, 1
guardsound = S36, 0
ground.type = high
ground.slidetime = ceil(16*ifelse(var(31),1.2,1))
ground.hittime  = ceil(16*ifelse(var(31),1.2,1))
ground.velocity = -11
guard.velocity = -11
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-4.4
air.hittime = 12
air.fall = 1
guard.ctrltime = 12
fall.recover = 0
yaccel = .44
ground.cornerpush.veloff = 0
getpower = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = anim = 10200
trigger1 = animelem = 4
trigger2 = anim = 10201
trigger2 = animelem = 3
trigger3 = anim = 10202
trigger3 = animelem = 6
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Classic Slow Attack
[Statedef 10210]
type    = S
movetype= A
physics = S
juggle  = 4
velset = 0,0
ctrl = 0
anim = ifelse(p2bodydist x<=15,10210,ifelse(p2bodydist x<=35,10211,10212))
sprpriority = 2
facep2 = 1

[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = time = 1
value = 30, 5

[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 10212
trigger1 = animelem = 3
x = 22*const(size.xscale)
[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 10212
trigger1 = animelem = 4
x = 18*const(size.xscale)
[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 10212
trigger1 = animelem = 6
x = 38*const(size.xscale)

[State 200, 1]
type = HitDef
trigger1 = anim = 10210
trigger1 = AnimElem = 3
attr = S, HA
damage = 175, 0
animtype = hard
guardflag = M
hitflag = MAF
pausetime = 12-var(49), 12
sparkno = S960
guard.sparkno = S961
sparkxy = -10, ceil(-158 * const(size.yscale) )
hitsound = S35, 0
guardsound = S36, 0
ground.type = low
ground.slidetime = ceil(16*ifelse(var(31),1.2,1))
ground.hittime  = ceil(16*ifelse(var(31),1.2,1))
ground.velocity = -14
guard.velocity = -14
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-4.4
air.hittime = 12
air.fall = 1
guard.ctrltime = 14
fall.recover = 0
yaccel = .44
ground.cornerpush.veloff = 0
getpower = 0
[State 200, 1]
type = HitDef
trigger1 = anim = 10211
trigger1 = AnimElem = 3
attr = S, HA
damage = 175, 0
animtype = hard
guardflag = M
hitflag = MAF
pausetime = 12-var(49), 12
sparkno = S960
guard.sparkno = S961
sparkxy = -10, ceil(-131 * const(size.yscale) )
hitsound = S35, 0
guardsound = S36, 0
ground.type = low
ground.slidetime = ceil(16*ifelse(var(31),1.2,1))
ground.hittime  = ceil(16*ifelse(var(31),1.2,1))
ground.velocity = -14
guard.velocity = -14
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-4.4
air.hittime = 12
air.fall = 1
guard.ctrltime = 14
fall.recover = 0
yaccel = .44
ground.cornerpush.veloff = 0
getpower = 0
[State 200, 1]
type = HitDef
trigger1 = anim = 10212
trigger1 = AnimElem = 6
attr = S, HA
damage = 175, 0
animtype = hard
guardflag = M
hitflag = MAF
pausetime = 12-var(49), 12
sparkno = S960
guard.sparkno = S961
sparkxy = -10, ceil(-140 * const(size.yscale) )
hitsound = S35, 0
guardsound = S36, 0
ground.type = high
ground.slidetime = ceil(16*ifelse(var(31),1.2,1))
ground.hittime  = ceil(16*ifelse(var(31),1.2,1))
ground.velocity = -14
guard.velocity = -14
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-4.4
air.hittime = 12
air.fall = 1
guard.ctrltime = 12
fall.recover = 0
yaccel = .44
ground.cornerpush.veloff = 0
getpower = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = anim = 10200
trigger1 = animelem = 5
trigger2 = anim = 10201
trigger2 = animelem = 4
trigger3 = anim = 10202
trigger3 = animelem = 7
movetype = I

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Classic Crouch Attack
[Statedef 10400]
type    = C
movetype= A
physics = C
juggle  = 4
velset = 0,0
ctrl = 0
anim = 10400
sprpriority = 2
facep2 = 1

[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = time = 1
value = 30, 4

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 2
attr = C, HA
damage = 75, 0
animtype = medium
guardflag = M
hitflag = MAF
pausetime = 12-var(49), 12
sparkno = S960
guard.sparkno = S961
sparkxy = -10, ceil(-100 * const(size.yscale) )
hitsound = S35, 1
guardsound = S36, 0
ground.type = low
ground.slidetime = ceil(16*ifelse(var(31),1.2,1))
ground.hittime  = ceil(16*ifelse(var(31),1.2,1))
ground.velocity = -11
guard.velocity = -11
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-4.4
air.hittime = 12
air.fall = 1
guard.ctrltime = 14
fall.recover = 0
yaccel = .44
ground.cornerpush.veloff = 0
getpower = 0

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; Classic Crouch Attack
[Statedef 10410]
type    = C
movetype= A
physics = C
juggle  = 4
velset = 0,0
ctrl = 0
anim = 10410
sprpriority = 2
facep2 = 1

[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = time = 1
value = 30, 4

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 2
attr = C, HA
damage = 125, 0
animtype = hard
guardflag = M
hitflag = MAF
pausetime = 12-var(49), 12
sparkno = S960
guard.sparkno = S961
sparkxy = -10, ceil(-100 * const(size.yscale) )
hitsound = S35, 0
guardsound = S36, 0
ground.type = low
ground.slidetime = ceil(16*ifelse(var(31),1.2,1))
ground.hittime  = ceil(16*ifelse(var(31),1.2,1))
ground.velocity = -14
guard.velocity = -14
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-4.4
air.hittime = 12
air.fall = 1
guard.ctrltime = 14
fall.recover = 0
yaccel = .44
ground.cornerpush.veloff = 0
getpower = 0

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; Classic Air Attack
[Statedef 10600]
type    = A
movetype= A
physics = A
juggle  = 4
ctrl = 0
anim = 10600
sprpriority = 2
facep2 = 1

[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = time = 0
value = 30, 1

[State 200, 1]
type = HitDef
trigger1 = time = 1
attr = A, HA
damage = 150, 0
animtype = hard
guardflag = H
hitflag = MAF
pausetime = 12-var(49), 12
sparkno = S960
guard.sparkno = S961
sparkxy = -10, ceil(-65 * const(size.yscale) )
hitsound = S35, 0
guardsound = S36, 0
ground.type = high
ground.slidetime = ceil(20*ifelse(var(31),1.2,1))
ground.hittime  = ceil(20*ifelse(var(31),1.2,1))
ground.velocity = -14
guard.velocity = -14
airguard.velocity = -5,-4.4
air.type = high
air.velocity = -4,-4.4
air.hittime = 12
air.fall = 1
guard.ctrltime = 14
fall.recover = 0
yaccel = .44
ground.cornerpush.veloff = 0
getpower = 0


;---------------------------------------------------------------------------
; Classic Reppuken
[Statedef 10220]
type    = S
movetype= A
physics = S
juggle  = 4
velset = 0,0
ctrl = 0
anim = 10220
sprpriority = 2
facep2 = 1

[State 200, 1]
type = PlaySnd
trigger1 = time = 0
value = 30, 12
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 5
value = 30, 3

[State 0, Helper]
type = Helper
trigger1 = animelem = 5
helpertype = normal
name = "Reppuken"
ID = 10220
stateno = 10225
pos = 0,0
;pos = floor(0*const(size.xscale)),0
postype = p1
facing = 1
ownpal = 1

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;
[Statedef 10225]
type    = S
movetype= A
physics = N
juggle  = 4
velset = 0,0
ctrl = 0
anim = 10225
sprpriority = 4

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = ,NA,NT,ST
time = 2
ignorehitpause = 1
[State 0, HitOverride]
type = HitOverride
trigger1 = time = 0
attr = SCA,AA,AP,AT
slot = 0
stateno = 10226
time = -1
forceair = 1
ignorehitpause = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = time != 0
trigger1 = (time%2)=0
x = 32*const(size.xscale)

[State 0, Explod]
type = Explod
trigger1 = time != 0
trigger1 = (time%2)=0
anim = 10227
ID = 10227
pos = -16,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
scale = const(size.xscale),const(size.yscale)
sprpriority = 3
ownpal = 1
removeongethit = 1
ignorehitpause = 1

[State 200, 1]
type = HitDef
trigger1 = time
trigger1 = !movecontact
trigger1 = !movereversed
attr = S, HP
damage = 222, 20
animtype = diagup
guardflag = M
hitflag = MAF
pausetime = 0, 12
guard.pausetime = 0,0
sparkno = S960
guard.sparkno = S961
sparkxy = -10, ceil(-32 * const(size.yscale) )
hitsound = S35, 3
guardsound = S36, 0
ground.type = low
ground.slidetime = ceil(16*ifelse(var(31),1.2,1))
ground.hittime  = ceil(16*ifelse(var(31),1.2,1))
ground.velocity =  -4,-4.4
guard.velocity = -10
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-4.4
air.hittime = 12
fall = 1
guard.ctrltime = 14
fall.recover = 0
yaccel = .44
ground.cornerpush.veloff = 0
getpower = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = movecontact
trigger2 = movereversed
trigger3 = frontedgedist < -32
value = 10226
ctrl = 0

[Statedef 10226]
type    = S
movetype= I
physics = N
juggle  = 4
anim = 10226
velset = 0,0
ctrl = 0

;[State 0, ChangeAnim]
;type = ChangeAnim
;trigger1 = time = 0
;value = 10226
;elem = animelemno(0)
;ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = ,NA,NT,ST
time = 2
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = animtime = 0
ignorehitpause = 1

[Statedef 10800]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 10800
sprpriority = 2

[State 800, 1]
type = HitDef
Trigger1 = Time = 0
attr = S, HT
hitflag = M-
priority = 3, Miss
sparkno = -1
p1sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 10810
;p2stateno = 820
guard.dist = 0
fall = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = 5000,1
channel = 0
lowpriority = 1

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

[Statedef 10810]
type    = S
movetype= A
physics = N
anim = 10810

[State 810, TargetState] ; This is the sctrl you'd use to put victims into custom states
type = TargetState
trigger1 = time = 0
value = 10820

[State 810, Grab Sound]
type = PlaySnd
trigger1 = time = 0
value = 1, 1

[State 810, Grab Sound]
type = PlaySnd
trigger1 = animelem = 2
value = 30, 13

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 3
x = -37*const(size.xscale)
[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 4
x = -120*const(size.xscale)

[State 810, Bind 4]
type = TargetBind
trigger1 = animelemtime(2) < 0
pos = floor(95*const(size.xscale)), 0

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = floor(34*const(size.xscale)), floor(-156*const(size.yscale))

[State 810, Bind 5]
type = TargetBind
trigger1 = animelemtime(3) = 0
pos = floor(-67*const(size.xscale)), floor(-177*const(size.yscale))

[State 810, Throw 11]
type = TargetState
trigger1 = AnimElem = 3
value = 10821

[State 810, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 4
value = -150
persistent = 0


[State 810, State End]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1



;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw
; (a custom gethit state)
; Description: This is the state that the opponent changes to after being
;     hit by KFM's throw HitDef. The important thing here is to use a
;     ChangeAnim2 controller. The difference between ChangeAnim2 and
;     ChangeAnim is that ChangeAnim2 changes the player's animation to
;     an action in the AIR file of the attacker (in this case, kfm.air),
;     whereas ChangeAnim always changes the player to an action in his
;     own AIR file. Look at Action 820 in kfm.air for some extra
;     comments.
[Statedef 10820]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,0
ignorehitpause = 1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 10820

;In case attacker loses binding on player for any reason, this controller
;guarantees that the player will never get stuck in this thrown state.
[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
; (a custom gethit state)
; Description: This state has the opponent flying through the air and
;     falling down onto the ground. The SelfState controller sets the
;     opponent back using to his own state file when he his the ground.
;     Controllers 821,2 and 821,3 allow the opponent to recover by
;     hitting his recovery command when he is falling.
[Statedef 10821]
type    = A
movetype= H
physics = N
velset = 6,-6

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = 0-const(size.mid.pos.x)
y = 0-const(size.mid.pos.y)

[State 0, VelAdd]
type = VelAdd
trigger1 = time
y = 0.48

[State 5100, 7]
type = SelfState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 0
value = 5100 ;HIT_LIEDOWN


;---------------------------------------------------------------------------
; Classic Counter
[Statedef 10830]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 10830
ctrl = 0
sprpriority = 2
facep2 = 1

[State 200, 1]
type = PlaySnd
trigger1 = time = 1
value = 30, 5

[State 0, ReversalDef]
type = ReversalDef
trigger1 = 1
attr = S,ST
reversal.attr = SCA,NA,SA,HA
hitflag = MAF
id = 1100
sparkno = -1
hitsound = -1
p1stateno = 10840
;pausetime = 2,2
p2stateno = 10850
ignorehitpause = 1
numhits = 0
priority = 5
guard.dist = 0

[State 1000, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

[Statedef 10840]
type    = S
movetype= A
physics = N
anim = 10840
sprpriority = -2

[State 0, SprPriority]
type = SprPriority
trigger1 = animelem = 2
value = 2
ignorehitpause = 1

[State 810, TargetState] ; This is the sctrl you'd use to put victims into custom states
type = TargetState
trigger1 = time = 0
value = 10850

[State 810, Grab Sound]
type = PlaySnd
trigger1 = time = 0
value = 30, 9
channel = 0

[State 810, Grab Sound]
type = PlaySnd
trigger1 = animelem = 2
value = 30, 13

[State 810, Grab Sound]
type = PlaySnd
trigger1 = animelem = 6
value = 35, 7

[State 0, EnvShake]
type = EnvShake
trigger1 = animelem = 6
time = 12
freq = 255
ampl = -6

[State 0, Turn]
type = Turn
trigger1 = animelem = 5
[State 0, TargetFacing]
type = TargetFacing
trigger1 = animelem = 5
value = 1
;ID = 1100
ignorehitpause = 1

[State 810, TargetState]
type = TargetState
trigger1 = animelem = 2
value = 10851

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(4) < 0
pos = floor(50*const(size.xscale)), 0

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = floor(-2*const(size.xscale)), floor(-223*const(size.yscale))

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
pos = floor(69*const(size.xscale)), floor(-99*const(size.yscale))

[State 0, Explod]
type = Explod
trigger1 = animelem = 6
anim = 960
ID = 960
pos = floor(95*const(size.xscale)), 0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
pausemovetime = 65535
supermovetime = 65535
scale = 1,1
sprpriority = 6
ontop = 1
ownpal = 1

[State 810, Bind 4]
type = TargetBind
trigger1 = animelem = 6
pos = floor(95*const(size.xscale)), 0

[State 810, Throw 11]
type = TargetState
trigger1 = AnimElem = 6
value = 10852

[State 810, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 6
value = -250
persistent = 0

[State 0, TargetVelSet]
type = TargetVelSet
trigger1 = numtarget
trigger1 = target,stateno = 5101
x = 4
y = -5
;ID = 1100
ignorehitpause = 1
persistent = 0

[State 810, State End]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1



;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw
; (a custom gethit state)
; Description: This is the state that the opponent changes to after being
;     hit by KFM's throw HitDef. The important thing here is to use a
;     ChangeAnim2 controller. The difference between ChangeAnim2 and
;     ChangeAnim is that ChangeAnim2 changes the player's animation to
;     an action in the AIR file of the attacker (in this case, kfm.air),
;     whereas ChangeAnim always changes the player to an action in his
;     own AIR file. Look at Action 820 in kfm.air for some extra
;     comments.
[Statedef 10850]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = 1
value = anim
elem = animelemno(0)
ignorehitpause = 1

;In case attacker loses binding on player for any reason, this controller
;guarantees that the player will never get stuck in this thrown state.
[State 820, 2]
type = SelfState
trigger1 = time >= 66
value = 5050

[Statedef 10851]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,0
ignorehitpause = 1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 10850
elem = 2

;In case attacker loses binding on player for any reason, this controller
;guarantees that the player will never get stuck in this thrown state.
[State 820, 2]
type = SelfState
trigger1 = time >= 66
value = 5050


;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
; (a custom gethit state)
; Description: This state has the opponent flying through the air and
;     falling down onto the ground. The SelfState controller sets the
;     opponent back using to his own state file when he his the ground.
;     Controllers 821,2 and 821,3 allow the opponent to recover by
;     hitting his recovery command when he is falling.
[Statedef 10852]
type    = A
movetype= H
physics = N
velset = 0,0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 0
value = ifelse(selfanimexist(5101),5101,5100)

[State 0, PosSet]
type = PosSet
trigger1 = time = 0
y = 0

[State 5100, 7]
type = SelfState
trigger1 = 1
value = 5100 ;HIT_LIEDOWN

;---------------------------------------------------------------------------
; Classic Plane Shift Attack Init
[Statedef 11200]
type    = S
movetype= I
physics = N
velset = 0,0
ctrl = 0
anim = 11200
sprpriority = 2
facep2 = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 1
[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(1) = 1

[State 0, VelSet]
type = VelSet
trigger1 = animtime = 0
x = 1
y = -10

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animtime = 0
statetype = A
physics = N

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 11201
ctrl = 0

;---------------------------------------------------------------------------
; Classic Plane Shift Attack Init
[Statedef 11210]
type    = S
movetype= I
physics = N
velset = 0,0
ctrl = 0
anim = 11200
sprpriority = 2
facep2 = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 2
[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(1) = 1

[State 0, VelSet]
type = VelSet
trigger1 = animtime = 0
x = 2
y = -10

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animtime = 0
statetype = A
physics = N

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 11201
ctrl = 0

;---------------------------------------------------------------------------
; Classic Plane Shift Attack Init
[Statedef 11220]
type    = S
movetype= I
physics = N
velset = 0,0
ctrl = 0
anim = 11200
sprpriority = 2
facep2 = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 4
[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(1) = 1

[State 0, VelSet]
type = VelSet
trigger1 = animtime = 0
x = 4
y = -10

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animtime = 0
statetype = A
physics = N

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 11201
ctrl = 0

;---------------------------------------------------------------------------
; Classic Plane Shift Attack Jump 1
[Statedef 11201]
type    = A
movetype= A
physics = N
juggle = 0
ctrl = 0
anim = 11201
sprpriority = 2

[State 0, VelAdd]
type = VelAdd
trigger1 = 1
y = 0.47

[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = time = 0
value = 30, 5

[State 200, 1]
type = HitDef
trigger1 = movetype = A
trigger1 = !movecontact
trigger1 = !movereversed
attr = A, HA
damage = 175, 0
animtype = diagup
guardflag = M
hitflag = MAF
pausetime = 12-var(49), 12
sparkno = S960
guard.sparkno = S961
sparkxy = -10, ceil(-100 * const(size.yscale) )
hitsound = S35, 0
guardsound = S36, 0
ground.type = low
ground.slidetime = ceil(32*ifelse(var(31),1.2,1))
ground.hittime  = ceil(32*ifelse(var(31),1.2,1))
ground.velocity = -4,-4.4
guard.velocity = -14
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-4.4
air.hittime = 12
fall = 1
guard.ctrltime = 14
fall.recover = 0
yaccel = .44
ground.cornerpush.veloff = 0
getpower = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= -10
value = 11202
ctrl = 0

[State 0, PlayerPush]
type = PlayerPush
trigger1 = fvar(1) <= 0.9
value = 0
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = fvar(1) <= 0.9
trigger1 = movetype = A
movetype = I

[State 0, NotHitBy]
type = NotHitBy
trigger1 = fvar(1) <= 0.9
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = fvar(1) <= 0.8
flag = noshadow
ignorehitpause = 1

[State 0, VarSet]
type = VarAdd
trigger1 = fvar(1) > 0.75
fvar(1) = -0.01

[State 0, SprPriority]
type = SprPriority
trigger1 = fvar(1) <= 0.9
value = -3
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = fvar(1),fvar(1)
;ignorehitpause = 1

[Statedef 11202]
type    = A
movetype= I
physics = N
velset = 0,0
ctrl = 0
anim = 11202
sprpriority = -3

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S40,10

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = time = 0
y = -10

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = animtime = 0
x = fvar(0)
y = -10

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animtime = 0
statetype = A
physics = N

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 11203
ctrl = 0

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = fvar(1),fvar(1)
;ignorehitpause = 1



;---------------------------------------------------------------------------
; Classic Plane Shift Attack Jump 2
[Statedef 11203]
type    = A
movetype= I
physics = N
juggle  = 0
ctrl = 0
anim = 11203
sprpriority = -3

[State 0, VelAdd]
type = VelAdd
trigger1 = 1
y = 0.47

[State ProRation]
type = VarSet
trigger1 = var(21) = 1
fvar(13) = fvar(13) * 0.75
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = time = 0
value = 30, 5

[State 200, 1]
type = HitDef
trigger1 = movetype = A
trigger1 = !movecontact
trigger1 = !movereversed
attr = A, HA
damage = 175, 0
animtype = hard
guardflag = H
hitflag = MAF
pausetime = 12-var(49), 12
sparkno = S960
guard.sparkno = S961
sparkxy = -10, ceil(-100 * const(size.yscale) )
hitsound = S35, 0
guardsound = S36, 0
ground.type = low
ground.slidetime = ceil(30*ifelse(var(31),1.2,1))
ground.hittime  = ceil(30*ifelse(var(31),1.2,1))
ground.velocity = -14
guard.velocity = -14
airguard.velocity = -5,-4.4
air.type = low
air.velocity = -4,-4.4
air.hittime = 12
air.fall = 1
guard.ctrltime = 14
fall.recover = 0
yaccel = .44
ground.cornerpush.veloff = 0
getpower = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = vel y > 0
trigger1 = vel y + pos y >= 0
value = 52
ctrl = 0

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1;fvar(1) <= 0.95
value = 0
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = fvar(1) >= 0.95
trigger1 = movetype = I
movetype = A

[State 0, NotHitBy]
type = NotHitBy
trigger1 = fvar(1) <= 0.97
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = fvar(1) <= 0.95
flag = noshadow
ignorehitpause = 1

[State 0, VarSet]
type = VarAdd
trigger1 = fvar(1) < 1
fvar(1) = 0.01

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = fvar(1),fvar(1)
;ignorehitpause = 1

[State 0, SprPriority]
type = SprPriority
trigger1 = fvar(1) >= 0.95
value = 3
ignorehitpause = 1

; FATALITY
[Statedef 10183]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(2) = (anim=10840)
ignorehitpause=1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nokoslow
flag2 = nokosnd
flag3 = nomusic

[State 0, TargetState]
type = TargetState
trigger1 = time = 1
value = 10184
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = 1
value = anim
elem = animelemno(0)
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(4) = 0
[State 0, VarSet]
type = VarAdd
trigger1 = var(4) < 255
var(4) = 10

[State 0, AllPalFX]
type = AllPalFX
trigger1 = 1
time = 2
add = var(4),var(4),var(4)
;mul = 256,256,256
;sinadd = 0,0,0,10
;invertall = 0
color = 256-var(4)
;ignorehitpause =
;persistent =

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = var(4) >= 255
value = 10185
ctrl = 0

; AAAAAAA
[Statedef 10184]
type    = A
movetype= H
physics = N
;velset = 0,0
ctrl = 0

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 0, HitVelSet]
type = HitVelSet
triggerall = time = 0
trigger1 = vel x = 0
trigger1 = vel y = 0
x = 1
y = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1

;[State 0, ChangeAnim]
;type = ChangeAnim
;trigger1 = 1
;value = anim
;elem = animelemno(0)
;ignorehitpause = 1

[State 0, VelAdd]
type = VelAdd
trigger1 = pos y < 0
trigger1 = time
trigger1 = gethitvar(yvel)
x = 0
y = gethitvar(yaccel)

[State 0, VelAdd]
type = Velset
trigger1 = pos y >= 0
trigger1 = time
y = 0

[State 0, VelAdd]
type = Posset
trigger1 = pos y >= 0
trigger1 = time
y = 0

[State 0, SelfState]
type = SelfState
trigger1 = time >= 222
value = 5150


; FATALITY
[Statedef 10185]
type    = S
movetype= A
physics = N
anim = 9741;10000
velset = 0,0
ctrl = 0

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(4) = 256
[State 0, VarSet]
type = VarSet
trigger1 = var(4) > 0
var(4) = ifelse(var(4)-10<=0,0,var(4)-10)

[State 0, AllPalFX]
type = AllPalFX
trigger1 = var(4)
time = 2
add = var(4),var(4),var(4)
;mul = 256,256,256
;sinadd = 0,0,0,10
;invertall = 0
color = 256-var(4)

[State 0, PosSet]
type = PosSet
trigger1 = time = 0
x = 0
y = 0
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
var(39) = 10
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 2
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nokoslow
flag2 = nokosnd
flag3 = nomusic
[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = globalnoshadow

[State 0, Explod]
type = Explod
trigger1 = time = [0,120]
trigger1 = !numexplod(10185)
anim = 10185
ID = 10185
pos = 160,120
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
pausemovetime = 65535
scale = 1.11111,1.07142857142857
sprpriority = -64
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = time = [0,120]
trigger1 = !numexplod(10186)
anim = 10186
ID = 10186
pos = 160,120
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
pausemovetime = 65535
scale = 1.11111,1.07142857142857
sprpriority = 64
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = time = [0,120]
trigger1 = !numexplod(10188)
trigger1 = var(2) = 1
anim = 10188
ID = 10188
pos = 160,120
postype = left
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
pausemovetime = 65535
scale = 1,1
sprpriority = 80
ownpal = 1

[State 0, TargetState]
type = TargetState
trigger1 = time = 0
value = 10186
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(0) = 1
[State 0, VarSet]
type = VarSet
trigger1 = time = 0
fvar(1) = 2
[State 0, VarSet]
type = VarSet
trigger1 = time
fvar(0) = fvar(0) * 0.99
;[State 0, VarSet]
;type = VarSet
;trigger1 = time
;fvar(1) = fvar(1) * fvar(0)
[State 0, VarSet]
type = VarSet
trigger1 = time
fvar(1) = fvar(1) - 0.0123

[State 0, TargetState]
type = TargetState
trigger1 = time
trigger1 = fvar(1) <= 0.1
value = 3228
[State 0, PlaySnd]
type = PlaySnd
trigger1 = time
trigger1 = fvar(1) <= 0.1
value = S35,ifelse(random<500,5,6)
[State 0, TargetDrop]
type = TargetDrop
trigger1 = time
trigger1 = fvar(1) <= 0.1
[State 0, EnvShake]
type = EnvShake
trigger1 = time
trigger1 = fvar(1) <= 0.1
time = 12
freq = 255
ampl = -3
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time
trigger1 = fvar(1) <= 0.1
trigger1 = numexplod(10185)
id = 10185
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time
trigger1 = fvar(1) <= 0.1
trigger1 = numexplod(10186)
id = 10186
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time
trigger1 = fvar(1) <= 0.1
trigger1 = numexplod(10188)
id = 10188
[State 0, AllPalFX]
type = AllPalFX
trigger1 = time
trigger1 = fvar(1) <= 0.1
time = 16
add = 0,0,0
;mul = 256,256,256
sinadd = 200,200,200,32
;invertall = 0
;color = 256
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = time
trigger1 = fvar(1) <= 0.1
value = 0
ctrl = 1



[StateDef 10186]
type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 2

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S11,0
channel = 0
abspan = 0

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = time = 0
value = 10187

[State 0, PosSet]
type = PosSet
trigger1 = 1
x = 0
y = -120;+(120*(enemynear,fvar(1)))
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = (enemynear,fvar(1)),(enemynear,fvar(1))



[StateDef 9741]
type = S
movetype = I
physics = N
anim = 9741
ctrl = 0

[State 9741, Safety]; Just in case your opponent is very poorly coded.
type = SelfState
trigger1 = !IsHelper
value = 5050

[State 9741, UglyHack]
type = VarSet
trigger1 = !var(1)
var(2) = 2

[State 9741, PauseCheck]
type = VarSet
trigger1 = GameTime > Parent,var(57)
trigger2 = !(Parent,Alive)
trigger3 = RoundState != 2
trigger4 = Parent,var(58)
trigger5 = var(3):=0
var(2) = (var(3):=1)+(var(4):=0)

[State 9741, Facing]
type = Turn
trigger1 = var(9):=(Facing != Parent,Facing)
trigger1 = !(var(4):=0)

[State 9741, DirTurnOnAI]
type = ParentVarSet
triggerall = !(var(3) || var(9))
trigger1 = Parent,command = "holdfwd"
trigger2 = Parent,command = "holdback"
trigger3 = Parent,command = "holdup"
trigger4 = Parent,command = "holddown"
trigger5 = !(var(4):=1)
var(58) = var(4)

[State 9741, DirTurnOffAI]
type = ParentVarSet
triggerall = !var(3)
triggerall = Parent,var(58)
trigger1 = command = "holdfwd"
trigger1 = Parent,command = "holdfwd"
trigger2 = command = "holdback"
trigger2 = Parent,command = "holdback"
trigger3 = command = "holdup"
trigger3 = Parent,command = "holdup"
trigger4 = command = "holddown"
trigger4 = Parent,command = "holddown"
var(58) = var(4):=0

[State 9741, ButtonTurnOnAI]
type = ParentVarSet
triggerall = !var(2)
trigger1 = Parent,command = "a"
trigger2 = Parent,command = "b"
trigger3 = Parent,command = "c"
trigger4 = Parent,command = "x"
trigger5 = Parent,command = "y"
trigger6 = Parent,command = "z"
trigger7 = Parent,command = "start"
var(58) = 1

[State 9741, ButtonTurnOffAI]
type = ParentVarSet
triggerall = !var(2)
trigger1 = command = "a"
trigger1 = Parent,command = "a"
trigger2 = command = "b"
trigger2 = Parent,command = "b"
trigger3 = command = "c"
trigger3 = Parent,command = "c"
trigger4 = command = "x"
trigger4 = Parent,command = "x"
trigger5 = command = "y"
trigger5 = Parent,command = "y"
trigger6 = command = "z"
trigger6 = Parent,command = "z"
trigger7 = command = "start"
trigger7 = Parent,command = "start"
var(58) = -1

[State 9741, UnPauseCheck]
type = VarSet
triggerall = var(2)
trigger1 = Parent,command = "a"
trigger2 = Parent,command = "b"
trigger3 = Parent,command = "c"
trigger4 = Parent,command = "x"
trigger5 = Parent,command = "y"
trigger6 = Parent,command = "z"
trigger7 = Parent,command = "start"
trigger8 = var(2) = 2
trigger8 = var(2):=0
var(2) = 2

[State 9741, Goodbye]
type = DestroySelf
triggerall = var(1):=1
trigger1 = Parent,var(58)
trigger2 = !(Parent,Alive)
trigger3 = RoundState != 2


;------------------
; AI Activation Helper State - Compatibly Partnered Version
;
; var(1) - First tick activation prevention
; var(2) - Used for pause/superpause and custom state check, basically.
; var(3) - (Super/)Pause & custom state-triggered dir detection disabler.
; var(4) - Hitpause check.
; var(5) - No button on previous tick.
; var(6) - Any dir on this tick.
; var(7) - Any button on this tick.
; var(8) - Matching partner button detected.
; var(9) - AutoTurn bug fixer.
; var(10)- Buffered dir detection disabler.
; parent's var(57) - Parent's GameTime var, for pause and custom state check.
; parent's var(58) - Parent's primary AI variable.
;
; The code in this state is mostly simply copy/pasteable.
; But if you're using different indices for the parent's variables,
; or if you change your character's basic commands' names, you'll
; of course need to change the code in this state accordingly.

[StateDef 9742]
type = S
movetype = I
physics = N
anim = 9741
ctrl = 0

[State 9742, Safety]; Just in case your opponent is very poorly coded.
type = SelfState
trigger1 = !IsHelper
value = 5050

[State 9742, UglyHack]
type = VarSet
trigger1 = !var(1)
var(2) = var(3):=2

[State 9742, PauseCheck]
type = VarSet
trigger1 = GameTime > Parent,var(57)
trigger2 = !(Parent,Alive)
trigger3 = RoundState != 2
trigger4 = Parent,var(58)
trigger5 = var(1)
trigger5 = var(3):=0
var(2) = var(3):=1

[State 9742, Facing]
type = Turn
trigger1 = var(9):=(Facing != Parent,Facing)

[State 9742, ParentDirCheck]
type = VarSet
trigger1 = Parent,command = "holdfwd"
trigger2 = Parent,command = "holdback"
trigger3 = Parent,command = "holdup"
trigger4 = Parent,command = "holddown"
trigger5 = var(6):=0
var(6) = 1

[State 9742, BufferCheck]
type = VarSet
trigger1 = var(3) || var(4) || var(10)
var(10) = var(6)

[State 9742, ParentButtonCheck]
type = VarSet
trigger1 = Parent,command = "a"
trigger2 = Parent,command = "b"
trigger3 = Parent,command = "c"
trigger4 = Parent,command = "x"
trigger5 = Parent,command = "y"
trigger6 = Parent,command = "z"
trigger7 = Parent,command = "start"
trigger8 = var(7):=0
var(7) = 1

[State 9742, SameButtonCheck]
type = VarSet
triggerall = var(7)
triggerall = !var(2)
triggerall = NumPartner
trigger1 = Parent,command = "a"
trigger1 = Partner,command = "a"
trigger2 = Parent,command = "b"
trigger2 = Partner,command = "b"
trigger3 = Parent,command = "c"
trigger3 = Partner,command = "c"
trigger4 = Parent,command = "x"
trigger4 = Partner,command = "x"
trigger5 = Parent,command = "y"
trigger5 = Partner,command = "y"
trigger6 = Parent,command = "z"
trigger6 = Partner,command = "z"
trigger7 = Parent,command = "start"
trigger7 = Partner,command = "start"
trigger8 = var(8):=0
var(8) = 1

[State 9742, DirTurnOnAI]
type = ParentVarSet
trigger1 = var(6)
trigger1 = !(var(9) || var(10))
var(58) = 1

[State 9742, DirTurnOffAI]
type = ParentVarSet
triggerall = var(6)
triggerall = !var(3)
triggerall = Parent,var(58)
trigger1 = command = "holdfwd"
trigger1 = Parent,command = "holdfwd"
trigger2 = command = "holdback"
trigger2 = Parent,command = "holdback"
trigger3 = command = "holdup"
trigger3 = Parent,command = "holdup"
trigger4 = command = "holddown"
trigger4 = Parent,command = "holddown"
var(58) = 0

[State 9742, ButtonTurnOnAI]
type = ParentVarSet
trigger1 = var(5) && var(7)
trigger1 = !(var(2) || var(8))
var(58) = 1

[State 9742, ButtonTurnOffAI]
type = ParentVarSet
triggerall = var(7)
triggerall = !(var(2) || var(8))
trigger1 = command = "a"
trigger1 = Parent,command = "a"
trigger2 = command = "b"
trigger2 = Parent,command = "b"
trigger3 = command = "c"
trigger3 = Parent,command = "c"
trigger4 = command = "x"
trigger4 = Parent,command = "x"
trigger5 = command = "y"
trigger5 = Parent,command = "y"
trigger6 = command = "z"
trigger6 = Parent,command = "z"
trigger7 = command = "start"
trigger7 = Parent,command = "start"
var(58) = -1

[State 9742, UnPauseCheck]
type = VarSet
triggerall = var(2)
triggerall = !var(4)
trigger1 = var(7)
trigger2 = var(2) = 2
trigger2 = var(2):=0
var(2) = 2

[State 9742, Goodbye]
type = DestroySelf
trigger1 = Parent,var(58)
trigger2 = !(Parent,Alive)
trigger3 = RoundState != 2

[State 9742, HitPauseCheck]
type = VarSet
trigger1 = var(6) || var(7)
trigger2 = !(Parent,HitPauseTime)
var(4) = Parent,HitPauseTime

[State 9742, Delay]
type = VarSet
trigger1 = var(1):=1
var(5) = !var(7)


;---------------------------------------------------------------------------
; Override common states (use same number to override) :
;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
; States that are always executed (use statedef -2)
;---------------------------------------------------------------------------

[Statedef -2]

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 5950 || anim = 5955
trigger1 = animelemtime(3) = 0
trigger2 = anim = 5131
trigger2 = animelemtime(1) = 1
value = F7,0
[State 0, Explod]
type = Explod
trigger1 = anim = 5950 || anim = 5955
trigger1 = animelemtime(11) = 0
trigger2 = anim = 5131
trigger2 = animelemtime(9) = 0
anim = F61
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
;pausemovetime = 65535
scale = 1,1
sprpriority = 7
ownpal = 1
[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 5950 || anim = 5955
trigger1 = animelemtime(11) = 0
trigger2 = anim = 5131
trigger2 = animelemtime(9) = 0
value = F7,1


[State -2, Footsteps]
type = PlaySnd
trigger1 = anim = 100
trigger1 = animelem = 3 || animelem = 6 || animtime = 0
value = S40,1+random%3

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = var(19)
flag = noairguard
flag2 = nokosnd
ignorehitpause = 1

; if you're making a 10ov.st and copied the statedef -2 in it's entirety, uncomment this strcl so e.g. the hitpauses in both mugen versions would be the same
;[State ME AM USING 1.0]
;type = VarSet
;trigger1 = var(49) != 1
;var(49) = 1
;ignorehitpause = 1

[State 0, Get out of the modo card]
type = VarSet
trigger1 = var(19) = 1
trigger1 = anim = [200,9999]
trigger1 = stateno != [3070,3079]
trigger1 = anim != 9741
var(19) = 0
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
triggerall = var(30) = 0
triggerall = numenemy
trigger1 = (enemy,movecontact >= 1 || enemy,projcontact >= 1) && (!enemy,moveguarded)
var(30) = -1
ignorehitpause = 1
[State 0, PowerAdd]
type = PowerAdd
triggerall = var(30) = 0
triggerall = stateno != [3000,3999]
trigger1 = (movecontact >= 1 || projcontact >= 1) && (!moveguarded)
;trigger2 = projhittime = 0
;trigger2 = p2movetype = H
;trigger2 = movetype = A
;trigger2 = p2stateno != [120,169]
;trigger2 = projhittime = 1
value = 150
ignorehitpause = 1
[State -2 Send the message]
type = Varset
triggerall = var(30) = 0
trigger1 = (movecontact >= 1 || projcontact >= 1) && (!moveguarded)
;trigger2 = p2movetype = H
;trigger2 = movetype = A
;trigger2 = p2stateno != [120,169]
;trigger2 = projhittime = 1
var(37) = var(37) | floor(exp(2*ln(2)) + 0.5)
ignorehitpause = 1
[State 0, VarSet]
type = VarSet
triggerall = var(30) = 0
trigger1 = (movecontact >= 1 || projcontact >= 1) && (!moveguarded)
;trigger2 = p2movetype = H
;trigger2 = movetype = A
;trigger2 = p2stateno != [120,169]
;trigger2 = projhittime = 1
var(30) = 1
ignorehitpause = 1

[State -2, Movehitoner]
type = VarSet
trigger1 = numenemy
var(21) = ifelse(movehit=1&&(enemynear,movereversed!=[1,2]),var(21)+1,0)
ignorehitpause = 1
[State -2, Movehitoner]
type = VarSet
trigger1 = !numenemy
var(21) = ifelse(movehit=1,var(21)+1,0)
ignorehitpause = 1
[State -2, Moveguardoner]
type = VarSet
trigger1 = 1
var(22) = ifelse(moveguarded=1,var(22)+1,0)
ignorehitpause = 1
[State -2, FirstHit]
type = VarSet
trigger1 = 1
var(29) = 0
ignorehitpause = 1
[State -2, FirstHit]
type = VarSet
trigger1 = var(21)=1
trigger1 = numtarget
trigger1 = p2stateno != [120,169]
var(29) = (target,gethitvar(hitcount) <= 1)
ignorehitpause = 1

[State -2, Counter?]
type = VarSet
trigger1 = var(21) != 1
var(31) = (p2movetype=A)
ignorehitpause = 1
[State -2 Send the message]
type = Varset
trigger1 = !enemynear,movereversed
trigger1 = var(31) = 1
trigger1 = var(21) = 1
var(37) = var(37) | floor(exp(0*ln(2)) + 0.5)
ignorehitpause = 1
;[State 0, PlaySnd]
;type = PlaySnd
;trigger1 = !enemynear,movereversed
;trigger1 = var(31) = 1
;trigger1 = var(21) = 1
;value = S209,random%10
;channel = 0
;lowpriority = 1
;ignorehitpause = 1

[State P2Soundcode nope]
type = VarSet
trigger1 = 1
var(33) = 0
ignorehitpause = 1
[State P2Soundcode WHAM]
type = VarSet
trigger1 = (numtarget)
trigger1 = (target,stateno = 1307)
trigger1 = (target,time = 1)
trigger1 = (target,movetype = H)
var(33) = 1
ignorehitpause = 1


[State Throw Limiter]
type = VarSet
trigger1 = stateno = 40
trigger2 = statetype = A
trigger2 = movecontact
trigger3 = p2stateno = [120,169]
var(8) = 12
[State Throw Limiter count]
type = VarAdd
trigger1 = var(8) > 0
var(8) = -1
[State 0, Helper]
type = Helper
trigger1 = roundstate < 2
trigger1 = !numhelper(444)
helpertype = normal
name = "CONFIG"
ID = 444
stateno = 444
pos = 444,444
postype = p1
facing = 1
ownpal = 1
supermovetime = 65535
pausemovetime = 65535
ignorehitpause = 1

[State 0, ]
type = PlaySnd
triggerall = alive
;triggerall = random < 500
triggerall = anim != 70851
triggerall = !var(19)
trigger1 = (stateno = 5000) || (stateno = 5010) || (stateno = 5020) || (stateno = 5070)
trigger1 = time = 0
trigger2 = (stateno != 5000) && (stateno != 5010) && (stateno != 5020) && (stateno != 5070)
trigger2 = stateno != [120,160]
trigger2 = gethitvar(damage)
value = 5000,random%9
;volume = 255
channel = 0
ignorehitpause = 1

[State 0, ]
type = PlaySnd
triggerall = alive
triggerall = var(19)
trigger1 = (stateno = 5000) || (stateno = 5010) || (stateno = 5020) || (stateno = 5070)
trigger1 = time = 0
trigger2 = (stateno != 5000) && (stateno != 5010) && (stateno != 5020) && (stateno != 5070)
trigger2 = stateno != [120,160]
trigger2 = gethitvar(damage)
value = 30,10
;volume = 255
channel = 0
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
triggerall = time = 1
triggerall = random < 500
triggerall = !var(19)
trigger1 = stateno = 150
trigger2 = stateno = 152
value = S120,random%6
channel = 0
lowpriority = 1


[State 0, ]
type = PlaySnd
triggerall = !numhelper(3100)
triggerall = !var(19)
trigger1 = stateno = 5120
trigger1 = time = 1
trigger1 = random < 500
trigger1 = roundstate < 3
value = 5120,random%14
channel = 0
;volume = 255

[State 0, Helper]
type = Helper
triggerall = !ishelper
trigger1 = !numhelper(179)
helpertype = normal
name = "Misc Stuff"
ID = 179
stateno = 179
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 65535
pausemovetime = 65535
ignorehitpause = 1

[State -2, Neo-Juggle-System-Reset]
type = VarSet
triggerall = var(40)
trigger1 = !numtarget
;trigger2 = numtarget
;trigger2 = (target,statetype != A) && (target,statetype != L)
var(40) = 0
ignorehitpause = 1
[State -2, Neo-Juggle-System-Reset]
type = VarSet
triggerall = var(41)
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = (target,statetype != A) && (target,statetype != L)
var(41) = 0
ignorehitpause = 1
[State -2, Neo-Juggle-System-Reset]
type = VarSet
triggerall = var(42)
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = (target,statetype != A) && (target,statetype != L)
var(42) = 0
ignorehitpause = 1
[State Prevent the prorator from going too low. You can change the minimal proration rate if you want, just make sure the value in the trigger and actual varset match]
type = VarSet
trigger1 = fvar(13) < 0.15
fvar(13) = 0.15
ignorehitpause = 1
[State Prorator Reset]
type = VarSet
trigger1 = !numenemy
trigger2 = p2movetype != H || (!enemynear,gethitvar(hitcount))
trigger2 = !movehit || movereversed
trigger3 = p2stateno = 5120
fvar(13) = 1 + ifelse(numhelper(3050),0.25,0)
ignorehitpause = 1
[State 0, AttackMulSet]
type = AttackMulSet
trigger1 = 1
time = 2
;value = ifelse(p2movetype!=H,ifelse(var(20)=1,1.25,1),1 - ifelse(fvar(15)>.75,.75,fvar(15)))
;value = ( ifelse((stateno=[3000,3900]), 0.25+(fvar(13)*0.75) ,fvar(13))  ) * ifelse((p2statetype=A&&p2movetype!=H)||var(31),1.25,1)
value = ( ifelse((stateno=[3000,3900]), 0.25+(fvar(13)*0.75) ,fvar(13))  ) * ifelse(var(31),1.25,1)
ignorehitpause = 1



;
; Within StateDef -2, none of your own AI-related code should be placed
; above these next two controllers.

[State -2, StopAI]
type = VarSet
triggerall = var(58) > 0 && !IsHelper
trigger1 = RoundState != 2
trigger2 = !Alive
var(58) = -2
IgnoreHitPause = 1

; This controller is optional.  It allows you treat the AI flag as a boolean
; value rather than an integer value, letting you trigger your AI directives
; with "var(0)" instead of "var(58)>0", and letting you make moves usable only
; by humans by using "!var(0)" instead of "var(58)<1", thus slightly improving
; the size and efficiency of your code.
; Another benefit is that it makes it much easier for users to disable your AI,
; if they so choose.
[State -2, Scaler]
type = VarSet
trigger1 = time = 0
fvar(36) = roundno + matchno*3
IgnoreHitPause = 1
[State -2, TOO MUCH]
type = VarSet
trigger1 = fvar(36) >= 80
fvar(36) = 80
IgnoreHitPause = 1
[State -2, Simplifier]
type = VarSet
triggerall = !IsHelper
trigger1 = var(58) = 1
trigger2 = fvar(35):=0
fvar(35) = fvar(34) + (fvar(36)/10) ;  In case you are about to make a 10ov.st and copy the statedef -2, replace the value of this varset to ifelse((roundstate<=2),ailevel,0)
IgnoreHitPause = 1

[State ANTI-MINDGAME-GUARD]
type = VarAdd
triggerall = var(50) < 120
trigger1 = p2movetype = A
trigger1 = stateno = [120,169]
var(50) = 1
ignorehitpause = 1
[State ANTI-MINDGAME-GUARD]
type = VarSet
triggerall = var(50) > 0
trigger1 = stateno = [150,155]
trigger1 = time = 1
var(50) = ceil(var(50)*0.8)
ignorehitpause = 1
[State ANTI-MINDGAME-GUARD]
type = VarAdd
triggerall = var(50) > 0
triggerall = (gametime%3)=0
trigger1 = p2movetype != A
trigger2 = stateno != [120,169]
var(50) = -1
ignorehitpause = 1
[State ANTI-MINDGAME-TH]
type = VarSet
trigger1 = numenemy
trigger1 = fvar(35)
var(51) = (enemynear,HitDefAttr = SCA,AT) || (var(50) > 20) || ((abs(enemynear,animtime) <= enemynear,moveguarded )) || (numhelper(3050))
ignorehitpause = 1


;================================================================================
; ------- KOF Cornerpush System by Vans --------
;===============================================================================
[State -2, Superpause Check]
type = VarAdd
trigger1 = Var(6)
var(6) = -1

[State -2, Reset Time counter]
type = VarSet
trigger1 = movecontact = 1
var(12) = 0

[State -2, Accel]
type = VarSet
triggerall = roundstate = 2
triggerall = Var(6) <= 0
triggerall = numtarget >= 1
trigger1 = target, hitshakeover
fvar(6) = (target, gethitvar(xvel)*exp((-0.1886)*((var(12)))))
[State -2, Push]
type = PosAdd
triggerall = roundstate = 2
triggerall = !var(6)
triggerall = numtarget >= 1
triggerall = (target, BackEdgeBodyDist <= 0) || (target, FrontEdgeBodyDist <= 0)
triggerall = ProjContact = 0, < 50
triggerall = stateno != [800,899]
triggerall = stateno != [10800,10899]
triggerall = stateno != 2400
triggerall = enemynear,statetype != A
triggerall = enemynear,statetype != L
trigger1 = Statetype != A
x = ifelse(facing = -1,fvar(6),-fvar(6))

[State -2, Increase]
type = VarSet
triggerall = Var(6) <= 0
triggerall = var(12)
trigger1 = numtarget >= 1
trigger1 = target, hitshakeover
var(12) = var(12)+1

[State -2, Time counter]
type = VarSet
trigger1 = !var(12)
trigger1 = fvar(6)
var(12) = 1

[State -2, Freeze Pos During Superpause]
type = PosFreeze
trigger1 = Var(6)
value = 1

[State -2, Drop]
type = VarSet
triggerall = fvar(6)
trigger1 = !numtarget
trigger2 = projcontact = 1
trigger3 = movecontact = 1
fvar(6) = 0
ignorehitpause = 1

[State -2, Drop]
type = VarSet
triggerall = fvar(8)
trigger1 = !numtarget
trigger2 = projcontact = 1
trigger3 = numtarget >= 1 && target, gethitvar(xvel) = 0
var(17) = 0



;---------------------------------------------------------------------------
; States that are executed when in self's state file (use statedef -3)
;---------------------------------------------------------------------------

[Statedef -3]

[State 0, VarSet]
type = VarSet
trigger1 = var(19) != [0,1]
var(19) = ifelse(var(19)<0,0,1)
ignorehitpause = 1

[State 0, Helper]
type = Helper
trigger1 =numhelper(10003)=0
helpertype = normal ;player
name = "neutrality"
ID =  10003
stateno = 9999
pos = 61,-37
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
size.xscale =1*const(size.xscale)
size.yscale =1*const(size.yscale)
ignorehitpause=1


[State -2, DTC]
type = DisplayToClipboard
trigger1 = numhelper(10003)
text = "AI = %d, var(52) = %d, x = %f, y = %f, pro = %d"
params = var(58), var(52), (p2bodydist x), (pos y), (helper(10003),var(10))
IgnoreHitPause = 1
[State -2, DTC]
type = DisplayToClipboard
trigger1 = !numhelper(10003)
text = "AI = %d, var(52) = %d, x = %f, y = %f"
params = var(58), var(52), (p2bodydist x), (pos y)
IgnoreHitPause = 1
[State 0, AppendToClipboard]
type = AppendToClipboard
trigger1 = 1
text = "\nvar(40) = %d AI = %f"
params = var(40),fvar(35)
ignorehitpause = 1


[State 0, PlaySnd]
type = PlaySnd
triggerall = time = 0
trigger1 = stateno = 45
value = S0,7

; Straight outta POTS
[State -3, Prevent Undergound Juggles]
type= targetbind
triggerall = statetype != A
trigger1 =stateno!=[800,890] ; better exclude this happening during throws
trigger1 =stateno!=[1100,1150]
trigger1 =stateno!=[1250,1251]
trigger1 =stateno!=[1350,1380]
trigger1 =stateno!=[3051,3080]
trigger1= movehit=1
trigger1= numtarget=1 && numenemy
trigger1= (target,time<=1) && (target,ID=enemynear,ID); this is just to prevent Simul issues as usual
trigger1= !(target,hitshakeover) && (target, hitfall) && (target, pos y>0)
trigger1= !(target,statetype=L) && !(target,stateno=[5080,5120])
pos= ceil(p2dist x), ceil(-pos y); keeps P2 at the same horizontal distance, but resets his Y position
ignorehitpause= 1

[State -3, Variable Height]
type= playerpush
triggerall= statetype=A && movetype!=H && numenemy
triggerall= p2bodydist x = [-(enemynear,const(size.ground.back) + enemynear,const(size.ground.front)), 0]; checks if both characters are within each other's width
trigger1= p2statetype=S
trigger1= p2dist y >= (enemynear,const(size.height) - 22)
trigger2= p2statetype=C
trigger2= p2dist y >= (enemynear,const(size.height) - 48)
trigger3= p2statetype=L
trigger3= p2dist y >= 11
value= 0
ignorehitpause= 1



;This controller plays a sound everytime KFM lands from a jump, or
;from his back-dash.
[State -3, Landing Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 52 ;Jump land
trigger2 = stateno = 106 ;Run-back land
value = 40, ifelse(!var(19),0,10)

; Kamek and Luchini appear to have been the first ones to use the IsHomeTeam AI
; activation concept.
; Feel free to move this controller to your character's intro state for slightly
; better efficiency.
[State -3, SetAI]
type = VarSet
triggerall = Alive && !IsHelper
triggerall = IsHomeTeam
trigger1 = TeamSide = 2
trigger2 = MatchNo > 1
var(58) = 1

[State -3, AI Helper - Compatibly Partnered Version]
type = Helper
trigger1 = !var(58) && !IsHelper
trigger1 = !NumHelper(9742)
trigger1 = Alive && RoundState = 2
trigger1 = NumPartner
trigger1 = Partner,SelfAnimExist(9741)
HelperType = normal
name = "AI Helper (Simul Version)"
ID = 9742
pos = 9999999,99999
StateNo = 9742
KeyCtrl = 1
PauseMoveTime = 2147483647
SuperMoveTime = 2147483647

; If you want to use the Guard mode, Dummy mode, Distance, or Button jam dummy
; control options in Training mode without activating the dummy's AI while
; working on the character, then all you need to do is temporarily disable
; this controller.  Or, if you want to permanently disable this controller in
; Training mode, then you could use the Training mode detection code available
; from my site ( http://www.mugenguild.net/~winane/ ), and then just add a
; "(var(59)&63)>30" triggerall to this controller.
; Alternatively, you can just set "Dummy control" to "Manual", press a P2 button
; to kill the AI helper, and then set dummy control back to "Cooperative".  (In
; fact, setting dummy control to manual isn't even necessary, if you press the
; P2 button prior to the first time you pause.)
[State -3, AI Helper]
type = Helper
triggerall = !var(58) && !IsHelper
triggerall = !NumHelper(9741)
triggerall = Alive && RoundState = 2
trigger1 = !NumPartner
trigger2 = !(Partner,SelfAnimExist(9741))
HelperType = normal
name = "AI Helper"
ID = 9741
pos = 9999999,99999
StateNo = 9741
KeyCtrl = 1
PauseMoveTime = 2147483647
SuperMoveTime = 2147483647

[State -3, TurnBackOnAI]
type = VarSet
trigger1 = var(58) = -2 && !IsHelper
trigger1 = Alive && RoundState = 2
var(58) = 1

; This method works somewhat in Linux Mugen version 2002.04.14,
; whereas the old humanly-impossible commands method does not.
; It is very important that this controller NOT be moved to State -2.
; Note that this part won't work nearly as well if AI.Cheat is turned off
; in mugen.cfg.
[State -3, XOR]
type = VarSet
triggerall = var(58)!=1 && !IsHelper
triggerall = !var(56)
triggerall = var(57) = GameTime-1
trigger1 = command = "a" ^^ command = "a2"
trigger2 = command = "b" ^^ command = "b2"
trigger3 = command = "c" ^^ command = "c2"
trigger4 = command = "x" ^^ command = "x2"
trigger5 = command = "y" ^^ command = "y2"
trigger6 = command = "z" ^^ command = "z2"
trigger7 = command = "start" ^^ command = "start2"
trigger8 = command = "holda" ^^ command = "holda2"
trigger9 = command = "holdb" ^^ command = "holdb2"
trigger10 = command = "holdc" ^^ command = "holdc2"
trigger11 = command = "holdx" ^^ command = "holdx2"
trigger12 = command = "holdy" ^^ command = "holdy2"
trigger13 = command = "holdz" ^^ command = "holdz2"
trigger14 = command = "holdstart" ^^ command = "holdstart2"
trigger15 = command = "holdfwd" ^^ command = "holdfwd2"
trigger16 = command = "holdback" ^^ command = "holdback2"
trigger17 = command = "holdup" ^^ command = "holdup2"
trigger18 = command = "holddown" ^^ command = "holddown2"
trigger19 = command = "recovery" ^^ command = "recovery2"
;Add more as desired. (See my notes in the CMD.)
var(58) = 1

; These next two controllers must be placed here, after the above XOR
; VarSet controller and before the below GameTime VarSet controller.
[State -3, fiXOR]
type = VarAdd
trigger1 = var(56) > 0 && !IsHelper
var(56) = -1

[State -3, fuXOR]
type = VarSet
trigger1 = var(57) < GameTime-1 && !IsHelper
var(56) = 31
IgnoreHitPause = 1

; It is very important that this controller NOT be moved to State -2, as putting
; it there would defeat the entire purpose of the controller, allowing the
; helper method or the XOR method to erroneously set the AI variable.
; And within State -3, don't put any ChangeState controllers before this
; controller, lest you unnecessarily delay your character's AI activation.
[State -3, GameTimeVar]
type = VarSet
trigger1 = !IsHelper
var(57) = GameTime
IgnoreHitPause = 1

; Within StateDef -3, none of your own AI-related code should come after the code
; provided here (and putting it before the code is also generally a bad idea).
; It's better to use State -1 (or, in special circumstances, State -2) instead.


