;---------------------------------------------------------------------

;---------------------------------------------------------------------
; 基本設定
[Data]
life = 1000          ; 体力ゲージ、上限値（デフォルト：1000）
power = 5000         ; パワーゲージ、デフォルト：1000
attack = 100         ; 攻撃力（％）
defence = 100        ; 防御力（％）
fall.defence_up = 50 ; 空中コンボ修正率（％）
liedown.time = 16    ; ダウン時間
airjuggle = 999       ; 空中コンボ
sparkno = -1          ; 初期ヒットスパーク番号
guard.sparkno = -1   ; 初期ガードスパーク番号
KO.echo = 0          ; ＫＯボイスエコー（0:OFF、1:ON）
volume = 0         ; キャラボイスボリューム値
IntPersistIndex = 12 ;次のラウンドに持ち越すVarを決める
FloatPersistIndex = 15;次のラウンドに持ち越すfVarを決める

[Size]
xscale = .5          ; 水平サイズ倍率
yscale = .5          ; 垂直サイズ倍率
ground.back = 20     ; キャラ幅（地上、後ろ側）
ground.front = 20    ; キャラ幅（地上、前側）
air.back = 20        ; キャラ幅（空中、後ろ側）
air.front = 20       ; キャラ幅（空中、前側）
z.width = 10         ; キャラ幅（ｚ軸）
height = 50          ; キャラの高さ（ジャンプで飛び越せる高さ）
attack.width = 4,4   ;Default attack width: back, front
attack.dist = 360    ;Default attack distance
proj.attack.dist = 90;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too   
head.pos = 6,-115    ; 頭部座標
mid.pos = -10,-75    ; 体中心部座標
shadowoffset = 0     ; キャラの影・オフセット値

[Velocity]
walk.fwd  = 3.25       ; 前進速度
walk.back = -2.5      ; 後退速度
run.fwd  = 3.5, 0  ; 前ダッシュ速度（y<0の場合、ホップステップ）
run.back = -4.0,-3.0  ; バックステップ速度（y=0の場合、走り）
jump.neu = 0,-11.4    ; 垂直ジャンプ速度
jump.fwd = 3.0        ; 前方ジャンプ速度
jump.back = -3.0      ; 後方ジャンプ速度
runjump.fwd = 4.5,-17.0      ;前方ハイジャンプ
runjump.back = -4.5,-17.0 ;後方ハイジャンプ
airjump.fwd = 6.0    ;前方空中ダッシュ
airjump.back = -6.0  ;後方空中ダッシュ

[Movement]
airjump.num = 0        ; 空中ジャンプ回数
;airjump.height = 35   ; 空中ジャンプ最低高度
yaccel = .60           ; キャラ重力加速度
stand.friction = .85   ; 摩擦係数（立ち状態）
crouch.friction = .82  ; 摩擦係数（しゃがみ状態）

;---------------------------------------------------------------------------
;時間切れ負け
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

;鬼が負けるってか…へへ、へへへへ…
[state 190]
type = PlaySND
trigger1 = AnimElem=1
trigger1 = var(10) := floor(284*(TicksPerSecond/60))
value = 10,120
channel = 1
;4.748sec

;---------------------------------------------------------------------------
;引き分け（時間切れ）
[Statedef 175]
type = S
ctrl = 0
velset = 0,0
anim=170

;ちっ！ま、こんなもんか！
[state 190]
type = PlaySND
trigger1 = AnimElem=1 && DrawGame
trigger1 = var(10) := floor(183*(TicksPerSecond/60))
value = 10,118
channel = 1
;3.058sec

;勝利ポーズ
[statedef 180]
type = S
movetype = I
physics = S
ctrl = 0
anim = 180
velset = 0,0

[state 180]
type = ChangeState
trigger1 = var(45)=10000
value = 181

;==WIN
[state -2]
type = Helper
triggerall = time=120 && matchover
trigger1 = !numpartner
trigger2 = numpartner
trigger2 = (ID-partner,ID)>0 && (partner,authorname="rei"||partner,authorname="gal129")&&partner,fvar(39)=7
id = 8600
stateno=8600
pos = 0,0
postype = back
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

;==PERFECT
[state -2]
type = Helper
triggerall = time=150 && !matchover && WinPerfect
trigger1 = !numpartner
trigger2 = numpartner
trigger2 = (ID-partner,ID)>0 && (partner,authorname="rei"||partner,authorname="gal129")&&partner,fvar(39)=7
id = 8650
stateno=8650
pos = 0,0
postype = back
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

[state 180]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,1

[state 180]
type = PlaySND
trigger1 = AnimElem=4
trigger2 = AnimElem=6
trigger3 = AnimElem=8
trigger4 = AnimElem=10
trigger5 = AnimElem=12
trigger6 = AnimElem=14
trigger7 = AnimElem=16
trigger8 = AnimElem=18
trigger9 = AnimElem=22
value = 7300,1
channel = 10

;波の音
[state 190]
type = PlaySND
trigger1 = AnimElem=22
value = 30,2

;波
[state 180]
type = Explod
trigger1 = AnimElem=22
id = 181
anim = 181
pos = 0,0
postype = p1
sprpriority = -1
bindtime=-1
facing = 1
removeongethit=1
scale = const(size.xscale),const(size.yscale)

;波
[state 180]
type = Explod
trigger1 = AnimElem=22
id = 181
anim = 181
pos = -1,0
postype = p1
sprpriority = -1
bindtime=-1
facing = -1
removeongethit=1
scale = const(size.xscale),const(size.yscale)

;この長曾我部をナメんじゃねぇぞ！
;そんじょそこらの嵐じゃねえぜ！
[state 190,a]
type = PlaySND
trigger1 = AnimElem=1
trigger1 = var(10) := floor(348*(TicksPerSecond/60))
value = 10,101
channel = 1
;5.806sec

;がっぽりといただいてやるか！ははははあ
[state 190,b]
type = PlaySND
trigger1 = AnimElem=1 && random%2
trigger1 = var(10) := floor(250*(TicksPerSecond/60))
value = 10,102
channel = 1
;4.159sec

;西海の鬼をなめちゃいけねえ！
;竜ごとき百匹まとめて飲み込んでやるぜ！
[state 190,dra]
type = PlaySND
triggerall = AnimElem=1
trigger1 = enemynear,Name="Date Masamune" || enemynear,Name="Date_Masamune" || enemynear,Name="Masamune"
trigger1 = var(10) := floor(450*(TicksPerSecond/60))
trigger2 = enemynear,Name="Dragon"
trigger2 = var(10) := floor(450*(TicksPerSecond/60))
value = 10,103
channel = 1
;7.500sec

;燃え尽きたか？結構じゃねぇか！
[state 190,fire]
type = PlaySND
triggerall = AnimElem=1
trigger1 = enemynear,Name="Sanada Yukimura" || enemynear,Name="Sanada_Yukimura"
trigger1 = var(10) := floor(183*(TicksPerSecond/60))
trigger2 = enemynear,Name="Ken" || enemynear,Name="Ken Masters" || enemynear,Name="cvsken" || enemynear,Name="cvsken_normal"
trigger2 = var(10) := floor(183*(TicksPerSecond/60))
trigger3 = enemynear,name="Kyo"||enemynear,name="cvskyo"||enemynear,name="cvskyo_normal"||enemynear,name="cvskyo_ex"||enemynear,name="Kusanagi"||enemynear,name="Kusanagi Kyo"||enemynear,name="Saisyu"
trigger3 = var(10) := floor(183*(TicksPerSecond/60))
trigger4 = enemynear,name="Iori"||enemynear,name="cvsiori"||enemynear,name="cvsiori_normal"||enemynear,name="cvsiori_ex"||enemynear,name="Yagami Iori"||enemynear,name="nameless"||enemynear,name="K'"
trigger4 = var(10) := floor(183*(TicksPerSecond/60))
trigger5 = enemynear,name="Kazuki"||enemynear,name="Enja"||enemynear,name="Kagami"||enemynear,name="Kagami Shinnosuke"||enemynear,name="Lee Rekka"
trigger5 = var(10) := floor(183*(TicksPerSecond/60))
trigger6 = enemynear,name="Sol"||enemynear,name="Sol Budgy"||enemynear,name="Ragna"
trigger6 = var(10) := floor(183*(TicksPerSecond/60))
trigger7 = enemynear,Name="Viper"
trigger7 = var(10) := floor(183*(TicksPerSecond/60))
trigger8 = enemynear,Name="Avdol"||enemynear,Name="Pyron"
trigger8 = var(10) := floor(183*(TicksPerSecond/60))
value = 10,104
channel = 1
;3.050sec

;大将ってのはいつもシマってなきゃな！
[state 190,a]
type = PlaySND
triggerall = AnimElem=1
trigger1 = enemynear,Name="Maeda Keiji" || enemynear,Name="Maeda_Keiji" || enemynear,Name="Keiji"
trigger1 = var(10) := floor(169*(TicksPerSecond/60))
value = 10,105
channel = 1
;2.825sec

;野望ブチ上げンなら、てめえの器を考えな！
[state 190]
type = PlaySND
triggerall = AnimElem=1
trigger1 = enemynear,Name="Toyotomi Hideyoshi" || enemynear,Name="Toyotomi_Hideyoshi" || enemynear,Name="Hideyoshi"
trigger2 = enemynear,Name="Raoh" || enemynear,Name="DIO"
trigger2 = var(10) := floor(247*(TicksPerSecond/60))
value = 10,107
channel = 1
;4.117sec

;あんたにゃここより
;地獄の針山の大将が似合いだぜ！
[state 190]
type = PlaySND
triggerall = AnimElem=1
trigger1 = enemynear,Name="Oda Nobunaga" || enemynear,Name="Oda_Nobunaga" || enemynear,Name="Nobunaga"
trigger1 = var(10) := floor(277*(TicksPerSecond/60))
trigger2 = enemynear,Name="cvsvega"
trigger2 = var(10) := floor(277*(TicksPerSecond/60))
value = 10,108
channel = 1
;4.617sec

;俺の生き方、決めるのは俺だ！
;神も仏も節介も要らねぇ！
[state 190]
type = PlaySND
triggerall = AnimElem=1
trigger1 = enemynear,Name="Uesugi Kenshin" || enemynear,Name="Uesugi_Kenshin"
trigger1 = var(10) := floor(386*(TicksPerSecond/60))
trigger2 = enemynear,Name="Goenitz" || enemynear,Name="Goenitz_UM" || enemynear,Name="Dhalsim" || enemynear,Name="cvsdhalsim"
trigger2 = var(10) := floor(386*(TicksPerSecond/60))
value = 10,109
channel = 1
;6.428sec

;後味の悪い勝ちだぜ…
[state 190]
type = PlaySND
triggerall = AnimElem=1
trigger1 = enemynear,Name="Oichi"
trigger1 = var(10) := floor(308*(TicksPerSecond/60))
value = 10,110
channel = 1
;5.136sec

;やっぱ俺って最強だぜ！
[state 190]
type = PlaySND
triggerall = AnimElem=1
trigger1 = enemynear,Name="Honda Tadakatsu" || enemynear,Name="Honda_Tadakatsu" || enemynear,Name="Tadakatsu"
trigger1 = var(10) := floor(137*(TicksPerSecond/60))
trigger2 = enemynear,Name="Dan" || enemynear,Name="Dan Hibiki" || enemynear,Name="Hibiki Dan" || enemynear,Name="cvsdan" ||enemynear,Name="Cirno"
trigger2 = var(10) := floor(137*(TicksPerSecond/60))
value = 10,111
channel = 1
;2.277sec

;己こそが一番強え…
;そう思わねえ腰ぬけに、勝利はねぇよ！
[state 190]
type = PlaySND
triggerall = AnimElem=1
trigger1 = enemynear,Name="Katakura Kojuro" || enemynear,Name="Katakura_Kojuro" || enemynear,Name="Kojuro"
trigger1 = var(10) := floor(449*(TicksPerSecond/60))
trigger2 = enemynear,Name="Hol Horse" || enemynear,Name="Hol Horse & Boingo" || enemynear,Name="Vanilla Ice" || enemynear,Name="vanillaice" || enemynear,Name="Iced"
trigger2 = var(10) := floor(449*(TicksPerSecond/60))
value = 10,112
channel = 1
;7.476sec

;裏でナニやってようが、
;最後は鬼の圧勝よ！
[state 190]
type = PlaySND
triggerall = AnimElem=1
trigger1 = enemynear,Name="Takenaka Hambe" || enemynear,Name="Takenaka_Hambe" || enemynear,Name="Hambe"
trigger1 = var(10) := floor(264*(TicksPerSecond/60))
trigger2 = enemynear,Name="JUDA" || enemynear,Name="JUDA-(NERICHA)"
trigger2 = var(10) := floor(264*(TicksPerSecond/60))
value = 10,113
channel = 1
;4.397sec

;くだらえ理屈で兵を見捨てやがって！
;てめぇにアタマ張る資格はねぇ！
[state 190]
type = PlaySND
triggerall = AnimElem=1
trigger1 = enemynear,Name="Mouri Motonari" || enemynear,Name="Mouri_Motonari" || enemynear,Name="Motonari"
trigger1 = var(10) := floor(388*(TicksPerSecond/60))
value = 10,106
channel = 1
;6.470sec

;こういう命のやり取りも悪くねえな！
[state 190]
type = PlaySND
trigger1 = AnimElem=1 && MatchOver && random%2
trigger1 = var(10) := floor(185*(TicksPerSecond/60))
value = 10,115
channel = 1
;3.082sec

;軽すぎてあくびが出るぜ
[state 190]
type = PlaySND
trigger1 = AnimElem=1 && Life>floor(const(data.life)*.6) && random%3<2
trigger1 = var(10) := floor(126*(TicksPerSecond/60))
value = 10,114
channel = 1
;2.100sec

;無事に渡り付けよ！あの世への旅は長いぜ！
[state 190]
type = PlaySND
trigger1 = AnimElem=1 && numhelper(8800)
trigger1 = var(10) := floor(240*(TicksPerSecond/60))
value = 10,116
channel = 1
;4.00sec

;煮え切らねえが、ま、勝ちゃいいか...
[state 190]
type = PlaySND
trigger1 = AnimElem=1 && WinTime && random%2
trigger1 = var(10) := floor(212*(TicksPerSecond/60))
value = 10,119
channel = 1
;3.533sec

;なんだ、簡単に獲っちまったな！
;ま、鬼にゃあ朝飯前ってこった！
[state 190,a]
type = PlaySND
trigger1 = AnimElem=1 && !numenemy
value = 10,214
channel = 1
;5.806sec

[state 180]
type = AssertSpecial
trigger1 = ifelse(matchover,time<560,ifelse(!numenemy,1,time<360))
flag = roundnotover

;勝利ポーズ（千日航路専用）
[statedef 181]
type = S
movetype = I
physics = S
anim = 182
velset = 0,0
ctrl = 1

[state 181]
type = CtrlSet
trigger1 = roundstate=4
value = 0

;==WIN
[state -2]
type = Helper
triggerall = var(10)=360 && matchover
trigger1 = !numpartner
trigger2 = numpartner
trigger2 = (ID-partner,ID)>0 && (partner,authorname="rei"||partner,authorname="gal129")&&partner,fvar(39)=7
id = 8600
stateno=8600
pos = 0,0
postype = back
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

;==PERFECT
[state -2]
type = Helper
triggerall = var(10)=200 && !matchover && WinPerfect
trigger1 = !numpartner
trigger2 = numpartner
trigger2 = (ID-partner,ID)>0 && (partner,authorname="rei"||partner,authorname="gal129")&&partner,fvar(39)=7
id = 8650
stateno=8650
pos = 0,0
postype = back
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

[state 180]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,1

;へっ、決まりすぎだな！
[state 190]
type = PlaySND
trigger1 = prevstateno!=180&&roundstate=4
trigger1 = var(10) := floor((131+180+ifelse(matchover,160,0))*(TicksPerSecond/60))
value = 10,117
channel = 1
persistent = 0
;2.173sec

[state 50]
type = PlaySND
trigger1 = AnimElem=2,=0
value = 41,0
volume = 128

[state 180]
type = AssertSpecial
trigger1 = roundstate=4&&var(10);var(10)||time<120
flag = roundnotover

;イントロ
[statedef 190]
type = S
ctrl = 0
velset = 0,0
anim = 190

;援軍ゲージ、一撃ゲージMAXに
[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(40) = 1

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(43) = 100000

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(42) = 200

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(41) = 200

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(40) = 1

[state 5900]
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
fvar(15) = 1.00

[state 5900]
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(37) = 9999

[state 190]
type = ChangeAnim
trigger1 = Anim=190&&((enemynear,stateno!=[190,199])||teamside=1||Time>=600)&&time>=60
value = 191

[state 190]
type = varset
trigger1 = anim=190
var(7) = 0

[state 190]
type = varadd
trigger1 = anim=191||var(7)
var(7) = 1

[state 190]
type = AssertSpecial
trigger1 = 1
flag = Intro

;海賊の流儀ってやつ、教えてやるぜ！
[state 190]
type = PlaySND
trigger1 = Anim=191 && AnimElem=1
trigger1 = var(10) := floor(181*(TicksPerSecond/60))
value = 10,89
channel = 1
;3.023sec

;竜も飲み込む荒波、見せてやるよ！
[state 190]
type = PlaySND
triggerall = Anim=191 && AnimElem=1
trigger1 = P2Name="Date Masamune" || P4Name="Date Masamune" || P2Name="Date_Masamune" || P4Name="Date_Masamune" || P2Name="Masamune" || P4Name="Masamune"
trigger1 = var(10) := floor(234*(TicksPerSecond/60))
trigger2 = P2Name="Dragon" || P4Name="Dragon"
trigger2 = var(10) := floor(234*(TicksPerSecond/60))
value = 10,90
channel = 1
;3.898sec

;無駄に暑っ苦しいのも歓迎してやるぜ！
[state 190]
type = PlaySND
triggerall = Anim=191 && AnimElem=1
trigger1 = P2Name="Sanada Yukimura" || P4Name="Sanada Yukimura" || P2Name="Sanada_Yukimura" || P4Name="Sanada_Yukimura"
trigger1 = var(10) := floor(173*(TicksPerSecond/60))
trigger2 = P2Name="Enja" || P4Name="Enja"
trigger2 = var(10) := floor(173*(TicksPerSecond/60))
value = 10,91
channel = 1
;2.898sec

;ついてねぇなぁ、兄ちゃん。
;今日はあんたの厄日だぜ。
[state 190]
type = PlaySND
triggerall = Anim=191 && AnimElem=1
trigger1 = P2Name="Maeda Keiji" || P4Name="Maeda Keiji" || P2Name="Maeda_Keiji" || P4Name="Maeda_Keiji" || P2Name="Keiji" || P4Name="Keiji"
trigger1 = var(10) := floor(279*(TicksPerSecond/60))
value = 10,92
channel = 1
;4.648sec

;オイ猿！人間様の言葉は覚えたかい？
[state 190]
type = PlaySND
triggerall = Anim=191 && AnimElem=1
trigger1 = P2Name="Toyotomi Hideyoshi" || P4Name="Toyotomi Hideyoshi" || P2Name="Toyotomi_Hideyoshi" || P4Name="Toyotomi_Hideyoshi" || P2Name="Hideyoshi" || P4Name="Hideyoshi"
trigger1 = var(10) := floor(288*(TicksPerSecond/60))
value = 10,94
channel = 1
;4.795sec

;魔王？んなもん居るわけねえだろう！
[state 190]
type = PlaySND
triggerall = Anim=191 && AnimElem=1
trigger1 = P2Name="Oda Nobunaga" || P4Name="Oda Nobunaga" || P2Name="Oda_Nobunaga" || P4Name="Oda_Nobunaga" || P2Name="Nobunaga" || P4Name="Nobunaga"
trigger1 = var(10) := floor(211*(TicksPerSecond/60))
value = 10,95
channel = 1
;3.523sec

;軍神？どれ程のもんかこの鬼が試してやるぜ！
[state 190]
type = PlaySND
triggerall = Anim=191 && AnimElem=1
trigger1 = P2Name="Uesugi Kenshin" || P4Name="Uesugi Kenshin" || P2Name="Uesugi_Kenshin" || P4Name="Uesugi_Kenshin"
trigger1 = var(10) := floor(326*(TicksPerSecond/60))
value = 10,96
channel = 1
;5.434sec

;なんて面だよ…こっちまで滅入るぜ…
[state 190]
type = PlaySND
triggerall = Anim=191 && AnimElem=1
trigger1 = P2Name="Oichi" || P4Name="Oichi"
trigger1 = var(10) := floor(219*(TicksPerSecond/60))
value = 10,97
channel = 1
;3.655sec

;さあて…噂の最強、見せてみなよ！
[state 190]
type = PlaySND
triggerall = Anim=191 && AnimElem=1
trigger1 = P2Name="Honda Tadakatsu" || P4Name="Honda Tadakatsu" || P2Name="Honda_Tadakatsu" || P4Name="Honda_Tadakatsu" || P2Name="Tadakatsu" || P4Name="Tadakatsu"
trigger1 = var(10) := floor(342*(TicksPerSecond/60))
value = 10,98
channel = 1
;5.702sec

;竜の右目かぁ…本番前の小手調べと行くか！
[state 190]
type = PlaySND
triggerall = Anim=191 && AnimElem=1
trigger1 = P2Name="Katakura Kojuro" || P4Name="Katakura Kojuro" || P2Name="Katakura_Kojuro" || P4Name="Katakura_Kojuro" || P2Name="Kojuro" || P4Name="Kojuro"
trigger1 = var(10) := floor(329*(TicksPerSecond/60))
value = 10,99
channel = 1
;5.476sec

;ま、やってみろや、半兵衛。
;俺相手にいきがれんならよ！
[state 190,ham]
type = PlaySND
triggerall = Anim=191 && AnimElem=1
trigger1 = P2Name="Takenaka Hambe" || P4Name="Takenaka Hambe" || P2Name="Takenaka_Hambe" || P4Name="Takenaka_Hambe" || P2Name="Hambe" || P4Name="Hambe"
trigger1 = var(10) := floor(377*(TicksPerSecond/60))
trigger2 = P2Name="Takenaka Hanbe" || P4Name="Takenaka Hanbe" || P2Name="Takenaka_Hanbe" || P4Name="Takenaka_Hanbe" || P2Name="Hanbe" || P4Name="Hanbe"
trigger2 = var(10) := floor(377*(TicksPerSecond/60))
trigger3 = P2Name="Takenaka Hanbee" || P4Name="Takenaka Hanbee" || P2Name="Takenaka_Hanbee" || P4Name="Takenaka_Hanbee" || P2Name="Hanbee" || P4Name="Hanbee"
trigger3 = var(10) := floor(377*(TicksPerSecond/60))
trigger4 = P2Name="Takenaka Hambee" || P4Name="Takenaka Hambee" || P2Name="Takenaka_Hambee" || P4Name="Takenaka_Hambee" || P2Name="Hambee" || P4Name="Hambee"
trigger4 = var(10) := floor(377*(TicksPerSecond/60))
value = 10,100
channel = 1
;6.287sec

;毛利、あんたとはそりが合わねぇぜ。
[state 190]
type = PlaySND
triggerall = Anim=191 && AnimElem=1
trigger1 = P2Name="Mouri Motonari" || P4Name="Mouri Motonari" || P2Name="Mouri_Motonari" || P4Name="Mouri_Motonari" || P2Name="Motonari" || P4Name="Motonari" || P2Name="Mouri" || P4Name="Mouri"
trigger1 = var(10) := floor(208*(TicksPerSecond/60))
value = 10,93
channel = 1
;3.472sec

[state 190]
type = PlaySND
trigger1 = Anim=191 && AnimElem=11
value = 7300,2
channel = 10

[State 5900, 1]
type = null;VarAdd
trigger1 = Anim=191 && AnimElem=1
var(10) = 30
persitent = 0

[state 190]
type = ChangeAnim
trigger1 = Anim!=0 && AnimTime=0
value = 0

[state 190]
type = ChangeState
trigger1 = Anim=0 && !var(10)
value = 0

;挑発
[statedef 195]
type = S
movetype=I
physics = S
ctrl = 0
velset = 0,0
anim = 195
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[200,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 195]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&AnimElem=20
value = 10,56
channel = 1

[state 195]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;立ち弱
[statedef 200]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 200

[state 200]
type = ChangeAnim
trigger1 = Time=2&&AnimElemNo(0)=3
value = 200
elem = 4

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=8

;攻撃状態維持用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=1&&random%2=0
value = 10,1+(random<=500)
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=2
value = 7300,0
channel = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 11

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;千日航路
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;四縛
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Shibaku",3100,var(53))

;五羅：一撃
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Gora",3000,var(53))

;カラクリ兵器自爆要請
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59) && numhelper(20000) && var(12)>0
trigger1 = (var(40)=1||(var(40)=[2,9])||helper(20000),stateno%100=0)
var(53) = ifelse(command="Jibaku",1600,var(53))

;弩九
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Dokyu2",1150+ifelse(command="y",1,0),ifelse(command="Dokyu",1100+ifelse(command="y",1,0),var(53)))

;一触
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Issyoku",1000,var(53))
;~~~~
;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = movecontact
var(53) = ifelse(var(0)<10 && command="longjump",50+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),ifelse(command="holdup",40+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),0))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.2
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=3
damage = floor(ifelse(28*fvar(0)<1,1+(var(2)%5=4),28*fvar(0))*1.22)
ground.slidetime = 12+(P2statetype=C)
ground.hittime = 12+(P2statetype=C)
guard.slidetime = 10
guard.hittime = 10
pausetime = 1,11+var(49)*6
ground.velocity = -12.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0011,-8.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-9.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),24+11,12-ifelse(floor(var(14)/90)>6,6,floor(var(14)/90))+11)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(26*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(26*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(26*fvar(0)/fvar(2)*.8)*1.3,ceil(26*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=4
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(40*fvar(14)<1,1+(var(2)%5=1),40*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=3
var(16) = 0
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=3,>=0&&AnimElem=4,<0
var(17) = floor(ifelse(P2dist X>76*const(size.xscale),76*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,50]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=3,>=0&&AnimElem=4,<0
var(18) = floor(-140*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-12.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,10,12+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (11-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;立ち中
[statedef 210]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 210

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=4&&random%3!=0
value = 10,3+(random<=500)
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=4
value = 210,0
channel = 11

[state 190]
type = PlaySND
trigger1 = AnimElem=4
value = 7300,1
channel = 10

[state 900]
type = StatetypeSet
trigger1 = AnimElem=4
physics = N

[state 900]
type = PosAdd
trigger1 = AnimElem=9
x = floor(14*const(size.xscale))

[state 900]
type = PosAdd
trigger1 = AnimElem=12
x = -floor(14*const(size.xscale))

[state 900]
type = PosAdd
trigger1 = AnimTime=0
x = -floor(6*const(size.xscale))

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = (movecontact||var(19))&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && !var(19) && !IsHelper
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;千日航路
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;四縛
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Shibaku",3100,var(53))

;五羅：一撃
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Gora",3000,var(53))

;カラクリ兵器自爆要請
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59) && numhelper(20000) && var(12)>0
trigger1 = (var(40)=1||(var(40)=[2,9])||helper(20000),stateno%100=0)
var(53) = ifelse(command="Jibaku",1600,var(53))

;弩九
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Dokyu2",1150+ifelse(command="y",1,0),ifelse(command="Dokyu",1100+ifelse(command="y",1,0),var(53)))

;一触
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Issyoku",1000,var(53))
;~~~~

;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = movecontact
var(53) = ifelse(var(0)<10 && command="longjump",50+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),ifelse(command="holdup",40+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),0))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = ((command="y"&&(command="holddown"||(command="holdfwd"&&command!="holddown")))||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=5
damage = ifelse(floor(40*fvar(0))<1,1+(var(2)%5=4),ceil(floor(40*fvar(0))*1.22))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -13.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-13.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-5.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-160*const(size.xscale))
animtype = Medium
ground.type = Low
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(55*fvar(14)<1,1+(var(2)%5=1),55*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(ifelse(P2dist X>154*const(size.xscale),154*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-130*const(size.yscale))

;現在の速度取得
[state 900]
type = VarSet
trigger1 = AnimElem=4,=1
fvar(8) = 8.0

[state 900]
type = VarSet
trigger1 = AnimElem=4,>1
fvar(8) = fvar(8)*.7

[state 900]
type = VarSet
trigger1 = !time
trigger2 = AnimElem=7
fvar(8) = 0

[state -2]
type = velset
trigger1 = animelem=4,>0 && !fvar(9) && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
x = fvar(8)

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-13.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;立ち強
[statedef 220]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0,0)+(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5)*fvar(5),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=310||prevstateno=410))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=310||prevstateno=410))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=310||prevstateno=410))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 220

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=23

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&& AnimElem=4&&random%2=0
value = 10,5+(random<=500)
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=4
value = 7300,3
channel = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;千日航路
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;四縛
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Shibaku",3100,var(53))

;五羅：一撃
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Gora",3000,var(53))

;カラクリ兵器自爆要請
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59) && numhelper(20000) && var(12)>0
trigger1 = (var(40)=1||(var(40)=[2,9])||helper(20000),stateno%100=0)
var(53) = ifelse(command="Jibaku",1600,var(53))

;弩九
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Dokyu2",1150+ifelse(command="y",1,0),ifelse(command="Dokyu",1100+ifelse(command="y",1,0),var(53)))

;一触
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Issyoku",1000,var(53))
;~~~~
;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = movecontact
var(53) = ifelse(var(0)<10 && command="longjump",50+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),ifelse(command="holdup",40+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0)),0))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = (command="y"&&command="holdfwd"&&command!="holddown")||(command="z"&&command="holddown")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=5
damage = floor(ifelse(55*fvar(0)<1,1+(var(2)%5=4),55*fvar(0))*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -18.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-18.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-12.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 1
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(55*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(55*fvar(0)/fvar(2)*.8)*1.3,ceil(55*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(82*fvar(14)<1,1+(var(2)%5=1),82*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 3;縦
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=8,<0
var(17) = floor(ifelse(P2dist X>258*const(size.xscale),258*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-180*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

[state 200]
type = statetypeset
trigger1 = AnimElem=4
physiscs = N

[state 200]
type = statetypeset
trigger1 = AnimElem=7
physiscs = S

;現在の速度取得
[state 900]
type = VarSet
trigger1 = AnimElem=4,=1
fvar(8) = 4.0

[state 900]
type = VarSet
trigger1 = AnimElem=4,>1
fvar(8) = fvar(8)*.8

[state 900]
type = VarSet
trigger1 = !time
trigger2 = AnimElem=7
fvar(8) = 0

[state -2]
type = velset
trigger1 = animelem=4,>=1 && !fvar(9) && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||(P2stateno=927&&P2movetype=H)))
x = fvar(8)

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-18.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-18.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;6中(直蹴り)
[statedef 310]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=410))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=410))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=410))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time
trigger2 = anim!=315&&animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 310

[state 200]
type = ChangeAnim
trigger1 = Time=1&&AnimElemNo(0)=9
value = 310
elem = 10

[state 200]
type = VarSet
trigger1 = Time=13&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=13&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=13&&var(34)
var(35)=11

[state 200]
type = Helper
trigger1 = Time=13&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=13&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=13&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)&&root,AnimElemTime(8)>=0

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&(prevstateno!=[130,154])
var(7) = 0

[state 220]
type = varadd
trigger1 = var(7)<30&&((command="hold_y"&&!var(59))||(random<0&&var(59)))
trigger1 = (anim=315&&var(7))||(Anim=310 &&animelemtime(5)=0&&!var(7))
var(7) = 1

[state 220]
type = ChangeAnim
trigger1 = anim=310&&animelemtime(5)=0&&var(7)&&var(7)<=30
trigger1 = ((command="hold_y"&&!var(59))||(random<0&&var(59)))
value = 315
persistent=0

[state 220]
type = ChangeAnim
trigger1 = Anim=315 && (command!="hold_y"||var(7)>=30)&&var(7)
value = 310+(var(7)>=21)
elem = 5
persistent=0

[state 220]
type = playsnd
triggerall = var(7)=1
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&anim=315
value = 10,11
channel = 1
persistent=0

;溜めエフェクト
[state -2]
type = Helper
trigger1 = var(7)%6=1 &&anim=315
id = 7770
stateno=7770
pos = 0,0
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

;~~~~~

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=7&&random%2=0
value = 10,5+(random%3=0)
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=7
value = 7300,1
channel = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;千日航路
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;四縛
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Shibaku",3100,var(53))

;五羅：一撃
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Gora",3000,var(53))

;カラクリ兵器自爆要請
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59) && numhelper(20000) && var(12)>0
trigger1 = (var(40)=1||(var(40)=[2,9])||helper(20000),stateno%100=0)
var(53) = ifelse(command="Jibaku",1600,var(53))

;弩九
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Dokyu2",1150+ifelse(command="y",1,0),ifelse(command="Dokyu",1100+ifelse(command="y",1,0),var(53)))

;一触
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Issyoku",1000,var(53))
;~~~~

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = command="z"||(var(7)>=21&&command="y"&&(command="holdfwd"||command="holddown"))
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=8
damage = floor(ifelse(60*fvar(0)<1,1+(var(2)%5=4),60*fvar(0))*1.22)
ground.slidetime = 17+(P2statetype=C||P2statetype!=A)
ground.hittime = 17+(P2statetype=C||P2statetype!=A)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -16.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-18.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(55*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(55*fvar(0)/fvar(2)*.8)*1.3,ceil(55*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-240*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = HA

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = Anim=311&&AnimElem=8
damage = floor(ifelse(60*fvar(0)<1,1+(var(2)%5=4),60*fvar(0))*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = ifelse(var(1)%16<8,-10.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-18.0*const(size.xscale)),-11.0*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-18.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(1)%16<8,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-12.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),52+13,35-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(55*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(55*fvar(0)/fvar(2)*.8)*1.3,ceil(55*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-240*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = H

[state 200]
type = AttackDist
trigger1 = AnimElem=9
value = 0

;==壁バウンド
[state 920]
type = varAdd
trigger1 = Anim=311&&(movehit=[1,5])&&numtarget&&var(1)%16<8
trigger1 = target,time=0
var(1) = 4+8
ignorehitpause=1
persistent=0

[state 920]
type = targetstate
trigger1 = Anim=311&&(movehit=[1,5])&&numtarget&&var(1)%8>=4
trigger1 = target,time=0
value = 938
ignorehitpause=1
persistent=0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(60*fvar(14)<1,1+(var(2)%5=1),60*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=8
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(17) = floor(ifelse(P2dist X>176*const(size.xscale),176*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(18) = floor(-120*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(290*const(size.xscale)),60,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.5)))

[state 200]
type = statetypeset
trigger1 = AnimElem=7
physiscs = N

[state 200]
type = statetypeset
trigger1 = AnimElem=11
physiscs = S

;現在の速度取得
[state 900]
type = VarSet
trigger1 = AnimElem=7,=1
fvar(8) = ifelse(anim=311,15.0,8.0)

[state 900]
type = VarSet
trigger1 = AnimElem=7,>1&&!(var(52)>0&&movecontact)
fvar(8) = fvar(8)*.8

[state 900]
type = VarSet
trigger1 = !time
trigger2 = AnimElem=12
fvar(8) = 0

[state -2]
type = velset
trigger1 = animelem=7,>=1 && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||(P2stateno=927&&P2movetype=H)))
x = fvar(8)+fvar(9)

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-18.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-18.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 310]
type = targetstate
trigger1 = Anim=310&&movehit=1&&numtarget
trigger1 = target,statetype=S&&target,time=0
value = 15010
ignorehitpause=1
persistent=0

[state 200]
type = ChangeState
trigger1 = Anim!=315 && AnimTime=0
value = 0
ctrl = 1

;強制しゃがみ食らい
[statedef 15010]
type = C
movetype=H
physics = C

[state 15010]
type = SelfState
trigger1 = !time
value = 5010

;しゃがみ弱
[statedef 400]
type = C
movetype=A
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&prevstateno=200)
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&prevstateno=200)
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&prevstateno=200)
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 400

[state 210]
type = ChangeAnim
trigger1 = time=0&&AnimElemNo(0)=6&&!IsHelper
value = anim
elem = 7

[state 210]
type = ChangeAnim
trigger1 = time=2&&AnimElemNo(0)=7&&!IsHelper
value = anim
elem = 8

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = PosAdd
trigger1 = Time=0&&var(34)
x = -1

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=7

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper&&!time
value = 20000+stateno

[state 200]
type = ChangeAnim
trigger1 = IsHelper
trigger1 = (root,stateno=150||root,stateno=152||root,stateno=154)
value = 20000+stateno
elem = Root,AnimElemNo(0)-(root,time=0)

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = ifelse(root,animelemtime(7)>=0,0,1),0

[state 200]
type = parentvaradd
trigger1 = IsHelper&&movecontact&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

[state 200]
type = parentvaradd
trigger1 = IsHelper&&movecontact&&numtarget
trigger1 = target,statetype=A
var(3) = 1
persistent=0
ignorehitpause=1

[state 200]
type = varset
trigger1 = IsHelper
var(1) = root,var(1)

[state 200]
type = varset
trigger1 = IsHelper
var(2) = root,var(2)

[state 200]
type = varset
trigger1 = IsHelper
var(3) = root,var(3)

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = (!root,var(34)&&(root,animelemtime(7)>=1||root,movecontact))||(root,stateno!=400&&root,anim!=400)
ignorehitpause=1

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=3&&random%2=0
value = 10,1+(random<=500)
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=3
value = 7300,0
channel = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&!var(19)
var(52) = 100

[state 250]
type = varadd
trigger1 = (movecontact||var(19))&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 11

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)&&!var(19)&& !IsHelper
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;千日航路
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;四縛
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Shibaku",3100,var(53))

;五羅：一撃
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Gora",3000,var(53))

;カラクリ兵器自爆要請
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59) && numhelper(20000) && var(12)>0
trigger1 = (var(40)=1||(var(40)=[2,9])||helper(20000),stateno%100=0)
var(53) = ifelse(command="Jibaku",1600,var(53))

;弩九
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Dokyu2",1150+ifelse(command="y",1,0),ifelse(command="Dokyu",1100+ifelse(command="y",1,0),var(53)))

;一触
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Issyoku",1000,var(53))
;~~~~
;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = (command="y"||command="z")
trigger1 = !(var(15)<=0&&command="x")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.2
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=4
damage = floor(ifelse(37*fvar(0)<1,1+(var(2)%5=4),37*fvar(0))*1.22)
ground.slidetime = 12+(P2statetype=C)
ground.hittime = 12+(P2statetype=C)
guard.slidetime = 10
guard.hittime = 10
pausetime = 1,11+var(49)*6
ground.velocity = -7.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-7.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0011,-9.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-9.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),24+11,12-ifelse(floor(var(14)/90)>6,6,floor(var(14)/90))+11)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(16*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(16*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(16*fvar(0)/fvar(2)*.8)*1.3,ceil(16*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = L
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=5
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(37*fvar(14)<1,1+(var(2)%5=1),37*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=4
var(16) = 0
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
var(17) = floor(ifelse(P2dist X>122*const(size.xscale),122*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
var(18) = floor(-20*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-7.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-7.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,10,12+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (11-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 11
ctrl = 1


;しゃがみ中
[statedef 410]
type = C
movetype=A
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 410

[state 440]
type = NotHitBy
trigger1 = animelemtime(5)<0
value = ,AT

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=4&&random%3!=0
value = 10,3+(random<=500)
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=4
value = 7300,2
channel = 10

;転倒食らい
[state 190]
type = Targetstate
trigger1 = numtarget && movehit=1 && var(1)%2<1 && var(1)%8<4 && var(6)%10<1
trigger1 = target,time=0
value = 15070

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;千日航路
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;四縛
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Shibaku",3100,var(53))

;五羅：一撃
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Gora",3000,var(53))

;カラクリ兵器自爆要請
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59) && numhelper(20000) && var(12)>0
trigger1 = (var(40)=1||(var(40)=[2,9])||helper(20000),stateno%100=0)
var(53) = ifelse(command="Jibaku",1600,var(53))

;弩九
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Dokyu2",1150+ifelse(command="y",1,0),ifelse(command="Dokyu",1100+ifelse(command="y",1,0),var(53)))

;一触
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Issyoku",1000,var(53))
;~~~~

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = ((command="y"&&command="holdfwd"&&command!="holddown")||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=5
damage = ifelse(floor(30*fvar(0))<1,1+(var(2)%5=4),ceil(floor(30*fvar(0))*1.22))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = ifelse(var(49),0,-3.0*const(size.xscale)),ifelse(var(49),-18.0,-13.0)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-9.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(49),0,-3.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(ifelse(var(49),-18.0,-13.0)*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(49),0,ifelse(var(6)%10>0||var(28)>0,0,1))
fall.recovertime = ifelse(var(49)&&!var(2),47+13,30-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(26*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(26*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(26*fvar(0)/fvar(2)*.8)*1.3,ceil(26*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Medium
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = L
persistent=0

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = var(1)%2>=1||var(1)%8>=4
trigger1 = AnimElem=5
damage = ifelse(floor(30*fvar(0))<1,1+(var(2)%5=4),ceil(floor(30*fvar(0))*1.22))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = ifelse(var(49),0,-4.0*const(size.xscale)),(ifelse(var(49),-18.0,-13.0)-.9)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-9.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,ifelse(var(6)%10>0,var(6)%10*1.5,(ifelse(var(49),-15.0,-13.0)*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(49),0,ifelse(var(6)%10>0||var(28)>0,0,1))
fall.recovertime = ifelse(var(49)&&!var(2),47+13,30-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(26*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(26*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(26*fvar(0)/fvar(2)*.8)*1.3,ceil(26*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Medium
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = L
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(30*fvar(14)<1,1+(var(2)%5=1),30*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(ifelse(P2dist X>358*const(size.xscale),358*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-40*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-6.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-9.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 11
ctrl = 1


;しゃがみ強
[statedef 420]
type = C
movetype=A
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||prevstateno=410))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||prevstateno=410))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||prevstateno=410))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 420

[state 200]
type = VarSet
trigger1 = Time=9&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=9&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=9&&var(34)
var(35)=10;本来11F

;攻撃発生中のガードポイント
[state 200]
type = HitBy
trigger1 = var(32)&&AnimElemTime(9)>0&&AnimElemTime(9)<=1&&!movecontact
value = ,AT

[state 200]
type = Helper
trigger1 = Time=9&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=9&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=9&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=4&&random%2=0
value = 10,5+(random<=500)
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=4
value = 7300,2
channel = 10

[state 195]
type = EnvShake
trigger1 = AnimElem=6
ampl = 4
time = 8

;転倒食らい
[state 190]
type = Targetstate
trigger1 = numtarget && movehit=1 && var(1)%2<1 && var(1)%8<4 && var(6)%10<1 && animelemtime(6)>0
trigger1 = target,time=0
value = 15070

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(animelemtime(4)>=1&&AnimElemTime(5)<=0,4,ifelse(animelemtime(5)>=1&&AnimElemTime(6)<=0,4,13))

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;千日航路
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;四縛
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Shibaku",3100,var(53))

;五羅：一撃
[state 250]
type = varset
trigger1 = Power>=1000 && var(53)<3000 && time>4 && !var(59)
var(53) = ifelse(command="Gora",3000,var(53))

;カラクリ兵器自爆要請
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59) && numhelper(20000) && var(12)>0
trigger1 = (var(40)=1||(var(40)=[2,9])||helper(20000),stateno%100=0)
var(53) = ifelse(command="Jibaku",1600,var(53))

;弩九
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Dokyu2",1150+ifelse(command="y",1,0),ifelse(command="Dokyu",1100+ifelse(command="y",1,0),var(53)))

;一触
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Issyoku",1000,var(53))
;~~~~

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = ((command="y"&&command="holdfwd"&&command!="holddown")||(command="z"&&command!="holddown"))
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.1
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=4
damage = ifelse(floor(25*fvar(0))<1,1+(var(2)%5=4),ceil(floor(25*fvar(0))*1.22))
ground.slidetime = 10+(P2statetype=C)
ground.hittime = 10+(P2statetype=C)
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,4
ground.velocity = -7.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-7.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0004,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-9.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),20+4,10-ifelse(floor(var(14)/100)>5,5,floor(var(14)/100))+4)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,3)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-50*const(size.xscale))
animtype = Light
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = H
persistent=0

;Attack Lv.1
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=5
damage = ifelse(floor(25*fvar(0))<1,1+(var(2)%5=4),ceil(floor(25*fvar(0))*1.22))
ground.slidetime = 10+(P2statetype=C)
ground.hittime = 10+(P2statetype=C)
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,4
ground.velocity = -7.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-7.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0004,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-9.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),20+4,10-ifelse(floor(var(14)/100)>5,5,floor(var(14)/100))+4)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,3)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-50*const(size.xscale))
animtype = Light
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = M
persistent=0

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=6
damage = ifelse(floor(25*fvar(0))<1,1+(var(2)%5=4),ceil(floor(25*fvar(0))*1.22))
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+var(49)*6
ground.velocity = -4.0*const(size.xscale),4
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0012,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,4)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),44+12,30-ifelse(floor(var(14)/70)>10,10,floor(var(14)/70))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,4)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-50*const(size.xscale))
animtype = Light
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = M
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=8
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&hitpausetime=ifelse(animelemtime(6)>=0,13,ifelse(animelemtime(5)>=0,10,4))
fvar(15) = .00005*floor(ifelse(25*fvar(14)<1,1+(var(2)%5=1),25*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 5-(AnimElemTime(6)<0)

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
var(17) = floor(ifelse(P2dist X>160*const(size.xscale),160*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(ifelse(P2dist X>164*const(size.xscale),164*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(17) = floor(ifelse(P2dist X>226*const(size.xscale),226*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
var(18) = floor(-140*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-130*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(18) = floor(-20*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-13.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(animelemtime(5)>=1&&AnimElemTime(6)<=0,4,ifelse(animelemtime(6)>=1&&AnimElemTime(7)<=0,10,13))-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 11
ctrl = 1

;ジャンプ弱
[statedef 600]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)+fvar(8),Vel X),vel Y
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((var(1)%4>=2&&(prevstateno=[600,620]))||prevstateno=610))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((var(1)%4>=2&&(prevstateno=[600,620]))||prevstateno=610))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((var(1)%4>=2&&(prevstateno=[600,620]))||prevstateno=610))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 600

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 600]
type = VelSet
trigger1 = (prevstateno=[110,115])&&time<4
y = 0

[state 600]
type = VelAdd
trigger1 = !(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2,.45,const(movement.yaccel))*ifelse(var(5)%2>=1,1.11,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,1.0,1.0)*ifelse(fvar(10)>0&&var(1)%2>=1,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&(var(5)%8>=4||var(5)%32>=16)
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&(var(5)%8>=4||var(5)%32>=16)
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=3&&random%2=0
value = 10,1+(random<=500)
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=3
value = 7300,1
channel = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,11)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

;~~必殺技~~~
;弩九
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Dokyu2",1150+ifelse(command="y",1,0),ifelse(command="Dokyu",1100+ifelse(command="y",1,0),var(53)))

;~~~~~~~~~~~
;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,0))

;２段ジャンプ、２段ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = var(1)%4>=2
var(53) = ifelse(var(0)%ifelse(var(0)>=1000,1000,100)<10&&command="longjump",50+ifelse(command="holdfwd",1,ifelse(command="holdback",2,0)),ifelse(command="up"&&var(0)<200,40,ifelse(command="fwdup",41,ifelse(command="backup",42,var(53)))))

;碇落とし
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
var(53) = ifelse(command="y"&&command="holddown"&&command!="holdfwd"&&command!="holdback",710,var(53))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = (command="y"||command="z")
var(53) = ifelse(command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&var(1)%4>=2,720,ifelse(command="z",620,ifelse(command="y",610,ifelse(command="x"&&0,600,var(53)))))
;~~~~~~~~~~~
;Attack Lv.2
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = var(1)%4<2
trigger1 = AnimElem=4
damage = floor(ifelse(23*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=4),23*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ground.slidetime = 12+(P2statetype=C)
ground.hittime = 12+(P2statetype=C)
guard.slidetime = 10
guard.hittime = 10
pausetime = 1,11+var(49)*6
ground.velocity = -10.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-10.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0011,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = ifelse(var(1)%4>=2,1.0,.9)*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),24+11,12-ifelse(floor(var(14)/90)>6,6,floor(var(14)/90))+11)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(26*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(26*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(26*fvar(0)/fvar(2)*.8)*1.3,ceil(26*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Light
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;Attack Lv.2
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = var(1)%4>=2
trigger1 = AnimElem=4
damage = floor(ifelse(23*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=4),23*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ground.slidetime = 12+(P2statetype=C)
ground.hittime = 12+(P2statetype=C)
guard.slidetime = 10
guard.hittime = 10
pausetime = 1,9
ground.velocity = -10.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-10.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -10.0*const(size.xscale)-.0009,-(8.0-(var(4)-ifelse(var(4)>=100,floor(var(4)/100)*100-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0),0)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))*2)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),24+9,12-ifelse(floor(var(14)/90)>6,6,floor(var(14)/90))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,0)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,ceil(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Light
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=5
value = 0

;エリアル中
[state -2]
type = varset
trigger1 = animelem=4,>=0&&animelem=5,<0&&!movecontact&&var(1)%4>=2&&floor(fvar(26))=91000
fvar(26) = ifelse((var(4)-ifelse(var(4)>=100,floor(var(4)/100)*100-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0),0)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))=0,floor(P2bodydist Y),90000)

[state -2]
type = targetbind
trigger1 = movecontact=1&&var(1)%2<1&&var(1)%8<4&&var(1)%4>=2&&(var(4)-ifelse(var(4)>=100,floor(var(4)/100)*100-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0),0)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))=0&&floor(fvar(26))<90000
pos = floor(P2dist X),floor(fvar(26))

[state -2]
type = VarAdd
trigger1 = var(1)%4>=2 && movecontact=1 && !var(2)
var(1) = -2
ignorehitpause=1

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && var(1)%2<1 && movecontact=1
trigger2 = numhelper(3107) && movecontact=1
trigger2 = helper(3107),stateno=3108
y = -8.0*const(size.yscale)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(23*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),23*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=4
var(16) = 0
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
var(17) = floor(ifelse(P2dist X>164*const(size.xscale),164*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
var(18) = floor(-120*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-18.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-18.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,14)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact)
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;ジャンプ中
[statedef 610]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)+fvar(8),Vel X),vel Y
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((var(1)%4>=2&&(prevstateno=[600,620]))||prevstateno=600))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((var(1)%4>=2&&(prevstateno=[600,620]))||prevstateno=600))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((var(1)%4>=2&&(prevstateno=[600,620]))||prevstateno=600))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 610

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 600]
type = VelSet
trigger1 = (prevstateno=[110,115])&&time<4
y = 0

[state 600]
type = VelAdd
trigger1 = !(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2,.45,const(movement.yaccel))*ifelse(var(5)%2>=1,1.11,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,1.0,1.0)*ifelse(fvar(10)>0&&var(1)%2>=1,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&(var(5)%8>=4||var(5)%32>=16)
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&(var(5)%8>=4||var(5)%32>=16)
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 200]
type = VarSet
trigger1 = Time=9&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=9&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=9&&var(34)
var(35)=5

[state 200]
type = Helper
trigger1 = Time=9&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=9&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=9&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = StatetypeSet
trigger1 = IsHelper
physics = N

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)||(root,anim!=610&&root,anim!=610)

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=6&&random%3!=0
value = 10,3+(random<=500)
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=6
value = 7300,2
channel = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,13)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

;~~必殺技~~~
;弩九
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Dokyu2",1150+ifelse(command="y",1,0),ifelse(command="Dokyu",1100+ifelse(command="y",1,0),var(53)))
;~~~~~~~~~~~
;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,var(53)))

;２段ジャンプ、２段ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
var(53) = ifelse(var(0)%ifelse(var(0)>=1000,1000,100)<10&&command="longjump",50+ifelse(command="holdfwd",1,ifelse(command="holdback",2,0)),ifelse(command="up"&&var(0)<200,40,ifelse(command="fwdup",41,ifelse(command="backup",42,var(53)))))

;碇落とし
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
var(53) = ifelse(command="y"&&command="holddown"&&command!="holdfwd"&&command!="holdback",710,var(53))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = (command="x"||(command="y"&&var(1)%4>=2)||command="z")
var(53) = ifelse(command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&var(1)%4>=2,720,ifelse(command="z",620,ifelse(command="y"&&0,610,ifelse(command="x",600,var(53)))))
;~~~~~~~~~~~
;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
triggerall = var(1)%4<2
trigger1 = AnimElem=6
damage = ifelse(floor(42*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(42*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -13.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-13.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = HAFD
guardflag = HA
persistent=0

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
triggerall = var(1)%4>=2
trigger1 = AnimElem=6
damage = ifelse(floor(42*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(42*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,9
ground.velocity = -13.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-13.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -10.0*const(size.xscale)-.0009,-(8.0-(floor(var(4)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))/100)*2.35)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+9,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = HAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=7
value = 0

;エリアル中
[state -2]
type = varset
trigger1 = animelem=6,>=0&&animelem=7,<0&&!movecontact&&var(1)%4>=2&&floor(fvar(26))=91000
fvar(26) = ifelse((var(4)-ifelse(var(4)>=100,floor(var(4)/100)*100-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0),0)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))=0,floor(P2bodydist Y),90000)

[state -2]
type = targetbind
trigger1 = movecontact=1&&var(1)%2<1&&var(1)%8<4&&var(1)%4>=2&&(floor(var(4)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))/100)=0&&floor(fvar(26))<90000

pos = floor(P2dist X),floor(fvar(26))

[state -2]
type = VarAdd
trigger1 = var(1)%4>=2 && movecontact=1 && !var(2)
var(1) = -2
ignorehitpause=1

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && var(1)%2<1 && movecontact=1
trigger2 = numhelper(3107) && movecontact=1
trigger2 = helper(3107),stateno=3108
y = -8.0*const(size.yscale)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(42*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),42*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(17) = floor(ifelse(P2dist X>274*const(size.xscale),274*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(18) = floor(-180*const(size.yscale))+ifelse(P2bodydist Y<0,ifelse(P2bodydist Y<-160*const(size.yscale),floor(-160*const(size.yscale)),floor(P2bodydist Y)),0)


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-21.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,14)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact) && !IsHelper
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;ジャンプ強
[statedef 620]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)+fvar(8),Vel X),vel Y
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 620

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 600]
type = VelSet
trigger1 = (prevstateno=[110,115])&&time<4
y = 0

[state 600]
type = VelAdd
trigger1 = !(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2,.45,const(movement.yaccel))*ifelse(var(5)%2>=1,1.11,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,1.0,1.0)*ifelse(fvar(10)>0&&var(1)%2>=1,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&(var(5)%8>=4||var(5)%32>=16)
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&(var(5)%8>=4||var(5)%32>=16)
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=4&&random%2=0
value = 10,5+(random<=500)
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=4
value = 7300,2
channel = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,14)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

;~~必殺技~~~
;弩九
[state 250]
type = varset
trigger1 = var(53)<1000 && time>4 && !var(59)
var(53) = ifelse(command="Dokyu2",1150+ifelse(command="y",1,0),ifelse(command="Dokyu",1100+ifelse(command="y",1,0),var(53)))

;~~~~~~~~~~~

;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,var(53)))

;２段ジャンプ、２段ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = var(1)%4>=2
var(53) = ifelse(var(0)%ifelse(var(0)>=1000,1000,100)<10&&command="longjump",50+ifelse(command="holdfwd",1,ifelse(command="holdback",2,0)),ifelse(command="up"&&var(0)<200,40,ifelse(command="fwdup",41,ifelse(command="backup",42,var(53)))))

;碇落とし
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
var(53) = ifelse(command="y"&&command="holddown"&&command!="holdfwd"&&command!="holdback",710,var(53))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = (command="x"||command="y"||command="z")&&var(1)%4>=2
var(53) = ifelse(command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&var(1)%4>=2,720,ifelse(command="z"&&0,620,ifelse(command="y"&&var(1)%4>=2,610,ifelse(command="x"&&var(1)%4>=2,600,var(53)))))
;~~~~~~~~~~~
;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
triggerall = var(1)%4<2
trigger1 = AnimElem=5
damage = floor(ifelse(50*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=4),50*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7
ground.velocity = ifelse(var(49)&&!var(2),-2,-15.0*(1.0+ifelse(var(2)>31,31,var(2))*.04))*const(size.xscale),ifelse(var(49)&&!var(2),8.0,0)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,ifelse(var(49)&&!var(2),-2,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale))),ifelse(var(6)%10>0,var(6)%10*1.5,ifelse(var(49)&&!var(2),8.0,1.0))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(50*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(50*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(50*fvar(0)/fvar(2)*.8)*1.3,ceil(50*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = var(49)
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = Hard
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
triggerall = var(1)%4>=2
trigger1 = AnimElem=5
damage = floor(ifelse(50*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=4),50*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,9
ground.velocity = -15.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -10.0*const(size.xscale)-.0009,-(8.0+floor(var(4)/10000)*1.65)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .8*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+9,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(50*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(50*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(50*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8)*1.3,ceil(50*ifelse(var(1)%4>=2,.5,1.0)*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = var(49)
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = Hard
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=7
value = 0

;エリアル中
[state -2]
type = varset
trigger1 = animelem=5,>=0&&animelem=7,<0&&!movecontact&&var(1)%4>=2&&floor(fvar(26))=91000
fvar(26) = ifelse((var(4)-ifelse(var(4)>=100,floor(var(4)/100)*100-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0),0)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))=0,floor(P2bodydist Y),90000)

[state -2]
type = targetbind
trigger1 = movecontact=1&&var(1)%2<1&&var(1)%8<4&&var(1)%4>=2&&floor(var(4)/10000)=0&&floor(fvar(26))<90000
pos = floor(P2dist X),floor(fvar(26))

[state -2]
type = VarAdd
trigger1 = var(1)%4>=2 && movecontact=1 && !var(2)
var(1) = -2
ignorehitpause=1

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && var(1)%2<1 && movecontact=1
trigger2 = numhelper(3107) && movecontact=1
trigger2 = helper(3107),stateno=3108
y = -8.0*const(size.yscale)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(50*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),50*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(ifelse(P2dist X>182*const(size.xscale),182*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(17) = floor(ifelse(P2dist X>130*const(size.xscale),130*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-100*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(18) = floor(-100*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-21.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,14)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact) && !IsHelper
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;ジャンプ2中（碇落とし）
[statedef 710]
type = A
movetype=A
physics = N
ctrl = 0
velset = 0,0;ifelse(fvar(9),fvar(9)+fvar(8),Vel X),vel Y
movehitpersist=1

[state -2]
type = varset
triggerall = floor(var(6)%1000/100)>0&&enemynear,backedgebodydist>5&&enemynear,frontedgebodydist>5
trigger1 = !time&&fvar(10)>0
fvar(9) = 0

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,620]))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,620]))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,620]))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 710

[state 600]
type = VelSet
trigger1 = (prevstateno=[110,115])&&time<4
y = 0

[state 600]
type = VelAdd
trigger1 = ((Anim=710&&AnimElem=7,>1)||Anim=711)&&!(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2,.45,const(movement.yaccel))*ifelse(var(5)%2>=1,1.11,1)*ifelse(var(5)%4>=2||var(5)%8>=4,1.0,1)*ifelse(fvar(10)>0&&var(1)%2>=1,.9,1)*2*const(size.yscale)

[state 200]
type = VarSet
trigger1 = Time=9&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=9&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=9&&var(34)
var(35)=5

[state 200]
type = Helper
trigger1 = Time=9&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=9&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=9&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = StatetypeSet
trigger1 = IsHelper
physics = N

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)||(root,anim!=610&&root,anim!=610)

[state 800]
type = varset
trigger1 = !time
fvar(5) = 0

[state 800]
type = varset
trigger1 = !time
fvar(6) = 0

[state 800]
type = varset
trigger1 = !time
fvar(7) = 0

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&Anim=710&&AnimElem=6&&random%2=0
value = 10,3+(random<=500)
channel = 1

[state 190]
type = PlaySND
trigger1 = Anim=710&&AnimElem=6
value = 7300,2
channel = 10

[state 190]
type = VelSet
trigger1 = Anim=710&&AnimElem=1
x = 0
y = 0

[state 190]
type = VarSet
trigger1 = Anim=710&&AnimElem=1
fvar(8) = 0

[state 190]
type = VelSet
trigger1 = Anim=710&&AnimElem=7,=1
y = 4.0
persistent=0

[state 200]
type = EnvShake
trigger1 = Anim=710&&movecontact
time = 12
ampl = 6
persistent=0

[state 190,own_bounce]
type = ChangeAnim
trigger1 = Anim=710&&MoveContact&&var(52)<=1
trigger2 = Anim=710 && numhelper(18500)
trigger2 = helper(18500),stateno=18510 && helper(18500),prevstateno=18500 && helper(18500),time<2;"自分"の宝箱破壊時
value = 711
persistent=0

[state 190]
type = VelSet
trigger1 = Anim=711&&AnimElem=1&&var(1)%4<2
x = -3.0+ifelse((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||(P2stateno=927&&P2movetype=H)),fvar(5),0)
y = -7.0
persistent=0

[state 190]
type = VarSet
trigger1 = Anim=711&&AnimElem=1
fvar(8) = -3.0
persistent=0

;転倒食らい
[state 190]
type = Targetstate
trigger1 = numtarget && movehit=1 && var(1)%2<1 && var(1)%8<4
trigger1 = target,time=0
value = 15070

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,13)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

;~~~~~~~~~~~
;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && movecontact && !var(59)
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,var(53)))

;２段ジャンプ、２段ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && movecontact && !var(59)
var(53) = ifelse(var(0)%ifelse(var(0)>=1000,1000,100)<10&&command="longjump",50+ifelse(command="holdfwd",1,ifelse(command="holdback",2,0)),ifelse(command="up",40,ifelse(command="fwdup",41,ifelse(command="backup",42,var(53)))))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = (((command="x"||command="y")&&var(1)%4>=2)||command="z")
var(53) = ifelse(command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&var(1)%4>=2,720,ifelse(command="z",620,ifelse(command="y"&&0,610,ifelse(command="x"&&var(1)%4>=2,600,var(53)))))
;~~~~~~~~~~~
;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
triggerall = var(1)%4<2
trigger1 = AnimElem=7
damage = ifelse(floor(38*fvar(2)*fvar(3)*fvar(4)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(38*fvar(2)*fvar(3)*fvar(4)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -4.0*const(size.xscale),-11.0*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-13.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),45+13,28-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Medium
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
triggerall = var(1)%4>=2
trigger1 = AnimElem=7
damage = ifelse(floor(38*fvar(2)*fvar(3)*fvar(4)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(38*fvar(2)*fvar(3)*fvar(4)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,9
ground.velocity = -4.0*const(size.xscale),-11.0*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-13.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -10.0*const(size.xscale)-.0009,-8.0*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),45+9,28-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Medium
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = StatetypeSet
trigger1 = Anim=712
movetype=I

[state 200]
type = AttackDist
trigger1 = Anim=711
value = 0

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && var(1)%2<1 && movecontact=1
y = -8.0*const(size.yscale)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(38*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),38*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=7
var(16) = 3
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0
var(17) = floor(ifelse(P2dist X>64*const(size.xscale),64*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0
var(18) = floor(-40*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-13.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,13)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = VarSet
trigger1 = Anim=711&&AnimTime=0
fvar(8) = 0

[state 200]
type = ChangeState
trigger1 = Anim=711&&AnimTime=0
value = 50
ctrl = 1

[state 200]
type = ChangeAnim
trigger1 = Anim=710&&AnimElem=7,>0&&Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact) && !IsHelper
value = 712

[State 40, 1]
type = VarSet
trigger1 = Anim=712&&AnimElem=1
var(13) = 0

[state 200]
type = PosSet
trigger1 = Anim=712&&AnimElem=1
Y =0

[state 200]
type = VelSet
trigger1 = Anim=712&&AnimElem=1
Y =0

[state 200]
type = StateTypeSet
trigger1 = Anim=712&&AnimElem=1
statetype=S
physics=S

[state 200]
type = EnvShake
trigger1 = Anim=712&&AnimElem=1
time=12
ampl=6

[state 200]
type = PlaySND
trigger1 = Anim=712&&AnimElem=1
value= 5100,2

[State 40, 1]
type = PlaySND
trigger1 = Anim=712&&AnimElem=5
value = 52,0

[State 40, 1]
type = Explod
trigger1 = Anim=712&&AnimElem=5
id = 6910
anim = 6910
pos = ceil(-6*const(size.xscale)),ceil(0*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 3
facing = -1
vel = -5*const(size.xscale),0
scale = const(size.xscale),const(size.yscale)
pausemovetime = 9999
supermovetime = 9999

[State 40, 1]
type = Explod
trigger1 = Anim=712&&AnimElem=5
id = 6910
anim = 6910
pos = ceil(6*const(size.xscale)),ceil(0*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 3
facing = 1
vel = 5*const(size.xscale)
scale = const(size.xscale),const(size.yscale)
pausemovetime = 9999
supermovetime = 9999

[state 200]
type = ChangeState
trigger1 = Anim=712&&AnimTime=0
value = 0
ctrl = 1

;エリアルスパイク
[statedef 720]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)+fvar(8),Vel X),vel Y
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,620]))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,620]))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,620]))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 720

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 600]
type = VelSet
trigger1 = (prevstateno=[110,115])&&time<2
y = 0

[state 600]
type = VelAdd
trigger1 = !(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2,.45,const(movement.yaccel))*ifelse(var(5)%2>=1,1.11,1)*ifelse(var(5)%4>=2||var(5)%8>=4,1.0,1)*ifelse(fvar(10)>0&&var(1)%2>=1,.9,1)*2*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&(var(5)%8>=4||var(5)%32>=16)
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&(var(5)%8>=4||var(5)%32>=16)
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=1&&random%2=0
value = 10,5+(random<=500)
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=5
value = 7300,2
channel = 10

;エフェクト1
[state -2]
type = Explod
trigger1 = AnimElem=5
trigger2 = AnimElem=6
trigger3 = AnimElem=7
id = 6000
anim=6000
pos = floor(96*const(size.xscale)),-floor(0*const(size.yscale))
postype = P1
ownpal = 1
sprpriority = 3
removeongethit = 1
vel = -5.0*const(size.xscale),-8.0*const(size.yscale)
accel = 0*const(size.xscale),-.5*const(size.yscale)
scale = 2.0*const(size.xscale),2.0*const(size.yscale)
pausemovetime=999999
supermovetime=999999

[state -2]
type = Explod
trigger1 = AnimElem=5
trigger2 = AnimElem=6
trigger3 = AnimElem=7
id = 6000
anim=6000
pos = floor(224*const(size.xscale)),floor(10*const(size.yscale))
postype = P1
ownpal = 1
sprpriority = 3
removeongethit = 1
vel = -5.0*const(size.xscale),-8.0*const(size.yscale)
accel = 0*const(size.xscale),-.5*const(size.yscale)
scale = 2.0*const(size.xscale),2.0*const(size.yscale)
pausemovetime=999999
supermovetime=999999

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,13)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = AnimElem=6
damage = ifelse(floor(60*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(60*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,9
ground.velocity = -13.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-13.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-15.0*const(size.xscale)-.0009,-10),6
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = ifelse(var(1)%4>=2,1.1,.9)*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),49+9,44-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(45*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(45*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(45*fvar(0)/fvar(2)*.8)*1.3,ceil(45*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-80*const(size.xscale))
animtype = Hard
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=7
value = 0

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && var(1)%2<1 && movecontact=1
y = -8.0*const(size.yscale)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(60*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),60*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(17) = floor(ifelse(P2dist X>240*const(size.xscale),240*const(size.xscale),floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(18) = floor(-30*const(size.yscale))+ifelse(P2bodydist Y<0,ifelse(P2bodydist Y<-140*const(size.yscale),floor(-80*const(size.yscale)),floor(P2bodydist Y)),0)


;・・・・自分側ヒットバック・・・・
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,14)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !(var(52)>0&&movecontact)
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;■■■■■■■
;通常投げ
;(発生5F)
[statedef 800]
type = S
physics = S
movetype=A
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0,vel x),0
anim = 800

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=0)
triggerall = (P2stateno!=[150,155])
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
attr = S,NT
hitflag = M-
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=801
p1facing = ifelse((command="holdback"&&!var(59))||(ifelse(facing=1,-(helper(30005),pos x-pos x),helper(30000),pos x-pos x)<(160+const(size.ground.back))&&var(59)),-1,1)
p2facing=1
numhits=0

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = (P2stateno!=[150,155])&&enemynear,anim=5300
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
attr = S,NT
hitflag = M
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=801
p1facing = ifelse((command="holdback"&&!var(59))||(ifelse(facing=1,-(helper(30005),pos x-pos x),helper(30000),pos x-pos x)<(160+const(size.ground.back))&&var(59)),-1,1)
p2facing=1
fall = 1
numhits = 0

[state 1000]
type = AttackDist
trigger1 = 1
value = 0

[state 1000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;■■■■■■■
;通常投げ掴み
[statedef 801]
type = S
physics = S
movetype=A
ctrl = 0
velset = 0,0
anim = 801

[state 800]
type = varset
trigger1 = !time
fvar(8) = 0

[state 800]
type = varset
trigger1 = !time
fvar(9) = 0

[state 800]
type = varset
trigger1 = !time
fvar(10) = 0

[state 800]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=13
value = 10,44
channel = 1

[state 801]
type = targetstate
trigger1 = time=0||(target,stateno!=806&&animelemtime(10)<0)
value = 806

[state 801]
type = Width
trigger1 = animelemtime(1)=0
edge = floor(154*const(size.xscale)),0

;コンボ補正なし
[state 801]
type = null;targetlifeadd
trigger1 = animelemtime(11)=0
value = -floor(40*fvar(0)*1.22)

[state 801]
type = null;poweradd
trigger1 = animelemtime(11)=0
value = floor(ifelse(var(9),0,floor(70*fvar(0)/fvar(2))*1.3*fvar(16)))

[state 801]
type = null;targetpoweradd
trigger1 = animelemtime(11)=0
value = floor(floor(70*fvar(0)/fvar(2)*.8)*1.3)

[state 801]
type = targetbind
trigger1 = animelemtime(2)<0
pos = floor(25*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(2)>=0&&animelemtime(3)<0
pos = floor(30*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
pos = floor(65*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(4)>=0&&animelemtime(5)<0
pos = floor(50*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(5)>=0&&animelemtime(6)<0
pos = floor(120*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(6)>=0&&animelemtime(7)<0
pos = floor(-15*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(7)>=0&&animelemtime(8)<0
pos = floor(-60*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(8)>=0&&animelemtime(9)<0
pos = floor(-10*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(9)>=0&&animelemtime(10)<0
pos = floor(5*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(10)=0
pos = floor(100*const(size.xscale)),floor(0*const(size.yscale))

[state 801]
type = targetstate
trigger1 = animelemtime(10)>=0&&movehit=1
value = 807
ignorehitpause=1
persistent = 0

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = AnimElem=4
trigger2 = AnimElem=6
damage = floor(30*fvar(4)*1.22)
ground.slidetime = 18+(P2statetype=C)
ground.hittime = 18+(P2statetype=C)
guard.slidetime = 17
guard.hittime = 17
pausetime = 8,7
ground.velocity = 0;-4*const(size.xscale),-6.0*const(size.yscale)
guard.velocity = 0;-15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = 0;-4*const(size.xscale),ifelse(var(6)%10>0,4,-6.0)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .8*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 0;1
air.fall = 0;1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-220*const(size.xscale))
animtype = Hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M


;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = AnimElem=10
damage = floor(30*fvar(4)*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 15,14
ground.velocity = -6*const(size.xscale),-8.0*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale),ifelse(var(6)%10>0,4,-8.0)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .8*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-220*const(size.xscale))
animtype = Hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&hitpausetime=ifelse(animelemtime(10),7,14)
fvar(15) = .00005*floor(30*fvar(4)*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1&&hitpausetime=ifelse(animelemtime(10),7,14)
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=4
var(16) = 5
persistent=0

[state 240]
type = VarSet
trigger1 = AnimElem=10
var(16) = 1
persistent=0

;X座標
[state 240]
type = null;VarSet
trigger1 = 0;AnimElem=4,>=0&&AnimElem=11,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,50]),10,-10)

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
var(17) = floor(135*const(size.xscale))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=8,<0
var(17) = floor(20*const(size.xscale))

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
var(17) = floor(135*const(size.xscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
var(18) = floor(-230*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=8,<0
var(18) = floor(-245*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
var(18) = floor(-220*const(size.yscale))

;強制基底補正50%
[state -1]
type = varadd
trigger1 = animelemtime(10)=0 && var(8)%8<4
var(8) = 4
ignorehitpause=1

;気絶値増加
[state -1]
type = varadd
trigger1 = animelemtime(4)=0
trigger2 = animelemtime(6)=0
trigger3 = animelemtime(10)=0
var(29) = floor(7*fvar(1))
ignorehitpause=1

;小判獲得
[state -1]
type = varadd
trigger1 = animelemtime(10)=0&&roundstate=2
var(37) = floor(30*fvar(24))
ignorehitpause=1

;小判エフェクト
[state -2]
type = Helper
trigger1 = animelemtime(10)=0&&roundstate=2
id = 18600
stateno=18600
pos = floor(80*const(size.xscale)),enemynear,const(size.mid.pos.y)
postype = P1
ownpal = 1
facing=1
pausemovetime=999999
supermovetime=999999
ignorehitpause = 1

[state 1000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;■■■■■■■
;通常投げ食らい
[statedef 806]
type = A
physics = N
movetype=H
ctrl = 0
velset = 0,0

[state 806]
type = ScreenBound
trigger1 = 1
value = 1

[state 806]
type = PlayerPush
trigger1 = 1
value = 0

[state 806]
type = ChangeAnim2
trigger1 = time=0
value = 806

[state 806]
type = SelfState
trigger1 = time>=120
value = 5000

;■■■■■■■
;通常投げ食らい（吹き飛び）
[statedef 807]
type = A
physics = N
movetype=H
ctrl = 0
velset = 0,0

[state 806]
type = ChangeAnim
trigger1 = !time
value = 5030
persistent = 0

[state 806]
type = ChangeAnim
trigger1 = Anim=5030 && !AnimTime
value = 5050

[state 806]
type = VelSet
trigger1 = hitshakeover
x = -4.0
y = -6.0
persistent = 0

[state 806]
type = VelAdd
trigger1 = hitshakeover
y = .45

[state 806]
type = ChangeState
trigger1 = time && Vel Y>0 && Pos Y>=-Vel Y
value = 15100

;吹き飛ばし攻撃
[statedef 900]
type = S
movetype = A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 900

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=20

;攻撃発生中のガードポイント
[state 200]
type = HitBy
trigger1 = var(32)&&AnimElemTime(6)>0&&AnimElemTime(7)<=0&&!movecontact
value = ,AT

;攻撃状態維持用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&(prevstateno!=[130,154])
var(7) = 0

[state 220]
type = varadd
trigger1 = var(7)<120&&((command="hold_y"&&command="hold_z"&&!var(59))||!(var(7)>=66&&((enemynear,pos Y>-55&&enemynear,vel Y>-2&&enemynear,vel Y<2&&enemynear,vel Y!=0)||(var(7)>=80&&var(2)<=3&&random%4=0)))&&var(59))
trigger1 = (anim=905&&var(7))||(animelemtime(5)=0&&!var(7))
var(7) = 1

[state 220]
type = ChangeAnim
trigger1 = anim=900&&animelemtime(5)=0&&var(7)&&var(7)<=120
trigger1 = ((command="hold_y"&&command="hold_z"&&!var(59))||!(var(7)>=66&&((enemynear,pos Y>-55&&enemynear,vel Y>-2&&enemynear,vel Y<2&&enemynear,vel Y!=0)||(var(7)>=80&&var(2)<=3&&random%4=0)))&&var(59))
value = 905
persistent=0

[state 220]
type = ChangeAnim
trigger1 = (((command!="hold_y"||command!="hold_z")&&!var(59))||(var(7)>=66&&((enemynear,pos Y>-55&&enemynear,vel Y>-2&&enemynear,vel Y<2&&enemynear,vel Y!=0)||(var(7)>=80&&var(2)<=3&&random%4=0)))&&var(59)||var(7)>=120)&&var(7)
value = 900
elem = 5
persistent=0

[state 220]
type = playsnd
triggerall = var(7)=1
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&anim=905
value = 10,11
channel = 1
persistent=0

[state 220]
type = playsnd
triggerall = var(7)>0
trigger1 = anim=905
value = 7400,0
channel = 10
persistent=0

[state 220]
type = stopsnd
trigger1 = var(7)>0&&anim!=905
channel = 10
persistent=0

;溜めエフェクト
[state -2]
type = Helper
trigger1 = var(7)%8=1 &&anim=905
id = 7770
stateno=7770
pos = 0,0
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

[state 220]
type = PalFX
trigger1 = anim=905&&(var(7)=[60,68])&&((command="hold_y"&&command="hold_z"&&!var(59))||(random<0&&var(59)))
add = 255-(var(7)-60)*30,255-(var(7)-60)*30,255-(var(7)-60)*30
time = 1
;~~~~~

;消えちまいな！
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=5
value = 10,9
channel = 1

[state 190]
type = PlaySND
trigger1 = Anim=900 && AnimElem=5
value = 7300,3
channel = 10

[state 900]
type =PosAdd
trigger1 = Anim=900&&animelem=2
x = floor(40*const(size.xscale))

[state 900]
type =PosAdd
trigger1 = Anim=900&&animelem=3
x = floor(30*const(size.xscale))

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13+(var(7)>=60)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggearll = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=6
damage = floor(ifelse(60*fvar(0)<1,1+(var(2)%5=4),60*fvar(0))*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -11.5,-11*const(size.yscale)
guard.velocity = -13.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%2>=1||var(1)%16<8,-11.5*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-15.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-5.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ceil(((var(3)%5=4)+floor(var(3)/5)))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(70*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(70*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(70*fvar(0)/fvar(2)*.8)*1.3,ceil(70*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = Hard
ground.type = Low
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0

;Attack Lv.5
[state 200]
type = Hitdef
triggearll = (var(52)<=0||var(52)=100)
triggerall = var(7)>=60
trigger1 = AnimElem=6
damage = floor(ifelse(60*fvar(0)<1,1+(var(2)%5=4),60*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7
ground.velocity = -10,-11*const(size.yscale)
guard.velocity = -44*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(1)%16<8,-10.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-7.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(70*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(70*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(70*fvar(0)/fvar(2)*.8)*1.3,ceil(70*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = Hard
ground.type = Low
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0
ID = 920

;==壁ダウンに
[state 920]
type = varadd
trigger1 = movehit=1 && numtarget && var(6)%10=0
trigger1 = target,time=0
var(1) = ifelse(var(7)<60&&var(1)%2<1&&var(1)%16<8,4+8,ifelse(var(1)%2<1&&var(7)>=60,1,0))-(var(1)%16>=8&&var(1)%8>=4)*4
ignorehitpause=1
persistent=0

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && var(6)%10=0 && (var(1)%2>=1||var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(var(7)<60&&var(1)%2<1,938,928)
ignorehitpause=1
persistent=0

[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && var(52)>0 && time>4 && var(7)<60 && !var(59)
var(53) = ifelse(var(0)<10 && command="longjump",50,ifelse(command="holdup",40,var(53)))+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0))
ignorehitpause=1

;ブースト
[state 900]
type = VarSet
triggerall = (movehit||(moveguarded&&var(7)>=60)) && var(52)>0 && movecontact
trigger1 = command="holdfwd"&&command!="holdup"&&command!="holddown"&&!var(59)
var(53) = 2000+ifelse(var(53)=40||var(53)=50,var(53),0)

;ブースト
[state 900]
type = ChangeState
triggerall = (movehit||(moveguarded&&var(7)>=60))&&!(var(52)>0&&movecontact) && (var(1)%2>=1||var(1)%8>=4) && P2dist X>10
trigger1 = ((command="holdfwd"&&command!="holdup")||(var(53)=[2000,2050]))&&!var(59)
trigger2 = var(59)
value = 2000

;ジャンプ
[state 900]
type = ChangeState
triggerall = movecontact&&!(var(52)>0&&movecontact)&&var(7)<60
trigger1 = (command="up"||command="fwdup"||command="backup"||(var(53)=[40,42])||(var(53)=[50,52]))&&!var(59)
trigger2 = var(59)
value = 40

[state 200]
type = AttackDist
trigger1 = AnimElem=7
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(60*fvar(14)<1,1+(var(2)%5=1),60*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,50]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(18) = floor(-160*const(size.yscale))

;現在の速度取得
[state 900]
type = VarSet
trigger1 = !time
fvar(8) = 0

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = (ifelse(var(7)>=60,-15.0,-13.5)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (ifelse(var(7)>=60,-15.0,-13.5)*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&var(6))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(var(7)>=60,ifelse(moveguarded,18,20+(P2statetype=C)),ifelse(moveguarded,15,17+(P2statetype=C)))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&var(6))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(7)>=60,14,13)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 2000]
type = ChangeState
trigger1 = anim=900&&AnimTime=0
value = 0
ctrl = 1

;エリアル攻撃
[statedef 910]
type = S
movetype = A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 910

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=4
value = 910
elem = 5

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=14

;攻撃状態維持用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive&&AnimElem=4
value = 10,6-random%2*2
channel = 1

[state 190]
type = PlaySND
trigger1 = AnimElem=7
value = 7300,2
channel = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggearll = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=8
damage = floor(ifelse(60*fvar(0)<1,1+(var(2)%5=4),60*fvar(0))*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,13+var(49)*7
ground.velocity = 0,(-22.0-.9)*const(size.yscale)
guard.velocity = -13.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,ifelse(var(6)%10>0,-8,0)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-22.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+13,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(45*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(45*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(45*fvar(0)/fvar(2)*.8)*1.3,ceil(45*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-160*const(size.xscale))
animtype  = diagup
ground.type = Low
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0

[state 200]
type = VarAdd
trigger1 = movehit=1&&numtarget&&var(1)%4<2&&var(6)%10=0
var(1) = 2
ignorehitpause=1

;ジャンプ・ハイジャンプ
[state 250]
type = varset
triggerall = !var(53) && var(52)>0 && movehit && var(7)<60 && !var(59)
triggerall = command="holdup"
trigger1 = !numhelper(3107)
trigger2 = numhelper(3107)
trigger2 = helper(3107),stateno!=3108
var(53) = 40+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0))

[state 200]
type = ChangeState
triggerall = movehit&&numtarget&&!(var(52)>0&&movecontact)
triggerall = (command="holdup"||(var(53)=[40,42]))&&!var(59)||var(59)
trigger1 = !numhelper(3107)
trigger2 = numhelper(3107)
trigger2 = helper(3107),stateno!=3108
value = 40

[state 200]
type = AttackDist
trigger1 = AnimElem=10
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(60*fvar(14)<1,1+(var(2)%5=1),60*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=12,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,50]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=12,<0
var(18) = floor(-160*const(size.yscale))

;現在の速度取得
[state 240]
type = varset
trigger1 = !time
fvar(8) = 0

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0&&(var(6)||moveguarded)
fvar(5) = (-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-13.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&(var(6)||moveguarded))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,8,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&(var(6)||moveguarded))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 2000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;一触
[statedef 1000]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state a]
type = ChangeAnim
trigger1 = time<=1&&(prevstateno=210||prevstateno=220)&&P2statetype=S&&!var(3)
value = anim
ignorehitpause=1

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1000

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=23

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;食らってみるか？
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&Anim=1000&&AnimElem=1
value = 10,40
channel = 1
persistent=0

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&(prevstateno!=[130,154])
var(7) = 0

[state 220]
type = varadd
trigger1 = var(7)<120&&((command="hold_x"&&!var(59))||(random<0&&var(59)))
trigger1 = (anim=1005&&var(7))||(Anim=1000 &&animelemtime(3)=0&&!var(7))
var(7) = 1

[state 220]
type = ChangeAnim
trigger1 = anim=1000&&animelemtime(3)=0&&var(7)&&var(7)<=120
trigger1 = ((command="hold_x"&&!var(59))||(random<0&&var(59)))
value = 1005
persistent=0

[state 220]
type = ChangeAnim
trigger1 = Anim=1005 && (command!="hold_x"||var(7)>=120)&&var(7)
value = 1000
elem = 3
persistent=0

[state 220]
type = playsnd
triggerall = var(7)>0
trigger1 = anim=1005
value = 7400,0
channel = 12
persistent=0

;溜めエフェクト
[state -2]
type = Helper
trigger1 = var(7)%6=1 &&anim=1005
id = 7770
stateno=7770
pos = 0,0
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

;~~~~~

;いただくぜ！／いいもんもってんじゃねえか
[state 190]
type = PlaySND
triggerall = var(40)!=-2
trigger1 = (!var(10)||var(10)>=1000)&&Anim=1000&&AnimElem=12&&random%3=0
value = 10,ifelse(var(50)%3=2,213,46+var(50)%2)
channel = 1

;そらよっ！
[State 40, 1]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&roundstate=2&&alive&&Anim=1000&&AnimElem=5&&var(7)>60
value = 10,39
channel = 1

[state 190]
type = PlaySND
trigger1 = Anim=1000&&AnimElem=5
trigger2 = Anim=1000&&AnimElem=13
trigger3 = Anim=1010&&AnimElem=2
value = 7300,3
channel = 10

[state 190]
type = PlaySND
triggerall = !(var(52)>1&&movecontact)
trigger1 = Anim=1000&&AnimElem=5,>=0&&AnimElem=20,<0&&!(animelemtime(12)>=0&&animelemtime(13)<0)&&time%2=0
trigger2 = Anim=1010&&AnimElem=1,>=0&&AnimElem=12,<0&&time%2=0
value = 30,3
channel = 11

;叩きつけ音
[state 190]
type = PlaySND
trigger1 = Anim=1000&&AnimElem=10
value = 5100,2

;揺れ
[state 195]
type = EnvShake
trigger1 = Anim=1000&&AnimElem=10
ampl = 4
time = 16

;岩盤
[State 40, 1]
type = Helper
trigger1 = Anim=1000&&AnimElem=10
id = 6925
stateno = 6920
pos = floor(540*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

;岩石1
[state 801]
type = Explod
trigger1 = Anim=1000&&AnimElem=10
id = 6150
anim = 6150
pos =  floor(550*const(size.xscale)),0
postype = p1
scale = const(size.xscale),const(size.yscale)
vel = random%3*const(size.xscale),(-random%5)*const(size.yscale)
facing = -1+(random%2=0)*2
sprpriority = 0
pausemovetime=999
supermovetime=999
persistent=0
ignorehitpause=1

;岩石2
[state 801]
type = Explod
trigger1 = Anim=1000&&AnimElem=10
id = 6150
anim = 6150
pos =  floor(530*const(size.xscale)),0
postype = p1
scale = const(size.xscale),const(size.yscale)
vel = random%3*const(size.xscale),(-random%5)*const(size.yscale)
facing = -1+(random%2=0)*2
sprpriority = 0
pausemovetime=999
supermovetime=999
persistent=0
ignorehitpause=1

;ほこり
[state 801]
type = Explod
trigger1 = Anim=1000&&AnimElem=10
id = 6100
anim = 6100
pos = floor(540*const(size.xscale)),0
postype = p1
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

;ほこり
[state 801]
type = Explod
trigger1 = Anim=1000&&AnimElem=10
id = 6100
anim = 6100
pos = floor(540*const(size.xscale)),0
postype = p1
scale = const(size.xscale),const(size.yscale)
facing=-1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

;岩石


[state 190]
type = VarSet
trigger1 = AnimElem=11&&!var(59)
var(7) = -ifelse(command="holdfwd",1,ifelse(command="holdback",2,ifelse(command="holdup",3,0)))
persistent=0

[state 190]
type = VarSet
trigger1 = AnimElem=11 && var(59)
var(7) = -2
persistent=0

[state 190]
type = VarSet
trigger1 = AnimElem=11,>0&&AnimElem=12,<=0&&movehit=1&&var(7)
var(7) = -var(7)
persistent=0

[state 190]
type = ChangeAnim
trigger1 = AnimElem=12&&movehit&&var(7)=2
value = 1010
persistent=0

[state 190]
type = ChangeAnim
trigger1 = Anim=1000&&AnimElem=12,=2&&movecontact
value = 1000
elem = 13
persistent=0

[state 190]
type = ChangeAnim
trigger1 = Anim=1000&&AnimElem=13,=2&&movecontact
value = 1000
elem = 14
persistent=0

;転倒食らい
[state 190]
type = Targetstate
trigger1 = numtarget && AnimElemTime(11)>0 && movehit=1 && var(1)%2<1 && var(1)%8<4 && var(6)%10=0
trigger1 = target,time=0
value = 15070

;小判獲得
[state 1000]
type = varadd
triggerall = var(40)!=-2
trigger1 = anim=1000&&animelemtime(10)=0&&roundstate=2
var(37) = ifelse(var(7)>=65,660,ifelse(var(7)>=45,540,ifelse(var(7)>=25,420,300)))

;小判エフェクト
[state -2]
type = Helper
triggerall = var(40)!=-2
trigger1 = anim=1000&&animelemtime(10)=0&&roundstate=2
id = 18600
stateno=18600
pos = floor(500*const(size.xscale)),0
postype = P1
ownpal = 1
facing=1
pausemovetime=999999
supermovetime=999999
ignorehitpause = 1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(animelemtime(11)>=1&&AnimElemTime(12)<=0,12,ifelse(animelemtime(10)>=1&&AnimElemTime(11)<=0,0,13))

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=9
damage = floor(ifelse(28*ifelse(fvar(1)<0.25,0.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)<1,1+(var(2)%5=4),28*ifelse(fvar(1)<0.25,0.25,fvar(1))*fvar(2)*fvar(3)*fvar(4))*1.22),floor(ceil(28*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = -27.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-27.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-12.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 1
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = Low
attr = S,SA
hitflag = MAFD
guardflag = MA

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = AnimElem=10
damage = floor(ifelse(28*ifelse(fvar(1)<0.25,0.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)<1,1+(var(2)%5=4),28*ifelse(fvar(1)<0.25,0.25,fvar(1))*fvar(2)*fvar(3)*fvar(4))*1.22),floor(ceil(28*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,0
ground.velocity = -12.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0000,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-12.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 1
fall.recovertime = ifelse(var(49)&&!var(2),30+0,16-ifelse(floor(var(14)/70)>7,7,floor(var(14)/70))+0)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = Low
attr = S,SA
hitflag = MAFD
guardflag = MA

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = var(7)>=-1
trigger1 = AnimElem=11
damage = floor(ifelse(1*ifelse(fvar(1)<0.25,0.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)<1,1+(var(2)%5=4),1*ifelse(fvar(1)<0.25,0.25,fvar(1))*fvar(2)*fvar(3)*fvar(4))*1.22),floor(ceil(1*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+var(49)*6
ground.velocity = ifelse(var(7)=-1,2.0,6.0)*const(size.xscale),ifelse(var(7)=-1,-8.0,-6.0)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,11.0*(1.0+ifelse(var(3)>31,31,var(3))*.1)+.0012,ifelse(var(7)=-1,2.0,6.0)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,ifelse(var(7)=-1,-8.0,-6.0)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = ifelse(var(7)=-3,.4,.5)*const(size.yscale)
fall.recover = ifelse(var(7)=-3||var(3),1,0)
fall.recovertime = ifelse(var(49)&&!var(2),42+12,28-ifelse(floor(var(14)/70)>7,7,floor(var(14)/70))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = Low
attr = S,SA
hitflag = MAFD
guardflag = MA

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
trigger1 = var(7)<=-2
trigger1 = AnimElem=11
damage = floor(ifelse(1*ifelse(fvar(1)<0.25,0.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)<1,1+(var(2)%5=4),1*ifelse(fvar(1)<0.25,0.25,fvar(1))*fvar(2)*fvar(3)*fvar(4))*1.22),floor(ceil(1*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)
ground.hittime = 14+(P2statetype=C)
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+var(49)*6
ground.velocity = ifelse(var(7)=-1,2.0,ifelse(var(7)=-2,10.0,ifelse(var(7)=-3,5.0,6.0)))*const(size.xscale),ifelse(var(7)=-1,-8.0,ifelse(var(7)=-2,-11.0,ifelse(var(7)=-3,-12.0,-6.0)))*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,11.0*(1.0+ifelse(var(3)>31,31,var(3))*.1)+.0012,ifelse(var(7)=-3,5.0,10.0)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,ifelse(var(7)=-3,-12.0,-11.0)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = ifelse(var(7)=-3,.4,.5)*const(size.yscale)
fall.recover = ifelse(var(7)=-3||var(3),1,0)
fall.recovertime = ifelse(var(49)&&!var(2),42+12,28-ifelse(floor(var(14)/70)>7,7,floor(var(14)/70))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = Low
attr = S,SA
hitflag = MAFD
guardflag = MA

[state 200]
type = AttackDist
trigger1 = AnimElem=12
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(ifelse(animelemtime(11)>=0,1,28)*fvar(14)<1,1+(var(2)%5=1),ifelse(animelemtime(11)>=0,1,28)*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=11,<0
var(16) = 10+random%6
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=11,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,50]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=9,<0
var(18) = floor(-100*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
var(18) = floor(-60*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
var(18) = floor(-20*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse((var(3)&&target,statetype=A)||(movehit&&animelemtime(11)>0),-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),ifelse(animelemtime(10)>0,-12.0,-27.0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (ifelse(animelemtime(10)>0,-12.0,-27.0)*1.5*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(animelemtime(10)>0,ifelse(moveguarded,12,14+(P2statetype=C)),ifelse(moveguarded,15,17+(P2statetype=C)))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(animelemtime(11)>0,12,ifelse(animelemtime(10)>0,0,13))-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Anim!=1005 && AnimTime=0
value = 0
ctrl = 1

;弩九
[statedef 1100]
type = U
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0;Vel Y

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))&&statetype!=A
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))&&statetype!=A

[state 1000]
type = VarSet
trigger1 = Time=0 && !var(59)
var(7) = ifelse((command="y"&&!var(53)&&!fvar(27))||var(53)=1101||var(53)=1151||floor(fvar(27)/10)*10=1160,1,0)+(statetype=A)*10+(command="Dokyu2"||(var(53)=[1150,1151])||floor(fvar(27)/10)*10=1150||floor(fvar(27)/10)*10=1160)*20

[state 1000]
type = VarSet
trigger1 = Time=0 && var(59)
var(7) = 0

[state 1000]
type = VarSet
triggerall = Time=0 && var(59)
trigger1 = (P2bodydist Y<ifelse(var(1)%16<8,0,-30)&&var(3)<8&&((enemynear,backedgebodydist<=25||enemynear,frontedgebodydist<=25)&&prevstateno=220))||(var(2)>=24&&var(1)%2<1)
trigger1 = prevstateno!=410
trigger2 = enemynear,pos Y<-50&&(var(3)=[6,16])&&(var(40)=1||var(42)>=(var(41)-40))&&(var(12)=[2,2000])
trigger2 = ifelse(helper(20000),facing=1,helper(30000),pos x-helper(20000),pos x,-(helper(30005),pos x-helper(20000),pos x))<(160+helper(20000),const(size.ground.front))
trigger2 = prevstateno!=410
var(7) = 1

[state 1000]
type = VarSet
trigger1 = time=0 && var(59)
var(7) = ifelse(var(59)=2&&Power>=2000&&prevstateno=410,20,var(7))

[state 1000]
type = VarSet
trigger1 = time=0 && var(59)
var(7) = ifelse(fvar(33),ifelse(ifelse(facing=1,-(helper(30005),pos x-pos x),helper(30000),pos x-pos x)<(160+const(size.ground.back)),0,20)+(var(51)<400)+(statetype=A)*10,var(7))

[state 1000]
type = VarSet
triggerall = Time=0 && var(59)
trigger1 = (prevstateno=[210,220])&&var(2)<=1
trigger1 = (var(12)!=0||var(37)>=5000)&&(P2bodydist X=(ceil((111+0)*const(size.xscale)-const(size.ground.front)),ceil((111+60)*const(size.xscale)-const(size.ground.front))])
trigger2 = (prevstateno=[210,220])&&var(2)<=1
tirgger2 = backedgebodydist>40 && enemynear,backedgebodydist<60 && life<400 && random%5=0
trigger3 = fvar(33)>=1&&var(7)=0
var(7) = 20

[state 1000]
type = VarSet
triggerall = Time=0 && var(59)
trigger1 = prevstateno=620 && var(2)>1 && numhelper(3107)
trigger1 = helper(3107),stateno=3108
var(7) = 21

[state 1000]
type = VarSet
triggerall = Time=0 && var(59)
trigger1 = var(51)>=1000 && var(2)<=1
var(7) = (statetype=A)*10+((P2bodydist X<140 && enemynear,backedgebodydist<40)||(statetype!=A&&backedgebodydist>30))*20+(random%2=0&&Pos Y<-160)

[state 1000]
type = VarSet
trigger1 = Time=0
var(13) = 1

[state 1100]
type = StatetypeSet
trigger1 = time=0
statetype=A

[state 1100]
type = PlayerPush
trigger1 = vel x>0 && (P2bodydist X=[-60,0]) && P2dist X>-20 && P2bodydist Y>40
value = 0

[state 1100]
type = VelSet
trigger1 = vel x>0 && (P2bodydist X=[-60,0]) && P2dist X>-20 && P2bodydist Y<=40 && fvar(9)<=0
x = 0

[state 1100]
type = VelSet
trigger1 = !(vel x>=0 && (P2bodydist X=[-60,0]) && P2dist X>-20 && P2bodydist Y<=40)
x = fvar(8)+fvar(9)

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = VarSet
trigger1 = Time=0
fvar(8) = 0

[state 200]
type = VarSet
trigger1 = Time=0&&var(7)>=20
fvar(9) = -fvar(9)

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1100

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 800]
type = varset
trigger1 = !time
fvar(5) = 0

[state 800]
type = varset
trigger1 = !time
fvar(6) = 0

[state 800]
type = varset
trigger1 = !time
fvar(7) = 0

;はっは！
[state 1050]
type = playsnd
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&animelem=1
value = 10,45
channel = 1

[state 1050]
type = PlaySnd
trigger1 = Anim=1100 && AnimElem=3,=1
value = 30,5
channel = 11
volume = 128

[state 6150]
type = Explod
trigger1 = AnimElem=3,=1
id = 6000
anim= 6000
pos = -floor(104*const(size.xscale)),floor(0*const(size.yscale))
postype = p1
sprpriority = 0
ignorehitpause=1
pausemovetime = 99999
supermovetime = 99999
vel = const(size.xscale)*-10.0,const(size.yscale)*-2.0
accel = const(size.xscale)*0,const(size.yscale)*-.5
scale = const(size.xscale)*2,const(size.yscale)*2

[state 1150]
type = PosAdd
trigger1 = Anim=1100&&AnimElem=2
trigger2 = Anim=1100&&AnimElem=2,=1
y = -floor(15*const(size.yscale))

[state 1150]
type = turn
trigger1 = Anim=1100&&var(7)>=20&&AnimElem=3

[state 1050]
type = VelSet
trigger1 = Anim=1100&&AnimElem=3
x = 9.0-(var(7)%10)*4.5
y = -3.0-(var(7)%10)*3.0

[state 1050]
type = VarSet
trigger1 = Anim=1100&&AnimElem=3
fvar(8) = 9.0-(var(7)%10)*4.5

[state 1050]
type = VelAdd
trigger1 = Anim=1100&&AnimElem=3,>0
y = .15

;派生
[state 1050]
type = ChangeState
trigger1 = (Time=[5,25]) && !var(59)
trigger1 = (command="x"||command="y"||command="z")
value = ifelse(command="z",1400,ifelse(command="y",1300,1200))

;停止(AI用)
[state 1050]
type = ChangeState
triggerall = (Time=[5,25]) && var(59)
trigger1 = prevstateno=620 && var(2)>1 && numhelper(3107)
trigger1 = helper(3107),stateno=3108 && random%7<2
value = 1200

;回転(AI用)
[state 1050]
type = ChangeState
triggerall = (Time=[5+(var(1)%16<8||!var(3))*2,25]) && var(59)
trigger1 = ((P2BodyDist X=[-20,ceil(340*const(size.xscale)-const(size.air.front))])||(prevstateno=[200,420])) && var(2)>=ifelse(time>=18,1,2)
trigger1 = ifelse((var(1)%16>=8||(var(2)>=24&&var(7)=1))&&(prevstateno!=[200,420]),time>=8,1) && !(var(59)=2&&Power>=2000&&prevstateno=410) && random%5<3
trigger1 = !((prevstateno=[200,210])&&floor(var(6)%1000/100)>0)
value = 1300

;落下(AI用)
[state 1050]
type = ChangeState
triggerall = (Time=[5,25]) && var(59) && !(var(7)>=20 && (abs(P2bodydist X)>20||(backedgebodydist>2&&enemynear,backedgebodydist>20))&&var(2)<=1)
triggerall = !(P2statetype=L&&(enemynear,anim=[5120,5129])&&enemynear,animtime<-14) && var(51)<1000
trigger1 = (P2BodyDist X=[-80,ceil(140*const(size.xscale)-const(size.air.front))]) && var(2)<2
trigger1 = enemynear,Pos Y>-70 && time<=ifelse(var(7)>=20,6,12)
trigger1 = ifelse((var(7)=[20,21])||var(7)=0,var(51)%10<ifelse(enemynear,backedgebodydist<40,10,8+(prevstateno=[210,420])*2),ifelse(var(7)>=30&&enemynear,backedgebodydist<=5,var(51)%4=0,var(51)%7<ifelse(Pos Y>-40,5,3)))
trigger2 = var(59)=2&&Power>=2000&&prevstateno=410
trigger3 = (P2BodyDist X=[-80,ceil(100*const(size.xscale)-const(size.air.front))])&&enemynear,backedgebodydist<=5&&P2bodydist X<30&&random%4<ifelse(var(12)<0&&var(40)=-1,0,3)&&var(7)=20
value = 1400

[state 1050]
type = ChangeAnim
trigger1 = Time=26
value = 1200

[state 1050]
type = VelAdd
trigger1 = Anim=1200&&AnimElem=1,>0
y = .2

[state 1050]
type = VelSet
trigger1 = Time=ifelse(var(7)=20,43,ifelse(!var(7),44,39))
x = 0

[state 1050]
type = VarSet
trigger1 = Time=ifelse(var(7)=20,43,ifelse(!var(7),44,39))
fvar(8) = 0

[state 1050]
type = ChangeState
trigger1 = Time=ifelse(var(7)=20,43,ifelse(!var(7),44,39))
value = 50
ctrl = 1

[state 1050]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
value = 52

;弩九・急止
[statedef 1200]
type = U
movetype=I
physics = N
ctrl = 0
velset = 0,0
velset = ifelse(fvar(9),fvar(9)*0,0),Vel Y

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1200

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 200]
type = StopSND
trigger1 = !time
channel = 11

[state 2000]
type = PlaySND
trigger1 = !time
value = 30,11

[state 1050]
type = VelSet
trigger1 = !Time
x = ifelse(fvar(8)<0,3,-3)
y = 0

[state 1050]
type = VarSet
trigger1 = !Time
fvar(8) = ifelse(fvar(8)<0,3,-3)

[state 1050]
type = VelSet
trigger1 = AnimTime=0
x = 0

[state 1050]
type = VarSet
trigger1 = AnimTime=0
fvar(8) = 0

[state 1050]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;弩九：回転
[statedef 1300]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(8)>const(velocity.runjump.fwd.x)||fvar(8)<const(velocity.runjump.back.x),0,fvar(8)),0

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 1320]
type = VarSet
trigger1 = !time&&(fvar(8)>const(velocity.runjump.fwd.x)||fvar(8)<const(velocity.runjump.back.x))
fvar(8) = 0

[state 1320]
type = VarSet
trigger1 = !time&&(!var(11)||(fvar(10)=98&&(prevstateno!=[1320,1321])))
fvar(9) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1300

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper&&!(((prevstateno=[600,620])||(prevstateno=[1320,1344])||(prevstateno=[1650,1660]))&&var(11))
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

[state 200]
type = StopSND
trigger1 = !time
channel = 11

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=2&&random%3=0
value = 10,6
channel = 1

[state 200]
type = PlaySND
trigger1 = AnimElem=2&&!IsHelper
value = 7300,2
channel = 10

;炎エフェクト1
[state 6150]
type = Explod
trigger1 = AnimElem=1
id = 6000
anim= 6000
pos = -floor(104*const(size.xscale)),floor(0*const(size.yscale))
postype = p1
sprpriority = 0
ignorehitpause=1
pausemovetime = 99999
supermovetime = 99999
vel = const(size.xscale)*1.0,const(size.yscale)*-2.0
accel = const(size.xscale)*0,const(size.yscale)*-.5
scale = const(size.xscale)*2,const(size.yscale)*2

;軌跡エフェクト
[state 6150]
type = Explod
trigger1 = AnimElem=3
id = 6020
anim= 6020
pos = floor(40*const(size.xscale)),floor(0*const(size.yscale))
postype = p1
sprpriority = 0
ignorehitpause=1
pausemovetime = 99999
supermovetime = 99999
scale = const(size.xscale)*2,const(size.yscale)*2

[state 1300]
type = null;PosAdd
trigger1 = AnimElem=5
x = -floor(40*const(size.xscale))
y = -floor(40*const(size.yscale))

[state 1300]
type = null;PosAdd
trigger1 = AnimElem=6
x = -floor(40*const(size.xscale))
y = floor(20*const(size.yscale))

[state 1300]
type = PosAdd
trigger1 = AnimElem=7
x = -floor(20*const(size.xscale))

[state 1300]
type = PosAdd
trigger1 = AnimElem=8
x = -floor(40*const(size.xscale))

[state 1300]
type = PosAdd
trigger1 = AnimElem=9
x = -floor(40*const(size.xscale))

[state 1300]
type = varset
trigger1 = movehit=1
var(13) = 0

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

;~~~~~~~~~~~
;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && !var(59)
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,0))

;２段ジャンプ、２段ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && !var(59)
var(53) = ifelse(var(0)%ifelse(var(0)>=1000,1000,100)<10&&command="longjump",50+ifelse(command="holdfwd",1,ifelse(command="holdback",2,0)),ifelse(command="up"&&var(0)<200,40,ifelse(command="fwdup",41,ifelse(command="backup",42,0))))
;~~~~~~~~~~~~~~~~~~~^

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=3,>=0&&AnimElem=7,<0
damage = ifelse(floor(61*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(61*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(1)%16<8,-12.0*(1.0+ifelse(var(2)>31,31,var(2))*.050),-11)-.0013,ifelse(var(6)%10>0,4,-12.0)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(1)%16<8,-12.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),57+13,40-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Hard
ground.type = High
attr = A,SA
hitflag = MAFD
guardflag = MA
palfx.time=46
palfx.sinadd = 96,48,0,4
palfx.color = 0
palfx.add = 56,-96,-208
palfx.invertall = 1
persistent=0

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=3,>=0&&AnimElem=7,<0&&var(1)%4>=2
damage = ifelse(floor(61*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(61*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22))
ground.slidetime = 17+(P2statetype=C)
ground.hittime = 17+(P2statetype=C)
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13+var(49)*7
ground.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(1)%16<8,-5.0-.0013,-11),ifelse(var(6)%10>0,4,-12.0)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(1)%16<8,-9.0*const(size.xscale)-.0013,-12.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013),ifelse(var(6)%10>0,var(6)%10*1.5,-8.0*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),57+13,40-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(33*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(33*fvar(0)/fvar(2)*.8)*1.3,ceil(33*fvar(0)/fvar(2)*.8*1.0/8)*1.3
fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Hard
ground.type = High
attr = A,SA
hitflag = MAFD
guardflag = MA
palfx.time=46
palfx.sinadd = 96,48,0,4
palfx.color = 0
palfx.add = 56,-96,-208
palfx.invertall = 1
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=7
value = 0

;==壁バウンド
[state 920]
type = varAdd
trigger1 = (movehit=[1,5])&&numtarget&&var(6)%10<1
trigger1 = target,time=0
var(1) = ifelse(var(1)%16<8,4+8,0)-(var(1)%16>=8&&var(1)%8>=4)*4-(var(1)%2>=1)*1
ignorehitpause=1
persistent=0

[state 920]
type = targetstate
trigger1 = (movehit=[1,5])&&numtarget&&var(1)%8>=4
trigger1 = target,time=0
value = 938+(var(1)%4>=2)
ignorehitpause=1
persistent=0

[state -2]
type = null;VelAdd
trigger1 = vel Y!=0 && var(52)<=0
y = .9*const(size.yscale)
ignorehitpause=1

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && var(1)%2<1 && movecontact=1
trigger2 = numhelper(3107) && movecontact=1
trigger2 = helper(3107),stateno=3108
y = -8.0*const(size.yscale)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(61*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),61*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=3
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=3,>=0&&AnimElem=5,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,50]),10,-10)+10

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=3,>=0&&AnimElem=4,<0
var(18) = floor(-120*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
var(18) = floor(-175*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-220*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(18) = floor(-240*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-18.0*1.5*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.5+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

;強制基底補正90%
[state -1]
type = varadd
trigger1 = movehit=1 && numtarget && var(8)%16<8 && var(8)%4<2 && var(8)%2<1 && var(8)%8<4
var(8) = 8
ignorehitpause=1

[state 1050]
type = VelSet
trigger1 = AnimElem=1
x = 18.0

[state 1050]
type = VelSet
trigger1 = AnimElem=3
x = 0+ifelse(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||(P2stateno=927&&P2movetype=H),fvar(5),0)

[state 1050]
type = VelAdd
trigger1 = AnimElem=13,>0
y = .5

[state 1050]
type = VarSet
trigger1 = AnimElem=1
fvar(8) = 18.0

[state 1050]
type = VarSet
trigger1 = AnimElem=3
fvar(8) = 0

[state 1300]
type = ChangeState
trigger1 = Vel Y>0&&Pos Y>=-Vel Y
value = 52

[state 1300]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;弩九・落下
[statedef 1400]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = VarSet
trigger1 = !time
var(10) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1400

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 1320]
type = VarSet
trigger1 = !time
fvar(8) = 0

;そらよ！
[state 1050]
type = playsnd
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&Anim=1400&&AnimElem=5
value = 10,39
channel = 1

[state 1400]
type = VelSet
trigger1 = Anim=1400&&AnimElem=5
y = 6.0

[state 1400]
type = VelAdd
trigger1 = Anim=1400&&AnimElem=5,>0
y = .5

[state 200]
type = ChangeAnim
trigger1 = Anim=1400&&Vel Y>0&&Pos Y>=-Vel Y
value = 1410

[state 200]
type = varset
trigger1 = Anim=1410 && AnimElem=1
var(13) = 0

;どうだ！
[state 1050]
type = playsnd
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&Anim=1410&&AnimElem=1
value = 10,38
channel = 1

[state 190]
type = PlaySND
trigger1 = Anim=1410&&AnimElem=1
value = 5100,2

[state 195]
type = EnvShake
trigger1 = Anim=1410&&AnimElem=1
ampl = 4
time = 16

;岩
[State 40, 1]
type = Helper
trigger1 = Anim=1410&&AnimElem=1
id = 6925
stateno = 6920
pos = floor(0*const(size.xscale)),0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999

;エフェクト
[state 190]
type = Helper
trigger1 = Anim=1410&&AnimElem=1
id  = 6401
stateno=6400
name = "fx"
pos = 0,0
postype = P1
ignorehitpause=1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 0

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
triggerall = Anim=1410
trigger1 = AnimElem=1
damage = floor(ifelse(52*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)<1,1+(var(2)%5=4),ceil(52*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)))*1.22),floor(ceil(52*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 17+(P2statetype=C)*5+var(49)*7
ground.hittime = 17+(P2statetype=C)*5+var(49)*7
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,17
ground.velocity = -15.0*ifelse(p2dist X<0,-1,1)*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-9.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0017,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-8.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),41+17,24-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+17)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(50*fvar(0)/fvar(2))*1.3*fvar(16))),floor(ifelse(var(9),0,ceil(50*fvar(0)/fvar(2)*1.0/8)*1.3*fvar(16)))
givepower = floor(50*fvar(0)/fvar(2)*.8)*1.3,ceil(50*fvar(0)/fvar(2)*.8*1.0/8)*1.3
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = hard
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = HA
palfx.time=ifelse(P2statetype=A,41,34+(var(49)!=0)*7)
palfx.sinadd = 96,48,0,4
palfx.color = 0
palfx.add = 56,-96,-208
palfx.invertall = 1

[state 200]
type = AttackDist
trigger1 = Anim=1410&&AnimElem=2
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&Anim=1410
fvar(15) = .00005*floor(ifelse(52*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=4),ceil(52*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*ifelse(var(1)%4>=2,.5,1.0)))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
triggerall = Anim=1410
trigger1 = AnimElem=1
var(16) = 10+random%6

;X座標
[state 240]
type = VarSet
trigger1 = Anim=1410&&AnimElem=1,>=0&&AnimElem=2,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,50]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Anim=1410&&AnimElem=1,>=0&&AnimElem=2,<0
var(18) = floor(-20*const(size.yscale))

;・・・・自分側ヒットバック・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2&&statetype!=A
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2&&statetype!=A
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2&&statetype!=A
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C)*5)
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2&&statetype!=A
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = 0;(0-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = VelSet
trigger1 = Anim=1410&&AnimElem=1
y = 0

[state 200]
type = PosSet
trigger1 = Anim=1410&&AnimElem=1
y = 0

[state 200]
type = StatetypeSet
trigger1 = Anim=1410&&AnimElem=1
statetype=S
physics =S

[state 200]
type = ChangeState
trigger1 = Anim=1410&&AnimTime=0
value = 0
ctrl = 1

;カラクリ兵器生産要請
[statedef 1500]
type = S
movetype= I
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
anim = 1500

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;プレイヤー用カラクリ兵器種類指定
[state 1000]
type = VarSet
trigger1 = Time=0 && !var(59)
var(7) = ifelse((command="z"||var(53)=1502)&&floor(var(43)/1000)>=100,2,ifelse((command="y"||var(53)=1501)&&floor(var(43)/1000)>=50,1,0))

;AI用カラクリ兵器種類指定
[state 1000]
type = VarSet
trigger1 = Time=0 && var(59)
var(7) = ifelse(var(37)>=9999&&(roundstate=3||life>const(data.life)*.75)&&floor(var(43)/1000)>=100&&random%7<5,2,ifelse(var(37)>=5000&&floor(var(43)/1000)>=50,1,0))

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&(prevstateno!=[130,154])
var(56) = 0

[state 220]
type = varadd
trigger1 = var(56)<80&&((ifelse(var(7)=2,command="hold_z",ifelse(var(7)=1,command="hold_y",command="hold_x"))&&command="hold_a"&&!var(59))||(random<0&&var(59)))
trigger1 = (anim=1505&&var(56))||(Anim=1500 &&animelemtime(5)=0&&!var(56))
var(56) = 1

[state 220]
type = ChangeAnim
trigger1 = anim=1500&&animelemtime(5)=0&&var(56)&&var(56)<=80
trigger1 = ((ifelse(var(7)=2,command="hold_z",ifelse(var(7)=1,command="hold_y",command="hold_x"))&&command="hold_a"&&!var(59))||(random<0&&var(59)))
value = 1505
persistent=0

[state 220]
type = ChangeAnim
trigger1 = Anim=1505 && (!ifelse(var(7)=2,command="hold_z",ifelse(var(7)=1,command="hold_y",command="hold_x"))||command!="hold_a"||var(56)>=80)&&var(56)
value = 1500
elem = 5
persistent=0

;~~~~~

;小判エフェクト
[state -2]
type = Helper
trigger1 = AnimElem=5&&roundstate=2
id = 18600
stateno=18600
pos = floor(40*const(size.xscale)),-floor(200*const(size.yscale))
postype = P1
ownpal = 1
facing=1
pausemovetime=999999
supermovetime=999999
ignorehitpause = 1

[state 1320]
type = VarAdd
trigger1 = AnimElem=5&&roundstate=2
var(37) = -ifelse(var(7)=2,9999,ifelse(var(7)=1,5000,2000))+var(56)

[state 1000]
type = VarSet
trigger1 = AnimElem=5
fvar(23) = floor(ifelse(var(7)=2,2100,ifelse(var(7)=1,1800,1200))*(1.0+floor(var(43)/1000)*.0015+var(56)*.0015)*1.22)

[state 1000]
type = VarSet
trigger1 = AnimElem=5
var(12) = floor(ifelse(var(7)=2,-10001-840,ifelse(var(7)=1,-2001-720,-1-600))+(floor(var(43)/1000)=[50,99])*300+var(56))

[state 1000]
type = varset
triggerall = AnimElem=5
trigger1 = numpartner||(teammode=turns)
var(12) = (var(12)+ifelse(var(7)=2,10001,ifelse(var(7)=1,2001,1)))*.5-ifelse(var(7)=2,10001,ifelse(var(7)=1,2001,1))

[state 1000]
type = varset
triggerall = AnimElem=5
trigger1 = numpartner||(teammode=turns)
fvar(23) = floor(ifelse(var(7)=2,1800,ifelse(var(7)=1,1500,1250))*(1.2+floor(var(43)/1000)*.003+var(56)*.001))

[state -2]
type = varset
trigger1 = AnimElem=5
fvar(24) = 1.0
ignorehitpause = 1

;デバッグ用
[state 1500,debug]
type = VarSet
trigger1 = 0;AnimElem=5
var(12) = floor(ifelse(var(7)=2,-10001-10,ifelse(var(7)=1,-2001-10,-1-10)))

;デバッグ用
[state 1500,debug]
type = VarSet
trigger1 = 0;AnimElem=5,>=0
var(40) = 1

[state 1320]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&Anim=1500&&AnimElem=4
value = 10,48+var(7)
channel = 1
persistent = 0

[state 1320]
type = ChangeState
trigger1 = Anim=1500&&AnimTime=0
value = 0
ctrl = 1

;カラクリ兵器自爆要請
[statedef 1600]
type = S
movetype=I
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
anim = 1600

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 200]
type = VarSet
trigger1 = Time=0&&(prevstateno!=[5000,5099])
var(33) = 0

[state 200]
type = VarAdd
trigger1 = !time
var(37) = floor((var(12)-ifelse(var(12)>=10001,10001,ifelse(var(12)>=2001,2001,1)))*ifelse(var(12)>=10001,9999,ifelse(var(12)>=2001,5000,2000))*.5/fvar(23))

[state 200]
type = VarSet
trigger1 = !time
fvar(23) = 90018

[state 200]
type = VarAdd
trigger1 = time
fvar(23) = -1

;小判エフェクト
[state -2]
type = Helper
trigger1 = AnimElem=1&&roundstate=2&&numhelper(20000)
id = 18600
stateno=18600
pos = -floor(helper(20000),rootdist x),-floor(180*const(size.yscale))
postype = P1
ownpal = 1
facing=1
pausemovetime=999999
supermovetime=999999
ignorehitpause = 1

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;ブースト(吹き飛ばし攻撃後)
[statedef 2000]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,ifelse(pos Y<0,vel Y,0)
anim = 2000

;ブーストエフェクト
[state 2000]
type = Helper
trigger1 = !time
id = 7720
stateno=7720
pos = 0,floor(-160*const(size.yscale))
postype = p1
pausemovetime=999
supermovetime=999
ownpal = 1
sprpriority = 2
ignorehitpause=1

[state 2000]
type = PlaySND
trigger1 = !time
value = 2000,0
volume = 255

[State 0, AfterImage]
type = AfterImage
trigger1 = !time
time=24
length = 5
palbright = 0,0,0
palcontrast = 256,256,256
palpostbright = -30,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 1
framegap = 2
trans = AddAlpha
alpha = 128,128

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = !time||(fvar(10)=[32,40])
time = 1
add = ifelse(fvar(10)<32,255,floor(fvar(10)-32)*32),ifelse(fvar(10)<32,255,floor(fvar(10)-32)*32),ifelse(fvar(10)<32,255,floor(fvar(10)-32)*32)

;ブースト
[state 2000]
type = varadd
trigger1 = !time
var(6) = 100*(!floor(var(6)%1000/100))+1000*(var(1)%2<1&&!floor(var(6)%10000/1000))

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = !time
var(9)=ifelse(var(9)>=10000,12000-floor(var(9)/100)*100,12000)

;ヒットバック0
[state 900]
type = VarSet
trigger1 = !time
fvar(5) = 0

[state 2000]
type = PosAdd
trigger1 = time=0
x = -13.0

[state 2000]
type = VelSet
trigger1 = time=0
x = 13.0
y = ifelse(vel Y<0,-4,0)

[state 2000]
type = StatetypeSet
trigger1 = Pos Y<0
statetype=A
physics = N

[state 2000]
type = StatetypeSet
trigger1 = Pos Y>=0
statetype=S
physics = N

[state 2000]
type = Gravity
trigger1 = time>=2&&statetype=A

;現在の速度
[state 2000]
type = VarSet
trigger1 = !time
fvar(8) = 0

;ブースト速度
[state 2000]
type = VarSet
trigger1 = !time
fvar(9) = 13.0

;ブースト時間
[state 2000]
type = VarSet
trigger1 = !time
fvar(10) = 40

[state 200]
type = VarAdd
trigger1 = !Time&&var(53)>2000
var(53) = -2000

[state 2000]
type = ChangeState
trigger1 = !time&&(var(53)=40||var(53)=50)
value = 40

[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 2000]
type = ChangeState
trigger1 = time>=4
trigger1 = !fvar(10)||(P2bodydist X<=0&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
trigger2 = time>=30
value = 0
ctrl = 1

;ガードキャンセル攻撃
[statedef 2500]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 2500
poweradd =-1000

;ガードゲージ減少
[state 2000]
type = VarAdd
trigger1 = Time=0
var(23)=ifelse(var(23)<=128,-var(23)+1,-128)

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = 1
var(9)=ifelse((var(9)=[1,999]),420-var(9),420)

[state 2000]
type = PalFX
trigger1 = Time=[0,7]
add = 255-32*time,255-32*time,255-32*time
time = 1

[state 900]
type = PlaySND
trigger1 = Time=0
value = 2500,0

[state 2000]
type = HitBy
trigger1 = Time=[0,13]
value = ,AT

[state 190]
type = PlaySND
trigger1 = AnimElem=5
value = 7300,2
channel = 10


;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 15

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = AnimElem=6
damage = floor(ifelse(40*fvar(0)<1,1+(var(2)%5=4),40*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7;15,14
ground.velocity = -18*const(size.xscale),-5*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -18*const(size.xscale),ifelse(var(6)%10>0,var(6)%10*1.5,-5*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,5
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = High
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
kill = 0
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=7
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&hitpausetime=ifelse(var(49)&&var(2)=1,14,12)
fvar(15) = .00005*floor(ifelse(40*fvar(14)<1,1+(var(2)%5=1),40*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,50]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(18) = floor(-180*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = (-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 2000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;五羅：一撃
[statedef 3000]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time&&(prevstateno!=[5000,5099])

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Anim!=[3000,3005]
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3000

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = 1
var(9)=ifelse((var(9)=[1,999]),420-var(9),420)

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&Anim=3000 && AnimElem=1,=1&&var(46)=1
value = ,AP
time=43

[state 200]
type = pause
trigger1 = !IsHelper&&Anim=3000 &&AnimElem=1&&!var(46)
time = 43
movetime = 43
persistent = 0

[state 200]
type = helper
trigger1 = !IsHelper&&Anim=3000 &&AnimElem=1&&!var(46)
id = 7560
stateno = 7560
pos = 0,floor(-180*const(size.yscale))
postype = P1
pausemovetime=43+999
ownpal = 1

[state -2]
type = poweradd
trigger1 = !IsHelper&&Anim=3000 &&(prevstateno!=[5000,5099])&&AnimElem=1&&!var(46)
value = -1000
persistent=0

;BASARA Moves Finish
[state 3510]
type = Helper
trigger1 = (movehit=[1,3]) && ((!enemynear,alive && roundstate=3)||WinKO) && !numhelper(8800) && !numexplod(60000)
id  = 8800
stateno=8800
pos = 0,0
postype = left
scale = const(size.xscale),const(size.yscale)
persistent=0
ignorehitpause=1

;KO
[state 3500]
type = explod
trigger1 = (movehit!=[1,3]) && WinKO && !numexplod(60000)
id = 60000
anim = 90000
name="ko"
ownpal = 1
removetime=-1
facing=facing
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = !numhelper(15900)&&!IsHelper
trigger1 = time=1
id = 15900
stateno=15900
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;腹ぁ決めろー！
[State 40, 1]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&Anim=3000 && AnimElem=1,=1
value = 10,42
channel = 1

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&(prevstateno!=[130,154])&&(prevstateno!=[5000,5099])
var(7) = 0

[state 220]
type = varadd
triggerall = time>=var(48)
trigger1 = var(7)<59&&((command="hold_z"&&!var(59))||(p2stateno=105&&enemynear,time<16&&var(59)))
trigger1 = (anim=3005&&var(7))||(Anim=3000 &&animelemtime(3)=0&&!var(7))
var(7) = 1

[state 220]
type = ChangeAnim
trigger1 = anim=3000&&animelemtime(3)=0&&var(7)&&var(7)<=59
trigger1 = ((command="hold_z"&&!var(59))||(p2stateno=105&&enemynear,time<16&&var(59)))
value = 3005
persistent=0

[state 220]
type = ChangeAnim
trigger1 = Anim=3005 && ((command!="hold_z"&&!var(59))||(!(p2stateno=105&&enemynear,time<16)&&var(59))||var(7)>=59)&&var(7)
value = 3000
elem = 4
persistent=0

[state 220]
type = playsnd
triggerall = var(7)>0 && var(7)%14=1
trigger1 = anim=3005
value = 30,11
channel = 12

;溜めエフェクト
[state -2]
type = Helper
trigger1 = var(7)%8=1 &&anim=3005
id = 7770
stateno=7770
pos = 0,0
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999
;~~~~~

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)
var(46) = 1

;経過時間
[state 1610]
type = varset
trigger1 = time>0&&time>=var(48)
trigger1 = anim=3005&&var(46)=41
var(46) = 35

[state 1610]
type = varset
trigger1 = time>0&&time>=var(48)
trigger1 = var(46)<41&&anim=3000&animelem=4,>=0
var(46) = 41

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=1&&AnimElemNo(0)!=AnimElemNo(-1)&&(var(46)=[1,34])
value = 3000
elem = 1

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=2&&AnimElemNo(0)!=AnimElemNo(-1)&&(var(46)=[35,37])
value = ifelse(Anim=3005,3005,3000)
elem = ifelse(Anim=3005,1,2)

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=3&&AnimElemNo(0)!=AnimElemNo(-1)&&(var(46)=[38,40])
value = ifelse(Anim=3005,3005,3000)
elem = ifelse(Anim=3005,2,3)

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=4&&AnimElemNo(0)!=AnimElemNo(-1)&&(var(46)=[41,43])
value = 3000
elem = 4

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=5&&AnimElemNo(0)!=AnimElemNo(-1)&&(var(46)=[44,47])
value = 3000
elem = 5

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=6&&AnimElemNo(0)!=AnimElemNo(-1)&&(var(46)=[48,51])
value = 3000
elem = 6

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=7&&AnimElemNo(0)!=AnimElemNo(-1)&&(var(46)=[52,55])
value = 3000
elem = 7

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=8&&AnimElemNo(0)!=AnimElemNo(-1)&&(var(46)=[56,59])
value = 3000
elem = 8

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=9&&AnimElemNo(0)!=AnimElemNo(-1)&&(var(46)=[60,62])
value = 3000
elem = 9

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=10&&AnimElemNo(0)!=AnimElemNo(-1)&&(var(46)=[63,66])
value = 3000
elem = 10

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = anim
elem = AnimElemNo(0)

[state 1610]
type = PosFreeze
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = 1
;----------

;エフェクト1
[state -2]
type = Explod
trigger1 = !numExplod(6200)&&((Anim=3000 && AnimElem=3)||Anim=3005) && time>=var(48)
id = 6200
anim=6200
pos = -floor(60*const(size.xscale)),-floor(142*const(size.yscale))
postype = P1
ownpal = 1
sprpriority = 3
removetime = -1
removeongethit = 1
bindtime= -1
scale = const(size.xscale),const(size.yscale)
pausemovetime=999999
supermovetime=999999

;しゃらくせえ！
[State 40, 1]
type = PlaySND
trigger1 = Anim=3000 && AnimElem=4
value = 10,10
channel = 1
lowpriority = 1

[State 40, 1]
type = PlaySND
trigger1 = Anim=3000 && AnimElem=4
value = 30,11
channel = 10

[state -2]
type = RemoveExplod
trigger1 = Anim=3000 && AnimElem=4 && numExplod(6200)
id = 6200

;エフェクト1
[state -2]
type = Explod
trigger1 = Anim=3000 && AnimElem=5 && time>=var(48)
id = 6201
anim=6201
pos = floor(88*const(size.xscale)),-floor(192*const(size.yscale))
postype = P1
ownpal = 1
sprpriority = 3
removeongethit = 1
bindtime=-1
scale = const(size.xscale),const(size.yscale)
pausemovetime=999999
supermovetime=999999

;エフェクト2
[state -2]
type = Explod
trigger1 = Anim=3000 && AnimElem=5 && time>=var(48)
id = 6210
anim=6210
pos = floor(160*const(size.xscale)),-floor(192*const(size.yscale))
postype = P1
ownpal = 1
sprpriority = 3
removeongethit = 1
bindtime=-1
scale = const(size.xscale)*3.0,const(size.yscale)*3.0
pausemovetime=999999
supermovetime=999999

;受け身可能状態判別
[state 200]
type = VarSet
trigger1 = movehit=1&&numtarget
trigger1 = target,time=0
var(36) = 1
ignorehitpause=1

[state 200]
type = statetypeset
trigger1 = Anim=3000&&AnimElem=2
physiscs = N

[state 200]
type = statetypeset
trigger1 = Anim=3000&&AnimElem=5
physiscs = S

;現在の速度取得
[state 900]
type = VarSet
trigger1 = Anim=3000&&AnimElem=1,=36
trigger2 = Anim=3000&&AnimElem=4,=0&&var(7)
fvar(8) = 4.0+ifelse(var(7)>=12,floor(var(7)/10)*6,0)

[state 900]
type = VarSet
trigger1 = Anim=3000&&AnimElem=1,>36
fvar(8) = fvar(8)*.8

[state 900]
type = VarSet
trigger1 = !time
trigger2 = Anim=3000&&AnimElem=7
fvar(8) = 0

[state -2]
type = velset
trigger1 = Anim=3000&&animelem=1,>=36 && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||(P2stateno=927&&P2movetype=H)))
x = fvar(8)+fvar(9)

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = !movecontact && !movereversed
trigger1 = Anim=3000 && AnimElem=5,>=0&&AnimElem=6,<0
damage = ceil(floor(80*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0)))*1.22),ceil(floor(80*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,0
ground.velocity = 0*const(size.xscale),(-21.0-.9)*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050),ifelse(var(6)%10>0,-8,0)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-21.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,ifelse(var(36),1,0))
fall.recovertime = ifelse(var(49)&&!var(2),42+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = up
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = MA
palfx.time=56-(var(6)%10>0)*40
palfx.sinadd = 96,48,0,4
palfx.color = 0
palfx.add = 56,-96,-208
palfx.invertall = 1

[state 200]
type = AttackDist
trigger1 = Anim=3000 && AnimElem=6
value = 0

;強制停止中に動かないように
[state -2]
type = PosFreeze
triggerall = Anim=3000
trigger1 = (AnimElem=1,>0&&AnimElem=1,<=30)
trigger2 = NumHelper(7560)
trigger2 = helper(7560),time<30
value = 1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(80*fvar(14)<1,1+(var(2)%5=1),80*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 10+random%6
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,50]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(18) = floor(-140*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0&&!(var(6)%10<1&&var(3))
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (0-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Anim!=3005 && AnimTime=0
value = 0
ctrl = 1

;五羅：二撃
[statedef 3010]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 100]
type = MoveHitReset
trigger1 = !time&&(!var(46)||prevstateno=3000)

[state 200]
type = ChangeAnim
trigger1 = Anim!=[3010,3015]
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3010

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&(prevstateno!=[130,154])&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(7) = 0

[state 220]
type = varadd
triggerall = Time>=var(48)
trigger1 = ((command="hold_z"&&!var(59))||(var(59) && (var(7)<15||P2bodydist Y<=ifelse(var(59)=2&&var(40)=1&&(var(12)=[2001,5000]),-60,-30))))
trigger1 = (anim=3015&&var(7))||(Anim=3010 &&animelemtime(3)=0&&!var(7))
var(7) = 1

[state 220]
type = ChangeAnim
triggerall = Time>=var(48)
trigger1 = anim=3010&&animelemtime(3)=0&&var(7)
trigger1 = ((command="hold_z"&&!var(59))||(var(59) && (var(7)<15||P2bodydist Y<=ifelse(var(59)=2&&var(40)=1&&(var(12)=[2001,5000]),-60,-30))))
value = 3015
persistent=0

[state 220]
type = ChangeAnim
triggerall = Time>=var(48)
trigger1 = Anim=3015 && (((command!="hold_z"&&!var(59))||(var(59) && var(7)>=15 && P2bodydist Y>ifelse(var(59)=2&&var(40)=1&&(var(12)=[2001,5000]),-60,-30))))&&var(7)
value = 3010
elem = 3
;persistent=0

[state 220]
type = playsnd
triggerall = Time>=var(48)
triggerall = var(7)>0 && var(7)=8
trigger1 = anim=3015
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)
value = 10,11
channel = 1
persistent=0

[state 220]
type = playsnd
triggerall = Time>=var(48)
triggerall = var(7)>0 && var(7)%8=1
trigger1 = anim=3015
value = 30,12
channel = 12

;溜めエフェクト
[state -2]
type = Helper
triggerall = Time>=var(48)
trigger1 = var(7)%6=1 &&anim=3015
id = 7770
stateno=7770
pos = 0,0
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999
;~~~~~

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)
var(46) = 1

;経過時間
[state 1610]
type = varset
trigger1 = time>0&&time>=var(48)
trigger1 = anim=3015&&var(46)=5
var(46) = 1

[state 1610]
type = varset
trigger1 = time>0&&time>=var(48)
trigger1 = var(46)<5&&anim=3010&animelem=3,>=0
var(46) = 5

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&var(46)<=37&&!time
value = ifelse(var(46)<5,anim,3010)
elem =ifelse(AnimElemNo(0)<4&&var(46)>=36,4,ifelse(AnimElemNo(0)<3&&var(46)>=5,3,ifelse(AnimElemNo(0)<2&&var(46)>=3,2,ifelse(AnimElemNo(0)<1&&var(46)>=1,1,AnimElemNo(0)))))

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&var(46)<=49&&!time
value = ifelse(var(46)<5,anim,3010)
elem = ifelse(AnimElemNo(0)<9&&var(46)>=46,9,ifelse(AnimElemNo(0)<8&&var(46)>=44,8,ifelse(AnimElemNo(0)<7&&var(46)>=42,7,ifelse(AnimElemNo(0)<6&&var(46)>=40,6,ifelse(AnimElemNo(0)<5&&var(46)>=38,5,AnimElemNo(0))))))

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&var(46)<=59&&!time
value = ifelse(var(46)<5,anim,3010)
elem = ifelse(AnimElemNo(0)<14&&var(46)>=58,14,ifelse(AnimElemNo(0)<13&&var(46)>=56,13,ifelse(AnimElemNo(0)<12&&var(46)>=54,12,ifelse(AnimElemNo(0)<11&&var(46)>=52,11,ifelse(AnimElemNo(0)<10&&var(46)>=50,10,AnimElemNo(0))))))

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&var(46)<=66&&!time
value = ifelse(var(46)<5,anim,3010)
elem = ifelse(AnimElemNo(0)<17&&var(46)>=64,17,ifelse(AnimElemNo(0)<16&&var(46)>=62,16,ifelse(AnimElemNo(0)<15&&var(46)>=60,15,AnimElemNo(0))))

[state 1610]
type = ChangeAnim
trigger1 = Time<var(48) && (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = anim
elem = AnimElemNo(0)

[state 1610]
type = PosFreeze
trigger1 = Time<var(48) && (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = 1

;~~~~~~~~~~~~~~

[state -2]
type = varset
trigger1 = !(enemynear,pos Y<-110||(enemynear,vel Y>0&&enemynear,pos Y>=-enemynear,vel Y)||var(6)%10>0||(P2statetype!=A&&!var(2))) && (anim=3015||animelemtime(9)<0) && (AnimElem=3||var(46)=5)
var(36) = 0

[state -2]
type = varset
trigger1 = (enemynear,pos Y<-110||(enemynear,vel Y>0&&enemynear,pos Y>=-enemynear,vel Y)||var(6)%10>0||(P2statetype!=A&&!var(2))) && (anim=3015||animelemtime(9)<0) && (AnimElem=3||var(46)=5)
var(36) = 2

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&Anim=3010 && (AnimElem=3,=1||var(46)=6) && var(36)!=2 && Time>=var(48)
value = ,AP
time=42

[state 200]
type = pause
trigger1 = !IsHelper&&Anim=3010 &&(AnimElem=3||var(46)=5) && var(36)!=2 && Time>=var(48)
time = 41
movetime = 41
persistent = 0

[state 200]
type = helper
trigger1 = !IsHelper&&Anim=3010 &&(AnimElem=3||var(46)=5) && var(36)!=2 && Time>=var(48)
id = 7560
stateno = 7560
pos = floor(55*const(size.xscale)),floor(-110*const(size.yscale))
postype = P1
pausemovetime=41+999
ownpal = 1

[State 40, 1]
type = ChangeAnim
trigger1 = Anim=3010 && ((AnimElem=3,=2)||var(46)=7) && !numhelper(7560) && var(36)=2 && Time>=var(48)
value = 3010
elem = 4

;半端じゃねぇぞ！
[State 40, 1]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&Anim=3010 && ((AnimElem=3,=1)||var(46)=6) && var(36)!=2
value = 10,41
channel = 1

[State 40, 1]
type = PlaySND
trigger1 = Anim=3010 && AnimElem=8 && Time>=var(48)
value = 30,12
channel = 10

;エフェクト
[state -2]
type = Explod
trigger1 = Anim=3010 && AnimElem=6 && var(36)!=2 && Time>=var(48)
id = 6250
anim = 6250
pos = -floor(40*const(size.xscale)),-floor(20*const(size.yscale))
postype = P1
ownpal = 1
sprpriority = 3
bindtime = -1
scale = const(size.xscale)*2.0,const(size.yscale)*2.0
pausemovetime=999999
supermovetime=999999
ignorehitpause = 1

;爆発エフェクト
[state -2]
type = Explod
trigger1 = Anim=3010 && AnimElem=11 && movehit && Time>=var(48)
id = 6300
anim=6300
pos = floor(180*const(size.xscale)),-floor(180*const(size.yscale))
postype = P1
ownpal = 1
sprpriority = 4
scale = const(size.xscale)*4,const(size.yscale)*4
pausemovetime=999999
supermovetime=999999
ignorehitpause = 1

;どうだぃ！
[State 40, 1]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&Anim=3010 && AnimElem=10 && movehit
value = 10,44
channel = 1
persistent = 0

;追加攻撃
[state -2]
type = Helper
trigger1 = anim=3010 && Movehit && NumExplod(6300) && AnimElem=12 && P2bodydist Y>-35 && Time>=var(48)
id = 3050
stateno=3050
pos = floor(180*const(size.xscale)),-floor(180*const(size.yscale))
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999
ignorehitpause=1

;BASARA Moves Finish
[state 3510]
type = Helper
trigger1 = numhelper(3050) && !numhelper(8800) && !numexplod(60000)
trigger1 = helper(3050),movehit=1 && !enemynear,alive && roundstate=3
trigger2 = (movehit=[1,2]) && !enemynear,alive && roundstate=3 && !numhelper(8800) && !numexplod(60000)
id  = 8800
stateno=8800
pos = 0,0
postype = left
scale = const(size.xscale),const(size.yscale)
persistent=0
ignorehitpause=1

;KO
[state 3500]
type = explod
trigger1 = WinKO && !numexplod(60000)
id = 60000
anim = 90000
name="ko"
ownpal = 1
removetime=-1
facing=facing
ignorehitpause=1

;失敗
[state 200]
type = ChangeAnim
trigger1 = Anim=3010&&AnimTime=0&&!movehit
value = 3011
ignorehitpause=1
persistent=0

;おいっ！？
[State 40, 1]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&Anim=3011 && AnimElem=1
value = 10,32
channel = 1
persistent = 0

;つば
[state 200]
type = Explod
trigger1 = Anim=3011&&AnimElem=2
id = 3501
anim = 3501
pos = 0,0
postype = P1
ownpal = 1
sprpriority = 2
scale = const(size.xscale),const(size.yscale)

[state 200]
type = statetypeset
trigger1 = Anim=3000&&AnimElem=3
physiscs = N

[state 200]
type = statetypeset
trigger1 = Anim=3000&&AnimElem=9
physiscs = S

;現在の速度取得
[state 900]
type = VarSet
trigger1 = Anim=3010&&AnimElem=3,=1
fvar(8) = 4.0

[state 900]
type = VarSet
trigger1 = Anim=3010&&AnimElem=3,>1
fvar(8) = fvar(8)*.8

[state 900]
type = VarSet
trigger1 = !time
trigger2 = Anim=3000&&AnimElem=9
fvar(8) = 0

[state -2]
type = velset
trigger1 = Anim=3010&&animelem=3,>=1 && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||(P2stateno=927&&P2movetype=H)))
x = fvar(8)+fvar(9)

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = !movecontact&&!movereversed
trigger1 = Anim=3010 && AnimElem=9 && var(36)!=2
damage = ceil(floor(ifelse(P2bodydist Y>-70,95,72)*ifelse(fvar(1)<.25,.25*fvar(2)*fvar(3)*fvar(4),fvar(0)))*1.22),ceil(floor(ifelse(P2bodydist Y>-70,95,72)*fvar(3)*fvar(4)/4)*1.22)
ground.slidetime = 20+(P2statetype=C)
ground.hittime = 20+(P2statetype=C)
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,0
ground.velocity = -12*const(size.xscale),(-28.0-.9)*const(size.yscale)
guard.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0000,-12.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-28.0-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,ifelse(!(P2bodydist Y>-70),1,0))
fall.recovertime = ifelse(var(49)&&!var(2),42+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = MAFD
palfx.time=64
palfx.sinadd = 96,48,0,4
palfx.color = 0
palfx.add = 56,-96,-208
palfx.invertall = 1

[state 920]
type = varset
trigger1 = movehit=1 && numtarget && var(6)%10>0 && P2bodydist Y>-70 && var(1)%2<1
trigger1 = target,time=0
var(6) = 0
ignorehitpause=1
persistent=0

;==壁ダウンに
[state 920]
type = varadd
trigger1 = movehit=1 && numtarget && var(6)%10=0 && P2bodydist Y>-70 && var(1)%2<1
trigger1 = target,time=0
var(1) = 1-(var(1)%16>=8&&var(1)%8>=4)*4
ignorehitpause=1
persistent=0

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && var(6)%10=0 && P2bodydist Y>-70 && var(1)%2>=1
trigger1 = target,time=0
value = 926
ignorehitpause=1
persistent=0

[state 200]
type = AttackDist
trigger1 = 1;Anim=3010 && AnimElem=10
value = 0

;強制停止中に動かないように
[state -2]
type = PosFreeze
triggerall = Anim=3010
trigger1 = (AnimElem=3,>=1&&AnimElem=7,<0)
trigger2 = NumHelper(7560)
trigger2 = helper(7560),time<30
value = 1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(ifelse(var(7)>=32,96,72)*fvar(14)<1,1+(var(2)%5=1),ifelse(var(7)>=32,96,72)*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=9
var(16) = 10+random%6
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,50]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
var(18) = floor(-170*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.060))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-12.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (0-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Anim!=3015 && AnimTime=0
value = 0
ctrl = 1

;五羅・二撃（追加攻撃）
[statedef 3050]
type = A
physics = N
movetype = A
anim = 3050
sprpriority = 4

[state 6720]
type = AssertSpecial
trigger1 = 1
flag = Invisible

;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = Time=0
trigger2 = time=1
damage = ceil(floor(18*ifelse(root,fvar(1)<.25,.25*root,fvar(2)*root,fvar(3)*root,fvar(4),root,fvar(0)))*1.22),ceil(floor(18*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 20+(P2statetype=C)+root,var(49)*7
ground.hittime = 20+(P2statetype=C)+root,var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,7
ground.velocity = 0*const(size.xscale),-18*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = 0*const(size.xscale),-18*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = S,HP
hitflag = MAFD

[state 3510]
type = StatetypeSet
trigger1 = time>=2
movetype=I

[state 12000]
type = AttackDist
trigger1 = 1
value = 0

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10+random%6

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = 0

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = 0+20*time

;ヒットスパーク
[state 1000]
type = Helper
trigger1 = movecontact=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

[state -1]
type = targetstate
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
value = 926+(root,var(1)%8>=4)*10
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(3) = 1
ignorehitpause=1

;壁コンボヒット数補正増加
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget && floor(root,var(6)%100/10)<9
trigger1 = movehit=1 && target,time=0
var(6) = 10
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(18*root,fvar(14)<1,1+(root,var(2)%5=1),18*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

[state 6710]
type = DestroySelf
trigger1 = Time>=2

;四縛
[statedef 3100]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),vel Y
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Anim!=[3100,3105]
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3100

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = 1
var(9)=ifelse((var(9)=[1,999]),420-var(9),420)

[state 200]
type = pause
trigger1 = !IsHelper&&AnimElem=1&&Anim=3100&&!var(46)
time = 30
movetime = 30

[state 200]
type = helper
trigger1 = !IsHelper&&AnimElem=1&&Anim=3100&&!var(46)
id = 7560
stateno = 7560
pos = floor(0*const(size.yscale)),floor(-107*const(size.yscale))
postype = P1
pausemovetime=30+999
ownpal = 1

[state -2]
type = poweradd
trigger1 = !IsHelper&&(prevstateno!=[5000,5099])&&AnimElem=2&&var(46)=1
value = -1000
persistent=0

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&AnimElem=2&&Anim=3100&&var(46)=1
value = ,AP
time = 30

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&(prevstateno!=[130,154])&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(7) = 0

[state 220]
type = varadd
triggerall = Time>=var(48)
trigger1 = var(7)<42&&((command="hold_z"&&!var(59))||(random<0&&var(59)))
trigger1 = (anim=3105&&var(7))||(Anim=3100 &&animelemtime(5)=0&&!var(7))
var(7) = 1

[state 220]
type = ChangeAnim
triggerall = Time>=var(48)
trigger1 = anim=3100&&animelemtime(5)=0&&var(7)&&var(7)<=42
trigger1 = ((command="hold_z"&&!var(59))||(random<0&&var(59)))
value = 3105
persistent=0

[state 220]
type = ChangeAnim
triggerall = Time>=var(48)
trigger1 = Anim=3105 && (command!="hold_z"||var(7)>=42)&&var(7)
value = 3100
elem = 5
persistent=0

[state 220]
type = StatetypeSet
trigger1 = (var(7)&&Anim=3105)||Anim=3100&&AnimElem=5
statetype=A
physics = N

[state 220]
type = VelSet
trigger1 = (var(7)=1&&Anim=3105)||(!var(7)&&Anim=3100&&AnimElem=5)
x = 1.0
y = -4.0

[state 220]
type = VelSet
trigger1 = Anim=3100&&AnimElem=7
y = 2.0

[state 220]
type = VelAdd
triggerall = time>=var(48)
trigger1 = (var(7)&&Anim=3105)||(Anim=3100&&AnimElem=7,>0&&AnimElem=10,<0)
y = .1

[state 220]
type = StatetypeSet
trigger1 = Anim=3100&&AnimElem=10
statetype=S
physics = S

[state 220]
type = VelSet
trigger1 = Anim=3100&&AnimElem=10
x = 0
y = 0

[state 220]
type = PosSet
trigger1 = Anim=3100&&AnimElem=10
y = 0
;~~~~~

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)&&!(var(52)>0&&movecontact)
var(46) = 1

;経過時間
[state 1610]
type = varset
trigger1 = time>0&&time>=var(48)
trigger1 = anim=3105&&var(46)=38
var(46) = 32

[state 1610]
type = varset
trigger1 = time>0&&time>=var(48)
trigger1 = var(46)<39&&anim=3100&animelem=5,>=0
var(46) = 38

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=1&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=1
value = 3100
elem = 1

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=2&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[2,31]
value = 3100
elem = 2

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=3&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[32,34]
value = ifelse(Anim=3105,3105,3100)
elem = ifelse(Anim=3105,1,3)

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=4&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[35,37]
value = ifelse(Anim=3105,3105,3100)
elem = ifelse(Anim=3105,2,4)

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=5&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[38,40]
value = 3100
elem = 5

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=6&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[41,43]
value = 3100
elem = 6

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=7&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[44,46]
value = 3100
elem = 7

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=8&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[47,49]
value = 3100
elem = 8

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=9&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[50,51]
value = 3100
elem = 9

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=10&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[52,54]
value = 3100
elem = 10

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=11&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[55,57]
value = 3100
elem = 11

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=12&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[58,60]
value = 3100
elem = 12

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=13&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[61,63]
value = 3100
elem = 13

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=14&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[64,66]
value = 3100
elem = 14

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=15&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[67,69]
value = 3100
elem = 15

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=16&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[70,72]
value = 3100
elem = 16

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=17&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[73,75]
value = 3100
elem = 17

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=18&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[76,78]
value = 3100
elem = 18

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=19&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[79,81]
value = 3100
elem = 19

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=20&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[82,84]
value = 3100
elem = 20

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=21&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[85,88]
value = 3100
elem = 21

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = anim
elem = AnimElemNo(0)

[state 1610]
type = PosFreeze
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = 1


;いただくぜ！
[State 40, 1]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&Anim=3100&&AnimElem=2
value = 10,46
channel = 1
persistent = 0

;そらよっ！
[State 40, 1]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&Anim=3100&&AnimElem=8
value = 10,39
channel = 1
persistent = 0

;地震
[State 40, 1]
type = Helper
trigger1 = Anim=3100&&AnimElem=10
id = 6930
stateno = 6930
pos = 0,0
postype = p1
ownpal = 1
pausemovetime = 9999
supermovetime = 9999
ignorehitpause = 1

[state 12000]
type = PlaySND
trigger1 = Anim=3100&&AnimElem=10
value = 5100,2

[state 190]
type = Helper
trigger1 = Anim=3100&&AnimElem=10
id  = 3107
stateno=3107
name = "trap"
pos = floor(188*const(size.xscale)),floor(0*const(size.yscale))
postype = P1
ownpal = 1
persistent=0
ignorehitpause=1

;強制停止中に動かないように
[state -2]
type = PosFreeze
trigger1 = (AnimElem=3)
trigger2 = NumHelper(7560)
trigger2 = helper(7560),time<30
value = 1

[state 200]
type = ChangeState
trigger1 = Anim=3100 && AnimTime=0
value = 0
ctrl = 1

;援軍アシスト
[statedef 3150]
type = S
movetype = I
physics = S
velset = 0,0
anim = 3150
ctrl = 0

[state 1320]
type = VarSet
trigger1 = Time=0
fvar(8) = 0

[state 2200]
type = ChangeAnim
triggerall = time>=13
trigger1 = !numhelper(20000)
trigger2 = numhelper(20000)
trigger2 = helper(20000),stateno%100!=70
value = 3151
persistent=0

[state 2200]
type = ChangeState
trigger1 = Anim=3151&&AnimTime=0
value = 0
ctrl = 1

;罠
[statedef 3107]
type = S
physics =N
movetype = A
velset = 0,0
anim=3107
sprpriority = -1

[state 7990]
type = AssertSpecial
trigger1 = 1
flag = invisible

[state 3107]
type = varset
trigger1 = !time
var(1) = 0

[state 3107]
type = varAdd
trigger1 = 1
var(1) = 1
ignorehitpause = 1

[state 3107]
type = varset
trigger1 = !time
var(7) = root,var(7)

;埃
[state 801]
type = Explod
trigger1 = !time
id = 6100
anim = 6100
pos = 0,0
postype = p1
scale = const(size.xscale),const(size.yscale)
postype = p1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

;埃
[state 801]
type = Explod
trigger1 = !time
id = 6100
anim = 6100
pos = 0,0
postype = p1
scale = const(size.xscale),const(size.yscale)
facing=-1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

;エフェクト
[state 190]
type = Helper
trigger1 = !movecontact && !movereversed && Time%4=0 && root,numhelper(3107)<2 && root,numhelper(7560)
id  = 6400
stateno=6400
name = "trap_fx"
pos = 0,0
postype = P1
ignorehitpause=1

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = !movecontact && !movereversed
trigger1 = 1
damage = ceil(floor(20*ifelse(root,fvar(1)<.25,.25*root,fvar(2)*root,fvar(3)*root,fvar(4),root,fvar(0)))*1.22),ceil(floor(20*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 16+(P2statetype=C)+(root,var(49)&&!root,var(2))*5
ground.hittime = 16+(P2statetype=C)+(root,var(49)&&!root,var(2))*5
guard.slidetime = 14
guard.hittime = 14
pausetime = 1,12+var(49)*6
ground.velocity = -3*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale),(-22.0*(51-root,var(3))*1.0/51)*const(size.yscale)
guard.velocity = -12.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -3*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale),(-22.0*(51-root,var(3))*1.0/51)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),36+14,24-ifelse(floor(root,var(14)/90)>6,6,floor(root,var(14)/90))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = 0,0
givepower = 0,0
kill = 0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-60*const(size.xscale))
animtype = High
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA
persistent=0

[state -1]
type = AttackDist
trigger1 = movecontact||movereversed
value = 0

[state 12000]
type = TargetState
trigger1 = movehit&&numtarget
trigger1 = target,stateno!=3106
value = 3106

[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = -1*(root,var(1)%2>=1)-4*(root,var(1)%8>=4)
ignorehitpause=1

[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = -1*(root,var(1)%2>=1)-4*(root,var(1)%8>=4)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget&&root,var(3)
var(3) = 1
persistent=0
ignorehitpause=1

;引き剥がし効果
[state 12000]
type = ParentVarSet
trigger1 = movehit=1&&numtarget&&root,var(6)!=0
var(6) = 0
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(20*root,fvar(14)<1,1+(root,var(2)%5=1),20*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10+random%6
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,50]),10,-10)+floor(-60*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
trigger1 = movecontact=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

[state 7990]
type = ChangeState
trigger1 = movehit=1
value = 3108

[state 7990]
type = destroyself
trigger1 = Time>=150+var(7)*7
trigger2 = (moveguarded||movereversed)&&time>=100+var(7)

;罠（相手）
[statedef 3106]
type = A
movetype=H
physics = N
ctrl = 0
velset = 0,0
sprpriority = -2

[state 3516]
type = ChangeAnim2
trigger1 = !Time
value = 3106

[state 3516]
type = null;ChangeAnim
trigger1 = !time
value = 5012

[state 3516]
type = null;ChangeAnim
trigger1 = time
value = 5012
elem = AnimElemNo(0)

[state 3516]
type = PosFreeze
trigger1 = !HitShakeover
value = 1

[state 3516]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,1

[state 3516]
type = SelfState
trigger1 = HitShakeover && Time && Vel Y>0 && Pos Y>=0
value = 5050

;網
[statedef 3108]
type = A
physics =N
movetype = A
velset = 0,0
anim=3108
sprpriority = 2

[state 7990]
type = varset
trigger1 = numhelper(20000)
trigger1 = helper(20000),stateno%10=9&&helper(20000),var(50)=7||helper(20000),stateno%100=70
var(6) = 8

[state 7990]
type = varadd
trigger1 = numhelper(20000)
trigger1 = helper(20000),stateno%10!=9&&helper(20000),stateno%100!=70&&var(6)
var(6) = -1

[state 7990]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 7990]
type = AssertSpecial
trigger1 = Time>=(ifelse(var(7)>=22,90,40)+30)+2&&!var(6)
flag = noshadow
flag2 = invisible

[state 3107]
type = varAdd
trigger1 = 1
var(1) = 1
ignorehitpause = 1

;埃
[state 801]
type = Explod
trigger1 = !time
id = 6100
anim = 6100
pos = 0,0
postype = p1
scale = const(size.xscale),const(size.yscale)
postype = p1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

;埃
[state 801]
type = Explod
trigger1 = !time
id = 6100
anim = 6100
pos = 0,0
postype = p1
scale = const(size.xscale),const(size.yscale)
facing=-1
sprpriority = 4
pausemovetime=999
supermovetime=999
persistent=0

;網・反対側
[state 801]
type = Explod
trigger1 = !time
id = 3108
anim = 3108
pos = 0,0
postype = p1
scale = const(size.xscale),const(size.yscale)
postype = p1
removetime=-1
bindtime=-1
facing = -1
sprpriority = 2
pausemovetime=999
supermovetime=999
persistent=0

[state 3516]
type = VarSet
trigger1 = numhelper(20000)&&(root,var(12)=[2,2000])
trigger1 = abs(helper(20000),pos x-pos x)<60 && helper(20000),stateno%100=70 && helper(20000),vel x>0
var(5) = 1

[state 3516]
type = VelSet
trigger1 = !time
y = -6*const(size.yscale)

[state 3516]
type = VelSet
trigger1 = time=16
y = 0

[state 3516]
type = VelSet
trigger1 = time>=16&&frontedgebodydist>5&&backedgebodydist>5&&var(5)
x = 6

[state 3516]
type = VelSet
trigger1 = time>=16&&(frontedgebodydist<=5||backedgebodydist<=5)
x = 0

[state 12000]
type = TargetState
trigger1 = numtarget&&(time<(ifelse(var(7)>=22,90,40)+30)||var(6))
trigger1 = target,stateno=[5000,5099]
value = 3106

[state 3516]
type = BindToTarget
trigger1 = !time
pos = 0,0

[state 3516]
type = TargetBind
trigger1 = time=[1,(ifelse(var(7)>=22,90,40)+30)-1]
trigger2 = var(6)
pos = 0,-floor(40*const(size.yscale))

[state -1]
type = AttackDist
trigger1 = movecontact||movereversed
value = 0

[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = numhelper(6410)
trigger1 = helper(6410),movehit=1 && target,time=0
var(1) = -1*(root,var(1)%2>=1)-4*(root,var(1)%8>=4)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = numhelper(6410)
trigger1 = helper(6410),movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = numhelper(6410)
trigger1 = helper(6410),movehit=1&&numtarget&&root,var(3)
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = numhelper(6410)
trigger1 = helper(6410),movehit=1
fvar(15) = .00005*floor(ifelse(34*root,fvar(14)<1,1+(root,var(2)%5=1),34*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = numhelper(6410)
trigger1 = helper(6410),movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;BASARA Moves Finish
[state 3510]
type = Helper
trigger1 = numhelper(6410)
trigger1 = helper(6410),movehit=1&&numtarget && !enemynear,alive && roundstate=3 && !numexplod(60000)
id  = 8800
stateno=8800
pos = 0,0
postype = left
scale = const(size.xscale),const(size.yscale)
persistent=0
ignorehitpause=1

;KO
[state 3500]
type = explod
trigger1 = WinKO && !numexplod(60000)
id = 60000
anim = 90000
name="ko"
ownpal = 1
removetime=-1
facing=facing
ignorehitpause=1

;網爆発
[state 801]
type = Helper
trigger1 = !var(6) && time>=(ifelse(var(7)>=22,90,40)+30)
id = 6410
stateno = 6410
pos = floor(44*const(size.xscale)),-floor(120*const(size.xscale))
postype = p2
size.xscale = const(size.xscale)*3
size.yscale = const(size.xscale)*3
postype = p1
sprpriority = 2
pausemovetime=999
supermovetime=999
persistent=0

;網爆発
[state 801]
type = Helper
trigger1 = !var(6) && time>=(ifelse(var(7)>=22,90,40)+30)
id = 6411
stateno = 6410
pos = -floor(66*const(size.xscale)),-floor(120*const(size.xscale))
postype = p2
size.xscale = const(size.xscale)*3
size.yscale = const(size.xscale)*3
postype = p1
sprpriority = 2
pausemovetime=999
supermovetime=999
persistent=0

;網・消滅
[state 801]
type = Explod
trigger1 = !var(6) && time>=(ifelse(var(7)>=22,90,40)+30+10)
id = 3109
anim = 3109
pos = 0,0
postype = p1
scale = const(size.xscale),const(size.yscale)
postype = p1
sprpriority = 2
pausemovetime=999
supermovetime=999
persistent=0

;網・消滅
[state 801]
type = Explod
trigger1 = !var(6) && time>=(ifelse(var(7)>=22,90,40)+30+10)
id = 3109
anim = 3109
pos = 0,0
postype = p1
scale = const(size.xscale),const(size.yscale)
postype = p1
sprpriority = 2
facing=-1
pausemovetime=999
supermovetime=999
persistent=0

[state 7990]
type = RemoveExplod
trigger1 = !var(6) && Time>=(ifelse(var(7)>=22,90,40)+30+2)
trigger2 = numtarget
trigger2 = target,stateno=3516
id = 3108

[state 7990]
type = destroyself
trigger1 = !var(6) && Time>=(ifelse(var(7)>=22,90,40)+30+2)
trigger2 = numtarget
trigger2 = target,stateno=3516

;罠エフェクト
[statedef 6400]
type = S
physics =N
movetype = I
velset = 0,0
anim=6400
sprpriority = -1

[state 7990]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 7990]
type = AngleDraw
trigger1 = 1
scale = 1.25*((time-1)*.5+1),.25*((time-1)*.5+1)

[state 7990]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256-(time)*25,256

[state 7990]
type = destroyself
trigger1 = Time>=10

;四縛・網爆破
[statedef 6410]
type = A
physics = N
movetype = A
anim = 6410
sprpriority = 4

[state 6720]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;岩1
[state 801]
type = Explod
trigger1 = !time
id = 6152
anim = 6152
pos = 0,0
postype = p1
scale = const(size.xscale)/3,const(size.xscale)/3
vel = random%3*const(size.xscale)/3,(-random%5)*const(size.xscale)/3
facing = -1+(random%2=0)*2
sprpriority = 0
pausemovetime=999
supermovetime=999
persistent=0
ignorehitpause=1

;岩2
[state 801]
type = Explod
trigger1 = !time
id = 6152
anim = 6152
pos = 0,0
postype = p1
scale = const(size.xscale)/3,const(size.xscale)/3
vel = random%3*const(size.xscale)/3,(-random%5)*const(size.xscale)/3
facing = -1+(random%2=0)*2
sprpriority = 0
pausemovetime=999
supermovetime=999
persistent=0
ignorehitpause=1

;岩3
[state 801]
type = Explod
trigger1 = !time
id = 6152
anim = 6152
pos = 0,0
postype = p1
scale = const(size.xscale)/3,const(size.xscale)/3
vel = random%3*const(size.xscale)/3,(-random%5)*const(size.xscale)/3
facing = -1+(random%2=0)*2
sprpriority = 0
pausemovetime=999
supermovetime=999
persistent=0
ignorehitpause=1

;岩4
[state 801]
type = Explod
trigger1 = !time && random%3=1
id = 6152
anim = 6152
pos = 0,0
postype = p1
scale = const(size.xscale)/3,const(size.xscale)/3
vel = random%3*const(size.xscale)/3,(-random%5)*const(size.xscale)/3
facing = -1+(random%2=0)*2
sprpriority = 0
pausemovetime=999
supermovetime=999
persistent=0
ignorehitpause=1

;岩5
[state 801]
type = Explod
trigger1 = !time && random%4=3
id = 6152
anim = 6152
pos = 0,0
postype = p1
scale = const(size.xscale)/3,const(size.xscale)/3
vel = random%3*const(size.xscale)/3,(-random%5)*const(size.xscale)/3
facing = -1+(random%2=0)*2
sprpriority = 0
pausemovetime=999
supermovetime=999
persistent=0
ignorehitpause=1

;岩6
[state 801]
type = Explod
trigger1 = !time && random%5=1
id = 6152
anim = 6152
pos = 0,0
postype = p1
scale = const(size.xscale)/3,const(size.xscale)/3
vel = random%3*const(size.xscale)/3,(-random%5)*const(size.xscale)/3
facing = -1+(random%2=0)*2
sprpriority = 0
pausemovetime=999
supermovetime=999
persistent=0
ignorehitpause=1

;岩7
[state 801]
type = Explod
trigger1 = !time && random%6=5
id = 6152
anim = 6152
pos = 0,0
postype = p1
scale = const(size.xscale)/3,const(size.xscale)/3
vel = random%3*const(size.xscale)/3,(-random%5)*const(size.xscale)/3
facing = -1+(random%2=0)*2
sprpriority = 0
pausemovetime=999
supermovetime=999
persistent=0
ignorehitpause=1

;Attack Lv.3
[state 200]
type = Hitdef
trigger1 = Time=0
damage = ceil(floor(48*ifelse(root,fvar(1)<.25,.25*root,fvar(2)*root,fvar(3)*root,fvar(4),root,fvar(0)))*1.22),ceil(floor(48*root,fvar(3)*root,fvar(4)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*5
ground.hittime = 14+(P2statetype=C)+root,var(49)*5
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12+var(49)*6
ground.velocity = 8*const(size.xscale)/3,-12*const(size.yscale)/3
guard.velocity = -15.0*const(size.xscale)/3
ground.cornerpush.veloff = 0
air.velocity = 8*const(size.xscale)/3,-12*const(size.yscale)/3
airguard.velocity = -6*const(size.xscale)/3,-2*const(size.yscale)/3
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)/3
fall.recover = ifelse(root,var(6)%10>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),53+12,30-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = S,HP
hitflag = MAFD

[state 3510]
type = StatetypeSet
trigger1 = time>=1
movetype=I

[state 12000]
type = AttackDist
trigger1 = 1
value = 0

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10+random%6

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = 0

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
trigger1 = movecontact=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

[state -1]
type = targetstate
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
value = 926+(root,var(1)%8>=4)*10
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget&&numhelper(3107)
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget&&numhelper(3107)
var(3) = 1
persistent=0
ignorehitpause=1

;壁コンボヒット数補正増加
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget && floor(root,var(6)%100/10)<9&&numhelper(3107)
trigger1 = movehit=1 && target,time=0
var(6) = 10
ignorehitpause=1
persistent=0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1&&numhelper(3107)
fvar(15) = .00005*floor(ifelse(34*root,fvar(14)<1,1+(root,var(2)%5=1),34*root,fvar(14))*1.22)
ignorehitpause=1
persistent=0

[state -2]
type = parentvarset
trigger1 = movehit=1&&numhelper(3107)
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1
persistent=0

;BASARA Moves Finish
[state 3510]
type = Helper
trigger1 = !numhelper(8800)
trigger1 = (movehit=[1,2]) && !enemynear,alive && roundstate=3 && !numexplod(60000)
id  = 8800
stateno=8800
pos = 0,0
postype = left
scale = const(size.xscale),const(size.yscale)
persistent=0
ignorehitpause=1

;KO
[state 3500]
type = explod
trigger1 = WinKO && !numexplod(60000)
id = 60000
anim = 90000
name="ko"
ownpal = 1
removetime=-1
facing=facing
ignorehitpause=1

[state 6710]
type = DestroySelf
trigger1 = AnimTime=0

;千日航路
[statedef 3500]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3500

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=38

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1
pausemovetime=54+8

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1
pausemovetime=54+8

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;一撃BASARA技使用不能時間
[state 195]
type = VarSet
trigger1 = !Time
var(45) = -1

[state 200]
type = pause
trigger1 = !IsHelper&&time>1&&AnimElem=3,=2
time = 40
movetime = 40

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&AnimElem=3,=2
value = ,AP
time=40

[state 200]
type = helper
trigger1 = !IsHelper&&time>1&&AnimElem=4
id = 7580
stateno = 7580
pos = 0,0
postype = P1
pausemovetime=39+999

[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=4
value = 10,40
channel = 1

;地図
[state 200]
type = Explod
trigger1 = !IsHelper&&!NumExplod(3505)&&AnimElemTime(4)>=0&&AnimElemTime(5)<0
id = 3505
anim = 3505
pos = 0,0
postype = P1
ownpal = 1
removeongethit =1
sprpriority = 2
scale = const(size.xscale),const(size.yscale)

;地図
[state 200]
type = RemoveExplod
trigger1 = !IsHelper&&AnimElem=5,=0&&NumExplod(3505)
id = 3505

;地図
[state 200]
type = Explod
trigger1 = !IsHelper&&!NumExplod(3505)&&AnimElemTime(5)>=0&&AnimElemTime(6)<0
id = 3505
anim = 3506
pos = 0,0
postype = P1
ownpal = 1
removeongethit =1
sprpriority = 2
scale = const(size.xscale),const(size.yscale)

;地図
[state 200]
type = RemoveExplod
trigger1 = !IsHelper&&AnimElem=6,=0&&NumExplod(3505)
id = 3505

;地図
[state 200]
type = Explod
trigger1 = !IsHelper&&!NumExplod(3505)&&AnimElemTime(6)>=0&&AnimElemTime(7)<0
id = 3505
anim = 3507
pos = 0,0
postype = P1
ownpal = 1
removeongethit =1
sprpriority = 2
scale = const(size.xscale),const(size.yscale)

;地図
[state 200]
type = RemoveExplod
trigger1 = !IsHelper&&AnimElemTime(7)>=0&&NumExplod(3505)
id = 3505

;地図（飛び道具）
[state 200]
type = helper
trigger1 = !IsHelper&&AnimElem=7
id = 3550
stateno = 3550
pos = floor(80*const(size.xscale)),-floor(116*const(size.yscale))
postype = P1
ownpal = 1
pausemovetime=1+999

;つば
[state 200]
type = Explod
trigger1 = !IsHelper&&AnimElem=12
id = 3501
anim = 3501
pos = 0,0
postype = P1
ownpal = 1
sprpriority = 2
removeongethit =1
pausemovetime=9+999
scale = const(size.xscale),const(size.yscale)

;ちっ、田舎もんがよー！
[state 200]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&roundstate=2&&!IsHelper&&AnimElem=12
value = 10,62
channel = 1

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

;~~~~~~~~~~~
[state 3500]
type = NotHitBy
triggerall = roundstate=2
trigger1 = numhelper(3550)
trigger1 = helper(3550),Movehit
value = SCA
ignorehitpause=1

;相手を固定
[state 6710]
type = targetstate
triggerall = roundstate=2
trigger1 = numhelper(3550)
trigger1 = helper(3550),Movehit
trigger1 = helper(3550),NumTarget
value = 3516
ignorehitpause=1
persistent=0

;ヒット後の演出へ
[state 3500]
type = Pause
triggerall = roundstate=2
trigger1 = numhelper(3550)
trigger1 = helper(3550),Movehit
trigger1 = helper(3550),NumTarget
time = 0
movetime=0

;ヒット後の演出へ
[state 3500]
type = ChangeState
triggerall = roundstate=2
trigger1 = numhelper(3550)
trigger1 = helper(3550),Movehit
trigger1 = helper(3550),NumTarget
value = 3510

[state 200]
type = AttackDist
trigger1 = AnimElem=13
value = 0

;強制停止中に動かないように
[state -2]
type = PosFreeze
trigger1 = (AnimElem=4,>=0&&AnimElem=7,<=0)
trigger2 = NumHelper(7580)
trigger2 = helper(7580),time<30
value = 1

[state 195]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;一撃BASARA技ヒット後
[statedef 3510]
type = S
movetype=A
physics = S
ctrl = 0
velset = 0,0
anim = 3510

[state 3500]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause=1

;一撃BASARA技成功後
[state 195]
type = VarSet
trigger1 = !Time
var(45) = 10000
ignorehitpause=1

[state 801]
type = AssertSpecial
trigger1 = 1
flag = NoMusic
flag2 = TimerFreeze

[state 801]
type = PlaySND
trigger1 = !Time
value = 7900,0
loop = 1
channel = 30
lowpriority = 1

;てめぇの行き先は、ここだ！
[state 190]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=4
value = 10,43
channel = 1

;碇槍
[state 190]
type = Explod
trigger1 = Anim=3510 && animelem=5
id = 3511
anim = 3511
pos = 0,0
postype = P1
sprpriority = 4
removetime=-1
removeongethit =1
scale = const(size.xscale),const(size.yscale)

;ナイフ
[state 3510]
type = Helper
trigger1 = Anim=3510 && AnimElem=30
id  = 3555
stateno= 3555
pos = floor(228*const(size.xscale)),floor(-164*const(size.yscale))
postype = P1
persistent=0
pausemovetime=999
ignorehitpause=1
persistent =0

;BASARA K.O.
[state 3510]
type = Helper
trigger1 = numhelper(3550) && !numhelper(8850)
trigger1 = helper(3550),stateno=3551&&helper(3550),time>=178 && roundstate=3
id  = 8850
stateno=8850
pos = 0,0
postype = left
scale = const(size.xscale),const(size.yscale)
persistent=0
pausemovetime=999
ignorehitpause=1
persistent =0

[state 801]
type = PlaySND
trigger1 = Anim=3510 && AnimElem=30
value = 30,11

[state 50]
type = PlaySND
trigger1 = AnimElem=39,=0
value = 41,0
volume = 128

[state 3510]
type = AttackDist
trigger1 = 1
value = 0

[state 195]
type = ChangeState
trigger1 = AnimTime=0&&numhelper(3550)
trigger1 = helper(3550),time>=224
value = ifelse(WinKO,181,0)
ctrl = 1

;一撃BASARA技ヒット後（相手）
[statedef 3516]
type = A
movetype=H
physics = N
ctrl = 0
velset = 0,0
sprpriority = -1

[state 3516]
type = ChangeAnim
trigger1 = !Time
value = 5070

[state 3516]
type = ChangeAnim
trigger1 = !Time
value = 5070
elem = AnimElemNo(99)

[state 3516]
type = PosFreeze
trigger1 = !HitShakeover
value = 1

[state 3516]
type = NotHitBy
trigger1 = Time<100
value = SCA

[state 3516]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,1

[state 3516]
type = SelfState
trigger1 = HitShakeover && Time && (roundstate>=3||time>=150)
value = 5020

[state 3516]
type = SelfState
trigger1 = HitShakeover && Time && Vel Y>0 && Pos Y>=0
value = 5100

;一撃BASARA技ヒット後（相手）
[statedef 3517]
type = A
movetype=H
physics = N
ctrl = 0
velset = 0,0
sprpriority = -1

[state 3516]
type = NotHitBy
trigger1 = 1
value = SCA

[state 3516]
type = ChangeAnim
trigger1 = !Time
value = 5070

[state 3516]
type = ChangeAnim
trigger1 = !Time
value = 5070
elem = AnimElemNo(99)

[state 3516]
type = ChangeAnim2
trigger1 = Time=79
value = 3517

[state 3516]
type = LifeAdd
trigger1 = Time=80 && (Alive||Life)
value = -99999999999999999999

[state 3516]
type = LifeSet
trigger1 = Time=80 && (Alive||Life)
value = 0

[state 3516]
type = ScreenBound
trigger1 = 1
value = (time<132)
movecamera = (time<132),(time<132)

[state 3516]
type = StatetypeSet
trigger1 = (Time=[81,131])
movetype=I

[state 3516]
type = StatetypeSet
trigger1 = Time>=132
movetype=H

[state 3516]
type = PosSet
trigger1 = Time>=132
y = 0

[state 3516]
type = SelfState
trigger1 = Time>=132 && alive
value = 5110

[state 3516]
type = ChangeState
trigger1 = Time>=132 && !alive && roundstate>=3
trigger2 = Time>=132 && IsHelper
value = 5150

;地図
[statedef 3550]
type = A
physics = N
movetype = A
anim = 3550
sprpriority = 4

[state 6720]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6720]
type = Trans
trigger1 = time
trans = AddAlpha
alpha = 256-time*4,0+time*4

[state 3550]
type = VelSet
trigger1 = time=1
x = (1.5-1.5*(frontedgebodydist<=0))*const(size.xscale)
y = -4.0*const(size.yscale)

[state 20000]
type = PosFreeze
trigger1 = !root,numexplod(50000)
value = 1

;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = (Time=[0,55]) && root,numexplod(50000)
damage = 1
kill = 0
ground.slidetime = 20+(P2statetype=C)+root,var(49)*7
ground.hittime = 20+(P2statetype=C)+root,var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7
ground.velocity = 0*const(size.xscale),-18*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = 0*const(size.xscale),-18*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,2
guardsound = s7000,2
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = S,HP
hitflag = MAFD
guardflag = H

[state 3510]
type = StatetypeSet
trigger1 = movecontact||movereversed
movetype=I

[state 12000]
type = AttackDist
trigger1 = movecontact||movereversed
value = 0

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10+random%6

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,50]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(-80*const(size.yscale))

;ヒットスパーク
[state 1000]
type = Helper
trigger1 = movecontact=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;相手を画面外へ飛ばす
[state 6710]
type = targetstate
trigger1 = movehit=1 && numtarget && roundstate=2
value = 3516

[state 6710]
type = ChangeState
trigger1 = movehit=1 && numtarget && roundstate=2
value = 3551

[state 6710]
type = RemoveExplod
trigger1 = Time>=55

[state 6710]
type = DestroySelf
trigger1 = Time>=55

;地図・ヒット後
[statedef 3551]
type = A
physics = N
movetype = A
anim = 3551
velset =0,0
sprpriority = 0

[state 6720]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6720]
type = Turn
trigger1 = !time

[state 6720]
type = BindToRoot
trigger1 = !time
pos = floor(ifelse(ifelse(root,facing=1,helper(30000),pos x-root,pos x,-(helper(30005),pos x-root,pos x))<(280+root,const(size.air.front)),40,100)*const(size.xscale)),floor(0*const(size.yscale))

[state 6710]
type = TargetBind
trigger1 = numtarget
pos = 0,0

[state 801]
type = targetstate
triggerall = roundstate=2
trigger1 = numtarget
trigger1 = target,stateno!=[3516,3517]
value = 3516
ignorehitpause=1

[state 3550]
type = VelSet
trigger1 = time=1
x = -7.0*const(size.xscale)
y = -9.0*const(size.yscale)

[state 3550]
type = VelSet
trigger1 = time>=30
x = 0
y = 0

;炎上
[state 190]
type = Explod
trigger1 = NumHelper(3555)
trigger1 = Helper(3555),MoveHit=1
id = 3552
anim = 3552
pos = 0,0
postype = P1
sprpriority = 4
faing=-1
scale = const(size.xscale),const(size.yscale)

;爆発
[state 190]
type = Explod
trigger1 = Time=160
id = 6301
anim = 6301
pos = floor(24*const(size.xscale)),-floor(60*const(size.yscale))
postype = P1
sprpriority = 0
scale = const(size.xscale)*8.0,const(size.yscale)*8.0

[state 801]
type = PlaySND
trigger1 = Time=160
trigger2 = Time=164
trigger3 = Time=168
trigger4 = Time=172
trigger5 = Time=176
value = 30,7
volume = 128
channel = 12

[state 801]
type = PlaySND
trigger1 = Time=160
trigger2 = Time=164
trigger3 = Time=168
trigger4 = Time=172
trigger5 = Time=176
value = 30,7
volume = 128
channel = 13

[state 12000]
type = AttackDist
trigger1 = 1
value = 0

[state 6710]
type = AssertSpecial
trigger1 = Time>=160
flag = invisible

[state 6710]
type = DestroySelf
trigger1 = roundstate<2

;ナイフ
[statedef 3555]
type = A
physics = N
movetype = A
anim = 3555
sprpriority = 5

[state 6720]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6720]
type = AngleDraw
trigger1 = 1
value = -15

[state 6720]
type = Trans
trigger1 = 1
trans = Add

[state 6720]
type = ScreenBound
trigger1 = 1
value = 1

[state 3550]
type = VelSet
trigger1 = time=1
x = (8.0-ifelse(P2dist X<floor(140*const(size.xscale)),(floor(140*const(size.xscale))-P2dist X)*.05,0))*const(size.xscale)
y = -12.0*const(size.yscale)

[state 20000]
type = PosFreeze
trigger1 = !root,numexplod(50000)
value = 1

;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = (Time=[0,55]) && root,numexplod(50000)
damage = floor(400*1.22)
kill = 0
ground.slidetime = 20+(P2statetype=C)+root,var(49)*7
ground.hittime = 20+(P2statetype=C)+root,var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14+var(49)*7
ground.velocity = 0*const(size.xscale),-18*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = 0*const(size.xscale),-18*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,2
guardsound = s7000,2
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = S,HP
hitflag = MAFD
palfx.time=50
palfx.sinadd = 96,48,0,4
palfx.color = 0
palfx.add = 56,-96,-208
palfx.invertall = 1

[state 3510]
type = StatetypeSet
trigger1 = movecontact||movereversed
movetype=I

[state 12000]
type = AttackDist
trigger1 = movecontact||movereversed
value = 0

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = 1
var(16) = 10+random%6

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = 0;floor(P2dist X)+ifelse((P2dist X=[1,50]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = 1
var(18) = floor(-80*const(size.yscale))

;ヒットスパーク
[state 1000]
type = Helper
trigger1 = movecontact=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
ownpal = 1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;相手を画面外へ飛ばす
[state 6710]
type = targetstate
trigger1 = movehit=1
value = 3517
persistent=0

[state 6710]
type = AssertSpecial
trigger1 = movehit
trigger1 = NumTarget
flag = invisible

[state 6710]
type = DestroySelf
trigger1 = (movehit>1&&NumTarget)||time>=62

;一撃BASARA技発動準備
[statedef 2900]
type = S
movetype=I
physics = S
ctrl = 0
velset = 0,0
anim = 2900
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=9999
supermovetime=9999
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;一撃BASARA技発動可能時間
[state 195]
type = VarSet
trigger1 = AnimElem=14
var(45) = 600+ifelse(Life*100/const(data.life)<40,600,(100-Life*100/const(data.life))*10)+1

[state 1050]
type = playsnd
trigger1 = AnimElem=14
value = 7400,0

[state 195]
type = PlaySND
trigger1 = (!var(10)||var(10)>=1000)&&!IsHelper&&roundstate=2&&alive && life>gethitvar(damage)&&AnimElem=14
value = 10,11
channel = 1

[state 195]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

[statedef 6750]
type = S
ctrl = 0
velset = 0,0
anim = 90000

[state 801]
type = AssertSpecial
trigger1 = 1
flag = NoMusic

[state 6750]
type = AllPalFX
trigger1 = time<25
add = -10*time,-10*time,-10*time
time=1

[state 6750]
type = AllPalFX
trigger1 = time=[26,49]
add = -255,-255,-255
time=1

[state 6750]
type = AllPalFX
trigger1 = time=[50,81]
add = -255+8*(time-50),-255+8*(time-50),-255+8*(time-50)
time=1

[state 6750]
type = AllPalFX
trigger1 = time>=98
add = 8*(time-98),8*(time-98),8*(time-98)
time=1

[state 6750]
type = AllPalFX
trigger1 = time>=128
add = 255,255,255
time=1

[state 3510]
type = Pause
trigger1 = Time=24
time = 115
movetime = 115

[state 3510]
type = Explod
trigger1 = Time=50
anim = 6753
id = 6753
pos = 0,0
postype = left
ownpal = 1
ontop = 1
bindtime = -1
pausemovetime=80
scale = 320,240

[state 3510]
type = Explod
trigger1 = Time=50
anim = 6750
id = 6750
pos = 160,240
postype = left
ownpal = 1
ontop = 1
sprpriority = 99
bindtime = -1
pausemovetime=80
scale = const(size.xscale),const(size.yscale)

[state 3510]
type = Explod
trigger1 = Time=50
anim = 6751
id = 6751
pos = 160,240
postype = left
ownpal = 1
ontop = 1
sprpriority = 99
bindtime = -1
pausemovetime=80
scale = const(size.xscale),const(size.yscale)

[state 3510]
type = Explod
trigger1 = Time=50
anim = 6752
id = 6752
pos = 160,240
postype = left
ownpal = 1
ontop = 1
sprpriority = 99
bindtime = -1
pausemovetime=80
scale = const(size.xscale),const(size.yscale)

;眼光
[state 190]
type = Explod
trigger1 = Time=90
id = 6807
anim = 6807
pos = 145,177
postype = left
ownpal = 1
ontop = 1
sprpriority = 99
bindtime = -1
pausemovetime=30
scale = const(size.xscale),const(size.yscale)

[state -2]
type = RemoveExplod
trigger1 = Time=140

[state -2]
type = DestroySelf
trigger1 = Time=140

;=====小判・カラクリ兵器関連ゲージ
[statedef 8900]
ctrl = 0
anim = 90000

[state 8900]
type = RemoveExplod
trigger1 = root,var(37)!=var(38)
id = 8903

[state 8900]
type = RemoveExplod
trigger1 = root,var(37)!=var(38)
id = 8902

[state 8900]
type = RemoveExplod
trigger1 = root,var(37)!=var(38)
id = 8901

[state 8900]
type = RemoveExplod
trigger1 = root,var(37)!=var(38)
id = 8900

[state 8900]
type = VarSet
trigger1 = 1
var(37) = root,var(37)

[state 8900]
type = VarSet
trigger1 = var(38)<root,var(37)&&((roundstate>=2&&root,numexplod(40000))||(root,roundsexisted&&roundstate<2))
trigger2 = var(38)>root,var(37)
var(38) = root,var(37)-ifelse(!root,roundsexisted&&roundstate>=2&&root,numexplod(40000),50,0)

[state 8900]
type = varadd
trigger1 = var(38)<root,var(37)&&roundstate>=2&&!root,numexplod(40000)&&root,var(37)<=9999
var(38) = 1+ifelse(var(38)<(root,var(37)-1)&&time%2=0,1,0)

[state 8900]
type = varadd
trigger1 = ((floor(var(38)/100)*100-floor(var(38)/1000)*1000)/100)<((floor(root,var(37)/100)*100-floor(root,var(37)/1000)*1000)/100) && time%6=0
trigger1 = ((floor(var(38)/10)*10-floor(var(38)/100)*100)/10)<((floor(root,var(37)/10)*10-floor(root,var(37)/100)*100)/10)
trigger2 = (root,var(37)-var(38))>=100 && time%6=0
var(38) = 100

[state 8900]
type = varadd
trigger1 = floor(var(38)/1000)<floor(root,var(37)/1000) && time%6=0
trigger1 = ((floor(var(38)/100)*100-floor(var(38)/1000)*1000)/100)<((floor(root,var(37)/100)*100-floor(root,var(37)/1000)*1000)/100)
var(38) = 1000

;小判アイコン
[state 8900]
type = Explod
trigger1 = !NumExplod(8910)
id = 8910
anim = 8910
pos = 34+(teamside=2)*205+floor(root,fvar(17)),212+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 99
bindtime = -1
ownpal = 0
ontop = 1

;＝
[state 8900]
type = Explod
trigger1 = !NumExplod(8911)
id = 8911
anim = 8911
pos = 40+(teamside=2)*205+floor(root,fvar(17)),212+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 5
bindtime = -1
ownpal = 1
ontop = 1

;両
[state 8900]
type = Explod
trigger1 = !NumExplod(8912)
id = 8912
anim = 8912
pos = 82+(teamside=2)*205+floor(root,fvar(17)),211+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 6
bindtime = -1
ownpal = 1
ontop = 1

;小判量(4桁目)
[state 8900]
type = Explod
trigger1 = !NumExplod(8903)
id = 8903
anim = ifelse(var(38)<1000,90000,8900+floor(var(38)/1000))
pos = 49+(teamside=2)*205+floor(root,fvar(17)),211+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 7
bindtime = -1
ownpal = 1
ontop = 1

;小判量(3桁目)
[state 8900]
type = Explod
trigger1 = !NumExplod(8902)
id = 8902
anim = ifelse(var(38)<100,90000,8900+(floor(var(38)/100)*100-floor(var(38)/1000)*1000)/100)
pos = 57+(teamside=2)*205+floor(root,fvar(17)),211+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 7
bindtime = -1
ownpal = 1
ontop = 1

;小判量(2桁目)
[state 8900]
type = Explod
trigger1 = !NumExplod(8901)
id = 8901
anim = ifelse(var(38)<10,90000,8900+(floor(var(38)/10)*10-floor(var(38)/100)*100)/10)
pos = 65+(teamside=2)*205+floor(root,fvar(17)),211+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 7
bindtime = -1
ownpal = 1
ontop = 1

;小判量(1桁目)
[state 8900]
type = Explod
trigger1 = !NumExplod(8900)
id = 8900
anim = 8900+(var(38)-floor(var(38)/10)*10)
pos = 73+(teamside=2)*205+floor(root,fvar(17)),211+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 7
bindtime = -1
ownpal = 1
ontop = 1

;----カラクリ兵器アイコン---

;アイコン消去（仁王車・使用不可マーク）
[state 8900]
type = RemoveExplod
trigger1 = NumExplod(8956) && !((root,var(12)!=[1,2000])&&(root,var(12)!=[-2000,-1])&&root,var(12)!=0)
id = 8956

;アイコン消去（木騎）
[state 8900]
type = ModifyExplod
trigger1 = NumExplod(8952) && floor(root,var(43)/1000)<50
id = 8952
scale = 0,0

;アイコン消去（木騎・使用不可マーク）
[state 8900]
type = RemoveExplod
trigger1 = NumExplod(8957) && !((root,var(12)!=[2001,5000])&&(root,var(12)!=[-5000,-2001])&&root,var(12)!=0&&floor(root,var(43)/1000)>=50)
id = 8957

;アイコン消去（滅騎）
[state 8900]
type = ModifyExplod
trigger1 = NumExplod(8954) && floor(root,var(43)/1000)<100
id = 8954
scale = 0,0

;アイコン消去（滅騎・使用不可マーク）
[state 8900]
type = RemoveExplod
trigger1 = NumExplod(8958) && !((root,var(12)!=[10001,19999])&&(root,var(12)!=[-19999,-10001])&&root,var(12)!=0&&floor(root,var(43)/1000)>=100)
id = 8958

;カラクリ兵器アイコン（仁王車）
[state 8900]
type = Explod
trigger1 = !NumExplod(8950)
id = 8950
anim = 8950
pos = 95+(teamside=2)*98+floor(root,fvar(17)),208+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = -5
bindtime = -1
ownpal = 0
ontop = 1

;カラクリ兵器アイコン（仁王車・半透明化）
[state 8900]
type = ModifyExplod
trigger1 = NumExplod(8950) && !((root,var(12)=[1,2000])||(root,var(12)=[-2000,-1])||(!root,var(12)&&root,var(37)>=2000))
id = 8950
trans = AddAlpha
alpha = 96,256

;カラクリ兵器アイコン（仁王車・通常）
[state 8900]
type = ModifyExplod
trigger1 = NumExplod(8950) && ((root,var(12)=[1,2000])||(root,var(12)=[-2000,-1])||(!root,var(12)&&root,var(37)>=2000))
id = 8950
trans = None

;カラクリ兵器アイコン（木騎）
[state 8900]
type = Explod
trigger1 = !NumExplod(8952) && floor(root,var(43)/1000)>=50
id = 8952
anim = 8952
pos = 111+(teamside=2)*98+floor(root,fvar(17)),208+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = -1
bindtime = -1
ownpal = 0
ontop = 1

;カラクリ兵器アイコン（木騎・半透明化）
[state 8900]
type = ModifyExplod
trigger1 = NumExplod(8952) && (root,var(37)<5000||((root,var(12)!=[2001,5000])&&(root,var(12)!=[-5000,-2001])&&root,var(12)!=0)) && floor(root,var(43)/1000)>=50
id = 8952
trans = AddAlpha
alpha = 96,256

;カラクリ兵器アイコン（木騎・通常）
[state 8900]
type = ModifyExplod
trigger1 = NumExplod(8952) && ((root,var(12)=[2001,5000])||(root,var(12)=[-5000,-2001])||(!root,var(12)&&root,var(37)>=5000&&floor(root,var(43)/1000)>=50)||floor(root,var(43)/1000)<50)
id = 8952
trans = None

;カラクリ兵器アイコン（滅騎）
[state 8900]
type = Explod
trigger1 = !NumExplod(8954) && floor(root,var(43)/1000)>=100
id = 8954
anim = 8954
pos = 128+(teamside=2)*98+floor(root,fvar(17)),208+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 1
bindtime = -1
ownpal = 0
ontop = 1

;カラクリ兵器アイコン（滅騎・半透明化）
[state 8900]
type = ModifyExplod
trigger1 = NumExplod(8954) && (root,var(37)<9999||((root,var(12)!=[10001,19999])&&(root,var(12)!=[-19999,-10001])&&root,var(12)!=0)) && floor(root,var(43)/1000)>=100
id = 8954
trans = AddAlpha
alpha = 96,256

;カラクリ兵器アイコン（滅騎・通常）
[state 8900]
type = ModifyExplod
trigger1 = NumExplod(8954) && ((root,var(12)=[10001,19999])||(root,var(12)=[-19999,-10001])||(!root,var(12)&&root,var(37)>=9999&&floor(root,var(43)/1000)>=100)||floor(root,var(43)/1000)<100)
id = 8954
trans = None

;カラクリ兵器アイコン（仁王車・使用不可マーク）
[state 8900]
type = Explod
trigger1 = !NumExplod(8956) && NumExplod(8950) && (root,var(12)!=[1,2000])&&(root,var(12)!=[-2000,-1])&&root,var(12)!=0
id = 8956
anim = 8959
pos = 95+(teamside=2)*98+floor(root,fvar(17)),208+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 5
bindtime = -1
ownpal = 0
ontop = 1

;カラクリ兵器アイコン（木騎・使用不可マーク）
[state 8900]
type = Explod
trigger1 = !NumExplod(8957) && NumExplod(8952) &&(((root,var(12)!=[2001,5000])&&(root,var(12)!=[-5000,-2001]))) &&root,var(12)!=0 && floor(root,var(43)/1000)>=50
id = 8957
anim = 8959
pos = 111+(teamside=2)*98+floor(root,fvar(17)),208+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 5
bindtime = -1
ownpal = 0
ontop = 1

;カラクリ兵器アイコン（滅騎・使用不可マーク）
[state 8900]
type = Explod
trigger1 = !NumExplod(8958) && NumExplod(8954) &&(((root,var(12)!=[10001,19999])&&(root,var(12)!=[-19999,-10001])))&&root,var(12)!=0 && floor(root,var(43)/1000)>=100
id = 8958
anim = 8959
pos = 128+(teamside=2)*98+floor(root,fvar(17)),208+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 9999
bindtime = -1
ownpal = 0
ontop = 1

;カラクリ兵器アイコン（仁王車・生産中エフェクト）
[state 8900]
type = Explod
trigger1 = !NumExplod(8960) && (root,var(12)=[-999,-1])
id = 8960
anim = 8960
pos = 95+(teamside=2)*98+floor(root,fvar(17)),208+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .05,.05
sprpriority = 99999
bindtime = -1
ownpal = 0
ontop = 1

;カラクリ兵器アイコン（木騎・生産中エフェクト）
[state 8900]
type = Explod
trigger1 = !NumExplod(8960) && (root,var(12)=[-2999,-2001])
id = 8960
anim = 8961
pos = 111+(teamside=2)*98+floor(root,fvar(17)),208+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .05,.05
sprpriority = 99999
bindtime = -1
ownpal = 0
ontop = 1

;カラクリ兵器アイコン（滅騎・生産中エフェクト）
[state 8900]
type = Explod
trigger1 = !NumExplod(8960) && (root,var(12)=[-10999,-10001])
id = 8960
anim = 8962
pos = 128+(teamside=2)*98+floor(root,fvar(17)),208+9+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .05,.05
sprpriority = 99999
bindtime = -1
ownpal = 0
ontop = 1

;カラクリ兵器アイコン（生産中エフェクト・拡大）
[state 8900]
type = ModifyExplod
trigger1 = 1
id = 8960
scale = .025*(time%5+1),.025*(time%5+1)
;sprpriority = 999999
;ontop=1

;カラクリ兵器アイコン（生産中エフェクト・消滅）
[state 8900]
type = RemoveExplod
trigger1 = NumExplod(8960) && root,var(12)>=0
id = 8960

;---カラクリ兵器耐久値ゲージ---
[state 8900]
type = RemoveExplod
trigger1 = NumExplod(8970) && root,var(12)<=0
id = 8970

[state 8900]
type = RemoveExplod
trigger1 = NumExplod(8971) && root,var(12)<=0
id = 8971

;背景
[state 8900]
type = Explod
trigger1 = !NumExplod(8970) && ((root,var(12)=[1,5000])||(root,var(12)=[10001,19999]))
id = 8970
anim = 8970+(teamside=2)*5
pos = 58+(teamside=2)*204+floor(root,fvar(19)),74+floor(1000*ifelse(((root,fvar(19)-floor(root,fvar(19)))=(0,.001)),-1000,1)*(root,fvar(19)-floor(root,fvar(19))))
postype = back
removetime=-1
scale = .5*96,.5
sprpriority = -2
bindtime = -1
ownpal = 1
trans = AddAlpha
alpha = 0,0

;背景・点滅（黒・待機中）
[state 8900]
type = ModifyExplod
trigger1 = NumExplod(8970) && ((root,var(12)=[10001,10850])||(root,var(12)=[2001,2750])||(root,var(12)=[1,600])) && (time%96=[0,64])
id = 8970
trans = AddAlpha
alpha = 0,0

;背景・点滅（黒→白）
[state 8900]
type = ModifyExplod
trigger1 = NumExplod(8970) && ((root,var(12)=[10001,10850])||(root,var(12)=[2001,2750])||(root,var(12)=[1,600])) && (time%96=[65,79])
id = 8970
trans = AddAlpha
alpha = ((time%96-64)%16)*16,0

;背景・点滅（白）
[state 8900]
type = ModifyExplod
trigger1 = NumExplod(8970) && ((root,var(12)=[10001,10850])||(root,var(12)=[2001,2750])||(root,var(12)=[1,600])) && (time%96=[80,80])
id = 8970
trans = AddAlpha
alpha = 256,0

;背景・点滅（白→黒）
[state 8900]
type = ModifyExplod
trigger1 = NumExplod(8970) && ((root,var(12)=[10001,10850])||(root,var(12)=[2001,2750])||(root,var(12)=[1,600])) && (time%96>=81)
id = 8970
trans = AddAlpha
alpha = 256-((time%96-80)%16)*16,0

;ゲージ
[state 8900]
type = Explod
trigger1 = !NumExplod(8971) && ((root,var(12)=[1,2000])||(root,var(12)=[2001,5000])||(root,var(12)=[10001,19999]))
id = 8971
anim = 8970+(teamside=2)*5+(root,var(12)=[1,2000])*1+(root,var(12)=[2001,5000])*2+(root,var(12)=[10001,19999])*3
pos = 58+(teamside=2)*204+floor(root,fvar(19)),74+floor(1000*ifelse(((root,fvar(19)-floor(root,fvar(19)))=(0,.001)),-1000,1)*(root,fvar(19)-floor(root,fvar(19))))
postype = back
removetime=-1
scale = .5*((root,var(12)*96.00/root,fvar(23))),.5
sprpriority = -1
bindtime = -1
ownpal = 0

[state 8900]
type = ModifyExplod
trigger1 = (root,var(12)=[1,2000])
id = 8971
scale = (root,var(12)*96.00/root,fvar(23))*.5,.5

[state 8900]
type = ModifyExplod
trigger1 = (root,var(12)=[2001,5000])
id = 8971
scale = ((root,var(12)-2000)*96.00/root,fvar(23))*.5,.5

[state 8900]
type = ModifyExplod
trigger1 = (root,var(12)=[10001,19999])
id = 8971
scale = ((root,var(12)-10000)*96.00/root,fvar(23))*.5,.5

;手出し無用宣言時ゲージ全消滅
[state 8900]
type = RemoveExplod
trigger1 = root,var(40)=-2

;手出し無用宣言時ゲージ全消滅
[state 8900]
type = DestroySelf
trigger1 = root,var(40)=-2

