;---------------------------------------------------------------------

;---------------------------------------------------------------------
; 基本設定
[Data]
life = 1000          ; 体力ゲージ、上限値（デフォルト：1000）
power = 5000         ; パワーゲージ、デフォルト：1000
attack = 100         ; 攻撃力（％）
defence = 111        ; 防御力（％）
fall.defence_up = 50 ; 空中コンボ修正率（％）
liedown.time = 16    ; ダウン時間
airjuggle = 150       ; 空中コンボ
sparkno = -1          ; 初期ヒットスパーク番号
guard.sparkno = -1   ; 初期ガードスパーク番号
KO.echo = 0          ; ＫＯボイスエコー（0:OFF、1:ON）
volume = 0         ; キャラボイスボリューム値
IntPersistIndex = 32 ;次のラウンドに持ち越すVarを決める
FloatPersistIndex = 15;次のラウンドに持ち越すfVarを決める

[Size]
xscale = .5          ; 水平サイズ倍率
yscale = .5          ; 垂直サイズ倍率
ground.back = 32     ; キャラ幅（地上、後ろ側）
ground.front = 32    ; キャラ幅（地上、前側）
air.back = 32        ; キャラ幅（空中、後ろ側）
air.front = 32       ; キャラ幅（空中、前側）
z.width = 10         ; キャラ幅（ｚ軸）
height = 50          ; キャラの高さ（ジャンプで飛び越せる高さ）
attack.width = 4,4   ;Default attack width: back, front
attack.dist = 360    ;Default attack distance
proj.attack.dist = 90;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too   
head.pos = 6,-140    ; 頭部座標
mid.pos = -10,-80    ; 体中心部座標
shadowoffset = 0     ; キャラの影・オフセット値

[Velocity]
walk.fwd  = 3.25       ; 前進速度
walk.back = -3.5      ; 後退速度
run.fwd  = 9.0, 0  ; 前ダッシュ速度（y<0の場合、ホップステップ）
run.back = -6.0,0  ; バックステップ速度（y=0の場合、走り）
jump.neu = 0,-11.0    ; 垂直ジャンプ速度
jump.fwd = 3.5        ; 前方ジャンプ速度
jump.back = -3.5      ; 後方ジャンプ速度
runjump.fwd = 4.5,-16.5      ;前方ハイジャンプ
runjump.back = -4.5,-16.5 ;後方ハイジャンプ
airjump.fwd = 8.0    ;前方空中ダッシュ
airjump.back = -8.0  ;後方空中ダッシュ

[Movement]
airjump.num = 0        ; 空中ジャンプ回数
;airjump.height = 35   ; 空中ジャンプ最低高度
yaccel = .6           ; キャラ重力加速度
stand.friction = .85   ; 摩擦係数（立ち状態）
crouch.friction = .82  ; 摩擦係数（しゃがみ状態）


;勝利ポーズ
[statedef 180]
type = S
movetype = I
physics = S
ctrl = 0
anim = 180
velset = 0,0

[state 180]
type = RemoveExplod
trigger1 = !time
id = 1505

[state 180]
type = VarSet
trigger1 = !time&&var(33)>0
var(33) = 0

[state 180]
type = ChangeAnim
trigger1 = AnimElem=4,>=36&&AnimElemTime(5)<0&&(!var(40)||var(40)<=-2)
value = anim
elem = 5

[state 180]
type = RemoveExplod
trigger1 = AnimElem=5&&(!var(40)||var(40)<=-2)
id = 181

[state 180]
type = RemoveExplod
trigger1 = AnimElem=5&&(!var(40)||var(40)<=-2)
id = 182

[state 180]
type = PlaySND
trigger1 = AnimElem=3
value = 20,7
;channel = 10
;volume = 128

[state 180]
type = PlaySND
trigger1 = AnimElem=5
value = 20,1
;channel = 10
;volume = 128

[state 180]
type = StatetypeSet
trigger1 = AnimElem=5
statetype=A
physics = N

[state 180]
type = VelSet
trigger1 = AnimElem=5
x = 2.0
y = -8.0

[state 190]
type = Helper
trigger1 = AnimElem=4,=18
id = 6000
stateno = 6000
pos = floor(-126*const(size.xscale)),floor(-220*const(size.yscale))
postype = p1
sprpriority = -1

[state 180]
type = Explod
trigger1 = AnimElem=4
id = 182
anim = 182
pos = floor(-180*const(size.xscale)),floor(-164*const(size.yscale))
postype = p1
sprpriority = 1
bindtime=-1
removeongethit=1
scale = const(size.xscale),const(size.yscale)

[state 180]
type = Explod
trigger1 = AnimElem=4
id = 181
anim = 181
pos = floor(-180*const(size.xscale)),floor(-164*const(size.yscale))
postype = p1
sprpriority = 1
bindtime=-1
removeongethit=1
scale = const(size.xscale),const(size.yscale)

[state 180]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,1

;==WIN
[state -2]
type = Helper
triggerall = time=120 && matchover
trigger1 = !numpartner
trigger2 = numpartner
trigger2 = (ID-partner,ID)>0 && (partner,authorname="rei"||partner,authorname="gal129")&&partner,fvar(39)=7
id = 8600
stateno=8600
pos = 0,0
postype = back
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

;==PERFECT
[state -2]
type = Helper
triggerall = time=150 && !matchover && WinPerfect
trigger1 = !numpartner
trigger2 = numpartner
trigger2 = (ID-partner,ID)>0 && (partner,authorname="rei"||partner,authorname="gal129")&&partner,fvar(39)=7
id = 8650
stateno=8650
pos = 0,0
postype = back
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

[state 180]
type = AssertSpecial
trigger1 = ifelse(matchover,time<560,ifelse(!numenemy,1,time<360))
flag = roundnotover

;イントロ
[statedef 190]
type = S
ctrl = 0
velset = 0,0
anim = 190

;援軍ゲージ、一撃ゲージMAXに
[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(40) = 1

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(43) = 100000

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(42) = 200

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(41) = 200

[State 5900, 1] ;Clear all int variables
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
var(40) = 1

[state 5900]
type = VarSet
trigger1 = roundsexisted = 0 && !time && command="holdup" && command="hold_s"
fvar(15) = 1.00

[state 190]
type = ChangeAnim
trigger1 = Anim=190&&((enemynear,stateno!=[190,199])||teamside=1||Time>=600)&&time>=60
value = 191

[state 190]
type = AssertSpecial
trigger1 = 1
flag = Intro

[state 190]
type = PlaySND
trigger1 = Anim=191 && ifelse(numhelper(6980),(AnimElem=1,=1),(AnimElem=1))
value = 20,0

[state 190]
type = Helper
trigger1 = Anim=191 && AnimElem=1
id = 6800
stateno = 6800
pos = floor(40*const(size.xscale)),floor(-198*const(size.yscale))
postype = p1
sprpriority = 4
xscale = const(size.xscale)*2
yscale = const(size.yscale)*2

[state 190]
type = Explod
trigger1 = Anim=191 && AnimElem=1
id = 6805
anim = 6805
pos = floor(40*const(size.xscale)),floor(-198*const(size.yscale))
postype = P1
sprpriority = 4
scale = const(size.xscale),const(size.yscale)

;~~岩~~~
[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6920
anim = 6920
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
ignorehitpause=1
persistent=0
sprpriority = -2
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6924
anim = 6924
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = .75,-11.0
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6924
anim = 6924
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = -.75,-10.0
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6925
anim = 6925
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = .75,-9.5
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6926
anim = 6926
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = .5,-10.0
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6924
anim = 6924
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = 1,-9.0
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6927
anim = 6927
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = -.5,-11.5
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6926
anim = 6926
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = .5,-8.0
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6925
anim = 6925
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = -.75,-9.5
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6926
anim = 6926
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = -1,-8.5
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6924
anim = 6924
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = .75,-7.5
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6928
anim = 6928
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = -1,-9.5
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6928
anim = 6928
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = 1,-8.5
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6929
anim = 6929
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = -1,-10.0
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 6929
anim = 6929
pos = floor(-110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = 1,-11.0
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 190]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 192
anim = 192
pos = floor(-110*const(size.xscale)),floor(300*const(size.yscale))
postype = P1
vel = 0,-10*const(size.yscale)
sprpriority = 2
scale = const(size.xscale),const(size.yscale)

[state 190]
type = Explod
trigger1 = Anim=191 && AnimElem=6
id = 193
anim = 193
pos = floor(-110*const(size.xscale)),floor(300*const(size.yscale))
postype = P1
vel = 0,-10*const(size.yscale)
sprpriority = 2
scale = const(size.xscale),const(size.yscale)

[state 190]
type = Explod
trigger1 = Anim=191 && AnimElem=6,=52
id = 194
anim = 194
pos = floor(-110*const(size.xscale)),floor(-230*const(size.yscale))
postype = P1
sprpriority = 2
removetime=12
accel = 0,1.0*const(size.yscale)
scale = const(size.xscale),const(size.yscale)

[state 190]
type = Explod
trigger1 = Anim=191 && AnimElem=6,=52
id = 193
anim = 193
pos = floor(-110*const(size.xscale)),floor(-230*const(size.yscale))
postype = P1
sprpriority = 2
removetime=12
accel = 0,1.0*const(size.yscale)
scale = const(size.xscale),const(size.yscale)

[state 190]
type = PlaySND
trigger1 = Anim=191 && AnimElem=5
value = 5100,1

[state 190]
type = ChangeState
trigger1 = AnimTime=0
value = 0

;眼光
[statedef 6800]
ctrl = 0
anim = 6800
sprpriority = 4

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6050]
type = AngleDraw
trigger1 = 1
scale = const(size.xscale)*(Time*1.0/12+1)*2,const(size.yscale)*(1-Time*1.0/12)*2

[state 6050]
type = Trans
trigger1 = 1
trans = add

[state 6050]
type = DestroySelf
trigger1 = AnimTime=0

;挑発
[statedef 195]
type = S
movetype=I
physics = S
ctrl = 0
velset = 0,0
anim = 195
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 195]
type = PlaySND
trigger1 = AnimElem=14
value = 20,0
;channel = 10
;volume = 128

[state 195]
type = EnvShake
trigger1 = AnimElem=14
ampl = 4
time = 16

[state 195]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 195]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;バーニア噴射
[statedef 6000]
ctrl = 0
anim = 6000
sprpriority = ifelse(root,stateno=180,2,-1)

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6050]
type = BindtoRoot
trigger1 = 1
pos = floor(-60*const(size.xscale)),floor(-210*const(size.yscale))

[state 6050]
type = BindtoRoot
trigger1 = Root,Stateno=100
pos = floor(-40*const(size.xscale)),floor(-210*const(size.yscale))

[state 6050]
type = BindtoRoot
trigger1 = Root,Stateno=180
pos = floor(-126*const(size.xscale)),floor(ifelse(root,animelemtime(5)>=0,-286,-220)*const(size.yscale))

[state 6050]
type = BindtoRoot
trigger1 = Root,Stateno=3120
pos = floor(-20*const(size.xscale)),floor(-240*const(size.yscale))

[state 6050]
type = BindtoRoot
trigger1 = root,stateno=1300||(Root,Stateno=[1341,1349])
pos = floor(-90*const(size.xscale)),floor(-250*const(size.yscale))

[state 6050]
type = AngleDraw
trigger1 = 1
value = ifelse(root,stateno=1300||(Root,Stateno=[1341,1349]),-30,ifelse(root,stateno=100||root,stateno=3120,-90,ifelse(root,stateno=110||root,stateno=115||(root,stateno=[1320,1321])||root,stateno=180,-45,0)))
scale = const(size.xscale)*4,const(size.yscale)*4

[state 6050]
type = Trans
trigger1 = 1
trans = add

[state 6050]
type = DestroySelf
trigger1 = Time=24&&Root,stateno!=180&&root,stateno!=3120&&(Root,Stateno!=[1300,1349])
trigger2 = Root,stateno!=100&&Root,stateno!=105&&Root,stateno!=110&&Root,stateno!=115&&Root,stateno!=180&&(Root,Stateno!=[1300,1349])&&root,stateno!=3120
trigger3 = root,stateno=3120&&root,animelemtime(30)>=0

;バーニア噴射2
[statedef 6010]
ctrl = 0
anim = 6000
sprpriority = ifelse(root,stateno=180,2,-1)

[state 6050]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6050]
type = BindtoRoot
trigger1 = 1
pos = floor(0*const(size.xscale)),floor(-230*const(size.yscale))

[state 6050]
type = AngleDraw
trigger1 = 1
value = -60
scale = const(size.xscale)*4,const(size.yscale)*4

[state 6050]
type = Trans
trigger1 = 1
trans = add

[state 6050]
type = DestroySelf
trigger1 = Time=24&&Root,stateno!=180&&root,stateno!=3120
trigger2 = Root,stateno!=100&&Root,stateno!=105&&Root,stateno!=110&&Root,stateno!=115&&Root,stateno!=180&&root,stateno!=3120
trigger3 = root,stateno=3120&&root,animelemtime(30)>=0

;立ち弱
[statedef 200]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time&&var(53)!=1090&&var(53)!=1390
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 200

[state 200]
type = ChangeAnim
trigger1 = Time=1&&AnimElemNo(0)=3
value = 200
elem = 4

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=8

;攻撃状態維持用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
trigger1 = AnimElem=5&&!IsHelper
value = 20,3
;channel = 10
;volume = 128


;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;戦国最強・出力最大
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;電磁形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Denji",3000,var(53))

;突進形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Tosshin",3100,var(53))

;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;防御形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Bougyo",1500+(command="y")*10,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~
;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4&& !var(59); && var(52)>0 && movecontact
trigger1 = ((command="x"&&command="holddown")||command="y"||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
damage = floor(ifelse(40*fvar(0)<1,1+(var(2)%5=4),40*fvar(0))*1.22),floor((40*fvar(3)/5)*1.22)
ground.slidetime = 17+(P2statetype=C)+var(49)*7
ground.hittime = 17+(P2statetype=C)+var(49)*7
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13
ground.velocity = -19.5*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-19.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(33*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(33*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(33*fvar(1)*fvar(3)*.8)*1.38,ceil(33*fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = Light
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(40*fvar(14)<1,1+(var(2)%5=1),40*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&Animelem=6,<0
var(18) = floor(-180*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-19.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-19.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;立ち中
[statedef 210]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=200||prevstateno=400))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time&&var(53)!=1090&&var(53)!=1390
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

[state -2]
type = varset
trigger1 = !time&&anim=400
var(19) = 0
ignorehitpause=1

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 210

[state 210]
type = ChangeAnim
trigger1 = time<=1&&prevstateno=200&&P2statetype=S
value = anim

[state 250]
type = varset
trigger1 = !time
var(47) = AnimElemNo(0)

[state 210]
type = ChangeAnim
trigger1 = (Time=2||var(52)=-1)&&AnimElemNo(0)=4&&!IsHelper&&(var(52)<=0||var(52)=100) && abs(var(19))<40
value = anim
elem = 5

[state 210]
type = ChangeAnim
trigger1 = !Time&&(AnimElemNo(0)=[3,4])&&!IsHelper
value = anim
elem = 4

[state 200]
type = VarSet
trigger1 = Time=(5+(prevstateno=200&&P2statetype!=C))&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=(5+(prevstateno=200&&P2statetype!=C))&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=(5+(prevstateno=200&&P2statetype!=C))&&var(34)
var(35)=14

[state 200]
type = PosAdd
trigger1 = Time=(5+(prevstateno=200&&P2statetype!=C))&&var(34)
x = -1

[state 200]
type = Helper
trigger1 = Time=(5+(prevstateno=200&&P2statetype!=C))&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=(5+(prevstateno=200&&P2statetype!=C))&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=(5+(prevstateno=200&&P2statetype!=C))&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper&&!Time
value = 20000+stateno
elem = 2

[state 200]
type = ChangeAnim
trigger1 = IsHelper
trigger1 = (root,stateno=150||root,stateno=152||root,stateno=154)
value = 20000+stateno
elem = Root,AnimElemNo(0)

[state 200]
type = ChangeAnim
trigger1 = IsHelper
trigger1 = (root,prevstateno=150||root,prevstateno=152||root,prevstateno=154)||!root,var(35)
value = 20000+stateno
elem = ifelse((!root,var(35)&&root,animelemtime(4)>=3)||(root,stateno=210&&root,time=1),5,ifelse(root,var(35)<3,4,ifelse(root,var(35)<9,3,2)))

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = ifelse(root,animelemtime(5)>=0,0,1),0

[state 200]
type = HitAdd
trigger1 = var(19)&&!numhelper(20000)
;trigger1 = !IsHelper
;trigger1 = movehit=1&&var(19)=2
;trigger2 = IsHelper
;trigger2 = movehit=1&&root,var(19)=2
value = 1
ignorehitpause=1
persistent=0

[state 250]
type = varset
trigger1 = numhelper(20000)&&var(34)=210
trigger1 = helper(20000),movecontact
var(19) = 34*ifelse(helper(20000),movehit=1,1,-1);34*ifelse(helper(20000),movehit=1,1,-1);ifelse(helper(20000),movehit,20+(P2statetype=C)+var(49)*7,-18-(P2statetype=C))
persistent=0

[state 200]
type = null;parentvarset
trigger1 = IsHelper&&movecontact&&!var(19)
var(19) = ifelse(movehit,20+(P2statetype=C)+root,var(49)*7,-18-(P2statetype=C))
persistent=0
ignorehitpause=1

[state 200]
type = parentvaradd
trigger1 = IsHelper&&movecontact&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

[state 200]
type = parentvaradd
trigger1 = IsHelper&&movecontact&&numtarget
trigger1 = target,statetype=A
var(3) = 1
persistent=0
ignorehitpause=1

[state 200]
type = varset
trigger1 = IsHelper
var(1) = root,var(1)

[state 200]
type = varset
trigger1 = IsHelper
var(2) = root,var(2)

[state 200]
type = varset
trigger1 = IsHelper
var(3) = root,var(3)

[state 250]
type = parentvarset
trigger1 = movecontact=1&&IsHelper
var(52) = 14
ignorehitpause=1
persistent=0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = (!root,var(34)&&(root,animelemtime(10)>=2||root,movecontact))||(root,stateno!=210&&root,anim!=210)
ignorehitpause=1


[state 190]
type = PlaySND
trigger1 = !(!IsHelper&&var(32))&&AnimElem=4
value = 20,3
;channel = 10
;volume = 128
persistent=0

[state 190]
type = PlaySND
trigger1 = !Ishelper&&AnimElem=9
value = 20,12
;channel = 10
;volume = 128

;~~~自分側のhitpause作成~~
[state 200]
type = VarSet
trigger1 = AnimElem=10
var(19) = 0

[state 200]
type = MoveHitReset
trigger1 = AnimElem=10

[state 250]
type = varset
trigger1 = time=0&&!var(19)&&!NumHelper(20000)
trigger2 = AnimElem=10
var(52) = 100

[state 250]
type = varadd
trigger1 = (movecontact||var(19))&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time && !IsHelper
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;戦国最強・出力最大
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;電磁形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Denji",3000,var(53))

;突進形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Tosshin",3100,var(53))

;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;防御形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Bougyo",1500+(command="y")*10,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4&& !var(59); && var(52)>0 && movecontact
trigger1 = ((command="y"&&(command="holddown"||(command="holdfwd"&&command!="holddown")))||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
trigger1 = !(!IsHelper&&var(32))
trigger1 = !(IsHelper&&movecontact)
damage = ifelse(floor(55*fvar(0))<1,1+(var(2)%5=4),ceil(floor(55*fvar(0))*1.22)),floor((55*fvar(3)/5)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -12.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-9.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(45*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(45*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(45*fvar(1)*fvar(3)*.8)*1.38,ceil(45*fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-160*const(size.xscale))
animtype = Medium
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA
persistent=0

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
trigger1 = IsHelper
damage = ifelse(floor(55*root,fvar(0))<1,1+(root,var(2)%5=4),ceil(floor(55*root,fvar(0))*1.22)),floor((55*root,fvar(3)/4)*1.22)
ground.slidetime = 20+(P2statetype=C)+root,var(49)*7-ifelse(!root,var(3),1,0)
ground.hittime = 20+(P2statetype=C)+root,var(49)*7-ifelse(!root,var(3),1,0)
guard.slidetime = 18-ifelse(!root,var(3),1,0)
guard.hittime = 18-ifelse(!root,var(3),1,0)
pausetime = 15,14
ground.velocity = -12.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(root,numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-4.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-9.0*(51-root,var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(root,var(9),0,floor(45*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(45*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(45*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(45*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-160*const(size.xscale))
animtype = Medium
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA
persistent=0

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
damage = ifelse(floor(55*fvar(0))<1,1+(var(2)%5=4),ceil(floor(55*fvar(0))*1.22)),floor((55*fvar(3)/5)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -12.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0010,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-9.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,9+random%2)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(45*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(45*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(45*fvar(1)*fvar(3)*.8)*1.38,ceil(45*fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-80*const(size.xscale))
animtype = Medium
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = L


[state 200]
type = AttackDist
trigger1 = AnimElem=11
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(55*fvar(14)<1,1+(var(2)%5=1),55*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=4
trigger2 = AnimElem=10
var(16) = 5

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0||AnimElem=10,>=0&&AnimElem=11,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
var(18) = floor(-160*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=10&&AnimElem=11,<0
var(18) = floor(-100*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(344*const(size.xscale)),60,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.5)))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
triggerall = var(1)%2<1&&var(1)%8<4&&target,time=0
trigger1 = animelemtime(6)<=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-13.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
triggerall = var(1)%2<1&&var(1)%8<4&&target,time=0
trigger1 = animelemtime(6)>0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-12.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;立ち強
[statedef 220]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time&&var(53)!=1090&&var(53)!=1390
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 220

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=4&&var(7)<=0
value = 220
elem = 5

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=23

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&(prevstateno!=[130,154])
var(7) = 0

[state 220]
type = varadd
trigger1 = var(7)<76&&((command="hold_z"&&!var(59))||(random<0&&var(59)))
trigger1 = (animelemtime(3)>=0&&animelemtime(4)<=2&&var(7))||(animelemtime(2)=4&&!var(7))
var(7) = 1

[state 220]
type = PlaySND
trigger1 = var(7)=1
value = 7400,0
;channel = 10
;volume = 128
persistent=0

[state 220]
type = ChangeAnim
trigger1 = var(7)=1||(!time&&(prevstateno=[130,154])&&var(7)>0)
value = 225
elem = 3
persistent=0

[state 220]
type = ChangeState
trigger1 = ((animelemtime(3)>=0&&animelemtime(3)<=3)||(animelemtime(4)>=0&&animelemtime(4)<=3))&&var(7)>=28
trigger1 = command!="hold_z"&&!var(59)&&var(7)
trigger2 = var(7)>=76
value = ifelse((var(7)=[28,43]),225,ifelse((var(7)=[44,59]),226,ifelse((var(7)=[60,75]),227,228)))
persistent=0

[state 220]
type = ChangeAnim
trigger1 = ((animelemtime(3)>=0&&animelemtime(3)<=3)||(animelemtime(4)>=0&&animelemtime(4)<=3))&&(var(7)=[1,28])
trigger1 = command!="hold_z"&&!var(59)&&var(7)
value = 220
elem = 3
persistent=0

[state 220]
type = null;ChangeAnim
trigger1 = (animelemtime(3)>=0&&animelemtime(3)<=3)||(animelemtime(4)>=0&&animelemtime(4)<=3)
trigger1 = command!="hold_z"&&!var(59)&&var(7)
trigger2 = var(7)>=76
value = ifelse(var(7)<28,220,ifelse((var(7)=[28,43]),225,ifelse((var(7)=[44,59]),226,ifelse((var(7)=[60,75]),227,228))))
elem = ifelse(var(7)<28,3,5)
persistent=0

[state 220]
type = ChangeAnim
trigger1 = animelemtime(4)=3&&var(7)&&((command="hold_z"&&!var(59))||(random<0&&var(59)))&&var(7)<76&&anim=225
value = anim
elem = 3

;溜めエフェクト
[state -2]
type = Helper
trigger1 = var(7)%8=1 && anim=225&&animelemtime(3)>=0&&animelemtime(5)<0
id = 7770
stateno=7770
pos = 0,0
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999
;~~~~~

[state 190]
type = PlaySND
triggerall = anim=220
trigger1 = AnimElem=5
trigger2 = AnimElem=7
value = 20,3
;channel = 10
;volume = 128

[state 220]
type = StatetypeSet
trigger1 = movetype=I
movetype=A

[state 220]
type = StatetypeSet
trigger1 = AnimElemTime(2)>=0&&AnimElemTime(4)<5
movetype=I

;~~~自分側のhitpause作成~~
[state 200]
type = MoveHitReset
trigger1 = AnimElem=7

[state 250]
type = varset
trigger1 = time=0
trigger2 = AnimElem=7
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;戦国最強・出力最大
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;電磁形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Denji",3000,var(53))

;突進形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Tosshin",3100,var(53))

;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;防御形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Bougyo",1500+(command="y")*10,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~
;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && !var(59)
var(53) = ifelse(var(0)<10 && command="longjump",50,ifelse(command="holdup",40,var(53)))+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4&& !var(59); && var(52)>0 && movecontact
trigger1 = (command="y"&&command="holdfwd"&&command!="holddown")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
trigger1 = Anim=220
damage = floor(ifelse(82*fvar(0)<1,1+(var(2)%5=4),82*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = ifelse(var(49),-11.0-.0014,-10*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)),-22*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-18.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(49),-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-22.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
trigger1 = Anim=220
damage = floor(ifelse(82*fvar(0)<1,1+(var(2)%5=4),82*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = ifelse(var(49),-11.0-.0014,-10*const(size.xscale)),-22*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-18.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(49),-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-22.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = up
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;==壁ダウンに
[state 920]
type = varset
trigger1 = movehit=1 && numtarget&&var(6)%10<1
trigger1 = target,time=0 && var(49)
var(1) = 4
ignorehitpause=1
persistent=0

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget&&var(6)%10<1
trigger1 = target,time=0 && var(49)
value = 936
ignorehitpause=1
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=8
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(82*fvar(14)<1,1+(var(2)%5=1),82*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=8,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5&&AnimElem=6,<0
var(18) = floor(-260*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=7&&AnimElem=8,<0
var(18) = floor(-100*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-18.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-18.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;立ち強溜め１
[statedef 225]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0,0)+(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5)*fvar(5),0

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time&&var(53)!=1090&&var(53)!=1390
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 225
elem = 5

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=6
value = 225
elem = 7

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
elem = 5
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
trigger1 = AnimElem=7
trigger2 = AnimElem=12
trigger3 = AnimElem=14
value = 20,3
;channel = 10
;volume = 128

[state 220]
type = StatetypeSet
trigger1 = movetype=I
movetype=A

[state 220]
type = StatetypeSet
trigger1 = AnimElemTime(6)<0
movetype=I
;~~~自分側のhitpause作成~~
[state 200]
type = MoveHitReset
trigger1 = AnimElem=12
trigger2 = AnimElem=14

[state 250]
type = varset
trigger1 = time=0
trigger2 = AnimElem=12
trigger3 = AnimElem=14
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;戦国最強・出力最大
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;電磁形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Denji",3000,var(53))

;突進形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Tosshin",3100,var(53))

;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;防御形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Bougyo",1500+(command="y")*10,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~
;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && !var(59)
var(53) = ifelse(var(0)<10 && command="longjump",50,ifelse(command="holdup",40,var(53)))+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4&& !var(59); && var(52)>0 && movecontact
trigger1 = var(15)>0||(command="y"&&command="holdfwd"&&command!="holddown")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
damage = floor(ifelse(68*fvar(0)<1,1+(var(2)%5=4),68*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -15.0*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-16.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-120*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=12,>=0&&AnimElem=13,<0
damage = floor(ifelse(82*fvar(0)<1,1+(var(2)%5=4),82*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = ifelse(var(49),-11.0-.0014,-10*const(size.xscale)),-22*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(49),-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-22.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=14,>=0&&AnimElem=15,<0
damage = floor(ifelse(82*fvar(0)<1,1+(var(2)%5=4),82*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = ifelse(var(49),-11.0-.0014,-10*const(size.xscale)),-22*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(49),-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-22.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

[state 200]
type = VarSet
trigger1 = 1
fvar(8) = ifelse(animelemtime(11)<0,ifelse((command="holdfwd"&&!var(59))||(var(51)%7<5&&var(59)),2.0,ifelse(command="holdback"&&!var(59),-2.0,0)),0)

[state 200]
type = VelSet
trigger1 = !fvar(9)&&fvar(8)&&!fvar(7)
x = fvar(8)

;==壁ダウンに
[state 920]
type = varset
trigger1 = movehit=1 && numtarget
trigger1 = AnimElemTime(12)>=0&&AnimElemTime(15)<0&&target,time=0 && var(49)
var(1) = 4
ignorehitpause=1
persistent=0

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget
trigger1 = AnimElemTime(12)>=0&&AnimElemTime(15)<0&&target,time=0 && var(49)
value = 936
ignorehitpause=1
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=15
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(82*fvar(14)<1,1+(var(2)%5=1),82*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=7
trigger2 = AnimElem=12
trigger3 = AnimElem=14
var(16) = 5

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=15,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
var(18) = floor(-180*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=12,>=0&&AnimElem=13,<0
var(18) = floor(-260*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=14,>=0&&AnimElem=15,<0
var(18) = floor(-100*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
trigger1 = animelemtime(12)<0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
trigger1 = animelemtime(12)>=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;立ち強溜め２
[statedef 226]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time&&var(53)!=1090&&var(53)!=1390
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 226
elem = 5

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=6
value = 226
elem = 7

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
elem = 5
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
trigger1 = AnimElem=7
trigger2 = AnimElem=10
trigger3 = AnimElem=13
trigger4 = AnimElem=18
trigger5 = AnimElem=20
value = 20,3
;channel = 10
;volume = 128

[state 220]
type = StatetypeSet
trigger1 = movetype=I
movetype=A

[state 220]
type = StatetypeSet
trigger1 = AnimElemTime(6)<0
movetype=I

;~~~自分側のhitpause作成~~
[state 200]
type = MoveHitReset
trigger1 = AnimElem=10
trigger2 = AnimElem=13
trigger3 = AnimElem=18
trigger4 = AnimElem=20

[state 250]
type = varset
trigger1 = time=0
trigger2 = AnimElem=10
trigger3 = AnimElem=13
trigger4 = AnimElem=18
trigger5 = AnimElem=20
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;戦国最強・出力最大
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;電磁形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Denji",3000,var(53))

;突進形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Tosshin",3100,var(53))

;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;防御形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Bougyo",1500+(command="y")*10,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~
;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && !var(59)
var(53) = ifelse(var(0)<10 && command="longjump",50,ifelse(command="holdup",40,var(53)))+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4&& !var(59); && var(52)>0 && movecontact
trigger1 = var(15)>0||(command="y"&&command="holdfwd"&&command!="holddown")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
trigger2 = AnimElem=13,>=0&&AnimElem=14,<0
damage = floor(ifelse(68*fvar(0)<1,1+(var(2)%5=4),68*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -15.0*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-16.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-120*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
damage = floor(ifelse(68*fvar(0)<1,1+(var(2)%5=4),68*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -15.0*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-16.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=18,>=0&&AnimElem=19,<0
damage = floor(ifelse(82*fvar(0)<1,1+(var(2)%5=4),82*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = ifelse(var(49),-11.0-.0014,-10*const(size.xscale)),-22*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(49),-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-22.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=20,>=0&&AnimElem=21,<0
damage = floor(ifelse(82*fvar(0)<1,1+(var(2)%5=4),82*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = ifelse(var(49),-11.0-.0014,-10*const(size.xscale)),-22*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(49),-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-22.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

[state 200]
type = VarSet
trigger1 = 1
fvar(8) = ifelse(animelemtime(16)<0,ifelse((command="holdfwd"&&!var(59))||(var(51)%7<5&&var(59)),2.0,ifelse(command="holdback"&&!var(59),-2.0,0)),0)

[state 200]
type = VelSet
trigger1 = !fvar(9)&&fvar(8)&&!fvar(7)
x = fvar(8)


;==壁ダウンに
[state 920]
type = varset
trigger1 = movehit=1 && numtarget
trigger1 = AnimElemTime(18)>=0&&AnimElemTime(21)<0&&target,time=0 && var(49)
var(1) = 4
ignorehitpause=1
persistent=0

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget
trigger1 = AnimElemTime(18)>=0&&AnimElemTime(21)<0&&target,time=0 && var(49)
value = 936
ignorehitpause=1
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=21
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(82*fvar(14)<1,1+(var(2)%5=1),82*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=7
trigger2 = AnimElem=10
trigger3 = Animelem=13
trigger4 = AnimElem=18
trigger5 = AnimElem=20
var(16) = 5

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=21,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=10,<0
trigger2 = AnimElem=13,>=0&&AnimElem=15,<0
var(18) = floor(-160*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
var(18) = floor(-180*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=18,>=0&&AnimElem=19,<0
var(18) = floor(-260*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=20,>=0&&AnimElem=21,<0
var(18) = floor(-100*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
trigger1 = animelemtime(17)<0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
trigger1 = animelemtime(17)>=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;立ち強溜め３
[statedef 227]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time&&var(53)!=1090&&var(53)!=1390
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 227
elem = 5

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=6
value = 227
elem = 7

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
elem = 5
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
trigger1 = AnimElem=7
trigger2 = AnimElem=10
trigger3 = AnimElem=13
trigger3 = AnimElem=16
trigger4 = AnimElem=19
trigger5 = AnimElem=21
value = 20,3
;channel = 10
;volume = 128

[state 220]
type = StatetypeSet
trigger1 = movetype=I
movetype=A

[state 220]
type = StatetypeSet
trigger1 = AnimElemTime(6)<0
movetype=I

;~~~自分側のhitpause作成~~
[state 200]
type = MoveHitReset
trigger1 = AnimElem=10
trigger2 = AnimElem=13
trigger3 = AnimElem=16
trigger4 = AnimElem=19
trigger5 = AnimElem=21

[state 250]
type = varset
trigger1 = time=0
trigger2 = AnimElem=10
trigger3 = AnimElem=13
trigger4 = AnimElem=16
trigger5 = AnimElem=19
trigger6 = AnimElem=21
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;戦国最強・出力最大
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;電磁形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Denji",3000,var(53))

;突進形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Tosshin",3100,var(53))

;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;防御形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Bougyo",1500+(command="y")*10,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~
;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && !var(59)
var(53) = ifelse(var(0)<10 && command="longjump",50,ifelse(command="holdup",40,var(53)))+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4&& !var(59); && var(52)>0 && movecontact
trigger1 = var(15)>0||(command="y"&&command="holdfwd"&&command!="holddown")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
trigger2 = AnimElem=13,>=0&&AnimElem=14,<0
damage = floor(ifelse(68*fvar(0)<1,1+(var(2)%5=4),68*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -15.0*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-16.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-120*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
trigger2 = AnimElem=16,>=0&&AnimElem=17,<0
damage = floor(ifelse(68*fvar(0)<1,1+(var(2)%5=4),68*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -15.0*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-16.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=19,>=0&&AnimElem=20,<0
damage = floor(ifelse(82*fvar(0)<1,1+(var(2)%5=4),82*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = ifelse(var(49),-11.0-.0014,-10*const(size.xscale)),-22*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(49),-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-22.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA


;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=21,>=0&&AnimElem=22,<0
damage = floor(ifelse(82*fvar(0)<1,1+(var(2)%5=4),82*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = ifelse(var(49),-11.0-.0014,-10*const(size.xscale)),-22*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(49),-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-22.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

[state 200]
type = VarSet
trigger1 = 1
fvar(8) = ifelse(animelemtime(17)<0,ifelse((command="holdfwd"&&!var(59))||(var(51)%7<5&&var(59)),2.0,ifelse(command="holdback"&&!var(59),-2.0,0)),0)

[state 200]
type = VelSet
trigger1 = !fvar(9)&&fvar(8)&&!fvar(7)
x = fvar(8)


;==壁ダウンに
[state 920]
type = varset
trigger1 = movehit=1 && numtarget
trigger1 = AnimElemTime(19)>=0&&AnimElemTime(22)<0&&target,time=0 && var(49)
var(1) = 4
ignorehitpause=1
persistent=0

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget
trigger1 = AnimElemTime(19)>=0&&AnimElemTime(22)<0&&target,time=0 && var(49)
value = 936
ignorehitpause=1
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=22
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(82*fvar(14)<1,1+(var(2)%5=1),82*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=7
trigger2 = AnimElem=10
trigger3 = AnimElem=13
trigger4 = AnimElem=16
trigger5 = AnimElem=19
trigger6 = AnimElem=21
var(16) = 5

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=22,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=10,<0
trigger2 = AnimElem=13,>=0&&AnimElem=15,<0
var(18) = floor(-160*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
trigger2 = AnimElem=16,>=0&&AnimElem=17,<0
var(18) = floor(-180*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=19,>=0&&AnimElem=20,<0
var(18) = floor(-260*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=21,>=0&&AnimElem=22,<0
var(18) = floor(-100*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
trigger1 = animelemtime(18)<0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
trigger1 = animelemtime(18)>=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;立ち強溜め４
[statedef 228]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time&&var(53)!=1090&&var(53)!=1390
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 228
elem = 5

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=6
value = 228
elem = 7

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
elem = 5
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
trigger1 = AnimElem=7
trigger2 = AnimElem=10
trigger3 = AnimElem=13
trigger4 = AnimElem=16
trigger5 = AnimElem=19
trigger6 = AnimElem=24
trigger7 = AnimElem=26
value = 20,3
;channel = 10
;volume = 128

[state 220]
type = StatetypeSet
trigger1 = movetype=I
movetype=A

[state 220]
type = StatetypeSet
trigger1 = AnimElemTime(6)<0
movetype=I

;~~~自分側のhitpause作成~~
[state 200]
type = MoveHitReset
trigger1 = AnimElem=10
trigger2 = AnimElem=13
trigger3 = AnimElem=16
trigger4 = AnimElem=19
trigger5 = AnimElem=24
trigger6 = AnimElem=26

[state 250]
type = varset
trigger1 = time=0
trigger2 = AnimElem=10
trigger3 = AnimElem=13
trigger4 = AnimElem=16
trigger5 = AnimElem=19
trigger6 = AnimElem=24
trigger7 = AnimElem=26
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;戦国最強・出力最大
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;電磁形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Denji",3000,var(53))

;突進形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Tosshin",3100,var(53))

;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;防御形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Bougyo",1500+(command="y")*10,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~
;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && !var(59)
var(53) = ifelse(var(0)<10 && command="longjump",50,ifelse(command="holdup",40,var(53)))+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4&& !var(59); && var(52)>0 && movecontact
trigger1 = var(15)>0||(command="y"&&command="holdfwd"&&command!="holddown")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
trigger2 = AnimElem=13,>=0&&AnimElem=14,<0
trigger3 = AnimElem=19,>=0&&AnimElem=20,<0
damage = floor(ifelse(68*fvar(0)<1,1+(var(2)%5=4),68*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -15.0*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-16.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-120*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
trigger2 = AnimElem=16,>=0&&AnimElem=17,<0
damage = floor(ifelse(68*fvar(0)<1,1+(var(2)%5=4),68*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -15.0*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-16.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=24,>=0&&AnimElem=25,<0
damage = floor(ifelse(82*fvar(0)<1,1+(var(2)%5=4),82*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = ifelse(var(49),-11.0-.0014,-10*const(size.xscale)),-22*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(49),-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-22.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=26,>=0&&AnimElem=27,<0
damage = floor(ifelse(82*fvar(0)<1,1+(var(2)%5=4),82*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = ifelse(var(49),-11.0-.0014,-10*const(size.xscale)),-22*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(49),-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-22.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(80*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(80*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(80*fvar(1)*fvar(3)*.8)*1.38,ceil(80*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

[state 200]
type = VarSet
trigger1 = 1
fvar(8) = ifelse(animelemtime(22)<0,ifelse((command="holdfwd"&&!var(59))||(var(51)%7<5&&var(59)),2.0,ifelse(command="holdback"&&!var(59),-2.0,0)),0)

[state 200]
type = VelSet
trigger1 = !fvar(9)&&fvar(8)&&!fvar(7)
x = fvar(8)

;==壁ダウンに
[state 920]
type = varset
trigger1 = movehit=1 && numtarget
trigger1 = AnimElemTime(24)>=0&&AnimElemTime(27)<0&&target,time=0 && var(49)
var(1) = 4
ignorehitpause=1
persistent=0

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget
trigger1 = AnimElemTime(24)>=0&&AnimElemTime(27)<0&&target,time=0 && var(49)
value = 936
ignorehitpause=1
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=27
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(82*fvar(14)<1,1+(var(2)%5=1),82*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=7
trigger2 = AnimElem=10
trigger3 = AnimElem=13
trigger4 = AnimElem=16
trigger5 = AnimElem=19
trigger6 = AnimElem=24
trigger7 = AnimElem=26
var(16) = 5

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=27,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=10,<0
trigger2 = AnimElem=13,>=0&&AnimElem=15,<0
trigger3 = AnimElem=19,>=0&&AnimElem=21,<0
var(18) = floor(-160*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=10,>=0&&AnimElem=11,<0
trigger2 = AnimElem=16,>=0&&AnimElem=17,<0
var(18) = floor(-180*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=24,>=0&&AnimElem=25,<0
var(18) = floor(-260*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(407*const(size.xscale)),45,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=26,>=0&&AnimElem=27,<0
var(18) = floor(-100*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
trigger1 = animelemtime(22)<0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
trigger1 = animelemtime(22)>=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;6中
[statedef 310]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,229])||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,229])||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,229])||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time&&var(53)!=1090&&var(53)!=1390
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 310

[state 200]
type = ChangeAnim
trigger1 = Time=1&&AnimElemNo(0)=9
value = 310
elem = 10

[state 200]
type = VarSet
trigger1 = Time=13&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=13&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=13&&var(34)
var(35)=11

[state 200]
type = Helper
trigger1 = Time=13&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=13&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=13&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)&&root,AnimElemTime(8)>=0

[state 190]
type = PlaySND
trigger1 = AnimElem=10
value = 20,3
;channel = 10
;volume = 128

[state 200]
type = statetypeset
trigger1 = AnimElem=10
physiscs = N

[state 200]
type = VelSet
trigger1 = AnimElem=10
x = 4.0

[state 200]
type = VelMul
trigger1 = AnimElem=10,>0
x = .9

[state 200]
type = VelSet
trigger1 = AnimElem=10
fvar(8) = 4.0

[state 200]
type = VelSet
trigger1 = AnimElem=10,>0
fvar(8) = fvar(8)*.9

[state 190]
type = PlaySND
trigger1 = AnimElem=13
value = 5100,2

[state 190]
type = EnvShake
trigger1 = AnimElem=13
time = 12
ample = 6

;~~~自分側のhitpause作成~~
[state 200]
type = MoveHitReset
trigger1 = AnimElem=12
trigger2 = AnimElem=13

[state 250]
type = varset
trigger1 = time=0
trigger2 = AnimElem=12
trigger3 = AnimElem=13
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;戦国最強・出力最大
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;電磁形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Denji",3000,var(53))

;突進形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Tosshin",3100,var(53))

;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;防御形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Bougyo",1500+(command="y")*10,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=11,>=0&&AnimElem=12,<0
damage = floor(ifelse(42*fvar(0)<1,1+(var(2)%5=4),42*fvar(0))*1.22),floor((42*fvar(3)/5)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -15.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-6.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(55*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(55*fvar(1)*fvar(3)*.8)*1.38,ceil(55*fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-240*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = H

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=12,>=0&&AnimElem=13,<0
damage = floor(ifelse(46*fvar(0)<1,1+(var(2)%5=4),46*fvar(0))*1.22),floor((46*fvar(3)/5)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -15.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-6.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(55*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(55*fvar(1)*fvar(3)*.8)*1.38,ceil(55*fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = H

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=13,>=0&&AnimElem=14,<0
damage = floor(ifelse(52*fvar(0)<1,1+(var(2)%5=4),52*fvar(0))*1.22),floor((52*fvar(3)/5)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -6*const(size.xscale),-8*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-8.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(55*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(55*fvar(1)*fvar(3)*.8)*1.38,ceil(55*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = H

[state 200]
type = AttackDist
trigger1 = AnimElem=14
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse((42+(AnimElem=12,>=0)*6+(AnimElem=13,>=0)*6)*fvar(14)<1,1+(var(2)%5=1),(42+(AnimElem=12,>=0)*6+(AnimElem=13,>=0)*6)*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=11
trigger2 = AnimElem=12
trigger3 = AnimElem=13
var(16) = 5

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=11,>=0&&AnimElem=14,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=11&&AnimElem=12,<0
var(18) = floor(-240*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(290*const(size.xscale)),60,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.5)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=12&&AnimElem=13,<0
var(18) = floor(-180*const(size.xscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(274*const(size.xscale)),40,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.375)))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=13&&AnimElem=14,<0
var(18) = floor(-30*const(size.xscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(274*const(size.xscale)),30,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
triggerall = var(1)%2<1&&var(1)%8<4&&target,time=0
trigger1 = 1
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
triggerall = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
trigger1 = var(1)=1||(var(1)=[3,6])
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;しゃがみ弱
[statedef 400]
type = C
movetype=A
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&prevstateno=200)
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&prevstateno=200)
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&prevstateno=200)
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time&&var(53)!=1090&&var(53)!=1390
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 400

[state 210]
type = ChangeAnim
trigger1 = time=0&&AnimElemNo(0)=6&&!IsHelper
value = anim
elem = 7

[state 210]
type = ChangeAnim
trigger1 = time=2&&AnimElemNo(0)=7&&!IsHelper
value = anim
elem = 8

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = PosAdd
trigger1 = Time=0&&var(34)
x = -1

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=7

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper&&!time
value = 20000+stateno

[state 200]
type = ChangeAnim
trigger1 = IsHelper
trigger1 = (root,stateno=150||root,stateno=152||root,stateno=154)
value = 20000+stateno
elem = Root,AnimElemNo(0)-(root,time=0)

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = ifelse(root,animelemtime(7)>=0,0,1),0

[state 200]
type = parentvaradd
trigger1 = IsHelper&&movecontact&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

[state 200]
type = parentvaradd
trigger1 = IsHelper&&movecontact&&numtarget
trigger1 = target,statetype=A
var(3) = 1
persistent=0
ignorehitpause=1

[state 200]
type = varset
trigger1 = IsHelper
var(1) = root,var(1)

[state 200]
type = varset
trigger1 = IsHelper
var(2) = root,var(2)

[state 200]
type = varset
trigger1 = IsHelper
var(3) = root,var(3)

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = (!root,var(34)&&(root,animelemtime(7)>=1||root,movecontact))||(root,stateno!=400&&root,anim!=400)
ignorehitpause=1

[state 190]
type = PlaySND
trigger1 = !(!IsHelper&&var(32))&&AnimElem=7
value = 20,3
;channel = 10
;volume = 128
persistent=0

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0&&!var(19)
var(52) = 100

[state 250]
type = varadd
trigger1 = (movecontact||var(19))&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 12

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time&&!var(19)&& !IsHelper
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;戦国最強・出力最大
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;電磁形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Denji",3000,var(53))

;突進形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Tosshin",3100,var(53))

;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;防御形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Bougyo",1500+(command="y")*10,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~
;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4&& !var(59); && var(52)>0 && movecontact
trigger1 = (command="y"||command="z")
trigger1 = !(var(15)<=0&&command="x")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
trigger1 = !(!IsHelper&&var(32))&&time>4
trigger1 = !(IsHelper&&movecontact)
damage = floor(ifelse(37*fvar(0)<1,1+(var(2)%5=4),37*fvar(0))*1.22),floor((37*fvar(3)/5)*1.22)
ground.slidetime = 14+(P2statetype=C)+var(49)*6
ground.hittime = 14+(P2statetype=C)+var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,12
ground.velocity = -12.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0012,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-11.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),30+12,16-ifelse(floor(var(14)/70)>7,7,floor(var(14)/70))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(var(9),0,floor(26*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(26*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(26*fvar(1)*fvar(3)*.8)*1.38,ceil(26*fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = L
persistent=0

;Attack Lv.3
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
trigger1 = IsHelper
damage = floor(ifelse(37*root,fvar(0)<1,1+(root,var(2)%5=4),37*root,fvar(0))*1.22),floor((37*root,fvar(3)/4)*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 13,12
ground.velocity = -12.0*(1.0+ifelse(root,var(2)>31,31,root,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(root,numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0012,-6.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),30+12,16-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(33*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(33*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(33*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(33*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = L
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=7
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(37*fvar(14)<1,1+(var(2)%5=1),37*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(18) = floor(-30*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-12.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-12.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,12,14+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (12-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 11
ctrl = 1


;しゃがみ中
[statedef 410]
type = C
movetype=A
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=400))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=400))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||prevstateno=400))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time&&var(53)!=1090&&var(53)!=1390
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 410

[state 200]
type = ChangeAnim
trigger1 = Time=2&&AnimElemNo(0)=12
value = 410
elem = 13

[state 200]
type = VarSet
trigger1 = Time=(15-1)&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=(15-1)&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=(15-1)&&var(34)
var(35)=13

;攻撃発生中のガードポイント
[state 200]
type = HitBy
trigger1 = var(32)&&AnimElemTime(12)>0&&AnimElemTime(12)<=1&&!movecontact
value = ,AT

[state 200]
type = Helper
trigger1 = Time=(15-1)&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=(15-1)&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=(15-1)&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper&&!Time
value = 20000+stateno
elem = 8

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = ChangeAnim
trigger1 = IsHelper
trigger1 = (root,stateno=150||root,stateno=152||root,stateno=154)
value = 20000+stateno
elem = Root,AnimElemNo(0)

[state 200]
type = ChangeAnim
trigger1 = IsHelper
trigger1 = (root,prevstateno=150||root,prevstateno=152||root,prevstateno=154)||!root,var(35)
value = 20000+stateno
elem = ifelse((!root,var(35)&&root,animelemtime(12)>=3)||(root,stateno=210&&root,time=2),13,ifelse(root,var(35)<2,12,ifelse(root,var(35)<5,11,ifelse(root,var(35)<8,10,ifelse(root,var(35)<11,9,8)))))

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = ifelse(root,animelemtime(13)>=0,0,1),0

[state 200]
type = HitAdd
trigger1 = var(19)&&!numhelper(20000)
;trigger1 = !IsHelper
;trigger1 = movehit=1&&var(19)=2
;trigger2 = IsHelper
;trigger2 = movehit=1&&root,var(19)=2
value = 1
ignorehitpause=1
persistent=0

[state 250]
type = varset
trigger1 = numhelper(20000)&&var(34)=410
trigger1 = helper(20000),movecontact
var(19) = 34*ifelse(helper(20000),movehit=1,1,-1);34*ifelse(helper(20000),movehit=1,1,-1);ifelse(helper(20000),movehit,20+(P2statetype=C)+var(49)*7,-18-(P2statetype=C))
persistent=0

[state 200]
type = null;parentvarset
trigger1 = IsHelper&&movecontact&&!var(19)
var(19) = ifelse(movehit,20+(P2statetype=C)+root,var(49)*7,-18-(P2statetype=C))
persistent=0
ignorehitpause=1

[state 200]
type = parentvaradd
trigger1 = IsHelper&&movecontact&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

[state 200]
type = parentvaradd
trigger1 = IsHelper&&movecontact&&numtarget
trigger1 = target,statetype=A
var(3) = 1
persistent=0
ignorehitpause=1

[state 200]
type = varset
trigger1 = IsHelper
var(1) = root,var(1)

[state 200]
type = varset
trigger1 = IsHelper
var(2) = root,var(2)

[state 200]
type = varset
trigger1 = IsHelper
var(3) = root,var(3)

[state 250]
type = parentvarset
trigger1 = movecontact=1&&IsHelper
var(52) = 14
ignorehitpause=1
persistent=0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = (!root,var(34)&&(root,animelemtime(13)>=1||root,movecontact))||(root,stateno!=410&&root,anim!=410)
ignorehitpause=1

[state 190]
type = PlaySND
triggerall = !Ishelper
trigger1 = AnimElem=7
trigger2 = AnimElem=8
trigger3 = AnimElem=9
trigger4 = AnimElem=10
trigger5 = AnimElem=11
trigger6 = time>10&&AnimElem=12
value = 410,0;20,3
;channel = 10

[state 200]
type = PosAdd
trigger1 = AnimElem=7
trigger2 = AnimElem=8
trigger3 = AnimElem=9
trigger4 = AnimElem=10
trigger5 = AnimElem=11
trigger6 = time>10&&AnimElem=12
x = floor(30*const(size.xscale))


;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;戦国最強・出力最大
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;電磁形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Denji",3000,var(53))

;突進形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Tosshin",3100,var(53))

;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;防御形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Bougyo",1500+(command="y")*10,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4&& !var(59); && var(52)>0 && movecontact
trigger1 = ((command="y"&&command="holdfwd"&&command!="holddown")||command="z")
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=12,>=0&&AnimElem=13,<0
damage = ifelse(floor(63*fvar(0))<1,1+(var(2)%5=4),ceil(floor(63*fvar(0))*1.22)),floor((63*fvar(3)/5)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -6*const(size.xscale),-16*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-16.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.06)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-18.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(55*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(55*fvar(1)*fvar(3)*.8)*1.38,ceil(55*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Medium
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = LA
persistent=0

;Attack Lv.5
[state 200]
type = null;Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=12,>=0&&AnimElem=13,<0
trigger1 = !(!IsHelper&&var(32))
trigger1 = !(IsHelper&&movecontact)
damage = ifelse(floor(63*fvar(0))<1,1+(var(2)%5=4),ceil(floor(63*fvar(0))*1.22)),floor((63*fvar(3)/5)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -6*const(size.xscale),-16*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-6.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-16.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(55*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(55*fvar(1)*fvar(3)*.8)*1.38,ceil(55*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Medium
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = LA
persistent=0

;Attack Lv.5
[state 200]
type = null;Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=12,>=0&&AnimElem=13,<0
trigger1 = IsHelper
damage = ifelse(floor(63*root,fvar(0))<1,1+(root,var(2)%5=4),ceil(floor(63*root,fvar(0))*1.22)),floor((63*root,fvar(3)/4)*1.22)
ground.slidetime = 20+(P2statetype=C)+root,var(49)*7-ifelse(!root,var(3),1,0)
ground.hittime = 20+(P2statetype=C)+root,var(49)*7-ifelse(!root,var(3),1,0)
guard.slidetime = 18-ifelse(!root,var(3),1,0)
guard.hittime = 18-ifelse(!root,var(3),1,0)
pausetime = 15,14
ground.velocity = -6*const(size.xscale),-16*const(size.yscale)
guard.velocity = ifelse(root,numtarget(920),-44,-12.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity =ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-6.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-16.0*(51-root,var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(root,var(9),0,floor(55*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(55*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(55*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(55*root,fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = Medium
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = LA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=13
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(63*fvar(14)<1,1+(var(2)%5=1),63*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=12
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=12,>=0&&AnimElem=13,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=12&&AnimElem=13,<0
var(18) = floor(-120*const(size.yscale))+floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(274*const(size.xscale)),30,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.25)))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-18.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-18.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 11
ctrl = 1

;しゃがみ強
[statedef 420]
type = C
movetype=A
physics = C
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||(prevstateno=[400,410])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||(prevstateno=[400,410])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,210])||(prevstateno=[400,410])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 200]
type = VarSet
trigger1 = !Time&&var(53)!=1090&&var(53)!=1390
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

[state -2]
type = varset
trigger1 = !time&&(anim=400||anim=210)
var(19) = 0
ignorehitpause=1

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 420

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=7&&Anim=420
value = 420
elem = 6

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=8&&Anim=420
value = 420
elem = 9

[state 200]
type = VarSet
trigger1 = Time=9&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=9&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=9&&var(34)
var(35)=10;本来11F

;攻撃発生中のガードポイント
[state 200]
type = HitBy
trigger1 = var(32)&&AnimElemTime(9)>0&&AnimElemTime(9)<=1&&!movecontact
value = ,AT

[state 200]
type = Helper
trigger1 = Time=9&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=9&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=9&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&!((prevstateno=[130,154])&&var(34)=420)
var(7) = 0

[state 220]
type = varset
trigger1 = time=0&&(prevstateno=[130,154])&&var(34)=420
var(7) = var(7)-3

[state 220]
type = ChangeAnim
trigger1 = anim=420&&animelemtime(7)>=1&&animelemtime(8)<0&&var(7)>=28
value = 421
elem = 8

[state 220]
type = ChangeAnim
trigger1 = anim=420&&animelemtime(7)>=3&&animelemtime(8)<=0&&((command="hold_z"&&!var(59))||((fvar(27)>=90000||var(40)=-3)&&var(59)))&&(var(7)=[1,28])
value = ifelse(var(7)>=20,421,anim)
elem = 6

[state 220]
type = varadd
trigger1 = anim=420&&animelemtime(6)>=0&&animelemtime(8)<=0&&var(7)<29&&((command="hold_z"&&!var(59))||((fvar(27)>=90000||var(40)=-3)&&var(59)))
var(7) = 1

[state 220]
type = playsnd
triggerall = var(7)>0
trigger1 = animelemtime(6)=0
trigger2 = animelemtime(7)=0
value = 20,17
channel = 10

[state 220]
type = stopsnd
trigger1 = animelemtime(8)>=0 && animelemtime(9)<=0
channel = 10

[state 6150]
type = Explod
trigger1 = !numexplod(6080)&&animelemtime(6)>=0&&animelemtime(8)<=0&&var(7)
id = 6080
anim=6080
pos = floor(40*const(size.xscale)),floor(-320*const(size.yscale))
postype = p1
sprpriority = 5
bindtime=-1
ignorehitpause=1
removeongethit=1
removetime=-1
scale = const(size.xscale)*.75,const(size.yscale)*.75

[state 6150]
type = RemoveExplod
trigger1 = AnimElem=8
id = 6080

[state 6150]
type = Explod
trigger1 = AnimElem=9
id = 6070
anim=6070
pos = floor(170*const(size.xscale)),floor(-20*const(size.yscale))
postype = p1
sprpriority = 5
bindtime=-1
ignorehitpause=1
removeongethit=1
removetime=-1
scale = const(size.xscale)*.75,const(size.yscale)*.75

[state 6150]
type = Explod
trigger1 = AnimElem=9
id = 6071
anim=6071
pos = floor(170*const(size.xscale)),floor(-20*const(size.yscale))
postype = p1
sprpriority = 5
bindtime=-1
ignorehitpause=1
removeongethit=1
removetime=-1
scale = const(size.xscale)*.75,const(size.yscale)*.75

[state 6150]
type = RemoveExplod
trigger1 = AnimElem=10
id = 6070

[state 6150]
type = RemoveExplod
trigger1 = AnimElem=10
id = 6071

[state 1050]
type = playsnd
trigger1 = AnimElem=9
value = 20,7
;channel = 10
;volume = 128

[state 1050]
type = envshake
trigger1 = Anim=421&&AnimElem=9
ampl = -6
time = 12
freq = 120
phase = -2

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13+(Anim=421)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~
;~~必殺技~~~
;戦国最強・出力最大
[state 250]
type = varset
trigger1 = (var(45)=[1,9999]) && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Ichigeki",3500,var(53))

;電磁形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Denji",3000,var(53))

;突進形態
[state 250]
type = varset
trigger1 = Power>=1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(53) && !var(59)
var(53) = ifelse(command="Tosshin",3100,var(53))

;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;防御形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Bougyo",1500+(command="y")*10,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4&& !var(59); && var(52)>0 && movecontact
trigger1 = ((command="y"&&command="holdfwd"&&command!="holddown")||(command="z"&&command!="holddown"))
var(53) = ifelse(command="z",220,ifelse(command="y",ifelse(command="holdfwd"&&command!="holddown",310,210),ifelse(command="x",200,var(53))))+(command="holddown")*200
;~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
damage = ifelse(floor(75*fvar(0))<1,1+(var(2)%5=4),ceil(floor(75*fvar(0))*1.22)),floor((75*fvar(3)/5)*1.22)
ground.slidetime = 17+(P2statetype=C)+var(49)*7
ground.hittime = 17+(P2statetype=C)+var(49)*7
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13
ground.velocity = -4*const(size.xscale),-16*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-16.5)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-16.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(55*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(55*fvar(1)*fvar(3)*.8)*1.38,ceil(55*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-50*const(size.xscale))
animtype = Light
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = L
persistent=0

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
trigger1 = Anim=421
damage = ifelse(floor(75*fvar(0))<1,1+(var(2)%5=4),ceil(floor(75*fvar(0))*1.22)),floor((75*fvar(3)/5)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -4*const(size.xscale),-16*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-18.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-4.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-18.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(55*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(55*fvar(1)*fvar(3)*.8)*1.38,ceil(55*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-50*const(size.xscale))
animtype = Light
ground.type = Low
attr = C,NA
hitflag = MAFD
guardflag = L
persistent=0


[state 200]
type = AttackDist
trigger1 = AnimElem=10
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&hitpausetime=13
fvar(15) = .00005*floor(ifelse(75*fvar(14)<1,1+(var(2)%5=1),75*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=9
var(16) = 1;
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
var(18) = floor(-30*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),ifelse(anim=421,-18.0,-16.5)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (ifelse(anim=421,-18.0,-16.5)*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (13-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 11
ctrl = 1

;ジャンプ弱
[statedef 600]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(var(10),0,ifelse(var(10)%8>=4,fvar(9)+fvar(8),ifelse(fvar(9),fvar(9)*0+fvar(8),Vel X))),vel Y
anim = 600
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&var(1)%4>=2&&(prevstateno=[600,620]))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&var(1)%4>=2&&(prevstateno=[600,620]))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&var(1)%4>=2&&(prevstateno=[600,620]))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 1000]
type = VarAdd
trigger1 = var(10)%8>=4
var(37) = -4/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 600]
type = PosSet
trigger1 = var(10)%8>=4&&((Pos Y>=-1&&Vel Y>0)||(Pos Y<=-160&&Vel Y<0))
y = ifelse(Pos Y<=-160,-160,-1)

[state 600]
type = VelSet
trigger1 = var(10)%8>=4&&(Pos Y>=-1||Pos Y<=-160)
trigger2 = (prevstateno=[110,115])&&time<2
y = 0

[state 600]
type = VelAdd
trigger1 = !((prevstateno=[110,115])&&time<2)&&!var(10)&&!(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.15,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)*.75+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)*.75

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4&&!var(10)
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4&&!var(10)
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 600]
type = VelSet
trigger1 = (prevstateno=[1100,1120])
x = 0

[state 600]
type = VarSet
trigger1 = (prevstateno=[1100,1120])
fvar(8) = 0

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 6150]
type = Explod
trigger1 = AnimElem=4
id = 6070
anim=6070
pos = floor(170*const(size.xscale)),floor(-160*const(size.yscale))
postype = p1
sprpriority = 5
bindtime=-1
ignorehitpause=1
removeongethit=1
removetime=7
scale = const(size.xscale)*.75,const(size.yscale)*.75

[state 6150]
type = Explod
trigger1 = AnimElem=4
id = 6071
anim=6071
pos = floor(170*const(size.xscale)),floor(-160*const(size.yscale))
postype = p1
sprpriority = 5
bindtime=-1
ignorehitpause=1
removeongethit=1
removetime=7
scale = const(size.xscale)*.75,const(size.yscale)*.75

[state 190]
type = PlaySND
trigger1 = AnimElem=3
value = 20,3
;channel = 10
;volume = 128

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,14)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0&&var(53)!=1090&&var(53)!=1390&&!(((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

;~~必殺技~~~
;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;削岩直下
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Sakugan",1400,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~~~~~~~~
;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = movecontact
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,var(53)))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4&& !var(59); && var(52)>0 && movecontact
trigger1 = (command="y"||command="z")
var(53) = ifelse(command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&var(1)%4>=2,720,ifelse(command="z",620,ifelse(command="y",610,ifelse(command="x"&&0,600,var(53)))))
;~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
trigger1 = var(1)%4<2
damage = floor(ifelse(68*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=4),68*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -3*const(size.xscale),(-15-.9)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-18.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-3.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-15.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(55*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(55*fvar(1)*fvar(3)*.8)*1.38,ceil(55*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = up
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
trigger1 = var(1)%4>=2
damage = floor(ifelse(68*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=4),68*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,9
ground.velocity = -3*const(size.xscale),-15*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-18.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -9.0*const(size.xscale)-.0009,-(9.0-(var(4)-ifelse(var(4)>=100,floor(var(4)/100)*100-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0),0)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))*4)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = 1.0*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+9,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(1)*fvar(3)*.8)*1.38,ceil(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=5
value = 0

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && movecontact=1
y = -9.0*const(size.yscale)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(68*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),68*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=4
var(16) = 1;
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=4,>=0&&AnimElem=5,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=4
var(18) = floor(-100*const(size.yscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-7.5*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-18.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-18.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,14)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !var(10) && !(var(52)>0&&movecontact)
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = ifelse(var(10)%8>=4,1300,ifelse(var(10)%4>=2,1150,50))
ctrl = 1

;ジャンプ中
[statedef 610]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(var(10),0,ifelse(var(10)%8>=4,fvar(9)+fvar(8),ifelse(fvar(9),fvar(9)*0+fvar(8),Vel X))),vel Y
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((var(1)%4>=2&&prevstateno=620)||prevstateno=600))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((var(1)%4>=2&&prevstateno=620)||prevstateno=600))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((var(1)%4>=2&&prevstateno=620)||prevstateno=600))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 610

[state 200]
type = ChangeAnim
trigger1 = Time=2&&AnimElemNo(0)=5
value = 610
elem = 6

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 1000]
type = VarAdd
trigger1 = var(10)%8>=4
var(37) = -4/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 600]
type = PosSet
trigger1 = var(10)%8>=4&&((Pos Y>=-1&&Vel Y>0)||(Pos Y<=-160&&Vel Y<0))
y = ifelse(Pos Y<=-160,-160,-1)

[state 600]
type = VelSet
trigger1 = var(10)%8>=4&&(Pos Y>=-1||Pos Y<=-160)
trigger2 = (prevstateno=[110,115])&&time<2
y = 0

[state 600]
type = VelAdd
trigger1 = !((prevstateno=[110,115])&&time<2)&&!var(10)&&!(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.15,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)*.75+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)*.75

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4&&!var(10)
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4&&!var(10)
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 600]
type = VelSet
trigger1 = (prevstateno=[1100,1120])
x = 0

[state 600]
type = VarSet
trigger1 = (prevstateno=[1100,1120])
fvar(8) = 0

[state 200]
type = VarSet
trigger1 = Time=9&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=9&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=9&&var(34)
var(35)=5

[state 200]
type = Helper
trigger1 = Time=9&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=9&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=9&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = StatetypeSet
trigger1 = IsHelper
physics = N

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)||(root,anim!=610&&root,anim!=610)

[state 190]
type = PlaySND
trigger1 = AnimElem=5
value = 20,3
;channel = 10
;volume = 128

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,14)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0&&var(53)!=1090&&var(53)!=1390&&!(((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

;~~必殺技~~~
;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;削岩直下
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Sakugan",1400,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~~~~~~~~
;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = movecontact
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,var(53)))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4&& !var(59); && var(52)>0 && movecontact
trigger1 = (((command="x"||command="y")&&var(1)%4>=2)||command="z")
var(53) = ifelse(command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&var(1)%4>=2,720,ifelse(command="z",620,ifelse(command="y"&&0,610,ifelse(command="x"&&var(1)%4>=2,600,var(53)))))
;~~~~~~~~~~~
;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
trigger1 = var(1)%4<2
damage = ifelse(floor(80*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(80*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)),floor((80*fvar(3)/5)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -21.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-21.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-10.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,4*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(72*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(72*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(72*fvar(1)*fvar(3)*.8)*1.38,ceil(72*fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
triggerall = var(1)%4>=2
damage = ifelse(floor(80*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(80*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)),floor((80*fvar(3)/5)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,9
ground.velocity = -21.0*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-21.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -9.0*const(size.xscale)-.0009,-(9.0+(floor(var(4)-ifelse(var(4)>=10000,floor(var(4)/10000)*10000,0))/100)*1.0)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = 1.0*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+9,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(72*ifelse(var(1)%4>=2,.5,1.0)*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(72*ifelse(var(1)%4>=2,.5,1.0)*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(72*ifelse(var(1)%4>=2,.5,1.0)*fvar(1)*fvar(3)*.8)*1.38,ceil(72*ifelse(var(1)%4>=2,.5,1.0)*fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=7
value = 0

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && movecontact=1
y = -9.0*const(size.yscale)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(80*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),80*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6&&AnimElem=7,<0
var(18) = floor(-60*const(size.yscale))+ifelse(P2bodydist Y<0,ifelse(P2bodydist Y<-140*const(size.yscale),floor(-140*const(size.yscale)),floor(P2bodydist Y)),0)


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-21.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,14)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !var(10) && !(var(52)>0&&movecontact) && !IsHelper
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = ifelse(var(10)%8>=4,1300,ifelse(var(10)%4>=2,1150,50))
ctrl = 1

;ジャンプ強
[statedef 620]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(var(10),0,ifelse(var(10)%8>=4,fvar(9)+fvar(8),ifelse(fvar(9),fvar(9)*0+fvar(8),Vel X))),vel Y
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,610]))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 620

[state 200]
type = ChangeAnim
trigger1 = Time=1&&AnimElemNo(0)=5
value = 620
elem = 6

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 1000]
type = VarAdd
trigger1 = var(10)%8>=4
var(37) = -4/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 600]
type = PosSet
trigger1 = var(10)%8>=4&&((Pos Y>=-1&&Vel Y>0)||(Pos Y<=-160&&Vel Y<0))
y = ifelse(Pos Y<=-160,-160,-1)

[state 600]
type = VelSet
trigger1 = var(10)%8>=4&&(Pos Y>=-1||Pos Y<=-160)
trigger2 = (prevstateno=[110,115])&&time<2
y = 0

[state 600]
type = VelAdd
trigger1 = !((prevstateno=[110,115])&&time<2)&&!var(10)&&!(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.15,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)*.75+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)*.75

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4&&!var(10)
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4&&!var(10)
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 600]
type = VelSet
trigger1 = (prevstateno=[1100,1120])
x = 0

[state 600]
type = VarSet
trigger1 = (prevstateno=[1100,1120])
fvar(8) = 0

[state 200]
type = VarSet
trigger1 = Time=5&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=5&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=5&&var(34)
var(35)=7

[state 200]
type = Helper
trigger1 = Time=5&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=5&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=5&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = StatetypeSet
trigger1 = IsHelper
physics = N

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
trigger1 = AnimElem=6
value = 20,12
;channel = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,14)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0&&var(53)!=1090&&var(53)!=1390&&!(((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

;~~必殺技~~~
;援護形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="a"&&var(40)=5&&!var(12),1600,var(53))

;削岩直下
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Sakugan",1400,var(53))

;飛行形態
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command = "Hikou"&&var(10)%8<4,1300,var(53))

;攻撃形態・浮遊機雷
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki3",1020+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・時限弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki2",1010+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))

;攻撃形態・通常弾
[state 250]
type = varset
trigger1 = var(53)<1000 && (time>4||(prevstateno=[130,132])||(prevstateno=[150,153])) && !var(59)
var(53) = ifelse(command="Kougeki1",1000+ifelse(command="z",2,ifelse(command="y",1,0)),var(53))
;~~~~~~~~~~~

;空中ダッシュ・空中バックステップ
[state 250]
type = varset
trigger1 = !var(53) && time>4 && !var(59)
trigger1 = movecontact
var(53) = ifelse((fvar(13)=17&&P2dist X>=0)||(fvar(13)=-17&&P2dist X<0),110,ifelse((fvar(13)=-17&&P2dist X>=0)||(fvar(13)=17&&P2dist X<0),115,var(53)))

;チェーンコンボ
[state 250]
type = varset
trigger1 = !var(53) && time>4&& !var(59); && var(52)>0 && movecontact
trigger1 = (command="x"||command="y"||command="z")&&var(1)%4>=2
var(53) = ifelse(command="z"&&command="holddown"&&command!="holdfwd"&&command!="holdback"&&var(1)%4>=2,720,ifelse(command="z"&&0,620,ifelse(command="y"&&var(1)%4>=2,610,ifelse(command="x"&&var(1)%4>=2,600,var(53)))))
;~~~~~~~~~~~
;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=7,>=0&&AnimElem=9,<0
trigger1 = var(1)%4<2
damage = floor(ifelse(72*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=4),72*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22),floor((72*fvar(3)/5)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = ifelse(var(49),-11.0-.0014,-8*const(size.xscale)),-14*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-21.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(49),-11.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-8.0*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-14.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,10)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(55*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(55*fvar(1)*fvar(3)*.8)*1.38,ceil(55*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = HAFD
guardflag = HA
persistent=0

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=7,>=0&&AnimElem=9,<0
trigger1 = var(1)%4>=2
damage = floor(ifelse(72*fvar(0)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=4),72*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22),floor((72*fvar(3)/5)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,9
ground.velocity = -8*const(size.xscale),-14*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-21.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -9.0*const(size.xscale)-.0009,-(9.0-floor(var(4)/10000)*2.0)*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = 1.0*const(size.yscale)
fall.recover = !var(49)
fall.recovertime = ifelse(var(49)&&!var(2),43+9,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,10)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(1)*fvar(3)*.8)*1.38,ceil(55*ifelse(var(1)%4>=2,.5,1.0)*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-140*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = HAFD
guardflag = HA
persistent=0

;==壁ダウンに
[state 920]
type = varset
trigger1 = movehit=1 && numtarget&&var(6)%10<1
trigger1 = target,time=0 && var(49)
var(1) = 4
ignorehitpause=1
persistent=0

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget&&var(6)%10<1
trigger1 = target,time=0 && var(49)
value = 936
ignorehitpause=1
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=8
value = 0

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && movecontact=1
y = -9.0*const(size.yscale)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(72*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),72*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=7
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=9,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=9,<0
var(18) = floor(-140*const(size.xscale))


;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-21.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,14)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !var(10) && !(var(52)>0&&movecontact) && !IsHelper
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = ifelse(var(10)%8>=4,1300,ifelse(var(10)%4>=2,1150,50))
ctrl = 1


;エリアルスパイク
[statedef 720]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(var(10),0,ifelse(var(10)%8>=4,fvar(9)+fvar(8),ifelse(fvar(9),fvar(9)*0+fvar(8),Vel X))),vel Y
anim = 720
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,620]))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,620]))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&(prevstateno=[600,620]))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;着地硬直設定
[state 600]
type = varadd
trigger1 = !time&&var(5)%256<128
var(5) = 128

[state 1000]
type = VarAdd
trigger1 = var(10)%8>=4
var(37) = -4/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 600]
type = PosSet
trigger1 = var(10)%8>=4&&((Pos Y>=-1&&Vel Y>0)||(Pos Y<=-160&&Vel Y<0))
y = ifelse(Pos Y<=-160,-160,-1)

[state 600]
type = VelSet
trigger1 = var(10)%8>=4&&(Pos Y>=-1||Pos Y<=-160)
trigger2 = (prevstateno=[110,115])&&time<2
y = 0

[state 600]
type = VelAdd
trigger1 = !((prevstateno=[110,115])&&time<2)&&!var(10)&&!(var(52)>0&&movecontact)
y = ifelse(var(1)%4>=2,.5,const(movement.yaccel))*ifelse(var(5)%2>=1,1.15,1.0)*ifelse(var(5)%4>=2||var(5)%8>=4,.9,1.0)*2.0*const(size.yscale)

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno=[110,115])
x = fvar(8)*.75+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno=[110,115])
fvar(8) = fvar(8)*.75

[state 600]
type = VelSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4&&!var(10)
trigger1 = (fvar(8)>ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x))||fvar(8)<ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))
x = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))+fvar(9)

[state 600]
type = VarSet
trigger1 = !Time&&(prevstateno!=[110,115])&&var(5)%8>=4&&!var(10)
fvar(8) = ifelse(fvar(8)>0,ifelse(var(5)%2>=1,const(velocity.runjump.fwd.x),const(velocity.jump.fwd.x)),ifelse(var(5)%2>=1,const(velocity.runjump.back.x),const(velocity.jump.back.x)))

[state 600]
type = VelSet
trigger1 = (prevstateno=[1100,1120])
x = 0

[state 600]
type = VarSet
trigger1 = (prevstateno=[1100,1120])
fvar(8) = 0

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 190]
type = PlaySND
trigger1 = AnimElem=5
value = 20,3
;channel = 10
;volume = 128


;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(var(1)%4>=2,9,13)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54)
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0&&var(53)!=1090&&var(53)!=1390&&!(((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
damage = ifelse(floor(60*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))<1,1+(var(2)%5=4),ceil(floor(60*fvar(0)*ifelse(var(1)%4>=2,.5,1.0))*1.22)),floor((60*fvar(3)/5)*1.22)
ground.slidetime = 17+(P2statetype=C)+var(49)*7
ground.hittime = 17+(P2statetype=C)+var(49)*7
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,9
ground.velocity = -15.0*(1.0+ifelse(var(2)>31,31,var(2))*.04)*const(size.xscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-15.0*const(size.xscale)-.0009,-10),6
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = ifelse(var(1)%4>=2,1.0,.9)*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),49+9,32-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+9)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(55*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(55*fvar(1)*fvar(3)*.8)*1.38,ceil(55*fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-80*const(size.xscale))
animtype = High
ground.type = High
attr = A,NA
hitflag = MAFD
guardflag = HA
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=8
value = 0

[state -2]
type = VelSet
trigger1 = var(1)%4>=2 && movecontact=1
y = -9.0*const(size.yscale)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(60*fvar(14)*ifelse(var(1)%4>=2,.5,1.0)<1,1+(var(2)%5=1),60*fvar(14)*ifelse(var(1)%4>=2,.5,1.0))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=7
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=7,>=0&&AnimElem=8,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=7&&AnimElem=8,<0
var(18) = floor(-60*const(size.yscale))+ifelse(P2bodydist Y<0,ifelse(P2bodydist Y<-140*const(size.yscale),floor(-80*const(size.yscale)),floor(P2bodydist Y)),0)


;・・・・自分側ヒットバック・・・・
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(((var(3)&&target,statetype=A)||movehit)&&var(6)%10<1,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(1)%4>=2,9,14)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = ChangeState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !var(10) && !(var(52)>0&&movecontact)
value = 52

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = ifelse(var(10)%8>=4,1300,ifelse(var(10)%4>=2,1150,50))
ctrl = 1

;■■■■■■■
;通常投げ
;(発生4F)
[statedef 800]
type = S
physics = S
movetype=A
ctrl = 0
velset = ifelse(fvar(2),fvar(2),vel x),0
anim = 800

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=0)
triggerall = (P2stateno!=[150,155])
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
attr = S,NT
hitflag = M-
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=801
p1facing = ifelse((command="holdback"&&!var(59))||(ifelse(facing=1,-(helper(30005),pos x-pos x),helper(30000),pos x-pos x)<(160+const(size.ground.back))&&var(59)),-1,1)
p2facing=1
fall = 1
fall.recover=0
kill = 0

[State 0, HitDef]
type = HitDef
triggerall = !(P2stateno=40&&enemynear,time>=1)
triggerall = (P2stateno!=[150,155])&&enemynear,anim=5300
trigger1 = AnimElem=2,>=0&&AnimElem=3,<0
attr = S,NT
hitflag = M
priority = 1,Miss
getpower = 0,0
givepower = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
p1stateno=801
p1facing = ifelse((command="holdback"&&!var(59))||(ifelse(facing=1,-(helper(30005),pos x-pos x),helper(30000),pos x-pos x)<(160+const(size.ground.back))&&var(59)),-1,1)
p2facing=1
fall = 1
numhits = 0
kill = 0

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;戻り動作
[state 1000]
type = AttackDist
trigger1 = AnimElem=3
value = 0

[state 1000]
type = AttackDist
trigger1 = 1
value = 0

[state 1000]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 1000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;■■■■■■■
;通常投げ掴み
[statedef 801]
type = S
physics = S
movetype=A
ctrl = 0
velset = 0,0
anim = 801

[state 800]
type = varset
trigger1 = !time
fvar(8) = 0

[state 800]
type = varset
trigger1 = !time
fvar(9) = 0

[state 800]
type = varset
trigger1 = !time
fvar(10) = 0

;気絶値リセット
[state 801]
type = varset
trigger1 = !time
var(29) = 0

[state 801]
type = targetstate
trigger1 = time=0||(target,stateno!=806&&animelemtime(4)<0)
value = 806

[state 801]
type = Width
trigger1 = animelemtime(1)=0
edge = floor(174*const(size.xscale)),0

;コンボ補正なし
[state 801]
type = targetlifeadd
trigger1 = animelemtime(3)=0
value = -floor(40*fvar(0)*1.22)

[state 801]
type = poweradd
trigger1 = animelemtime(3)=0
value = floor(ifelse(var(9),0,floor(70*fvar(1)*fvar(3))*1.38*fvar(16)))

[state 801]
type = targetpoweradd
trigger1 = animelemtime(3)=0
value = floor(floor(70*fvar(1)*fvar(3)*.8)*1.38)

[state 801]
type = targetbind
trigger1 = animelemtime(2)<0
pos = floor(160*const(size.xscale)),floor(-264*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(2)>=0&&animelemtime(3)<0
pos = floor(160*const(size.xscale)),floor(-244*const(size.yscale))

[state 801]
type = targetbind
trigger1 = animelemtime(3)>=0&&animelemtime(4)<0
pos = floor(168*const(size.xscale)),floor(-402*const(size.xscale))

[state 801]
type = targetbind
trigger1 = animelemtime(4)=0
pos = floor(168*const(size.xscale)),floor(-270*const(size.xscale))

[state 801]
type = targetstate
trigger1 = animelemtime(4)=0
value = 807

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
damage = floor(ifelse(40*fvar(0)<1,1+(var(2)%5=4),40*fvar(0))*1.22),floor((40*1.0/6*1.22))
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 15,14
ground.velocity = -3*const(size.xscale),-8*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -3*const(size.xscale),ifelse(var(6)%10>0,var(6)%10*1.5,-8*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(60*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(60*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(60*fvar(1)*fvar(3)*.8)*1.38,ceil(60*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-220*const(size.xscale))
animtype = High
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

[state 801]
type = PlaySND
trigger1 = animelemtime(1)=0
value = 20,7
;channel = 10
;volume = 128

[state 801]
type = PlaySND
trigger1 = animelemtime(5)=0
value = 20,3
;channel = 10
;volume = 128

[state 3100]
type = Attackdist
trigger1 = 1
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = ((movehit=1&&hitpausetime=14)||animelemtime(3)=0)
fvar(15) = .00005*floor(ifelse(40*fvar(14)<1,1+(var(2)%5=1),40*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = ((movehit=1&&hitpausetime=14)||animelemtime(3)=0)
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6&&AnimElem=7,<0
var(18) = floor(-280*const(size.yscale))-floor(ifelse(floor(P2dist X)<(33+enemynear,const(size.ground.front)),0,ifelse(floor(P2dist X)>(358*const(size.xscale)),60,(floor(P2dist X)-(33+enemynear,const(size.ground.front)))*.5)))

[state 1000]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 1000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;■■■■■■■
;通常投げ食らい
[statedef 806]
type = S
physics = N
movetype=H
ctrl = 0
velset = 0,0

[state 806]
type = ScreenBound
trigger1 = 1
value = 1

[state 806]
type = SprPriority
trigger1 = 1
value = 2

[state 806]
type = ChangeAnim2
trigger1 = time=0
value = 806

[state 806]
type = SelfState
trigger1 = time>=180
value = 5000

;■■■■■■■
;通常投げ食らい（吹き飛び）
[statedef 807]
type = As
physics = N
movetype=H
ctrl = 0
velset = 0,0
sprpriority = -1

[state 806]
type = ChangeAnim
trigger1 = time=0
value = 5050

[state 806]
type = ChangeAnim
trigger1 = time && selfanimexist(5060)&&vel Y>0
value = 5060

[state 806]
type = VelSet
trigger1 = !time
x = -3
y = -2

[state 806]
type = VelAdd
trigger1 = 1
y = .45

[state 806]
type = SelfState
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
value = 5100

;吹き飛ばし攻撃
[statedef 900]
type = S
movetype = A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])&&(prevstateno!=[1100,1120])
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])&&(prevstateno!=[1100,1120])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])&&(prevstateno!=[1100,1120])
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 900

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=5&&var(32)
value = 900
elem = 6

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=20

;攻撃発生中のガードポイント
[state 200]
type = HitBy
trigger1 = var(32)&&AnimElemTime(6)>0&&AnimElemTime(7)<=0&&!movecontact
value = ,AT

;攻撃状態維持用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;◇◇溜め用◇◇
[state 220]
type = varset
trigger1 = time=0&&(prevstateno!=[130,154])
var(7) = 0

[state 220]
type = varadd
trigger1 = var(7)<=120&&((command="hold_y"&&command="hold_z"&&!var(59))||(random<0&&var(59)))
trigger1 = (anim=905&&var(7))||(animelemtime(3)=5&&!var(7))
var(7) = 1

[state 220]
type = ChangeAnim
trigger1 = anim=900&&var(7)&&((command="hold_y"&&command="hold_z"&&!var(59))||(random<0&&var(59)))&&var(7)<=120
value = 905
persistent=0

[state 220]
type = ChangeAnim
trigger1 = (command!="hold_y"||command!="hold_z"||var(7)>=120)&&var(7)
value = 900
elem = 4
persistent=0

[state 220]
type = playsnd
trigger1 = anim=905&&var(7)%8=1
value = 20,17
channel = 10

[state 220]
type = stopsnd
trigger1 = anim!=905
channel = 10

;溜めエフェクト
[state -2]
type = Helper
trigger1 = var(7)%8=1 &&anim=905
id = 7770
stateno=7770
pos = 0,0
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999

[state 220]
type = PalFX
trigger1 = anim=905&&(var(7)=[60,68])
add = 255-(var(7)-60)*30,255-(var(7)-60)*30,255-(var(7)-60)*30
time = 1
;~~~~~

[state 190]
type = PlaySND
trigger1 = AnimElem=5
value = 20,3
;channel = 10
;volume = 128

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 13+(var(7)>=60)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
damage = floor(ifelse(60*fvar(0)<1,1+(var(2)%5=4),60*fvar(0))*1.22)
ground.slidetime = 17+(P2statetype=C)+var(49)*7
ground.hittime = 17+(P2statetype=C)+var(49)*7
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,13
ground.velocity = -11.5,-11*const(size.yscale)
guard.velocity = -13.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%2>=1||var(1)%16<8,-11.5*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0013,-15*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-5.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),37+13,20-ifelse(floor(var(14)/60)>9,9,floor(var(14)/60))+13)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(70*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(70*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(70*fvar(1)*fvar(3)*.8)*1.38,ceil(70*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = High
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = var(7)>=60
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=6,>=0&&AnimElem=7,<0
damage = floor(ifelse(60*fvar(0)<1,1+(var(2)%5=4),60*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -10,-11*const(size.yscale)
guard.velocity = -44*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1||var(1)%16<8,-10.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-7*(1.0+ifelse(var(3)>31,31,var(3))*.04)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-10.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(70*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(70*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(70*fvar(1)*fvar(3)*.8)*1.38,ceil(70*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = High
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
persistent=0
ID = 920

;==壁ダウンに
[state 920]
type = varadd
trigger1 = movehit=1 && numtarget && var(6)%10=0 && !(var(7)<60&&var(1)%16>=8&&var(1)%2<1)
trigger1 = target,time=0
var(1) = ifelse(var(7)<60&&var(1)%2<1&&var(1)%16<8,4+8,ifelse(var(1)%2<1&&var(7)>=60,1,0))-(var(1)%16>=8&&var(1)%8>=4)*4
ignorehitpause=1
persistent=0

[state 900]
type = TargetState
trigger1 = movehit=1 && numtarget && !var(6) && (var(1)%2>=1||var(1)%8>=4)
trigger1 = target,time=0
value = ifelse(var(7)<60&&var(1)%2<1,938,928)
ignorehitpause=1
persistent=0

[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && var(52)>0 && time>4 && var(7)<60 && !var(59)
var(53) = ifelse(var(0)<10 && command="longjump",50,ifelse(command="holdup",40,var(53)))+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0))
ignorehitpause=1

;ブースト
[state 900]
type = VarSet
triggerall = (movehit||(moveguarded&&var(7)>=60)) && var(52)>0 && movecontact
trigger1 = command="holdfwd"&&command!="holdup"&&command!="holddown"&&!var(59)
var(53) = 2000+ifelse(var(53)=40||var(53)=50,var(53),0)

;ブースト
[state 900]
type = ChangeState
triggerall = (movehit||(moveguarded&&var(7)>=60))&&!(var(52)>0&&movecontact) && (var(1)%2>=1||var(1)%8>=4) && P2dist X>10
trigger1 = ((command="holdfwd"&&command!="holdup")||(var(53)=[2000,2050]))&&!var(59)
trigger2 = var(59)
value = 2000

;ジャンプ
[state 900]
type = ChangeState
triggerall = movecontact&&!(var(52)>0&&movecontact)
trigger1 = (command="up"||command="fwdup"||command="backup"||(var(53)=[40,42])||(var(53)=[50,52]))&&!var(59)
trigger2 = var(59)
value = 40

[state 200]
type = AttackDist
trigger1 = AnimElem=8
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(60*fvar(14)<1,1+(var(2)%5=1),60*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=6
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=6,>=0&&AnimElem=8,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=6&&AnimElem=8,<0
var(18) = floor(-180*const(size.yscale))

[state 900]
type = StatetypeSet
trigger1 = AnimElem=6
physics = N

;現在の速度取得
[state 900]
type = VarSet
trigger1 = AnimElem=6
fvar(8) = 6.0

[state 900]
type = VarSet
trigger1 = AnimElem=6,>0
fvar(8) = fvar(8)*.9

[state 900]
type = VarSet
trigger1 = !time
trigger2 = AnimElem=9
fvar(8) = 0

[state -2]
type = velset
trigger1 = animelem=6,>0 && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
x = fvar(8)+fvar(9)

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = (ifelse(var(7)>=60,-15.0,-13.5)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (ifelse(var(1)%8>=4&&movehit,-16.5,ifelse(var(7)>=60,-15.0,-13.5))*1.5*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(var(7)>=60,ifelse(moveguarded,18,20+(P2statetype=C)),ifelse(moveguarded,15,17+(P2statetype=C)))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(7)>=60,14,13)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 2000]
type = ChangeState
trigger1 = Anim=900&&AnimTime=0
value = 0
ctrl = 1

;エリアル攻撃
[statedef 910]
type = S
movetype = A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])&&(prevstateno!=[1100,1120])
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])&&(prevstateno!=[1100,1120])
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno!=[100,140])&&(prevstateno=[195,1999])&&(prevstateno!=[1100,1120])
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 910

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=7
value = 910
elem = 8

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=14

;攻撃状態維持用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 190]
type = PlaySND
trigger1 = AnimElem=4
value = 20,3
;channel = 10
;volume = 128

[state 190]
type = PlaySND
trigger1 = AnimElem=7
value = 20,12
;channel = 10

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.1
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)&&!movecontact&&!movereversed
trigger1 = AnimElem=9,>=0&&AnimElem=10,<0
damage = floor(ifelse(60*fvar(0)<1,1+(var(2)%5=4),60*fvar(0))*1.22),floor((60*fvar(3)/4*1.22))
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 8
guard.hittime = 8
pausetime = 1,14
ground.velocity = 0,(-22-.9)*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,ifelse(var(6)%10>0,-8,0)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-22.0*(51-var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(var(6)%10>0||var(28)>0,0,1)
fall.recovertime = ifelse(var(49)&&!var(2),43+14,24-ifelse(floor(var(14)/50)>10,10,floor(var(14)/50))+14)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,5)
guardsound = s7000,4
getpower = floor(ifelse(var(9),0,floor(55*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(55*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(55*fvar(1)*fvar(3)*.8)*1.38,ceil(55*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-160*const(size.xscale))
animtype  = diagup
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA
persistent=0

[state 200]
type = VarAdd
trigger1 = movehit=1&&numtarget&&var(1)%4<2&&var(6)%10<1
var(1) = 2
ignorehitpause=1

;ジャンプ・ハイジャンプ
[state 250]
type = varset
trigger1 = !var(53) && var(52)>0 && movehit && var(7)<60 && !var(59)
trigger1 = command="holdup"
var(53) = 40+ifelse(command="holdback",2,ifelse(command="holdfwd",1,0))

[state 200]
type = ChangeState
triggerall = movehit&&numtarget&&!(var(52)>0&&movecontact)
trigger1 = (command="holdup"||(var(53)=[40,42]))&&!var(59)
trigger2 = var(59)
value = 40

[state 200]
type = AttackDist
trigger1 = AnimElem=12
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(60*fvar(14)<1,1+(var(2)%5=1),60*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 5
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=8,>=0&&AnimElem=12,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=8&&AnimElem=12,<0
var(18) = floor(-160*const(size.yscale))

;現在の速度取得
[state 240]
type = varset
trigger1 = !time
fvar(8) = 0

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0&&(var(6)||moveguarded)
fvar(5) = (-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-13.5*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&(var(6)||moveguarded))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,8,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0&&(var(6)||moveguarded))||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 2000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;攻撃形態(地上)
[statedef 1000]
type = S
movetype=I
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 1000]
type = VarSet
trigger1 = Time=0 && !var(34) && !var(59)
var(7) = ifelse(command="z"||var(53)=1002,2,ifelse(command="y"||var(53)=1001,1,0))

[state 1000]
type = VarSet
trigger1 = Time=0 && !var(34) && var(59)
var(7) = ifelse((P2bodydist X>180&&random%5<2)||(P2bodydist X>140&&(enemynear,hitfall||P2statetype=L)),2,ifelse(P2bodydist X>110&&random%5<2,1,0))

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time && !var(34)
var(53) = 0

[state 1000]
type = VarAdd
trigger1 = !time && !var(34)
var(37) = -1

[state 1000]
type = VarAdd
trigger1 = AnimElemTime(5)=10&&(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105))
trigger1 = var(53)!=1090
var(37) = -480/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 1050]
type = VarSet
trigger1 = Time=0
var(10) = 1

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1000

[state 210]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=3&&!IsHelper
value = 1000
elem = 4

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 1050]
type = playsnd
trigger1 = var(10)<=0 && !var(50) && AnimElem=5,=1
value = 20,6
channel = 10
;volume = 128

;援護形態へ移行
[state 1500]
type = ChangeState
triggerall = !Time&&(var(40)=1||(var(40)=[5,6]))&&!var(12)&&(prevstateno!=[5000,5099])
trigger1 = command="a"&&command!="holddown"&&!var(59)
value = 1600

;~~~~~~~~~~~~~溜め動作~~~~~~~~~~
;var(50):溜め時間
[state 1050]
type = varset
trigger1 = !time
var(50) = 0

[state 1050]
type = varadd
trigger1 = var(50)>0&&time
var(50) = 1

[state 1050]
type = varset
triggerall = animelemtime(4)=5&&!var(50)
trigger1 = ifelse(var(7)=2,command="hold_z",ifelse(var(7)=1,command="hold_y",command="hold_x"))&&!var(59)
trigger2 = !var(2)&&var(59)
var(50) = 1
persistent=0

[state 1050]
type = playsnd
trigger1 = var(50)=1
value = 7400,0
;channel = 10
;volume = 128
persistent=0

[state 1050]
type = playsnd
trigger1 = var(50)=60||var(50)=90
value = 20,17
;channel = 10
;volume = 128

[state -2]
type = PalFX
trigger1 = var(50)=[60,71]
add = 64+(-var(50)+59)*5,128+(-var(50)+59)*9,255+(-var(50)+59)*20
color = 0-(-var(50)+59)*20
time = 1
ignorehitpause=1

[state -2]
type = PalFX
trigger1 = var(50)=[90,101]
add = 64+(-var(50)+89)*5,128+(-var(50)+89)*9,255+(-var(50)+89)*20
color = 0-(-var(50)+89)*20
time = 1
ignorehitpause=1

[state 1050]
type = varset
triggerall = var(50)>0&&time
trigger1 = ifelse(var(7)=2,command!="hold_z",ifelse(var(7)=1,command!="hold_y",command!="hold_x"))&&!var(59)
trigger2 = var(50)>=120
trigger3 = random%3=0&&var(59)
var(50) = -var(50)

[state 1050]
type = ChangeAnim
trigger1 = var(50)>0&&time
value = anim
elem = 4

[state 1050]
type = ChangeAnim
trigger1 = var(50)<0&&time
value = anim
elem = 5
persistent=0

;溜めエフェクト
[state -2]
type = Helper
trigger1 = var(50)%8=1 && animelemtime(5)<0
id = 7770
stateno=7770
pos = 0,0
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999
;===溜め動作

[state 6150]
type = Explod
trigger1 = AnimElem=3&&!IsHelper
id = 1001
anim=1001
pos = floor(-56*const(size.xscale)),floor(-192*const(size.yscale))
postype = p1
sprpriority = 2
bindtime=-1
ignorehitpause=1
removeongethit=1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = Explod
trigger1 = AnimElem=3&&!IsHelper
id = 1002
anim=1002
pos = floor(-68*const(size.xscale)),floor(-204*const(size.yscale))
postype = p1
sprpriority = 1
bindtime=-1
ignorehitpause=1
removeongethit=1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = Explod
trigger1 = AnimElem=3&&!IsHelper
id = 1002
anim=1002
pos = floor(-8*const(size.xscale)),floor(-204*const(size.yscale))
postype = p1
sprpriority = 3
bindtime=-1
ignorehitpause=1
removeongethit=1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = Explod
trigger1 = AnimElem=4&&!IsHelper
id = 1003
anim=1003
pos = floor(-68*const(size.xscale)),floor(-204*const(size.yscale))
postype = p1
sprpriority = 1
bindtime=-1
ignorehitpause=1
removeongethit=1
removetime=-1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = Explod
trigger1 = AnimElem=4&&!IsHelper
id = 1003
anim=1003
pos = floor(-8*const(size.xscale)),floor(-204*const(size.yscale))
postype = p1
sprpriority = 3
bindtime=-1
ignorehitpause=1
removeongethit=1
removetime=-1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = RemoveExplod
trigger1 = AnimElem=4
id = 1002
persistent=0

[state 6150]
type = RemoveExplod
trigger1 = AnimElem=6
id = 1001
persistent=0

[state 6150]
type = RemoveExplod
trigger1 = AnimElem=6
id = 1003
persistent=0

[state 1050]
type = playsnd
trigger1 = AnimElemTime(5)=10&&(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105))
value = 20,15
channel = 10
;volume = 128

[state 6150]
type = Explod
trigger1 = AnimElemTime(5)=10
id = 6150
anim=ifelse((!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105)),6150,6111)
pos = floor(-30*const(size.xscale)),floor(-380*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6150]
type = Explod
trigger1 = AnimElemTime(5)=10
id = 6150
anim=ifelse((!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105)),6150,6111)
pos = floor(14*const(size.xscale)),floor(-380*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 1000]
type = Helper
trigger1 = AnimElemTime(5)=10 && (!NumHelper(6100)||!NumHelper(6102)||!NumHelper(6104))
id = 6100+(NumHelper(6100))*2+(NumHelper(6102))*2
stateno = 6100+ifelse(var(7)=2,NumHelper(6172)!=0,ifelse(var(7)=1,NumHelper(6171)!=0,NumHelper(6170)!=0))*30
pos = floor(-30*const(size.xscale)),floor(-380*const(size.yscale))
postype = P1
ownpal = 1
persistent=0

[state 1000]
type = Helper
trigger1 = AnimElemTime(5)=10 && (!NumHelper(6101)||!NumHelper(6103)||!NumHelper(6105))
id = 6101+(NumHelper(6101))*2+(NumHelper(6103))*2
stateno = 6100+ifelse(var(7)=2,NumHelper(6172)!=0,ifelse(var(7)=1,NumHelper(6171)!=0,NumHelper(6170)!=0))*30
pos = floor(14*const(size.xscale)),floor(-380*const(size.yscale))
postype = P1
ownpal = 1
persistent=0

;~~~パーフェクトガード~~~
[state -2]
type = varset
triggerall = (animelemtime(4)=[0,5])
trigger1 = var(50)>0&&command="holdback"&&command="hold_x"&&command="hold_y"&&!var(59)
var(31) = -ifelse(NumExplod(7705),1,5)

;サウンド
[state 8000]
type = PlaySND
trigger1 = var(31)=-ifelse(NumExplod(7705),1,5)
value = 4100,0
ignorehitpause=0

;エフェクト1
[state 8000]
type = Helper
trigger1 = var(31)=-ifelse(NumExplod(7705),1,5)
id = 7700
stateno = 7700
pos = 0,-floor(180*const(size.yscale))
postype = p1
sprpriority = 3
bindtime=-1
ownpal = 1
ignorehitpause=0
size.xscale = const(size.xscale)
size.yscale = const(size.yscale)

;パーフェクトガードへ
[state 1050]
type = changestate
trigger1 = var(31)=-ifelse(NumExplod(7705),1,5)
value = 120

;ジャンプへ
[state 1050]
type = changestate
triggerall = (animelemtime(4)=[0,5])
trigger1 = var(50)>0&&command="holdup"&&!var(59)
value = 40

;しゃがみへ
[state 1050]
type = changestate
triggerall = (animelemtime(4)=[0,5])
trigger1 = var(50)>0&&command="holddown"&&!var(59)
trigger2 = var(50)>0&&!var(2)&&var(59)
value = 11
ctrl = 1

[state 1050]
type = CtrlSet
trigger1 = animtime=-1
value = 1

[state 1050]
type = changestate
trigger1 = animtime=0
value = 0
ctrl = 1


;攻撃形態・時限弾(地上)
[statedef 1010]
type = S
movetype=I
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 1000]
type = VarSet
trigger1 = Time=0 && !var(34) && !var(59)
var(7) = ifelse(command="z"||var(53)=1012,2,ifelse(command="y"||var(53)=1011,1,0))

[state 1000]
type = VarSet
trigger1 = Time=0 && !var(34) && var(59)
var(7) = ifelse((P2bodydist X>180&&random%5<2)||(P2bodydist X>140&&(enemynear,hitfall||P2statetype=L)),2,ifelse(P2bodydist X>140&&random%2=0,1,0))

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time && !var(34)
var(53) = 0

[state 1000]
type = VarAdd
trigger1 = !time && !var(34)
var(37) = -1

[state 1000]
type = VarAdd
trigger1 = AnimElemTime(5)=10&&(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105))
trigger1 = var(53)!=1090
var(37) = -480/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 1050]
type = VarSet
trigger1 = Time=0
var(10) = 1

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1000

[state 210]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=3&&!IsHelper
value = 1000
elem = 4

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 1050]
type = playsnd
trigger1 = var(10)<=0 && !var(50) && AnimElem=5,=1
value = 20,6
channel = 10
;volume = 128

;援護形態へ移行
[state 1500]
type = ChangeState
triggerall = !Time&&(var(40)=1||(var(40)=[5,6]))&&!var(12)&&(prevstateno!=[5000,5099])
trigger1 = command="a"&&command!="holddown"&&!var(59)
value = 1600
;~~~~~~~~~~~~~溜め動作~~~~~~~~~~
;var(50):溜め時間
[state 1050]
type = varset
trigger1 = !time
var(50) = 0

[state 1050]
type = varadd
trigger1 = var(50)>0&&time
var(50) = 1

[state 1050]
type = varset
triggerall = animelemtime(4)=5&&!var(50)
trigger1 = ifelse(var(7)=2,command="hold_z",ifelse(var(7)=1,command="hold_y",command="hold_x"))&&!var(59)
trigger2 = !var(2)&&var(59)
var(50) = 1
persistent=0

[state 1050]
type = playsnd
trigger1 = var(50)=1
value = 7400,0
;channel = 10
;volume = 128
persistent=0

[state 1050]
type = playsnd
trigger1 = var(50)=60||var(50)=90
value = 20,17
;channel = 10
;volume = 128

[state -2]
type = PalFX
trigger1 = var(50)=[60,71]
add = 64+(-var(50)+59)*5,128+(-var(50)+59)*9,255+(-var(50)+59)*20
color = 0-(-var(50)+59)*20
time = 1
ignorehitpause=1

[state -2]
type = PalFX
trigger1 = var(50)=[90,101]
add = 64+(-var(50)+89)*5,128+(-var(50)+89)*9,255+(-var(50)+89)*20
color = 0-(-var(50)+89)*20
time = 1
ignorehitpause=1

[state 1050]
type = varset
triggerall = var(50)>0&&time
trigger1 = ifelse(var(7)=2,command!="hold_z",ifelse(var(7)=1,command!="hold_y",command!="hold_x"))&&!var(59)
trigger2 = var(50)>=120
trigger3 = random%3=0&&var(59)
var(50) = -var(50)

[state 1050]
type = ChangeAnim
trigger1 = var(50)>0&&time
value = anim
elem = 4

[state 1050]
type = ChangeAnim
trigger1 = var(50)<0&&time
value = anim
elem = 5
persistent=0

;溜めエフェクト
[state -2]
type = Helper
trigger1 = var(50)%8=1 && animelemtime(5)<0
id = 7770
stateno=7770
pos = 0,0
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999
;===溜め動作

[state 6150]
type = Explod
trigger1 = AnimElem=3&&!IsHelper
id = 1001
anim=1001
pos = floor(-56*const(size.xscale)),floor(-192*const(size.yscale))
postype = p1
sprpriority = 2
bindtime=-1
ignorehitpause=1
removeongethit=1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = Explod
trigger1 = AnimElem=3&&!IsHelper
id = 1002
anim=1002
pos = floor(-68*const(size.xscale)),floor(-204*const(size.yscale))
postype = p1
sprpriority = 1
bindtime=-1
ignorehitpause=1
removeongethit=1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = Explod
trigger1 = AnimElem=3&&!IsHelper
id = 1002
anim=1002
pos = floor(-8*const(size.xscale)),floor(-204*const(size.yscale))
postype = p1
sprpriority = 3
bindtime=-1
ignorehitpause=1
removeongethit=1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = Explod
trigger1 = AnimElem=4&&!IsHelper
id = 1003
anim=1003
pos = floor(-68*const(size.xscale)),floor(-204*const(size.yscale))
postype = p1
sprpriority = 1
bindtime=-1
ignorehitpause=1
removeongethit=1
removetime=-1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = Explod
trigger1 = AnimElem=4&&!IsHelper
id = 1003
anim=1003
pos = floor(-8*const(size.xscale)),floor(-204*const(size.yscale))
postype = p1
sprpriority = 3
bindtime=-1
ignorehitpause=1
removeongethit=1
removetime=-1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = RemoveExplod
trigger1 = AnimElem=4
id = 1002
persistent=0

[state 6150]
type = RemoveExplod
trigger1 = AnimElem=6
id = 1001
persistent=0

[state 6150]
type = RemoveExplod
trigger1 = AnimElem=6
id = 1003
persistent=0

[state 1050]
type = playsnd
trigger1 = AnimElemTime(5)=10&&(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105))
value = 20,15
channel = 10
;volume = 128

[state 6150]
type = Explod
trigger1 = AnimElemTime(5)=10
id = 6150
anim=ifelse((!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105)),6150,6111)
pos = floor(-30*const(size.xscale)),floor(-380*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6150]
type = Explod
trigger1 = AnimElemTime(5)=10
id = 6150
anim=ifelse((!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105)),6150,6111)
pos = floor(14*const(size.xscale)),floor(-380*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 1000]
type = Helper
trigger1 = AnimElemTime(5)=10 && (!NumHelper(6100)||!NumHelper(6102)||!NumHelper(6104))
id = 6100+(NumHelper(6100))*2+(NumHelper(6102))*2
stateno = 6110
pos = floor(-30*const(size.xscale)),floor(-380*const(size.yscale))
postype = P1
ownpal = 1
persistent=0

[state 1000]
type = Helper
trigger1 = AnimElemTime(5)=10 && (!NumHelper(6101)||!NumHelper(6103)||!NumHelper(6105))
id = 6101+(NumHelper(6101))*2+(NumHelper(6103))*2
stateno = 6110
pos = floor(14*const(size.xscale)),floor(-380*const(size.yscale))
postype = P1
ownpal = 1
persistent=0


;~~~パーフェクトガード~~~
[state -2]
type = varset
triggerall = (animelemtime(4)=[0,5])
trigger1 = var(50)>0&&command="holdback"&&command="hold_x"&&command="hold_y"&&!var(59)
var(31) = -ifelse(NumExplod(7705),1,5)

;サウンド
[state 8000]
type = PlaySND
trigger1 = var(31)=-ifelse(NumExplod(7705),1,5)
value = 4100,0
ignorehitpause=0

;エフェクト1
[state 8000]
type = Helper
trigger1 = var(31)=-ifelse(NumExplod(7705),1,5)
id = 7700
stateno = 7700
pos = 0,-floor(180*const(size.yscale))
postype = p1
sprpriority = 3
bindtime=-1
ownpal = 1
ignorehitpause=0
size.xscale = const(size.xscale)
size.yscale = const(size.yscale)

;パーフェクトガードへ
[state 1050]
type = changestate
trigger1 = var(31)=-ifelse(NumExplod(7705),1,5)
value = 120

;ジャンプへ
[state 1050]
type = changestate
triggerall = (animelemtime(4)=[0,5])
trigger1 = var(50)>0&&command="holdup"&&!var(59)
value = 40

;しゃがみへ
[state 1050]
type = changestate
triggerall = (animelemtime(4)=[0,5])
trigger1 = var(50)>0&&command="holddown"&&!var(59)
trigger2 = var(50)>0&&!var(2)&&var(59)
value = 11
ctrl = 1

[state 1050]
type = CtrlSet
trigger1 = animtime=-1
value = 1

[state 1050]
type = changestate
trigger1 = animtime=0
value = 0
ctrl = 1


;攻撃形態・浮遊機雷(地上)
[statedef 1020]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

[state 1000]
type = VarSet
trigger1 = Time=0 && !var(34) && !var(59)
var(7) = ifelse(command="z"||var(53)=1022,2,ifelse(command="y"||var(53)=1021,1,0))

[state 1000]
type = VarSet
trigger1 = Time=0 && !var(34) && var(59)
var(7) = ifelse(random%4<1,2,ifelse(random%8<1,1,0))

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time && !var(34)
var(53) = 0

[state 1000]
type = VarAdd
trigger1 = !time && !var(34)
var(37) = -1

[state 1000]
type = VarAdd
trigger1 = AnimElemTime(5)=10&&(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105))
trigger1 = var(53)!=1090
var(37) = -480/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 1050]
type = VarSet
trigger1 = Time=0
var(10) = 1

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1000

[state 210]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=3&&!IsHelper
value = 1000
elem = 4

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 1050]
type = playsnd
trigger1 = var(10)<=0 && !var(50) && AnimElem=5,=1
value = 20,6
channel = 10
;volume = 128

;援護形態へ移行
[state 1500]
type = ChangeState
triggerall = !Time&&(var(40)=1||(var(40)=[5,6]))&&!var(12)&&(prevstateno!=[5000,5099])
trigger1 = command="a"&&command!="holddown"&&!var(59)
value = 1600
;~~~~~~~~~~~~~溜め動作~~~~~~~~~~
;var(50):溜め時間
[state 1050]
type = varset
trigger1 = !time
var(50) = 0

[state 1050]
type = varadd
trigger1 = var(50)>0&&time
var(50) = 1

[state 1050]
type = varset
triggerall = animelemtime(4)=5&&!var(50)
trigger1 = ifelse(var(7)=2,command="hold_z",ifelse(var(7)=1,command="hold_y",command="hold_x"))&&!var(59)
trigger2 = !var(2)&&var(59)
var(50) = 1
persistent=0

[state 1050]
type = playsnd
trigger1 = var(50)=1
value = 7400,0
channel = 10
;volume = 128
persistent=0

[state 1050]
type = playsnd
trigger1 = var(50)=60||var(50)=90
value = 20,17
;channel = 10
;volume = 128

[state -2]
type = PalFX
trigger1 = var(50)=[60,71]
add = 64+(-var(50)+59)*5,128+(-var(50)+59)*9,255+(-var(50)+59)*20
color = 0-(-var(50)+59)*20
time = 1
ignorehitpause=1

[state -2]
type = PalFX
trigger1 = var(50)=[90,101]
add = 64+(-var(50)+89)*5,128+(-var(50)+89)*9,255+(-var(50)+89)*20
color = 0-(-var(50)+89)*20
time = 1
ignorehitpause=1

[state 1050]
type = varset
triggerall = var(50)>0&&time
trigger1 = ifelse(var(7)=2,command!="hold_z",ifelse(var(7)=1,command!="hold_y",command!="hold_x"))&&!var(59)
trigger2 = var(50)>=120
trigger3 = random%3=0&&var(59)
var(50) = -var(50)

[state 1050]
type = ChangeAnim
trigger1 = var(50)>0&&time
value = anim
elem = 4

[state 1050]
type = ChangeAnim
trigger1 = var(50)<0&&time
value = anim
elem = 5
persistent=0

;溜めエフェクト
[state -2]
type = Helper
trigger1 = var(50)%8=1 && animelemtime(5)<0
id = 7770
stateno=7770
pos = 0,0
postype = P1
ownpal = 1
facing=facing
pausemovetime=999999
supermovetime=999999
;===溜め動作

[state 6150]
type = Explod
trigger1 = AnimElem=3&&!IsHelper
id = 1001
anim=1001
pos = floor(-56*const(size.xscale)),floor(-192*const(size.yscale))
postype = p1
sprpriority = 2
bindtime=-1
ignorehitpause=1
removeongethit=1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = Explod
trigger1 = AnimElem=3&&!IsHelper
id = 1002
anim=1002
pos = floor(-68*const(size.xscale)),floor(-204*const(size.yscale))
postype = p1
sprpriority = 1
bindtime=-1
ignorehitpause=1
removeongethit=1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = Explod
trigger1 = AnimElem=3&&!IsHelper
id = 1002
anim=1002
pos = floor(-8*const(size.xscale)),floor(-204*const(size.yscale))
postype = p1
sprpriority = 3
bindtime=-1
ignorehitpause=1
removeongethit=1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = Explod
trigger1 = AnimElem=4&&!IsHelper
id = 1003
anim=1003
pos = floor(-68*const(size.xscale)),floor(-204*const(size.yscale))
postype = p1
sprpriority = 1
bindtime=-1
ignorehitpause=1
removeongethit=1
removetime=-1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = Explod
trigger1 = AnimElem=4&&!IsHelper
id = 1003
anim=1003
pos = floor(-8*const(size.xscale)),floor(-204*const(size.yscale))
postype = p1
sprpriority = 3
bindtime=-1
ignorehitpause=1
removeongethit=1
removetime=-1
scale = const(size.xscale),const(size.yscale)
removeongethit=1
persistent=0

[state 6150]
type = RemoveExplod
trigger1 = AnimElem=4
id = 1002
persistent=0

[state 6150]
type = RemoveExplod
trigger1 = AnimElem=6
id = 1001
persistent=0

[state 6150]
type = RemoveExplod
trigger1 = AnimElem=6
id = 1003
persistent=0

[state 1050]
type = playsnd
triggerall = !ifelse(floor(var(43)/1000)>=100,0,ifelse(floor(var(43)/1000)>=50,var(7)=1,var(7)=2))
trigger1 = AnimElemTime(5)=10&&(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105))
value = 20,15
channel = 10
;volume = 128

[state 6150]
type = Explod
triggerall = !ifelse(floor(var(43)/1000)>=100,0,ifelse(floor(var(43)/1000)>=50,var(7)=1,var(7)=2))
trigger1 = AnimElemTime(5)=10
id = 6150
anim=ifelse((!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105)),6150,6111)
pos = floor(-30*const(size.xscale)),floor(-380*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6150]
type = Explod
triggerall = !ifelse(floor(var(43)/1000)>=100,0,ifelse(floor(var(43)/1000)>=50,var(7)=1,var(7)=2))
trigger1 = AnimElemTime(5)=10
id = 6150
anim=ifelse((!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105)),6150,6111)
pos = floor(14*const(size.xscale)),floor(-380*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 1000]
type = Helper
triggerall = !ifelse(floor(var(43)/1000)>=100,0,ifelse(floor(var(43)/1000)>=50,var(7)=1,var(7)=2))
trigger1 = AnimElemTime(5)=10 && (!NumHelper(6100)||!NumHelper(6102)||!NumHelper(6104))
trigger2 = AnimElemTime(5)=10 && (!NumHelper(6101)||!NumHelper(6103)||!NumHelper(6105))
id = 6100+(NumHelper(6101)||NumHelper(6103))+(NumHelper(6100))*2+(NumHelper(6102))*2
stateno = 6120
pos = floor(ifelse(var(7)=2,-180,ifelse(var(7)=1,0,180))*const(size.xscale)),floor(ifelse(var(7)=1,-400,-240)*const(size.yscale))
postype = P1
ownpal = 1
persistent=0


;~~~パーフェクトガード~~~
[state -2]
type = varset
triggerall = (animelemtime(4)=[0,5])
trigger1 = var(50)>0&&command="holdback"&&command="hold_x"&&command="hold_y"&&!var(59)
var(31) = -ifelse(NumExplod(7705),1,5)

;サウンド
[state 8000]
type = PlaySND
trigger1 = var(31)=-ifelse(NumExplod(7705),1,5)
value = 4100,0
ignorehitpause=0

;エフェクト1
[state 8000]
type = Helper
trigger1 = var(31)=-ifelse(NumExplod(7705),1,5)
id = 7700
stateno = 7700
pos = 0,-floor(180*const(size.yscale))
postype = p1
sprpriority = 3
bindtime=-1
ownpal = 1
ignorehitpause=0
size.xscale = const(size.xscale)
size.yscale = const(size.yscale)

;パーフェクトガードへ
[state 1050]
type = changestate
trigger1 = var(31)=-ifelse(NumExplod(7705),1,5)
value = 120

;ジャンプへ
[state 1050]
type = changestate
triggerall = (animelemtime(4)=[0,5])
trigger1 = var(50)>0&&command="holdup"&&!var(59)
value = 40

;しゃがみへ
[state 1050]
type = changestate
triggerall = (animelemtime(4)=[0,5])
trigger1 = var(50)>0&&command="holddown"&&!var(59)
trigger2 = var(50)>0&&!var(2)&&var(59)
value = 11
ctrl = 1

[state 1050]
type = CtrlSet
trigger1 = animtime=-1
value = 1

[state 1050]
type = changestate
trigger1 = animtime=0
value = 0
ctrl = 1


;終了（攻撃形態）
[statedef 1090]
type = S
movetype=I
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
anim = 1090

[state 200]
type = VarSet
trigger1 = Time=0
var(10) = 0

[state 200]
type = VarSet
trigger1 = Time=0
fvar(8) = 0

[state -2]
type = Explod
trigger1 = !time&&var(36)%2<1&&(var(40)=-2||var(40)>0)
id = 6170
anim = 6175
pos = floor(180*const(size.xscale)),floor(-240*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state -2]
type = Explod
trigger1 = !time&&var(36)%4<2&&(var(40)=-2||var(40)>0) && floor(var(43)/1000)>=100
id = 6171
anim = 6175
pos = floor(0*const(size.xscale)),floor(-400*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state -2]
type = Explod
trigger1 = !time&&var(36)%8<4&&(var(40)=-2||var(40)>0) && floor(var(43)/1000)>=50
id = 6172
anim = 6175
pos = floor(-180*const(size.xscale)),floor(-240*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state 1320]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;攻撃形態（通常弾・球）
[statedef 6100]
type = A
movetype=A
physics = N
velset = 0,0
ctrl = 0
anim = 6100
sprpriority = 4

[state 6150]
type = Explod
trigger1 = Time%2=0&&!movecontact
id = 6110
anim=6110
pos = 0,0
postype = p1
ownpal = 1
sprpriority = 5
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

;溜め時間判別
[state 6100]
type = varset
trigger1 = !time
var(20) = ifelse(root,var(50)<=-120,2,ifelse(root,var(50)<=-90,1,0))

;突進形態中判別
[state 6100]
type = varset
trigger1 = !time
var(21) = (root,stateno=3100)

[state 6100]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6100]
type = AssertSpecial
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
flag = noshadow
flag2 = invisible

[state 6100]
type = StatetypeSet
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
movetype=I

[state 6100]
type = NotHitBy
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
value = SCA

[state 6100]
type = VarSet
trigger1 = !Time
var(7) = root,var(7)

[state 6100]
type = VarRandom
trigger1 = !Time
v = 8
range = 0,4
;root,var(51)%4=0

[state 6100]
type = VelAdd
trigger1 = Time>=1
y = .5

[state 6100]
type = VelSet
trigger1 = Time=1
x = 1.25+var(7)*2.0+var(8)*.15+ifelse(IsHelper(6101)||IsHelper(6103)||IsHelper(6105),0.5,0)
y = -9.0-var(7)*2

[state 6100]
type = VelSet
trigger1 = ScreenPos X<=0||ScreenPos X>=320
x = -Vel X
persistent=0

;Attack Lv.3
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed
damage = floor(ifelse(8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),floor(ceil(8*root,fvar(3)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 5,12
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0012,-8.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-14*(51-root,var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),30+12,16-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(14*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(14*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(14*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(14*root,fvar(3)*.8*1.0/8)*1.38
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = 0,0
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
fall.xvelocity = -3.0*ifelse(enemynear,facing=facing,-1,1)
fall.yvelocity = -3.0
persistent=0
numhits = 0

;移動系飛び道具判別用
[state 200]
type = Projectile
trigger1 = 1
projanim = 90000
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = 0,0
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
projremovetime=1

[state 1000]
type = parentvarset
trigger1 = root,fvar(27)>=90000 && root,var(40)=-4 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
var(40) = 11

[state 6100]
type = varadd
trigger1 = var(0)
var(0) = 1

[state 6100]
type = varset
trigger1 = Time=1
var(0) = 1

[state 6100]
type = velset
trigger1 = var(0) && Time<var(5)&&(prevstateno=[5000,6120])
x = 0
y = 0

[state 6100]
type = StatetypeSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
movetype=H

[state 6100]
type = VarSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
fvar(3) = GetHitVar(xvel)

[state 6100]
type = VarSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
fvar(4) = GetHitVar(yvel)

[state 6100]
type = VarSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
var(5) = 1;GetHitVar(Hitshaketime)

[state 6100]
type = PlaySND
trigger1 = prevstateno=stateno
trigger1 = time=0
value = 7100,ifelse(var(10)=6||var(10)=7,2,ifelse(var(10)=4,1,5))

[state 6100]
type = VarSet
trigger1 = prevstateno=stateno
trigger1 = time=0
fvar(3) = ifelse(var(10)=2||var(10)=5||var(10)=9||var(10)=30,8,ifelse(var(10)=1,5,ifelse(var(10)=3,2,ifelse((var(10)=[6,8]),3,ifelse(var(10)=4,4,6)))))*root,facing

[state 6100]
type = VarSet
trigger1 = prevstateno=stateno
trigger1 = time=0
fvar(4) = ifelse(var(10)=3||var(10)=6,-12,ifelse((var(10)=[7,8])||var(10)=10||var(10)=20,6,ifelse(var(10)=5||var(10)=31,-8,-6)))*(random%2)

[state 6100]
type = VarSet
trigger1 = prevstateno=stateno
trigger1 = time=0
var(5) = 1;ifelse(var(10)!=5,12,10)

[state 6100]
type = VelSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=var(5)
x = fvar(3)*facing
y = ifelse(fvar(4)>0&&(prevstateno!=[6100,6120]),-2,fvar(4))

[state 1000]
type = parentvarset
trigger1 = root,fvar(27)>=90000 && root,var(40)=-4 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
var(40) = 11

;爆風
[state 1000]
type = Helper
trigger1 = ((var(0)&&MoveContact=1)||(Vel Y>0&&Pos Y>=0)) && (IsHelper(6100)||IsHelper(6102)||IsHelper(6104))
trigger2 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger3 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3]);爆発
trigger4 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7]);爆発
trigger5 = numhelper(6300)
trigger5 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger6 = numhelper(6305)
trigger6 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
id = 6150+(IsHelper(6102))*2+(IsHelper(6104))*4
stateno = 6150
pos = 0,0
postype = P1
ownpal = 1
ignorehitpause=1
persistent=0

[state 1000]
type = Helper
trigger1 = ((var(0)&&MoveContact=1)||(Vel Y>0&&Pos Y>=0)) && (IsHelper(6101)||IsHelper(6103)||IsHelper(6105))
trigger2 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger3 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3]);爆発
trigger4 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7]);爆発
trigger5 = numhelper(6300)
trigger5 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger6 = numhelper(6305)
trigger6 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
id = 6151+(IsHelper(6103))*2+(IsHelper(6105))*4
stateno = 6150
pos = 0,0
postype = P1
ownpal = 1
ignorehitpause=1
persistent=0

[state 6100]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
stateno=stateno
slot = 0
time = 1

;==本体攻撃ヒット判別（擬似）
[state 6100]
type = varset
trigger1 = !time
var(10) = 0

[state 6100]
type = varset
trigger1 = Time>var(5)&&root,stateno=200 && root,movecontact<=1 && (root,animelemtime(5)=[0,2])
trigger1 = ((pos y-root,pos y)=[floor((-216-30)*const(size.yscale)),floor((-120+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(100*const(size.xscale)),floor((342+20)*const(size.xscale))]
var(10) = 1

[state 6100]
type = varset
triggerall = Time>var(5)&&(root,stateno=210||root,var(34)=210) && root,movecontact<=1 && (root,animelemtime(4)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-254-30)*const(size.yscale)),floor((-130+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(80*const(size.xscale)),floor((182+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-254-30)*const(size.yscale)),floor((-142+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(144*const(size.xscale)),floor((390+20)*const(size.xscale))]
var(10) = 2

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=210 && root,movecontact<=1 && (root,animelemtime(10)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-160-30)*const(size.yscale)),floor((-11+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(70*const(size.xscale)),floor((258+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-124-30)*const(size.yscale)),floor((24+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(216*const(size.xscale)),floor((344+20)*const(size.xscale))]
var(10) = 2

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=220 && root,movecontact<=1 && (root,animelemtime(5)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-328-30)*const(size.yscale)),floor((-122+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((236+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-367-30)*const(size.yscale)),floor((-246+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((181-20)*const(size.xscale)),floor((407+20)*const(size.xscale))]
var(10) = 3

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=220 && root,movecontact<=1 && (root,animelemtime(7)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-70-30)*const(size.yscale)),floor((-34+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((-384+20)*const(size.xscale)),floor((-244-20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-148-30)*const(size.yscale)),floor((-11+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((-306+20)*const(size.xscale)),floor((-142-20)*const(size.xscale))]
var(10) = 3

[state 6100]
type = varset
triggerall = Time>var(5)&&(root,stateno=400||root,var(34)=400) && root,animelemtime(6)=0
trigger1 = ((pos y-root,pos y)=[floor((-59-30)*const(size.yscale)),floor((15+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((40-20)*const(size.xscale)),floor((172+20)*const(size.xscale))]
var(10) = 4

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=410 && (root,animelemtime(12)=[0,2])
trigger1 = ((pos y-root,pos y)=[floor((-174-30)*const(size.yscale)),floor((6+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((56-20)*const(size.xscale)),floor((221+20)*const(size.xscale))]
var(10) = 5

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=420 && (root,animelemtime(9)=[0,3]) && root,anim!=421
trigger1 = ((pos y-root,pos y)=[floor((-139-30)*const(size.yscale)),floor((13+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((45-20)*const(size.xscale)),floor((200+20)*const(size.xscale))]
var(10) = 6

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=600 && root,movecontact<=1 && (root,animelemtime(4)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-272-20)*const(size.yscale)),floor((-92+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((50-20)*const(size.xscale)),floor((203+20)*const(size.xscale))]
var(10) = 7

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=610 && root,movecontact<=1 && (root,animelemtime(6)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-264-20)*const(size.yscale)),floor((-2+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((40-20)*const(size.xscale)),floor((218+20)*const(size.xscale))]
var(10) = 8

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=620 && root,movecontact<=1 && root,animelemtime(7)>=0&&root,animelemtime(9)<=3
trigger1 = ((pos y-root,pos y)=[floor((-260-20)*const(size.yscale)),floor((-81+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((390+20)*const(size.xscale))]
var(10) = 9

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=720 && root,movecontact<=1 && (root,animelemtime(7)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-191-20)*const(size.yscale)),floor((83+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((40-20)*const(size.xscale)),floor((183+20)*const(size.xscale))]
var(10) = 10

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=310 && root,movecontact<=1 && (root,animelemtime(11)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-322-20)*const(size.yscale)),floor((-164+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((234+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-366-20)*const(size.yscale)),floor((-264+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((172-20)*const(size.xscale)),floor((290+20)*const(size.xscale))]
var(10) = 20

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=310 && root,movecontact<=1 && (root,animelemtime(12)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-236-20)*const(size.yscale)),floor((-38+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((274+20)*const(size.xscale))]
var(10) = 20

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=310 && root,movecontact<=1 && (root,animelemtime(13)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-189-20)*const(size.yscale)),floor((42+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((274+20)*const(size.xscale))]
var(10) = 20

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=900 && root,movecontact<=1 && (root,animelemtime(6)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-250-20)*const(size.yscale)),floor((-90+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((20-20)*const(size.xscale)),floor((142+20)*const(size.xscale))]
var(10) = 30

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=900 && root,movecontact<=1 && (root,animelemtime(7)=[0,0])
trigger1 = ((pos y-root,pos y)=[floor((-250-20)*const(size.yscale)),floor((-90+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((20-20)*const(size.xscale)),floor((142+20)*const(size.xscale))]
var(10) = 30

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=910 && root,movecontact<=1 && (root,animelemtime(8)=[0,2])
trigger1 = ((pos y-root,pos y)=[floor((-108-20)*const(size.yscale)),floor((20+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((224-20)*const(size.xscale)),floor((274+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-132-20)*const(size.yscale)),floor((16+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((176-20)*const(size.xscale)),floor((246+20)*const(size.xscale))]
trigger3 = ((pos y-root,pos y)=[floor((-164-20)*const(size.yscale)),floor((12+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((190+20)*const(size.xscale))]
var(10) = 31

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=910 && root,movecontact<=1 && ((root,animelemtime(9)=[0,2])||(root,animelemtime(10)=[0,0]))
trigger1 = ((pos y-root,pos y)=[floor((-200-20)*const(size.yscale)),floor((-10+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((164-20)*const(size.xscale)),floor((234+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-324-20)*const(size.yscale)),floor((-32+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((-100-20)*const(size.xscale)),floor((152+20)*const(size.xscale))]
trigger3 = ((pos y-root,pos y)=[floor((-234-20)*const(size.yscale)),floor((-16+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((124-20)*const(size.xscale)),floor((194+20)*const(size.xscale))]
var(10) = 31

;爆発
[state 6100]
type = varset
trigger1 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3])
trigger2 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7])
trigger3 = numhelper(6300)
trigger3 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger4 = numhelper(6305)
trigger4 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
var(35) = 1
persistent=0

;電磁形態引き込み
[state 6100]
type = posadd
trigger1 = numhelper(6300)
trigger1 = abs(pos x-helper(6300),pos x)>220*const(size.xscale)
x = -5*ifelse((pos x-helper(6300),pos x)*ifelse(facing!=helper(6300),facing,-1,1)>0,1,-1)*root,facing

;電磁形態引き込み
[state 6100]
type = posadd
trigger1 = numhelper(6305)
trigger1 = abs(pos x-helper(6305),pos x)>220*const(size.xscale)
x = -5*ifelse((pos x-helper(6305),pos x)*ifelse(facing!=helper(6305),facing,-1,1)>0,1,-1)*root,facing

;壁コンボ中
[state -1]
type = targetstate
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
value = 926+(root,var(1)=4||root,var(1)=6)*3
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1
persistent=0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1&&!hitpausetime
fvar(15) = fvar(15)
ignorehitpause=1
persistent=0

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1&&!hitpausetime
fvar(14) = fvar(14)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=0
var(16) = 10+random%6
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;X座標
[state 240]
type = VarSet
trigger1 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
var(17) = 0

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=0
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;ヒットスパーク
[state 1000]
type = Helper
trigger1 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)]);対忍者
id = 7000
stateno=7100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5
persistent=0

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !((root,stateno=3000&&root,AnimElemTime(11)>=0&&root,AnimElemTime(11)<30)||((root,stateno=[3100,3120])&&root,AnimElemTime(3)>=0&&root,AnimElemTime(3)<30)||(root,stateno=3500&&root,AnimElemTime(4)>=0&&root,AnimElemTime(5)<0))
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && (!numhelper(15902)|| !numhelper(15901))&&IsHelper
trigger1 = time=1
id = 15902-(numhelper(15902))
stateno=15902-(numhelper(15902))
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&(!numhelper(15907)||!numhelper(15906))&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2-(numhelper(15907))
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&(!numhelper(15387)||!numhelper(15386))&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7-(numhelper(15387))
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 6100]
type = changestate
trigger1 = var(10)&&time
value = stateno

[state 6100]
type = VarSet
trigger1 = !time
var(45) = 0

[state 6100]
type = VarAdd
trigger1 = var(45)!=0
var(45) = 1

[state 6100]
type = VarSet
triggerall = !var(45)
trigger1 = (Vel Y>0 && Pos Y>=0)||MoveContact=1
trigger2 = prevstateno=[5000,5099]
trigger3 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger4 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3])
trigger5 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7])
trigger6 = numhelper(6300)&&var(35)=1
trigger6 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger7 = numhelper(6305)&&var(35)=1
trigger7= abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
trigger8 = numhelper(7250)
trigger8 = abs(pos x-helper(7250),pos x)<=30 && var(0)>=1 && time>=1
var(45) = 1

[state 6100]
type = DestroySelf
trigger1 = var(45)=2


;攻撃形態（時限弾・球）
[statedef 6110]
type = A
movetype=A
physics = N
velset = 0,0
ctrl = 0
anim = 6100
sprpriority = 4

[state 6150]
type = varset
trigger1 = !time
var(15) = 0

[state 6150]
type = Explod
trigger1 = Time%4=0&&!movecontact&&!var(0)&&!var(5)
trigger1 = ifelse(numexplod(6115),ifelse(numexplod(6116),ifelse(numexplod(6117),ifelse(numexplod(6118),ifelse(numexplod(6119),var(14):=1,var(19):=1),var(18):=1),var(17):=1),var(16):=1),var(15):=1)
id = ifelse(numexplod(6115),ifelse(numexplod(6116),ifelse(numexplod(6117),ifelse(numexplod(6118),ifelse(numexplod(6119),6120,6119),6118),6117),6116),6115)
anim=6110
pos = 0,floor(10*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 5
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state 6150]
type = Explod
trigger1 = var(0)&&!var(5)&&!(Time<var(5)&&(prevstateno=[5000,6120]))&&!numexplod(6110)
trigger1 = var(13):=1
id = 6110
anim=6110
pos = 0,floor(10*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 5
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state 6150]
type = ModifyExplod
trigger1 = 1
id = 6115
scale = const(size.xscale)*(1-.05+var(15)%24*.0375),const(size.yscale)*(1-.05+var(15)%24*.05)

[state 6150]
type = ModifyExplod
trigger1 = 1
id = 6116
scale = const(size.xscale)*(1-.05+var(16)%24*.0375),const(size.yscale)*(1-.05+var(16)%24*.05)

[state 6150]
type = ModifyExplod
trigger1 = 1
id = 6117
scale = const(size.xscale)*(1-.05+var(17)%24*.0375),const(size.yscale)*(1-.05+var(17)%24*.05)

[state 6150]
type = ModifyExplod
trigger1 = 1
id = 6118
scale = const(size.xscale)*(1-.05+var(18)%24*.0375),const(size.yscale)*(1-.05+var(18)%24*.05)

[state 6150]
type = ModifyExplod
trigger1 = 1
id = 6119
scale = const(size.xscale)*(1-.05+var(19)%24*.0375),const(size.yscale)*(1-.05+var(19)%24*.05)

[state 6150]
type = ModifyExplod
trigger1 = 1
id = 6120
scale = const(size.xscale)*(1-.05+var(14)%24*.0375),const(size.yscale)*(1-.05+var(14)%24*.05)

[state 6150]
type = ModifyExplod
trigger1 = !movecontact
id = 6110
scale = const(size.xscale)*(1-.05+var(13)%24*.0375),const(size.yscale)*(1-.05+var(13)%24*.05)

[state 6150]
type = varadd
trigger1 = var(13)!=0
var(13) = 1

[state 6150]
type = null
trigger1 = var(15)!=0
trigger1 = var(15):=var(15)+1
trigger2 = var(16)!=0
trigger2 = var(16):=var(16)+1
trigger3 = var(17)!=0
trigger3 = var(17):=var(17)+1
trigger4 = var(18)!=0
trigger4 = var(18):=var(18)+1
trigger5 = var(19)!=0
trigger5 = var(19):=var(19)+1
trigger6 = var(14)!=0
trigger6 = var(14):=var(14)+1

;溜め時間判別
[state 6100]
type = varset
trigger1 = !time
var(20) = ifelse(root,var(50)<=-120,2,ifelse(root,var(50)<=-90,1,0))

[state 6100]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6100]
type = StatetypeSet
trigger1 = (Vel Y>0 && Pos Y>=-Vel Y) || (var(0) && (prevstateno!=[5000,6120]))
movetype=I

[state 6100]
type = StatetypeSet
trigger1 = var(0)>=1300
movetype=A

[state 6100]
type = VarSet
trigger1 = !Time
var(7) = root,var(7)

[state 6100]
type = VarSet
trigger1 = !Time
var(8) = root,var(51)%4=0

[state 6100]
type = VelAdd
trigger1 = Time>=1&&pos Y<0
y = .5

[state 6100]
type = VelSet
trigger1 = prevstateno!=[5000,6120]
trigger1 = Time=1
x = 1.25+var(7)*2.0+var(8)*.15+ifelse(IsHelper(6101)||IsHelper(6103)||IsHelper(6105),0.5,0)
y = -9.0-var(7)*2

[state 6100]
type = VelSet
trigger1 = prevstateno!=[5000,6120]
trigger1 = ScreenPos X<=0||ScreenPos X>=320
x = -Vel X
persistent=0

;Attack Lv.3
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed
trigger1 = ifelse((prevstateno=[5000,6120]),Time>=var(5),1)
damage = floor(ifelse(8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),floor(ceil(8*root,fvar(3)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 5,12
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0012,-8.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-14*(51-root,var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),30+12,16-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(14*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(14*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(14*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(14*root,fvar(3)*.8*1.0/8)*1.38
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = 0,0
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
fall.xvelocity = -3.0*ifelse(enemynear,facing=facing,-1,1)
fall.yvelocity = -3.0
persistent=0
numhits = 0

;移動系飛び道具判別用
[state 200]
type = Projectile
trigger1 = (!(Vel Y>0 && Pos Y>=-Vel Y)&&!var(0))||(prevstateno=[5000,6120])
projanim = 90000
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = 0,0
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
projremovetime=1

[state 6100]
type = VarSet
trigger1 = time=0
var(5) = 0

[state 6100]
type = varset
trigger1 = !time
var(0) = 0

[state 6100]
type = varadd
trigger1 = var(0)
var(0) = 1

[state 6100]
type = varset
trigger1 = Vel Y>0 && Pos Y>=-Vel Y && !var(0)
var(0) = 1

[state 6100]
type = PosSet
trigger1 = var(0)=1
y = floor(10*const(size.yscale))

[state 6100]
type = velset
trigger1 = var(0) && ((prevstateno!=[5000,6120])||(Time<var(5)&&(prevstateno=[5000,6120])))
x = 0
y = 0

[state 6100]
type = StatetypeSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
movetype=H

[state 6100]
type = VarSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
fvar(3) = GetHitVar(xvel)

[state 6100]
type = VarSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
fvar(4) = GetHitVar(yvel)

[state 6100]
type = VarSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
var(5) = 1;GetHitVar(Hitshaketime)

[state 6100]
type = PlaySND
trigger1 = prevstateno=stateno
trigger1 = time=0
value = 7100,ifelse(var(10)=6||var(10)=7,2,ifelse(var(10)=4,1,5))

[state 6100]
type = VarSet
trigger1 = prevstateno=stateno
trigger1 = time=0
fvar(3) = ifelse(var(10)=2||var(10)=5||var(10)=9||var(10)=30,8,ifelse(var(10)=1,5,ifelse(var(10)=3,2,ifelse((var(10)=[6,8]),3,ifelse(var(10)=4,4,6)))))*root,facing

[state 6100]
type = VarSet
trigger1 = prevstateno=stateno
trigger1 = time=0
fvar(4) = ifelse(var(10)=3||var(10)=6,-12,ifelse((var(10)=[7,8])||var(10)=10||var(10)=20,6,ifelse(var(10)=5,-8,-6)))

[state 6100]
type = VarSet
trigger1 = prevstateno=stateno
trigger1 = time=0
var(5) = 1;ifelse(var(10)!=5,12,10)

[state 6100]
type = VelSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=var(5)
x = fvar(3)*facing
y = ifelse(fvar(4)>0&&(prevstateno!=[6100,6120]),-2,fvar(4))

[state 1000]
type = parentvarset
trigger1 = root,fvar(27)>=90000 && root,var(40)=-4 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
var(40) = 11

;爆風
[state 1000]
type = Helper
trigger1 = (var(0)>=1300||(var(0)&&MoveContact=1)||(Vel Y>0&&Pos Y>=0&&prevstateno=[5000,6120])) && (IsHelper(6100)||IsHelper(6102)||IsHelper(6104))
trigger2 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger3 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3]);爆発
trigger4 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7]);爆発
trigger5 = numhelper(6300)
trigger5 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger6 = numhelper(6305)
trigger6 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
trigger7 = numhelper(7250)
trigger7 = abs(pos x-helper(7250),pos x)<=30 && var(0)>=1 && time>=1
id = 6150+(IsHelper(6102))*2+(IsHelper(6104))*4
stateno = 6150
pos = 0,0
postype = P1
ownpal = 1
ignorehitpause=1
persistent=0

[state 1000]
type = Helper
trigger1 = (var(0)>=1300||(var(0)&&MoveContact=1)||(Vel Y>0&&Pos Y>=0&&prevstateno=[5000,6120])) && (IsHelper(6101)||IsHelper(6103)||IsHelper(6105))
trigger2 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger3 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3]);爆発
trigger4 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7]);爆発
trigger5 = numhelper(6300)
trigger5 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger6 = numhelper(6305)
trigger6 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
trigger7 = numhelper(7250)
trigger7 = abs(pos x-helper(7250),pos x)<=30 && var(0)>=1 && time>=1
id = 6151+(IsHelper(6103))*2+(IsHelper(6105))*4
stateno = 6150
pos = 0,0
postype = P1
ownpal = 1
ignorehitpause=1
persistent=0

[state 6100]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
stateno=stateno
slot = 0
time = 1

;==本体攻撃ヒット判別（擬似）
[state 6100]
type = varset
trigger1 = !time
var(10) = 0

[state 6100]
type = varset
trigger1 = Time>var(5)&&root,stateno=200 && root,movecontact<=1 && (root,animelemtime(5)=[0,2])
trigger1 = ((pos y-root,pos y)=[floor((-216-30)*const(size.yscale)),floor((-120+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(100*const(size.xscale)),floor((342+20)*const(size.xscale))]
var(10) = 1

[state 6100]
type = varset
triggerall = Time>var(5)&&(root,stateno=210||root,var(34)=210) && root,movecontact<=1 && (root,animelemtime(4)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-254-30)*const(size.yscale)),floor((-130+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(80*const(size.xscale)),floor((182+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-254-30)*const(size.yscale)),floor((-142+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(144*const(size.xscale)),floor((390+20)*const(size.xscale))]
var(10) = 2

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=210 && root,movecontact<=1 && (root,animelemtime(10)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-160-30)*const(size.yscale)),floor((-11+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(70*const(size.xscale)),floor((258+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-124-30)*const(size.yscale)),floor((24+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(216*const(size.xscale)),floor((344+20)*const(size.xscale))]
var(10) = 2

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=220 && root,movecontact<=1 && (root,animelemtime(5)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-328-30)*const(size.yscale)),floor((-122+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((236+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-367-30)*const(size.yscale)),floor((-246+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((181-20)*const(size.xscale)),floor((407+20)*const(size.xscale))]
var(10) = 3

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=220 && root,movecontact<=1 && (root,animelemtime(7)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-70-30)*const(size.yscale)),floor((-34+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((-384+20)*const(size.xscale)),floor((-244-20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-148-30)*const(size.yscale)),floor((-11+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((-306+20)*const(size.xscale)),floor((-142-20)*const(size.xscale))]
var(10) = 3

[state 6100]
type = varset
trigger1 = Time&&(root,stateno=400||root,var(34)=400) && root,animelemtime(6)=0
trigger1 = ((pos y-root,pos y)=[floor((-59-30)*const(size.yscale)),floor((15+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((40-20)*const(size.xscale)),floor((172+20)*const(size.xscale))]
var(10) = 4

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=410 && (root,animelemtime(12)=[0,2])
trigger1 = ((pos y-root,pos y)=[floor((-174-30)*const(size.yscale)),floor((6+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((56-20)*const(size.xscale)),floor((221+20)*const(size.xscale))]
var(10) = 5

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=420 && (root,animelemtime(9)=[0,3]) && root,anim!=421
trigger1 = ((pos y-root,pos y)=[floor((-139-30)*const(size.yscale)),floor((13+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((45-20)*const(size.xscale)),floor((200+20)*const(size.xscale))]
var(10) = 6

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=600 && root,movecontact<=1 && (root,animelemtime(4)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-272-20)*const(size.yscale)),floor((-92+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((50-20)*const(size.xscale)),floor((203+20)*const(size.xscale))]
var(10) = 7

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=610 && root,movecontact<=1 && (root,animelemtime(6)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-264-20)*const(size.yscale)),floor((-2+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((40-20)*const(size.xscale)),floor((218+20)*const(size.xscale))]
var(10) = 8

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=620 && root,movecontact<=1 && root,animelemtime(7)>=0&&root,animelemtime(9)<=3
trigger1 = ((pos y-root,pos y)=[floor((-260-20)*const(size.yscale)),floor((-81+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((390+20)*const(size.xscale))]
var(10) = 9

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=720 && root,movecontact<=1 && (root,animelemtime(7)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-191-20)*const(size.yscale)),floor((83+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((40-20)*const(size.xscale)),floor((183+20)*const(size.xscale))]
var(10) = 10

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=310 && root,movecontact<=1 && (root,animelemtime(9)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-322-20)*const(size.yscale)),floor((-164+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((234+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-366-20)*const(size.yscale)),floor((-264+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((172-20)*const(size.xscale)),floor((290+20)*const(size.xscale))]
var(10) = 20

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=310 && root,movecontact<=1 && (root,animelemtime(10)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-236-20)*const(size.yscale)),floor((-38+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((274+20)*const(size.xscale))]
var(10) = 20

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=310 && root,movecontact<=1 && (root,animelemtime(11)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-189-20)*const(size.yscale)),floor((42+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((274+20)*const(size.xscale))]
var(10) = 20

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=900 && root,movecontact<=1 && (root,animelemtime(6)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-250-20)*const(size.yscale)),floor((-90+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((20-20)*const(size.xscale)),floor((142+20)*const(size.xscale))]
var(10) = 30

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=900 && root,movecontact<=1 && (root,animelemtime(7)=[0,0])
trigger1 = ((pos y-root,pos y)=[floor((-250-20)*const(size.yscale)),floor((-90+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((20-20)*const(size.xscale)),floor((142+20)*const(size.xscale))]
var(10) = 30

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=910 && root,movecontact<=1 && (root,animelemtime(8)=[0,2])
trigger1 = ((pos y-root,pos y)=[floor((-108-20)*const(size.yscale)),floor((20+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((224-20)*const(size.xscale)),floor((274+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-132-20)*const(size.yscale)),floor((16+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((176-20)*const(size.xscale)),floor((246+20)*const(size.xscale))]
trigger3 = ((pos y-root,pos y)=[floor((-164-20)*const(size.yscale)),floor((12+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((190+20)*const(size.xscale))]
var(10) = 31

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=910 && root,movecontact<=1 && ((root,animelemtime(9)=[0,2])||(root,animelemtime(10)=[0,0]))
trigger1 = ((pos y-root,pos y)=[floor((-200-20)*const(size.yscale)),floor((-10+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((164-20)*const(size.xscale)),floor((234+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-324-20)*const(size.yscale)),floor((-32+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((-100-20)*const(size.xscale)),floor((152+20)*const(size.xscale))]
trigger3 = ((pos y-root,pos y)=[floor((-234-20)*const(size.yscale)),floor((-16+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((124-20)*const(size.xscale)),floor((194+20)*const(size.xscale))]
var(10) = 31

;爆発
[state 6100]
type = varset
trigger1 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3])
trigger2 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7])
trigger3 = numhelper(6300)
trigger3 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger4 = numhelper(6305)
trigger4 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
trigger5 = numhelper(7250)
trigger5 = abs(pos x-helper(7250),pos x)<=30 && var(0)>=1 && time>=1
var(35) = 1
persistent=0

;電磁形態引き込み
[state 6100]
type = posadd
trigger1 = numhelper(6300)
trigger1 = abs(pos x-helper(6300),pos x)>220*const(size.xscale)
x = -5*ifelse((pos x-helper(6300),pos x)*ifelse(facing!=helper(6300),facing,-1,1)>0,1,-1)*root,facing

;電磁形態引き込み
[state 6100]
type = posadd
trigger1 = numhelper(6305)
trigger1 = abs(pos x-helper(6305),pos x)>220*const(size.xscale)
x = -5*ifelse((pos x-helper(6305),pos x)*ifelse(facing!=helper(6305),facing,-1,1)>0,1,-1)*root,facing

;壁コンボ中
[state -1]
type = targetstate
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
value = 926+(root,var(1)=4||root,var(1)=6)*3
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1
persistent=0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1&&!hitpausetime
fvar(15) = fvar(15)
ignorehitpause=1
persistent=0

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1&&!hitpausetime
fvar(14) = fvar(14)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=0
var(16) = 10+random%6
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;X座標
[state 240]
type = VarSet
trigger1 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
var(17) = 0

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=0
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;ヒットスパーク
[state 1000]
type = Helper
trigger1 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)]);対忍者
id = 7000
stateno=7100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5
persistent=0

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !((root,stateno=3000&&root,AnimElemTime(11)>=0&&root,AnimElemTime(11)<30)||((root,stateno=[3100,3120])&&root,AnimElemTime(3)>=0&&root,AnimElemTime(3)<30)||(root,stateno=3500&&root,AnimElemTime(4)>=0&&root,AnimElemTime(5)<0))
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && (!numhelper(15902)|| !numhelper(15901))&&IsHelper
trigger1 = time=1
id = 15902-(numhelper(15902))
stateno=15902-(numhelper(15902))
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&(!numhelper(15907)||!numhelper(15906))&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2-(numhelper(15907))
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&(!numhelper(15387)||!numhelper(15386))&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7-(numhelper(15387))
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 6100]
type = changestate
trigger1 = var(10)&&time
value = stateno

[state 6100]
type = statetypeset
trigger1 = root,numhelper(7250)
movetype=A

[state 6100]
type = varadd
trigger1 = var(0)>=701
var(16) = var(0)%15=0

[state 6100]
type = PalFX
trigger1 = var(0)>=701
add = var(16)*3,0,0
time = 1

[state 6100]
type = VarSet
trigger1 = !time
var(45) = 0

[state 6100]
type = VarAdd
trigger1 = var(45)!=0
var(45) = 1

[state 6100]
type = VarSet
triggerall = !var(45)
trigger1 = var(0)>=1301||(var(0)&&MoveContact=1)
trigger2 = Vel Y>0&&Pos Y>=0&&prevstateno=[5000,6120]
trigger3 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger4 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3])
trigger5 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7])
trigger6 = numhelper(6300)&&var(35)=1
trigger6 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger7 = numhelper(6305)&&var(35)=1
trigger7 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
trigger8 = numhelper(7250)
trigger8 = abs(pos x-helper(7250),pos x)<=30 && var(0)>=1 && time>=1
var(45) = 1

[state 6100]
type = DestroySelf
trigger1 = var(45)=2


;攻撃形態（浮遊機雷・球）
[statedef 6120]
type = A
movetype=A
physics = N
velset = 0,0
ctrl = 0
anim = 6100
sprpriority = 4

[state 6150]
type = RemoveExplod
trigger1 = !Time||MoveContact
trigger2 = root,fvar(27)>=90000 && root,var(40)=-4 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger3 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3])
trigger4 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7])
trigger5 = numhelper(6300)
trigger5 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger6 = numhelper(6305)
trigger6 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
id = 6120

[state 6150]
type = RemoveExplod
trigger1 = !Time||MoveContact
trigger2 = root,fvar(27)>=90000 && root,var(40)=-4 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger3 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3])
trigger4 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7])
trigger5 = numhelper(6300)
trigger5 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger6 = numhelper(6305)
trigger6 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
id = 6121

[state 6150]
type = Explod
trigger1 = !Time&&(prevstateno!=[5000,6199])
id = 6120
anim=6120
pos = 0,0
postype = p1
sprpriority = 5
ignorehitpause=1
removeongethit=1
removetime=-1
scale = const(size.xscale)*.5,const(size.yscale)*.5

[state 6150]
type = Explod
trigger1 = !Time&&(prevstateno!=[5000,6199])
id = 6121
anim=6121
pos = 0,0
postype = p1
sprpriority = 5
ignorehitpause=1
removeongethit=1
removetime=-1
scale = const(size.xscale)*.75,const(size.yscale)*.75

[state 6150]
type = ModifyExplod
trigger1 = time&&prevstateno!=[5000,6199]
id = 6120
scale = const(size.xscale)*(.5625+(time%104+1)*.00725-(time%104>26)*.375-(time%104>78)*.375),const(size.yscale)*(.5625+(time%104+1)*.00725-(time%104>26)*.375-(time%104>78)*.375)

[state 6150]
type = ModifyExplod
trigger1 = time&&prevstateno!=[5000,6199]
id = 6121
scale = const(size.xscale)*(.75+(time%104+1)*.00725-(time%104>0)*.375-(time%104>52)*.375),const(size.yscale)*(.75+(time%104+1)*.00725-(time%104>0)*.375-(time%104>52)*.375)

[state 6150]
type = AngleDraw
trigger1 = 1
scale = 1,1

[state 6150]
type = AngleAdd
trigger1 = Time%2
value = 5

;溜め時間判別
[state 6100]
type = varset
trigger1 = !time
var(20) = ifelse(root,var(50)<=-120,2,ifelse(root,var(50)<=-90,1,0))

[state 6100]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6100]
type = AssertSpecial
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
flag = noshadow
flag2 = invisible

[state 6100]
type = NotHitBy
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
value = SCA

[state 6100]
type = VarSet
trigger1 = !Time
var(7) = root,var(7)

[state 6100]
type = VarSet
trigger1 = !Time
var(8) = root,var(51)%4=0

[state 6100]
type = VelAdd
trigger1 = Time>=var(5)
y = .5

[state 6100]
type = VelSet
trigger1 = Time=1 && prevstateno!=[5000,6120]
x = 0
y = 0

;Attack Lv.3
[state 200]
type = Hitdef
trigger1 = !movecontact&&!movereversed
damage = floor(ifelse(8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),floor(ceil(8*root,fvar(3)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 5,12
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0012,-8.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-14*(51-root,var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),30+12,16-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(14*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(14*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(14*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(14*root,fvar(3)*.8*1.0/8)*1.38
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = 0,0
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
fall.xvelocity = -3.0*ifelse(enemynear,facing=facing,-1,1)
fall.yvelocity = -3.0
persistent=0
numhits = 0

;移動系飛び道具判別用
[state 200]
type = Projectile
trigger1 = 1
projanim = 90000
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = 0,0
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
projremovetime=1

[state 6100]
type = varadd
trigger1 = var(0)
var(0) = 1

[state 6100]
type = varset
trigger1 = Time=1
var(0) = 1

[state 6100]
type = velset
trigger1 = var(0) && ((prevstateno!=[5000,6120])||(Time<var(5)&&(prevstateno=[5000,6120])))
x = 0
y = -.075*cos(time*Pi/30)

[state 6100]
type = StatetypeSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
movetype=H

[state 6100]
type = VarSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
fvar(3) = GetHitVar(xvel)

[state 6100]
type = VarSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
fvar(4) = GetHitVar(yvel)

[state 6100]
type = VarSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
var(5) = 1;GetHitVar(Hitshaketime)

[state 6100]
type = PlaySND
trigger1 = prevstateno=stateno
trigger1 = time=0
value = 7100,ifelse(var(10)=6||var(10)=7,2,ifelse(var(10)=4,1,5))

[state 6100]
type = VarSet
trigger1 = prevstateno=stateno
trigger1 = time=0
fvar(3) = ifelse(var(10)=2||var(10)=5||var(10)=9||var(10)=30,8,ifelse(var(10)=1,5,ifelse(var(10)=3,2,ifelse((var(10)=[6,8]),3,ifelse(var(10)=4,4,6)))))*root,facing

[state 6100]
type = VarSet
trigger1 = prevstateno=stateno
trigger1 = time=0
fvar(4) = ifelse(var(10)=3||var(10)=6,-12,ifelse((var(10)=[7,8])||var(10)=10||var(10)=20,6,ifelse(var(10)=5,-8,-6)))

[state 6100]
type = VarSet
trigger1 = prevstateno=stateno
trigger1 = time=0
var(5) = 1;ifelse(var(10)!=5,12,10)

[state 6100]
type = VelSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=var(5)
x = fvar(3)*facing
y = ifelse(fvar(4)>0&&(prevstateno!=[6100,6120]),-2,fvar(4))

[state 1000]
type = parentvarset
trigger1 = root,fvar(27)>=90000 && root,var(40)=-4 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
var(40) = 11

;爆風
[state 1000]
type = Helper
trigger1 = (MoveContact=1||(Vel Y>0&&Pos Y>=0&&prevstateno=[5000,6120])) && (IsHelper(6100)||IsHelper(6102)||IsHelper(6104))
trigger2 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger3 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3]);爆発
trigger4 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7]);爆発
trigger5 = numhelper(6300)
trigger5 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger6 = numhelper(6305)
trigger6 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
id = 6150+(IsHelper(6102))*2+(IsHelper(6104))*4
stateno = 6150
pos = 0,0
postype = P1
ownpal = 1
ignorehitpause=1
persistent=0

[state 1000]
type = Helper
trigger1 = (MoveContact=1||(Vel Y>0&&Pos Y>=0&&prevstateno=[5000,6120])) && (IsHelper(6101)||IsHelper(6103)||IsHelper(6105))
trigger2 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger3 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3]);爆発
trigger4 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7]);爆発
trigger5 = numhelper(6300)
trigger5 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger6 = numhelper(6305)
trigger6 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
id = 6151+(IsHelper(6103))*2+(IsHelper(6105))*4
stateno = 6150
pos = 0,0
postype = P1
ownpal = 1
ignorehitpause=1
persistent=0

[state 6100]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
stateno=stateno
slot = 0
time = 1

;==本体攻撃ヒット判別（擬似）
[state 6100]
type = varset
trigger1 = !time
var(10) = 0

[state 6100]
type = varset
trigger1 = Time>var(5)&&root,stateno=200 && root,movecontact<=1 && (root,animelemtime(5)=[0,2])
trigger1 = ((pos y-root,pos y)=[floor((-216-30)*const(size.yscale)),floor((-120+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(100*const(size.xscale)),floor((342+20)*const(size.xscale))]
var(10) = 1

[state 6100]
type = varset
triggerall = Time>var(5)&&(root,stateno=210||root,var(34)=210) && root,movecontact<=1 && (root,animelemtime(4)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-254-30)*const(size.yscale)),floor((-130+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(80*const(size.xscale)),floor((182+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-254-30)*const(size.yscale)),floor((-142+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(144*const(size.xscale)),floor((390+20)*const(size.xscale))]
var(10) = 2

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=210 && root,movecontact<=1 && (root,animelemtime(10)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-160-30)*const(size.yscale)),floor((-11+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(70*const(size.xscale)),floor((258+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-124-30)*const(size.yscale)),floor((24+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(216*const(size.xscale)),floor((344+20)*const(size.xscale))]
var(10) = 2

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=220 && root,movecontact<=1 && (root,animelemtime(5)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-328-30)*const(size.yscale)),floor((-122+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((236+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-367-30)*const(size.yscale)),floor((-246+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((181-20)*const(size.xscale)),floor((407+20)*const(size.xscale))]
var(10) = 3

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=220 && root,movecontact<=1 && (root,animelemtime(7)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-70-30)*const(size.yscale)),floor((-34+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((-384+20)*const(size.xscale)),floor((-244-20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-148-30)*const(size.yscale)),floor((-11+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((-306+20)*const(size.xscale)),floor((-142-20)*const(size.xscale))]
var(10) = 3

[state 6100]
type = varset
triggerall = Time>var(5)&&(root,stateno=400||root,var(34)=400) && root,animelemtime(6)=0
trigger1 = ((pos y-root,pos y)=[floor((-59-30)*const(size.yscale)),floor((15+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((40-20)*const(size.xscale)),floor((172+20)*const(size.xscale))]
var(10) = 4

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=410 && (root,animelemtime(12)=[0,2])
trigger1 = ((pos y-root,pos y)=[floor((-174-30)*const(size.yscale)),floor((6+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((56-20)*const(size.xscale)),floor((221+20)*const(size.xscale))]
var(10) = 5

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=420 && (root,animelemtime(9)=[0,3]) && root,anim!=421
trigger1 = ((pos y-root,pos y)=[floor((-139-30)*const(size.yscale)),floor((13+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((45-20)*const(size.xscale)),floor((200+20)*const(size.xscale))]
var(10) = 6

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=600 && root,movecontact<=1 && (root,animelemtime(4)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-272-20)*const(size.yscale)),floor((-92+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((50-20)*const(size.xscale)),floor((203+20)*const(size.xscale))]
var(10) = 7

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=610 && root,movecontact<=1 && (root,animelemtime(6)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-264-20)*const(size.yscale)),floor((-2+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((40-20)*const(size.xscale)),floor((218+20)*const(size.xscale))]
var(10) = 8

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=620 && root,movecontact<=1 && root,animelemtime(7)>=0&&root,animelemtime(9)<=3
trigger1 = ((pos y-root,pos y)=[floor((-260-20)*const(size.yscale)),floor((-81+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((390+20)*const(size.xscale))]
var(10) = 9

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=720 && root,movecontact<=1 && (root,animelemtime(7)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-191-20)*const(size.yscale)),floor((83+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((40-20)*const(size.xscale)),floor((183+20)*const(size.xscale))]
var(10) = 10

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=310 && root,movecontact<=1 && (root,animelemtime(9)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-322-20)*const(size.yscale)),floor((-164+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((234+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-366-20)*const(size.yscale)),floor((-264+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((172-20)*const(size.xscale)),floor((290+20)*const(size.xscale))]
var(10) = 20

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=310 && root,movecontact<=1 && (root,animelemtime(10)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-236-20)*const(size.yscale)),floor((-38+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((274+20)*const(size.xscale))]
var(10) = 20

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=310 && root,movecontact<=1 && (root,animelemtime(11)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-189-20)*const(size.yscale)),floor((42+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((274+20)*const(size.xscale))]
var(10) = 20

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=900 && root,movecontact<=1 && (root,animelemtime(6)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-250-20)*const(size.yscale)),floor((-90+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((20-20)*const(size.xscale)),floor((142+20)*const(size.xscale))]
var(10) = 30

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=900 && root,movecontact<=1 && (root,animelemtime(7)=[0,0])
trigger1 = ((pos y-root,pos y)=[floor((-250-20)*const(size.yscale)),floor((-90+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((20-20)*const(size.xscale)),floor((142+20)*const(size.xscale))]
var(10) = 30

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=910 && root,movecontact<=1 && (root,animelemtime(8)=[0,2])
trigger1 = ((pos y-root,pos y)=[floor((-108-20)*const(size.yscale)),floor((20+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((224-20)*const(size.xscale)),floor((274+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-132-20)*const(size.yscale)),floor((16+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((176-20)*const(size.xscale)),floor((246+20)*const(size.xscale))]
trigger3 = ((pos y-root,pos y)=[floor((-164-20)*const(size.yscale)),floor((12+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((190+20)*const(size.xscale))]
var(10) = 31

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=910 && root,movecontact<=1 && ((root,animelemtime(9)=[0,2])||(root,animelemtime(10)=[0,0]))
trigger1 = ((pos y-root,pos y)=[floor((-200-20)*const(size.yscale)),floor((-10+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((164-20)*const(size.xscale)),floor((234+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-324-20)*const(size.yscale)),floor((-32+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((-100-20)*const(size.xscale)),floor((152+20)*const(size.xscale))]
trigger3 = ((pos y-root,pos y)=[floor((-234-20)*const(size.yscale)),floor((-16+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((124-20)*const(size.xscale)),floor((194+20)*const(size.xscale))]
var(10) = 31

;爆発
[state 6100]
type = varset
trigger1 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3])
trigger2 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7])
trigger3 = numhelper(6300)
trigger3 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger4 = numhelper(6305)
trigger4 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
var(35) = 1
persistent=0

;電磁形態引き込み
[state 6100]
type = ModifyExplod
id = 6120
trigger1 = numhelper(6300)
trigger1 = abs(pos x-helper(6300),pos x)>220*const(size.xscale)
trigger2 = numhelper(6305)
trigger2 = abs(pos x-helper(6305),pos x)>220*const(size.xscale)
pos = 0,0
postype = p1

;電磁形態引き込み
[state 6100]
type = ModifyExplod
id = 6121
trigger1 = numhelper(6300)
trigger1 = abs(pos x-helper(6300),pos x)>220*const(size.xscale)
trigger2 = numhelper(6305)
trigger2 = abs(pos x-helper(6305),pos x)>220*const(size.xscale)
pos = 0,0
postype = p1

;電磁形態引き込み
[state 6100]
type = posadd
trigger1 = numhelper(6300)
trigger1 = abs(pos x-helper(6300),pos x)>220*const(size.xscale)
x = -5*ifelse((pos x-helper(6300),pos x)*ifelse(facing!=helper(6300),facing,-1,1)>0,1,-1)*root,facing

;電磁形態引き込み
[state 6100]
type = posadd
trigger1 = numhelper(6305)
trigger1 = abs(pos x-helper(6305),pos x)>220*const(size.xscale)
x = -5*ifelse((pos x-helper(6305),pos x)*ifelse(facing!=helper(6305),facing,-1,1)>0,1,-1)*root,facing

;壁コンボ中
[state -1]
type = targetstate
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
value = 926+(root,var(1)=4||root,var(1)=6)*3
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1
persistent=0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1&&!hitpausetime
fvar(15) = fvar(15)
ignorehitpause=1
persistent=0

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1&&!hitpausetime
fvar(14) = fvar(14)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=0
var(16) = 10+random%6
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;X座標
[state 240]
type = VarSet
trigger1 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
var(17) = 0

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=0
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;ヒットスパーク
[state 1000]
type = Helper
trigger1 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)]);対忍者
id = 7000
stateno=7100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5
persistent=0

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !((root,stateno=3000&&root,AnimElemTime(11)>=0&&root,AnimElemTime(11)<30)||((root,stateno=[3100,3120])&&root,AnimElemTime(3)>=0&&root,AnimElemTime(3)<30)||(root,stateno=3500&&root,AnimElemTime(4)>=0&&root,AnimElemTime(5)<0))
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && (!numhelper(15902)|| !numhelper(15901))&&IsHelper
trigger1 = time=1
id = 15902-(numhelper(15902))
stateno=15902-(numhelper(15902))
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&(!numhelper(15907)||!numhelper(15906))&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2-(numhelper(15907))
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&(!numhelper(15387)||!numhelper(15386))&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7-(numhelper(15387))
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 6100]
type = changestate
trigger1 = var(10)&&time
value = stateno

[state 6100]
type = VarSet
trigger1 = !time
var(45) = 0

[state 6100]
type = VarAdd
trigger1 = var(45)!=0
var(45) = 1

[state 6100]
type = VarSet
triggerall = !var(45)
trigger1 = MoveContact=1
trigger2 = Vel Y>0&&Pos Y>=0&&prevstateno=[5000,6120]
trigger3 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger4 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3])
trigger5 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7])
trigger6 = numhelper(6300)&&var(35)=1
trigger6 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger7 = numhelper(6305)&&var(35)=1
trigger7 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
var(45) = 1

[state 6100]
type = DestroySelf
trigger1 = var(45)=2


;攻撃形態（ミサイル）
[statedef 6130]
type = A
movetype=A
physics = N
velset = 0,0
ctrl = 0
anim = 6101
sprpriority = 4

;溜め時間判別
[state 6100]
type = varset
trigger1 = !time
var(20) = ifelse(root,var(50)<=-120,2,ifelse(root,var(50)<=-90,1,0))

[state 6100]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6100]
type = AssertSpecial
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
flag = noshadow
flag2 = invisible

[state 6100]
type = StatetypeSet
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
movetype=I

[state 6100]
type = NotHitBy
trigger1 = Vel Y>0 && Pos Y>=-Vel Y
value = SCA

[state 6100]
type = VarSet
trigger1 = !Time
var(7) = root,var(7)

[state 6100]
type = VarSet
trigger1 = !Time
var(8) = root,var(51)%4=0

[state 6100]
type = VelSet
trigger1 = (prevstateno!=[500,6120])&&Time=31
trigger2 = (prevstateno=[5000,6120])&&var(0)=31
x = (floor(ifelse(var(7)=2,root,fvar(26),ifelse(var(7)=1,root,fvar(25),root,fvar(24))))-pos x)*facing/20
y = -(ifelse(var(7)=2,root,fvar(26)-floor(root,fvar(26)),ifelse(var(7)=1,root,fvar(25)-floor(root,fvar(25)),root,fvar(24)-floor(root,fvar(24))))*10000+pos y)*1.0/20
persistent=0

[state 6100]
type = VelSet
triggerall = ifelse(var(7)=2,root,fvar(26)<0,ifelse(var(7)=1,root,fvar(25)<0,root,fvar(24)<0))
trigger1 = (prevstateno!=[500,6120])&&Time=31
trigger2 = (prevstateno=[5000,6120])&&var(0)=31
y = -(-ifelse(var(7)=2,root,fvar(26)-ceil(root,fvar(26)),ifelse(var(7)=1,root,fvar(25)-ceil(root,fvar(25)),root,fvar(24)-ceil(root,fvar(24))))*10000+pos y)*1.0/20
persistent=0

[state 6100]
type = AngleDraw
trigger1 = (prevstateno!=[500,6120])&&Time<31
trigger2 = (prevstateno=[5000,6120])&&var(0)<31
value = -15

[state 6100]
type = AngleDraw
trigger1 = (prevstateno!=[500,6120])&&Time>=31
trigger2 = (prevstateno=[5000,6120])&&var(0)>=31
value = (abs(atan(vel X/vel Y))*180/Pi+180)*ifelse(var(9)||floor(ifelse(var(7)=2,root,fvar(26),ifelse(var(7)=1,root,fvar(25),root,fvar(24))))*facing<0,-1,1);-120

[state 6100]
type = VarSet
trigger1 = floor(ifelse(var(7)=2,root,fvar(26),ifelse(var(7)=1,root,fvar(25),root,fvar(24))))*facing<0&&time=31
var(9) = 1

[state 6100]
type = VelAdd
trigger1 = (prevstateno!=[500,6120])&&Time=[1,20]
trigger2 = (prevstateno=[5000,6120])&&var(0)=[1,20]
y = .3

[state 6100]
type = VelSet
trigger1 = (prevstateno!=[500,6120])&&Time=20
trigger2 = (prevstateno=[5000,6120])&&var(0)=20
y = 0

[state 6100]
type = VelSet
trigger1 = Time=1
x = 1.5+var(7)*1.5+(var(8)*.15-(var(8)=1)*.3)*ifelse(IsHelper(6101)||IsHelper(6103)||IsHelper(6105),1,0)
y = -4.0

;Attack Lv.3
[state 200]
type = Hitdef
trigger1 = Time=0
damage = floor(ifelse(8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),floor(ceil(8*root,fvar(3)*1.0/4)*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 5,12
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0012,-8.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-14*(51-root,var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),30+12,16-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+12)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(14*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(14*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(14*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(14*root,fvar(3)*.8*1.0/8)*1.38
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = 0,0
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
persistent=0
numhits = 0

;移動系飛び道具判別用
[state 200]
type = Projectile
trigger1 = 1
projanim = 90000
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = 0,0
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
projremovetime=1

[state 1000]
type = parentvarset
trigger1 = root,fvar(27)>=90000 && root,var(40)=-4 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
var(40) = 11

[state 6100]
type = varset
trigger1 = Time=0&&(prevstateno=[5000,6120])&&var(0)>=31
var(0) = -1

[state 6100]
type = varadd
trigger1 = var(0)>0
var(0) = 1

[state 6100]
type = varset
trigger1 = Time=1&&(prevstateno!=[5000,6120])
var(0) = 1

[state 6100]
type = velset
trigger1 = var(0) && Time<var(5)&&(prevstateno=[5000,6120])
x = 0
y = 0

[state 6100]
type = StatetypeSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
movetype=H

[state 6100]
type = VarSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
fvar(3) = GetHitVar(xvel)

[state 6100]
type = VarSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
fvar(4) = GetHitVar(yvel)

[state 6100]
type = VarSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=0
var(5) = 1;GetHitVar(Hitshaketime)

[state 6100]
type = PlaySND
trigger1 = prevstateno=stateno
trigger1 = time=0
value = 7100,ifelse(var(10)=6||var(10)=7,2,ifelse(var(10)=4,1,5))

[state 6100]
type = VarSet
trigger1 = prevstateno=stateno
trigger1 = time=0
fvar(3) = ifelse(var(10)=2||var(10)=5||var(10)=9||var(10)=30,8,ifelse(var(10)=1,5,ifelse(var(10)=3,2,ifelse((var(10)=[6,8]),3,ifelse(var(10)=4,4,6)))))*root,facing

[state 6100]
type = VarSet
trigger1 = prevstateno=stateno
trigger1 = time=0
fvar(4) = ifelse(var(10)=3||var(10)=6,-12,ifelse((var(10)=[7,8])||var(10)=10||var(10)=20,6,ifelse(var(10)=5,-8,-6)))

[state 6100]
type = VarSet
trigger1 = prevstateno=stateno
trigger1 = time=0
var(5) = 1;ifelse(var(10)!=5,12,10)

[state 6100]
type = VelSet
trigger1 = prevstateno=[5000,6120]
trigger1 = time=var(5)
x = fvar(3)*facing
y = ifelse(fvar(4)>0&&(prevstateno!=[6100,6120]),-2,fvar(4))

[state 1000]
type = parentvarset
trigger1 = root,fvar(27)>=90000 && root,var(40)=-4 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
var(40) = 11

;爆風
[state 1000]
type = Helper
trigger1 = ((var(0)&&MoveContact=1)||(Vel Y>0&&Pos Y>=0)) && (IsHelper(6100)||IsHelper(6102)||IsHelper(6104))
trigger2 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger3 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3]);爆発
trigger4 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7]);爆発
trigger5 = numhelper(6300)
trigger5 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger6 = numhelper(6305)
trigger6 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
id = 6150+(IsHelper(6102))*2+(IsHelper(6104))*4
stateno = 6150
pos = 0,0
postype = P1
ignorehitpause=1
persistent=0

[state 1000]
type = Helper
trigger1 = ((var(0)&&MoveContact=1)||(Vel Y>0&&Pos Y>=0)) && (IsHelper(6101)||IsHelper(6103)||IsHelper(6105))
trigger2 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger3 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3]);爆発
trigger4 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7]);爆発
trigger5 = numhelper(6300)
trigger5 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger6 = numhelper(6305)
trigger6 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
id = 6151+(IsHelper(6103))*2+(IsHelper(6105))*4
stateno = 6150
pos = 0,0
postype = P1
ignorehitpause=1
persistent=0

[state 6100]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AT,AP
stateno=stateno
slot = 0
time = 1

;==本体攻撃ヒット判別（擬似）
[state 6100]
type = varset
trigger1 = !time
var(10) = 0

[state 6100]
type = varset
trigger1 = Time>var(5)&&root,stateno=200 && root,movecontact<=1 && (root,animelemtime(5)=[0,2])
trigger1 = ((pos y-root,pos y)=[floor((-216-30)*const(size.yscale)),floor((-120+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(100*const(size.xscale)),floor((342+20)*const(size.xscale))]
var(10) = 1

[state 6100]
type = varset
triggerall = Time>var(5)&&(root,stateno=210||root,var(34)=210) && root,movecontact<=1 && (root,animelemtime(4)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-254-30)*const(size.yscale)),floor((-130+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(80*const(size.xscale)),floor((182+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-254-30)*const(size.yscale)),floor((-142+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(144*const(size.xscale)),floor((390+20)*const(size.xscale))]
var(10) = 2

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=210 && root,movecontact<=1 && (root,animelemtime(10)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-160-30)*const(size.yscale)),floor((-11+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(70*const(size.xscale)),floor((258+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-124-30)*const(size.yscale)),floor((24+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor(216*const(size.xscale)),floor((344+20)*const(size.xscale))]
var(10) = 2

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=220 && root,movecontact<=1 && (root,animelemtime(5)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-328-30)*const(size.yscale)),floor((-122+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((236+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-367-30)*const(size.yscale)),floor((-246+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((181-20)*const(size.xscale)),floor((407+20)*const(size.xscale))]
var(10) = 3

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=220 && root,movecontact<=1 && (root,animelemtime(7)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-70-30)*const(size.yscale)),floor((-34+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((-384+20)*const(size.xscale)),floor((-244-20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-148-30)*const(size.yscale)),floor((-11+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((-306+20)*const(size.xscale)),floor((-142-20)*const(size.xscale))]
var(10) = 3

[state 6100]
type = varset
triggerall = Time>var(5)&&(root,stateno=400||root,var(34)=400) && root,animelemtime(6)=0
trigger1 = ((pos y-root,pos y)=[floor((-59-30)*const(size.yscale)),floor((15+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((40-20)*const(size.xscale)),floor((172+20)*const(size.xscale))]
var(10) = 4

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=410 && (root,animelemtime(12)=[0,2])
trigger1 = ((pos y-root,pos y)=[floor((-174-30)*const(size.yscale)),floor((6+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((56-20)*const(size.xscale)),floor((221+20)*const(size.xscale))]
var(10) = 5

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=420 && (root,animelemtime(9)=[0,3]) && root,anim!=421
trigger1 = ((pos y-root,pos y)=[floor((-139-30)*const(size.yscale)),floor((13+30)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((45-20)*const(size.xscale)),floor((200+20)*const(size.xscale))]
var(10) = 6

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=600 && root,movecontact<=1 && (root,animelemtime(4)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-272-20)*const(size.yscale)),floor((-92+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((50-20)*const(size.xscale)),floor((203+20)*const(size.xscale))]
var(10) = 7

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=610 && root,movecontact<=1 && (root,animelemtime(6)=[0,3])
trigger1 = ((pos y-root,pos y)=[floor((-264-20)*const(size.yscale)),floor((-2+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((40-20)*const(size.xscale)),floor((218+20)*const(size.xscale))]
var(10) = 8

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=620 && root,movecontact<=1 && root,animelemtime(7)>=0&&root,animelemtime(9)<=3
trigger1 = ((pos y-root,pos y)=[floor((-260-20)*const(size.yscale)),floor((-81+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((390+20)*const(size.xscale))]
var(10) = 9

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=720 && root,movecontact<=1 && (root,animelemtime(7)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-191-20)*const(size.yscale)),floor((83+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((40-20)*const(size.xscale)),floor((183+20)*const(size.xscale))]
var(10) = 10

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=310 && root,movecontact<=1 && (root,animelemtime(9)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-322-20)*const(size.yscale)),floor((-164+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((234+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-366-20)*const(size.yscale)),floor((-264+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((172-20)*const(size.xscale)),floor((290+20)*const(size.xscale))]
var(10) = 20

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=310 && root,movecontact<=1 && (root,animelemtime(10)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-236-20)*const(size.yscale)),floor((-38+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((274+20)*const(size.xscale))]
var(10) = 20

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=310 && root,movecontact<=1 && (root,animelemtime(11)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-189-20)*const(size.yscale)),floor((42+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((274+20)*const(size.xscale))]
var(10) = 20

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=900 && root,movecontact<=1 && (root,animelemtime(6)=[0,1])
trigger1 = ((pos y-root,pos y)=[floor((-250-20)*const(size.yscale)),floor((-90+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((20-20)*const(size.xscale)),floor((142+20)*const(size.xscale))]
var(10) = 30

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=900 && root,movecontact<=1 && (root,animelemtime(7)=[0,0])
trigger1 = ((pos y-root,pos y)=[floor((-250-20)*const(size.yscale)),floor((-90+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((20-20)*const(size.xscale)),floor((142+20)*const(size.xscale))]
var(10) = 30

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=910 && root,movecontact<=1 && (root,animelemtime(8)=[0,2])
trigger1 = ((pos y-root,pos y)=[floor((-108-20)*const(size.yscale)),floor((20+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((224-20)*const(size.xscale)),floor((274+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-132-20)*const(size.yscale)),floor((16+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((176-20)*const(size.xscale)),floor((246+20)*const(size.xscale))]
trigger3 = ((pos y-root,pos y)=[floor((-164-20)*const(size.yscale)),floor((12+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((80-20)*const(size.xscale)),floor((190+20)*const(size.xscale))]
var(10) = 31

[state 6100]
type = varset
triggerall = Time>var(5)&&root,stateno=910 && root,movecontact<=1 && ((root,animelemtime(9)=[0,2])||(root,animelemtime(10)=[0,0]))
trigger1 = ((pos y-root,pos y)=[floor((-200-20)*const(size.yscale)),floor((-10+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((164-20)*const(size.xscale)),floor((234+20)*const(size.xscale))]
trigger2 = ((pos y-root,pos y)=[floor((-324-20)*const(size.yscale)),floor((-32+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((-100-20)*const(size.xscale)),floor((152+20)*const(size.xscale))]
trigger3 = ((pos y-root,pos y)=[floor((-234-20)*const(size.yscale)),floor((-16+20)*const(size.yscale))])&&(pos x-root,pos x)*facing*ifelse(facing!=root,facing,-1,1)=[floor((124-20)*const(size.xscale)),floor((194+20)*const(size.xscale))]
var(10) = 31

;爆発
[state 6100]
type = varset
trigger1 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3])
trigger2 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7])
trigger3 = numhelper(6300)
trigger3 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger4 = numhelper(6305)
trigger4 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
var(35) = 1
persistent=0

[state 6100]
type = playsnd
trigger1 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3])
trigger2 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7])
trigger3 = numhelper(6300)
trigger3 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger4 = numhelper(6305)
trigger4 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
value = 7100,2
persistent=0

;電磁形態引き込み
[state 6100]
type = posadd
trigger1 = numhelper(6300)
trigger1 = abs(pos x-helper(6300),pos x)>220*const(size.xscale)
x = -5*ifelse((pos x-helper(6300),pos x)*ifelse(facing!=helper(6300),facing,-1,1)>0,1,-1)*root,facing

;電磁形態引き込み
[state 6100]
type = posadd
trigger1 = numhelper(6305)
trigger1 = abs(pos x-helper(6305),pos x)>220*const(size.xscale)
x = -5*ifelse((pos x-helper(6305),pos x)*ifelse(facing!=helper(6305),facing,-1,1)>0,1,-1)*root,facing

;壁コンボ中
[state -1]
type = targetstate
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
value = 926+(root,var(1)=4||root,var(1)=6)*3
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),8*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1
persistent=0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1&&!hitpausetime
fvar(15) = fvar(15)
ignorehitpause=1
persistent=0

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1&&!hitpausetime
fvar(14) = fvar(14)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=0
var(16) = 10+random%6
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;X座標
[state 240]
type = VarSet
trigger1 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
var(17) = 0

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=0
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;ヒットスパーク
[state 1000]
type = Helper
trigger1 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)]);対忍者
id = 7000
stateno=7100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5
persistent=0

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !((root,stateno=3000&&root,AnimElemTime(11)>=0&&root,AnimElemTime(11)<30)||((root,stateno=[3100,3120])&&root,AnimElemTime(3)>=0&&root,AnimElemTime(3)<30)||(root,stateno=3500&&root,AnimElemTime(4)>=0&&root,AnimElemTime(5)<0))
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && (!numhelper(15902)|| !numhelper(15901))&&IsHelper
trigger1 = time=1
id = 15902-(numhelper(15902))
stateno=15902-(numhelper(15902))
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1
[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&(!numhelper(15907)||!numhelper(15906))&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2-(numhelper(15907))
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&(!numhelper(15387)||!numhelper(15386))&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7-(numhelper(15387))
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 6100]
type = changestate
trigger1 = var(10)&&time
value = stateno

[state 6100]
type = VarSet
trigger1 = !time
var(45) = 0

[state 6100]
type = VarAdd
trigger1 = var(45)!=0
var(45) = 1

[state 6100]
type = VarSet
triggerall = !var(45)
trigger1 = Vel Y>0 && Pos Y>=0||MoveContact=1
trigger2 = prevstateno=[5000,5099]
trigger3 = root,fvar(27)>=90000 && root,var(40)=11 && (Pos X=[floor(root,fvar(27)-95000)-floor(ceil(Vel X/2))-10,floor(root,fvar(27)-95000)+abs(ceil(Vel X/2))+10]) && (Pos Y=[-240*const(size.yscale),-80*const(size.yscale)])
trigger4 = root,stateno=420 && root,anim=421 && root,movecontact<=1 && (root,animelemtime(9)=[0,3])
trigger5 = root,stateno=1400 && root,anim=1410 && (root,animelemtime(1)=[0,7])
trigger6 = numhelper(6300)&&var(35)=1
trigger6 = abs(pos x-helper(6300),pos x)<=220*const(size.xscale)
trigger7 = numhelper(6305)&&var(35)=1
trigger7 = abs(pos x-helper(6305),pos x)<=220*const(size.xscale)
var(45) = 1

[state 6100]
type = DestroySelf
trigger1 = var(45)=2

;攻撃形態（爆風）
[statedef 6150]
type = A
movetype=A
physics = N
velset = 0,0
ctrl = 0
anim = 6155
sprpriority = 4

[state 1050]
type = playsnd
trigger1 = !time
value = 20,15
;volume = 128

[state 6150]
type = Explod
trigger1 = Time=0
id = 6150
anim=6150
pos = 0,0
postype = p1
ignorehitpause=1
sprpriority = 4
persistent=0
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6100]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6100]
type = VarSet
trigger1 = !Time
var(7) = root,var(7)

[state 6100]
type = VarSet
trigger1 = !Time
var(8) = root,var(51)%4=0

[state 6100]
type = VelAdd
trigger1 = Time>=1
y = .5

[state 6100]
type = VelSet
trigger1 = Time=1
x = 1.5+var(7)*1.5+(var(8)*.15-(var(8)=1)*.3)*ifelse(IsHelper(6151)||IsHelper(6153)||IsHelper(6155),1,0)
y = -12.0

;Attack Lv.2
[state 200]
type = Hitdef
trigger1 = Time=0 && !parent,var(20)
damage = floor(ifelse(35*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),35*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),floor(ceil(35*root,fvar(3)/4)*1.22)
ground.slidetime = 12+(P2statetype=C)+root,var(49)*6
ground.hittime = 12+(P2statetype=C)+root,var(49)*6
guard.slidetime = 10
guard.hittime = 10
pausetime = 2,11
ground.velocity = -6*const(size.xscale),-11*const(size.yscale)
guard.velocity = -10.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0012,-8.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-14*(51-root,var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),24+11,12-ifelse(floor(root,var(14)/90)>6,6,floor(root,var(14)/90))+11)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(14*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(14*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(14*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(14*root,fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = 0,0
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
persistent=0
palfx.time=ifelse(root,var(49)&&!root,var(2),24+10,12-ifelse(floor(root,var(14)/90)>6,6,floor(root,var(14)/90))+11)
palfx.sinadd = 96,48,0,4
palfx.color = 0
palfx.add = 56,-96,-208
palfx.invertall = 1
fall.xvelocity = -3.0*ifelse(enemynear,facing=facing,-1,1)
fall.yvelocity = -3.0

;Attack Lv.2
[state 200]
type = Hitdef
trigger1 = Time=0 && !parent,var(20) && parent,var(21)!=0
damage = floor(ifelse(30*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),30*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),floor(ceil(30*root,fvar(3)/4)*1.22)
ground.slidetime = 12+(P2statetype=C)+root,var(49)*6
ground.hittime = 12+(P2statetype=C)+root,var(49)*6
guard.slidetime = 10
guard.hittime = 10
pausetime = 2,11
ground.velocity = -6*const(size.xscale),-11*const(size.yscale)
guard.velocity = -10.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0012,-8.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-14*(51-root,var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),24+11,12-ifelse(floor(root,var(14)/90)>6,6,floor(root,var(14)/90))+11)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(14*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(14*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(14*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(14*root,fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = 0,0
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
persistent=0
palfx.time=ifelse(root,var(49)&&!root,var(2),24+11,12-ifelse(floor(root,var(14)/90)>6,6,floor(root,var(14)/90))+11)
palfx.sinadd = 96,48,0,4
palfx.color = 0
palfx.add = 56,-96,-208
palfx.invertall = 1
fall.xvelocity = -3.0*ifelse(enemynear,facing=facing,-1,1)
fall.yvelocity = -3.0

;溜め版
;Attack Lv.2
[state 200]
type = Hitdef
trigger1 = Time=0 && parent,var(20)=1
damage = floor(ifelse(44*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),44*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),floor(ceil(44*root,fvar(3)/4)*1.22)
ground.slidetime = 12+(P2statetype=C)+root,var(49)*6
ground.hittime = 12+(P2statetype=C)+root,var(49)*6
guard.slidetime = 10
guard.hittime = 10
pausetime = 2,11
ground.velocity = -6*const(size.xscale),-11*const(size.yscale)
guard.velocity = -10.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0012,-8.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-14*(51-root,var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),24+11,12-ifelse(floor(root,var(14)/90)>6,6,floor(root,var(14)/90))+11)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(14*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(14*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(14*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(14*root,fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = 0,0
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
persistent=0
palfx.time=ifelse(root,var(49)&&!root,var(2),24+11,12-ifelse(floor(root,var(14)/90)>6,6,floor(root,var(14)/90))+11)
palfx.sinadd = 96,48,0,4
palfx.color = 0
palfx.add = 56,-96,-208
palfx.invertall = 1
fall.xvelocity = -3.0*ifelse(enemynear,facing=facing,-1,1)
fall.yvelocity = -3.0


;溜め版
;Attack Lv.2
[state 200]
type = Hitdef
trigger1 = Time=0 && parent,var(20)=2
damage = floor(ifelse(61*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),61*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22),floor(ceil(61*root,fvar(3)/4)*1.22)
ground.slidetime = 12+(P2statetype=C)+root,var(49)*6
ground.hittime = 12+(P2statetype=C)+root,var(49)*6
guard.slidetime = 10
guard.hittime = 10
pausetime = 2,11
ground.velocity = -6*const(size.xscale),-11*const(size.yscale)
guard.velocity = -10.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0012,-8.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-14*(51-root,var(3))/51-.9)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),24+11,12-ifelse(floor(root,var(14)/90)>6,6,floor(root,var(14)/90))+11)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(14*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(14*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(14*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(14*root,fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = 0,0
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
persistent=0
palfx.time=ifelse(root,var(49)&&!root,var(2),24+11,12-ifelse(floor(root,var(14)/90)>6,6,floor(root,var(14)/90))+11)
palfx.sinadd = 96,48,0,4
palfx.color = 0
palfx.add = 56,-96,-208
palfx.invertall = 1
fall.xvelocity = -3.0*ifelse(enemynear,facing=facing,-1,1)
fall.yvelocity = -3.0

;移動系飛び道具判別用
[state 200]
type = Projectile
trigger1 = 1
projanim = 90000
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = 0,0
animtype = High
ground.type = High
attr = S,SA
hitflag = MAFD
guardflag = MA
projremovetime=1

;壁コンボ中
[state -1]
type = targetstate
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
value = 926+(root,var(1)=4||root,var(1)=6)*3
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1&&!parent,var(20) && !parent,var(21)
fvar(15) = .00005*floor(ifelse(35*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),35*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1
persistent=0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1&&!parent,var(20) && parent,var(21)!=0
fvar(15) = .00005*floor(ifelse(30*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),30*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1
persistent=0


;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1&&parent,var(20)=1
fvar(15) = .00005*floor(ifelse(44*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),44*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1
persistent=0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1&&parent,var(20)=2
fvar(15) = .00005*floor(ifelse(61*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)<1,1+(root,var(2)%5=4),61*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4))*1.22)
ignorehitpause=1
persistent=0

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=0
var(16) = 10+random%6
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=0
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

;カウンターヒットエフェクト
[state -2]
type = Explod
triggerall = root,var(49)&&movehit=1
triggerall = !((root,stateno=3000&&root,AnimElemTime(11)>=0&&root,AnimElemTime(11)<30)||((root,stateno=[3100,3120])&&root,AnimElemTime(3)>=0&&root,AnimElemTime(3)<30)||(root,stateno=3500&&root,AnimElemTime(4)>=0&&root,AnimElemTime(5)<0))
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = ((!numtarget && P2movetype=A)||(numtarget && P2movetype=H))&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1;対アーマー，気絶時
id = 7760
anim = 7760
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
bindtime=-1
ontop = 1
ownpal = 1
scale = .5,.5

[state -2]
type = targetstate
trigger1 = root,var(28)>0 && numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5030||target,stateno=5050||target,stateno=5070) && target,hitfall
value = 15310
ignorehitpause=1

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && (!numhelper(15902)|| !numhelper(15901))&&IsHelper
trigger1 = time=1
id = 15902-(numhelper(15902))
stateno=15902-(numhelper(15902))
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1
persistent=0

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1
persistent=0

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1
persistent=0

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1
persistent=0

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1
persistent=0

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1
persistent=0

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&(!numhelper(15907)||!numhelper(15906))&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+2-(numhelper(15907))
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&(!numhelper(15387)||!numhelper(15386))&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+7-(numhelper(15387))
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = statetypeset
trigger1 = movecontact
movetype=I
ignorehitpause=1

[state 6100]
type = DestroySelf
triggerall = time>0
triggerall = movecontact!=1
trigger1 = Vel Y>0 && Pos Y>=0||MoveHit||Time=1
trigger2=ifelse(IsHelper(6155),!Root,NumHelper(6105),ifelse(IsHelper(6154),!Root,NumHelper(6104),ifelse(IsHelper(6153),!Root,NumHelper(6103),ifelse(IsHelper(6152),!Root,NumHelper(6102),ifelse(IsHelper(6151),!Root,NumHelper(6101),!Root,NumHelper(6100))))))

;ロックオン後(弱)
[statedef 6170]
type = A
physics = N
ctrl = 0
velset = 0,0
anim = 6170
sprpriority = 3

[state 29000]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6170]
type = AngleDraw
trigger1 = time
value = time%36*10
scale = 1,1

[state 6170]
type = trans
trigger1 = 1
trans = add

[state 6170]
type = parentvarset
trigger1 = 1
fvar(24) = floor(pos X)+ifelse(pos Y>=0,0,-pos Y*.0001*ifelse(pos X<0,-1,1))

[state -2]
type = varadd
trigger1 = var(36)>101000
var(36) = -1000

;925F間
[state -2]
type = playsnd
trigger1 = !time
value = 20,23

;925F間
[state -2]
type = varset
trigger1 = !time
var(36) = enemynear(numenemy-1),ID+925000

;925F間
[state -2]
type = varset
trigger1 = !time
trigger1 = ((enemynear,pos x-pos x)*facing=[120*const(size.xscale),240*const(size.xscale)])&&!enemynear,ishelper&&enemynear,alive&&enemynear,statetype!=L
trigger1 = ((enemynear,const(size.head.pos.y)*ifelse(enemynear(numenemy-1),statetype=C,2.0/3,1)+enemynear,pos y-10)=[-300*const(size.yscale),-180*const(size.yscale)])
var(36) = enemynear,ID+925000

;925F間
[state -2]
type = varset
trigger1 = !time
trigger1 = root,fvar(27)>=90000
trigger1 = (((root,fvar(27)-95000)-pos x)*facing=[120*const(size.xscale),240*const(size.xscale)])
var(36) = 999+925000

[state 6170]
type = PosSet
trigger1 = enemynear,ID=var(36)%1000
x = floor(enemynear,pos x)
y = floor((enemynear,const(size.mid.pos.y)+enemynear,const(size.head.pos.y))/2)+floor(enemynear,pos y)

[state 6170]
type = PosSet
trigger1 = enemynear(numenemy-1),ID=var(36)%1000&&enemynear,ID!=enemynear(numenemy-1),ID
x = floor(enemynear(numenemy-1),pos x)
y = floor((enemynear(numenemy-1),const(size.mid.pos.y)+enemynear(numenemy-1),const(size.head.pos.y))/2)+floor(enemynear(numenemy-1),pos y)

[state 6170]
type = PosSet
trigger1 = var(36)%1000=999
x = floor(root,fvar(27)-95000)
y = -80

[state 6170]
type = AssertSpecial
trigger1 = var(36)=[100000,100999]
flag = invisible

[state 6170]
type = DestroySelf
trigger1 = !root,var(10)&&var(36)=[100000,100999]
trigger2 = ((enemynear,ID=var(36)%1000&&!enemynear,alive)||(enemynear(numenemy-1),ID=var(36)%1000&&!enemynear(numenemy-1),alive))&&var(36)%100!=50
trigger3 = root,var(40)<=-1000
trigger4 = var(36)%1000=999&&root,fvar(27)<90000
trigger5 = roundstate!=2

[state -2]
type = DisplayToClipBoard
trigger1 = 1
text = "Pos = %f GP Time=%d Ninja_Pos=%f"
params = Pos X, var(36), root,fvar(27)-95000
ignorehitpause=1

;ロックオン後(中)
[statedef 6171]
type = A
physics = N
ctrl = 0
velset = 0,0
anim = 6170
sprpriority = 3

[state 29000]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6170]
type = AngleDraw
trigger1 = time
value = time%36*10
scale = 1,1

[state 6170]
type = trans
trigger1 = 1
trans = add

[state 6170]
type = parentvarset
trigger1 = 1
fvar(25) = floor(pos X)+ifelse(pos Y>=0,0,-pos Y*.0001*ifelse(pos X<0,-1,1))

[state -2]
type = varadd
trigger1 = var(36)>101000
var(36) = -1000

;925F間
[state -2]
type = playsnd
trigger1 = !time
value = 20,23

;925F間
[state -2]
type = varset
trigger1 = !time
var(36) = enemynear(numenemy-1),ID+925000

;925F間
[state -2]
type = varset
trigger1 = !time
trigger1 = ((enemynear,pos x-pos x)*facing=[-60*const(size.xscale),60*const(size.xscale)])&&!enemynear,ishelper&&enemynear,alive&&enemynear,statetype!=L
trigger1 = ((enemynear,const(size.head.pos.y)*ifelse(enemynear(numenemy-1),statetype=C,2.0/3,1)+enemynear,pos y-10)=[-460*const(size.yscale),-320*const(size.yscale)])
var(36) = enemynear,ID+925000

;925F間
[state -2]
type = varset
trigger1 = !time
trigger1 = root,fvar(27)>=90000
trigger1 = (((root,fvar(27)-95000)-pos x)*facing=[-60*const(size.xscale),60*const(size.xscale)])
var(36) = 999+925000

[state 6170]
type = PosSet
trigger1 = enemynear,ID=var(36)%1000
x = floor(enemynear,pos x)
y = floor((enemynear,const(size.mid.pos.y)+enemynear,const(size.head.pos.y))/2)+floor(enemynear,pos y)

[state 6170]
type = PosSet
trigger1 = enemynear(numenemy-1),ID=var(36)%1000&&enemynear,ID!=enemynear(numenemy-1),ID
x = floor(enemynear(numenemy-1),pos x)
y = floor((enemynear(numenemy-1),const(size.mid.pos.y)+enemynear(numenemy-1),const(size.head.pos.y))/2)+floor(enemynear(numenemy-1),pos y)

[state 6170]
type = PosSet
trigger1 = var(36)%1000=999
x = floor(root,fvar(27)-95000)
y = -80

[state 6170]
type = AssertSpecial
trigger1 = var(36)=[100000,100999]
flag = invisible

[state 6170]
type = DestroySelf
trigger1 = !root,var(10)&&var(36)=[100000,100999]
trigger2 = ((enemynear,ID=var(36)%1000&&!enemynear,alive)||(enemynear(numenemy-1),ID=var(36)%1000&&!enemynear(numenemy-1),alive))&&var(36)%100!=50
trigger3 = root,var(40)<=-1000
trigger4 = var(36)%1000=999&&root,fvar(27)<90000
trigger5 = roundstate!=2

[state -2]
type = DisplayToClipBoard
trigger1 = 1
text = "Pos = %f GP Time=%d Ninja_Pos=%f"
params = Pos X, var(36), root,fvar(27)-95000
ignorehitpause=1

;ロックオン後(強)
[statedef 6172]
type = A
physics = N
ctrl = 0
velset = 0,0
anim = 6170
sprpriority = 3

[state 29000]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6170]
type = AngleDraw
trigger1 = time
value = time%36*10
scale = 1,1

[state 6170]
type = trans
trigger1 = 1
trans = add

[state 6170]
type = parentvarset
trigger1 = 1
fvar(26) = floor(pos X)+ifelse(pos Y>=0,0,-pos Y*.0001*ifelse(pos X<0,-1,1))

[state -2]
type = varadd
trigger1 = var(36)>101000
var(36) = -1000

;925F間
[state -2]
type = playsnd
trigger1 = !time
value = 20,23

;925F間
[state -2]
type = varset
trigger1 = !time
var(36) = enemynear(numenemy-1),ID+925000

;925F間
[state -2]
type = varset
trigger1 = !time
trigger1 = ((enemynear,pos x-pos x)*facing=[-240*const(size.xscale),-120*const(size.xscale)])&&!enemynear,ishelper&&enemynear,alive&&enemynear,statetype!=L
trigger1 = ((enemynear,const(size.head.pos.y)*ifelse(enemynear(numenemy-1),statetype=C,2.0/3,1)+enemynear,pos y-10)=[-300*const(size.yscale),-180*const(size.yscale)])
var(36) = enemynear,ID+925000

;925F間
[state -2]
type = varset
trigger1 = !time
trigger1 = root,fvar(27)>=90000
trigger1 = (((root,fvar(27)-95000)-pos x)*facing=[-240*const(size.xscale),-120*const(size.xscale)])
var(36) = 999+925000

[state 6170]
type = PosSet
trigger1 = enemynear,ID=var(36)%1000
x = floor(enemynear,pos x)
y = floor((enemynear,const(size.mid.pos.y)+enemynear,const(size.head.pos.y))/2)+floor(enemynear,pos y)

[state 6170]
type = PosSet
trigger1 = enemynear(numenemy-1),ID=var(36)%1000&&enemynear,ID!=enemynear(numenemy-1),ID
x = floor(enemynear(numenemy-1),pos x)
y = floor((enemynear(numenemy-1),const(size.mid.pos.y)+enemynear(numenemy-1),const(size.head.pos.y))/2)+floor(enemynear(numenemy-1),pos y)

[state 6170]
type = PosSet
trigger1 = var(36)%1000=999
x = floor(root,fvar(27)-95000)
y = -80

[state 6170]
type = AssertSpecial
trigger1 = var(36)=[100000,100999]
flag = invisible

[state 6170]
type = DestroySelf
trigger1 = !root,var(10)&&var(36)=[100000,100999]
trigger2 = ((enemynear,ID=var(36)%1000&&!enemynear,alive)||(enemynear(numenemy-1),ID=var(36)%1000&&!enemynear(numenemy-1),alive))&&var(36)%100!=50
trigger3 = root,var(40)<=-1000
trigger4 = var(36)%1000=999&&root,fvar(27)<90000
trigger5 = roundstate!=2

[state -2]
type = DisplayToClipBoard
trigger1 = 1
text = "Pos = %f GP Time=%d Ninja_Pos=%f"
params = Pos X, var(36), root,fvar(27)-95000
ignorehitpause=1

;攻撃形態・通常弾（空中）
[statedef 1100]
type = A
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0,0),Vel Y

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time && !var(34)
var(53) = 0

[state 1000]
type = VarAdd
trigger1 = !time && !var(34)
var(37) = -1

[state 1050]
type = VarSet
trigger1 = Time=0
var(10) = 2

[state 1050]
type = PosSet
trigger1 = !Time&&(prevstateno=[600,620]) && Pos Y>=-1 && var(52)>0
y = 0

[state 1050]
type = ChangeState
trigger1 = !Time&&(prevstateno=[600,620]) && Pos Y>=-1 && var(52)>0
value = 52

[state 1050]
type = VelSet
trigger1 = !time
y = 0

[state 200]
type = VarSet
trigger1 = Time=0
fvar(8) = 0

[state 1000]
type = VarSet
trigger1 = Time=0 && !var(34) && !var(59)
var(7) = ifelse(command="z",2,ifelse(command="y",1,0))

[state 1000]
type = VarSet
trigger1 = Time=0 && !var(34) && var(59)
var(7) = ifelse((P2bodydist X>180&&random%5<2)||(P2bodydist X>140&&(enemynear,hitfall||P2statetype=L)),2,ifelse(P2bodydist X>110&&random%2=0,1,0))

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1100

[state 210]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=3&&!IsHelper
value = anim
elem = 4

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 1000]
type = VarAdd
trigger1 = !time
var(37) = -1

[state 1000]
type = VarAdd
trigger1 = animelemtime(4)=15&&(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105))
trigger1 = var(53)!=1090
var(37) = -480/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 200]
type = VarAdd
trigger1 = Time=0&&var(10)%8>=4
var(10) = -4

[state 1050]
type = VarAdd
trigger1 = Time=0 && var(10)%4<2
var(10) = 2

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;援護形態へ移行
[state 1500]
type = ChangeState
triggerall = !Time&&(var(40)=1||(var(40)=[5,6]))&&!var(12)&&(prevstateno!=[5000,5099])
trigger1 = command="a"&&command!="holddown"&&!var(59)
value = 1650

[state 1050]
type = playsnd
trigger1 = var(10)<=0 && animelemtime(4)=4
value = 20,6
channel = 10
;volume = 128

[state 1050]
type = playsnd
trigger1 = animelemtime(4)=15&&(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105))
value = 20,15
channel = 10
;volume = 128

[state 6150]
type = Explod
trigger1 = animelemtime(4)=15
id = 6150
anim=ifelse(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105),6111,6150)
pos = floor(-30*const(size.xscale)),floor(-380*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6150]
type = Explod
trigger1 = animelemtime(4)=15
id = 6150
anim=ifelse(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105),6111,6150)
pos = floor(14*const(size.xscale)),floor(-380*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 1000]
type = Helper
trigger1 = animelemtime(4)=15 && (!NumHelper(6100)||!NumHelper(6102)||!NumHelper(6104))
id = 6100+(NumHelper(6100))*2+(NumHelper(6102))*2
stateno = 6100+ifelse(var(7)=2,NumHelper(6172)!=0,ifelse(var(7)=1,NumHelper(6171)!=0,NumHelper(6170)!=0))*30
pos = floor(-30*const(size.xscale)),floor(-380*const(size.yscale))
postype = P1
ownpal = 1
persistent=0

[state 1000]
type = Helper
trigger1 = animelemtime(4)=15 && (!NumHelper(6101)||!NumHelper(6103)||!NumHelper(6105))
id = 6101+(NumHelper(6101))*2+(NumHelper(6103))*2
stateno = 6100+ifelse(var(7)=2,NumHelper(6172)!=0,ifelse(var(7)=1,NumHelper(6171)!=0,NumHelper(6170)!=0))*30
pos = floor(14*const(size.xscale)),floor(-380*const(size.yscale))
postype = P1
ownpal = 1
persistent=0

[state 1050]
type = ChangeState
trigger1 = AnimTime=0
value = 1150

;攻撃形態・時限弾（空中）
[statedef 1110]
type = A
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0,0),Vel Y

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time && !var(34)
var(53) = 0

[state 1000]
type = VarAdd
trigger1 = !time && !var(34)
var(37) = -1

[state 1050]
type = VarSet
trigger1 = Time=0
var(10) = 2

[state 1050]
type = PosSet
trigger1 = !Time&&(prevstateno=[600,620]) && Pos Y>=-1 && var(52)>0
y = 0

[state 1050]
type = ChangeState
trigger1 = !Time&&(prevstateno=[600,620]) && Pos Y>=-1 && var(52)>0
value = 52

[state 1050]
type = VelSet
trigger1 = !time
y = 0

[state 200]
type = VarSet
trigger1 = Time=0
fvar(8) = 0

[state 1000]
type = VarSet
trigger1 = Time=0 && !var(34) && !var(59)
var(7) = ifelse(command="z",2,ifelse(command="y",1,0))

[state 1000]
type = VarSet
trigger1 = Time=0 && !var(34) && var(59)
var(7) = ifelse((P2bodydist X>180&&random%5<2)||(P2bodydist X>120&&(enemynear,hitfall||P2statetype=L)),2,ifelse(P2bodydist X>120&&random%2=0,1,0))

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1100

[state 210]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=3&&!IsHelper
value = anim
elem = 4

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 1000]
type = VarAdd
trigger1 = !time
var(37) = -1

[state 1000]
type = VarAdd
trigger1 = animelemtime(4)=15&&(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105))
trigger1 = var(53)!=1090
var(37) = -480/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 200]
type = VarAdd
trigger1 = Time=0&&var(10)%8>=4
var(10) = -4

[state 1050]
type = VarAdd
trigger1 = Time=0 && var(10)%4<2
var(10) = 2

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;援護形態へ移行
[state 1500]
type = ChangeState
triggerall = !Time&&(var(40)=1||(var(40)=[5,6]))&&!var(12)&&(prevstateno!=[5000,5099])
trigger1 = command="a"&&command!="holddown"&&!var(59)
value = 1650

[state 1050]
type = playsnd
trigger1 = var(10)<=0 && animelemtime(4)=4
value = 20,6
channel = 10
;volume = 128

[state 1050]
type = playsnd
trigger1 = animelemtime(4)=15&&(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105))
value = 20,15
channel = 10
;volume = 128

[state 6150]
type = Explod
trigger1 = animelemtime(4)=15
id = 6150
anim=ifelse(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105),6111,6150)
pos = floor(-30*const(size.xscale)),floor(-380*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6150]
type = Explod
trigger1 = animelemtime(4)=15
id = 6150
anim=ifelse(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105),6111,6150)
pos = floor(14*const(size.xscale)),floor(-380*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 1000]
type = Helper
trigger1 = animelemtime(4)=15 && (!NumHelper(6100)||!NumHelper(6102)||!NumHelper(6104))
id = 6100+(NumHelper(6100))*2+(NumHelper(6102))*2
stateno = 6110
pos = floor(-30*const(size.xscale)),floor(-380*const(size.yscale))
postype = P1
ownpal = 1
persistent=0

[state 1000]
type = Helper
trigger1 = animelemtime(4)=15 && (!NumHelper(6101)||!NumHelper(6103)||!NumHelper(6105))
id = 6101+(NumHelper(6101))*2+(NumHelper(6103))*2
stateno = 6110
pos = floor(14*const(size.xscale)),floor(-380*const(size.yscale))
postype = P1
ownpal = 1
persistent=0

[state 1050]
type = ChangeState
trigger1 = (prevstateno=[600,620]) && !Pos Y && movecontact=1
value = 52

[state 1050]
type = ChangeState
trigger1 = AnimTime=0
value = 1150

;攻撃形態・浮遊機雷（空中）
[statedef 1120]
type = A
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*0,0),Vel Y

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time && !var(34)
var(53) = 0

[state 1000]
type = VarAdd
trigger1 = !time && !var(34)
var(37) = -1

[state 1050]
type = VarSet
trigger1 = Time=0
var(10) = 2

[state 1050]
type = PosSet
trigger1 = !Time&&(prevstateno=[600,620]) && Pos Y>=-1 && var(52)>0
y = 0

[state 1050]
type = ChangeState
trigger1 = !Time&&(prevstateno=[600,620]) && Pos Y>=-1 && var(52)>0
value = 52

[state 1050]
type = VelSet
trigger1 = !time
y = 0

[state 200]
type = VarSet
trigger1 = Time=0
fvar(8) = 0

[state 1000]
type = VarSet
trigger1 = Time=0 && !var(34) && !var(59)
var(7) = ifelse(command="z",2,ifelse(command="y",1,0))

[state 1000]
type = VarSet
trigger1 = Time=0 && !var(34) && var(59)
var(7) = ifelse(random%4<1,2,ifelse(random%8<1,1,0))

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1100

[state 210]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=3&&!IsHelper
value = anim
elem = 4

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 1000]
type = VarAdd
trigger1 = !time
var(37) = -1

[state 1000]
type = VarAdd
trigger1 = animelemtime(4)=15&&(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105))
trigger1 = var(53)!=1090
var(37) = -480/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 200]
type = VarAdd
trigger1 = Time=0&&var(10)%8>=4
var(10) = -4

[state 1050]
type = VarAdd
trigger1 = Time=0 && var(10)%4<2
var(10) = 2

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;援護形態へ移行
[state 1500]
type = ChangeState
triggerall = !Time&&(var(40)=1||(var(40)=[5,6]))&&!var(12)&&(prevstateno!=[5000,5099])
trigger1 = command="a"&&command!="holddown"&&!var(59)
value = 1650

[state 1050]
type = playsnd
trigger1 = var(10)<=0 && animelemtime(4)=4
value = 20,6
channel = 10
;volume = 128

[state 1050]
type = playsnd
trigger1 = animelemtime(4)=15&&(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105))
value = 20,15
channel = 10
;volume = 128

[state 6150]
type = Explod
trigger1 = animelemtime(4)=15
id = 6150
anim=ifelse(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105),6111,6150)
pos = floor(-30*const(size.xscale)),floor(-380*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6150]
type = Explod
trigger1 = animelemtime(4)=15
id = 6150
anim=ifelse(!numhelper(6100)||!numhelper(6101)||!numhelper(6102)||!numhelper(6103)||!numhelper(6104)||!numhelper(6105),6111,6150)
pos = floor(14*const(size.xscale)),floor(-380*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 1000]
type = Helper
trigger1 = animelemtime(4)=15 && (!NumHelper(6100)||!NumHelper(6102)||!NumHelper(6104))
trigger2 = animelemtime(4)=15 && (!NumHelper(6101)||!NumHelper(6103)||!NumHelper(6105))
id = 6100+(NumHelper(6101))+(NumHelper(6100))*2+(NumHelper(6102))*2
stateno = 6120
pos = floor(ifelse(var(7)=2,-180,ifelse(var(7)=1,0,180))*const(size.xscale)),floor(ifelse(var(7)=1,-400,-240)*const(size.yscale))
postype = P1
ownpal = 1
persistent=0

[state 1050]
type = ChangeState
trigger1 = AnimTime=0
value = 1150

;攻撃形態（空中）
[statedef 1150]
type = A
movetype=I
physics = N
ctrl = 1
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
anim = 1150

[state 1050]
type = VarSet
trigger1 = Time=0
var(10) = 2

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 200]
type = VarSet
trigger1 = Time=0
fvar(8) = 0

[state 1320]
type = VarSet
trigger1 = Time=0
fvar(9) = 0
persistent=0

[state 1150]
type = Turn
trigger1 = Time&&P2dist X<0

;終了
[state 200]
type = ChangeState
trigger1 = command="Hikou-End"&&!var(59)
trigger2 = roundstate>=3||var(37)<=0
trigger3 = time>=24&&var(59)
value = 1190

;前進
[state 200]
type = ChangeState
trigger1 = command="holdfwd"&&!var(59)
value = 1181
ctrl = 1

;後退
[state 200]
type = ChangeState
trigger1 = command="holdback"&&!var(59)
value = 1182
ctrl = 1

;前進（攻撃形態）
[statedef 1181]
type = A
movetype=I
physics = N
ctrl = 1
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
anim = 1120

[state 1320]
type = VelSet
trigger1 = AnimElem=1,=2
x = 4.0

[state 200]
type = ChangeState
triggerall = AnimElemTime(3)>=0
trigger1 = command="Hikou-End"&&!var(59)
trigger2 = roundstate>=3||var(37)<=0
value = 1190

[state 1320]
type = ChangeState
triggerall = AnimElemTime(3)>=0
trigger1 = P2dist X<0
trigger2 = command!="holdfwd"&&!var(59)
value = 1150
ctrl = 1

;後退（攻撃形態）
[statedef 1182]
type = A
movetype=I
physics = N
ctrl = 1
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
anim = 1121

[state 1320]
type = VelSet
trigger1 = AnimElem=1,=2
x = -4.0

[state 200]
type = ChangeState
triggerall = AnimElemTime(3)>=0
trigger1 = command="Hikou-End"&&!var(59)
trigger2 = roundstate>=3||var(37)<=0
value = 1190

[state 1320]
type = ChangeState
triggerall = AnimElemTime(3)>=0
trigger1 = P2dist X<0
trigger2 = command!="holdback"&&!var(59)
value = 1150
ctrl = 1

;終了（攻撃形態）
[statedef 1190]
type = A
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
anim = 1190

[state 200]
type = VarSet
trigger1 = Time=0
fvar(8) = 0

[state 200]
type = VarSet
trigger1 = Time=0
var(10) = 0

[state -2]
type = Explod
trigger1 = !time&&var(36)%2<1&&(var(40)=-2||var(40)>0)
id = 6170
anim = 6175
pos = floor(180*const(size.xscale)),floor(-240*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state -2]
type = Explod
trigger1 = !time&&var(36)%4<2&&(var(40)=-2||var(40)>0) && floor(var(43)/1000)>=100
id = 6171
anim = 6175
pos = floor(0*const(size.xscale)),floor(-400*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state -2]
type = Explod
trigger1 = !time&&var(36)%8<4&&(var(40)=-2||var(40)>0) && floor(var(43)/1000)>=50
id = 6172
anim = 6175
pos = floor(-180*const(size.xscale)),floor(-240*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state 1320]
type = VelSet
trigger1 = AnimTime=-1
y = 2.0

[state 1320]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1

;飛行形態
[statedef 1300]
type = A
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(8)>const(velocity.runjump.fwd.x)||fvar(8)<const(velocity.runjump.back.x)||(prevstateno=[20,22]),0,fvar(8)),Vel Y

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))&&statetype!=A
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))&&statetype!=A

;先行入力リセット
[state 200]
type = VarSet
trigger1 = !Time&&var(53)!=1390
var(53) = 0

;援護形態へ移行
[state 1500]
type = ChangeState
triggerall = !Time&&(var(40)=1||(var(40)=[5,6]))&&!var(12)&&(prevstateno!=[5000,5099])
trigger1 = command="a"&&command!="holddown"&&!var(59)
value = 1650

[state 1000]
type = VarAdd
trigger1 = 1
var(37) = -4/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 1320]
type = PosFreeze
trigger1 = (P2bodydist X=[-15,0])&&(P2bodydist Y=[-50,50])&&Vel X>0
value = 1

[state 200]
type = PosAdd
trigger1 = AnimElemTime(4)<0&&Vel Y
y = Vel Y

[state 200]
type = PosSet
trigger1 = Pos Y>=0
y = -1

[state 1320]
type = VarSet
trigger1 = !time&&(fvar(8)>const(velocity.runjump.fwd.x)||fvar(8)<const(velocity.runjump.back.x)||(prevstateno=[20,22]))
fvar(8) = 0

[state 1320]
type = VarSet
trigger1 = !time&&(var(10)%8<4||(fvar(10)=98&&(prevstateno!=[1320,1321])))
fvar(9) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1300

[state 200]
type = ChangeAnim
trigger1 = Time=0&&((prevstateno=[600,620])||(prevstateno=[1320,1344])||(prevstateno=[1650,1660]))&&var(10)%8>=4
value = 1300
elem = 4

[state 200]
type = ChangeAnim
trigger1 = Time=1&&AnimElemNo(0)=3
value = 1300
elem = 4

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper&&!(((prevstateno=[600,620])||(prevstateno=[1320,1344])||(prevstateno=[1650,1660]))&&var(10)%8>=4)
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

[state 1050]
type = VarSet
trigger1 = Time=0
var(10) = 4

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=7

;攻撃状態維持用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = (!root,var(34)||root,animelemtime(4)>=0||(root,stateno!=1300&&root,anim!=1300))

[state 200]
type = PlaySND
trigger1 = AnimElem=4&&!IsHelper
value = 20,3
;channel = 10
;volume = 128

[state 190]
type = Helper
trigger1 = AnimElem=4&&!numhelper(6000)&&!IsHelper
id = 6000
stateno = 6000
pos = floor(-90*const(size.xscale)),floor(-250*const(size.yscale))
postype = p1
sprpriority = -1
scale = const(size.xscale),const(size.yscale)

;振り向き動作~~

[state 200]
type = VarSet
trigger1 = Time=0&&((prevstateno=[600,620])||(prevstateno=[1320,1344])||(prevstateno=[1650,1660]))&&P2dist X<0
trigger2 = Time&&P2dist X<0
fvar(8) = -fvar(8)

[state 200]
type = VarSet
trigger1 = Time=0&&((prevstateno=[600,620])||(prevstateno=[1320,1344])||(prevstateno=[1650,1660]))&&P2dist X<0
trigger2 = Time&&P2dist X<0
fvar(9) = -fvar(9)

[state 200]
type = VelSet
trigger1 = Time=0&&((prevstateno=[600,620])||(prevstateno=[1320,1344])||(prevstateno=[1650,1660]))&&P2dist X<0
trigger2 = Time&&P2dist X<0
x = fvar(8)+fvar(9)

[state 200]
type = Turn
trigger1 = Time=0&&((prevstateno=[600,620])||(prevstateno=[1320,1344])||(prevstateno=[1650,1660]))&&P2dist X<0
trigger2 = Time&&P2dist X<0
;~~~

[state 1320]
type = VarAdd
trigger1 = AnimElem=4,>=0&&(fvar(10)=[51,98])
fvar(10) = -1

[state 1320]
type = VarSet
trigger1 = AnimElem=4,>=0&&fvar(10)>=50
fvar(9) = fvar(9)*.9

[state 1320]
type = VarSet
trigger1 = AnimElem=4,>=0&&(fvar(8)=(0,.5])
fvar(8) = ifelse(fvar(8)<=.1,.1,fvar(8)*.9)

[state 1320]
type = VarSet
trigger1 = AnimElem=4,>=0&&(fvar(9)=(0,.5))&&(fvar(8)=[-.5,0])
fvar(8) = 0

[state 1320]
type = VarSet
trigger1 = AnimElem=4,>=0&&(fvar(8)=[-.5,0))
fvar(8) = ifelse(fvar(8)>=-.1,-.1,fvar(8)*.9)

[state 1320]
type = VarSet
trigger1 = AnimElem=4,>=0&&(fvar(9)=(-.5,0))&&(fvar(8)=[0,.5])
fvar(8) = 0

[state 1300]
type = VelSet
trigger1 = !fvar(5) && !fvar(7) && !fvar(9)
x = fvar(8)

[state 200]
type = ChangeAnim
trigger1 = Time=0&&((prevstateno=[600,620])||(prevstateno=[1320,1344])||(prevstateno=[1650,1660]))&&P2dist X<0
trigger2 = Time&&P2dist X<0
value = 1300
elem = 3


[state 200]
type = VelSet
trigger1 = AnimElemTime(4)>=0
y = 0

[state 200]
type = ChangeState
triggerall = AnimElemTime(4)>=0&&!IsHelper
trigger1 = command="Hikou-End"&&!var(59)
trigger2 = roundstate>=3||var(37)<=0||var(40)<=-1000
value = 1350

;前進
[state 200]
type = ChangeState
triggerall = AnimElemTime(4)>=0&&!IsHelper
trigger1 = command="holdfwd"&&!var(59)
trigger2 = var(59)&&var(12)<=400
trigger2 = !(prevstateno=1320&&pos Y<0)&&prevstateno!=1321
value = 1320

;後退
[state 200]
type = ChangeState
triggerall = AnimElemTime(4)>=0&&!IsHelper
trigger1 = command="holdback"&&!var(59)
trigger2 = prevstateno=1320&&pos Y<-1&&var(59)
value = 1321

;上昇
[state 200]
type = ChangeState
triggerall = AnimElemTime(4)>=0&&!IsHelper
trigger1 = command="holdup"&&!var(59)
value = 1341

;下降
[state 200]
type = ChangeState
triggerall = AnimElemTime(4)>=0&&!IsHelper
trigger1 = command="holddown"&&!var(59)
trigger2 = prevstateno=1321&&var(59)
value = 1344

;前進（飛行形態）
[statedef 1320]
type = A
movetype=I
physics = N
velset = ifelse(fvar(9),fvar(9)*0,0)+fvar(8),0
anim = 1320

[state 1000]
type = VarAdd
trigger1 = 1
var(37) = -4/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 200]
type = PlaySND
trigger1 = Time=0
value = 20,3
;channel = 10
;volume = 128

[state 1320]
type = PosFreeze
trigger1 = (P2bodydist X=[-15,0])&&(P2bodydist Y=[-50,50])&&vel x>0
value = 1

[state 1320]
type = PosAdd
trigger1 = (P2bodydist X=[-15,0])&&(P2bodydist Y=[-50,50])
y = floor(vel Y)

[state 1320]
type = VarSet
trigger1 = AnimElem=1,=1
fvar(5) = 0
persistent=0

[state 1320]
type = VarSet
trigger1 = AnimElem=1,>=1&&(!fvar(10)||fvar(10)>=97)
fvar(10) = 98

[state 1320]
type = VarSet
trigger1 = AnimElem=1,=1
fvar(9) = 1.5+fvar(9)
persistent=0

[state 1320]
type = VarSet
trigger1 = (Time>10&&(fvar(9)=(-1,0]))
fvar(9) = .5
persistent=0

[state 1320]
type = VarAdd
trigger1 = AnimElem=2,>=0&&fvar(9)<8.0
fvar(9) = .2*ifelse(var(40)>-10&&var(40)!=0,1.25,1)


;~~上昇・下降
[state 1320]
type = VarSet
trigger1 = !time
var(7) = ifelse(prevstateno=1341,-1,ifelse(prevstateno=1344,1,0))

[state 1320]
type = VarAdd
trigger1 = var(7)
var(7) = -1+(var(7)>0)*2

;~~~~~上昇~~~~~
[state 1320]
type = VarSet
trigger1 = var(7)>=0&&command="holdup"&&!var(59)
var(7) = -1

[state 1320]
type = VelSet
trigger1 = var(7)=-1
y = -2.0
persistent=0

[state 1320]
type = VelAdd
trigger1 = var(7)<-1&&Vel Y>-8.0
y = -.2

[state 1320]
type = VelSet
trigger1 = Pos Y<=-160
y = 0
;~~~~~

;~~~~~下降~~~~~
[state 1320]
type = VarSet
trigger1 = var(7)<=0&&command="holddown"&&!var(59)
trigger2 = var(7)<=0&&var(2)>=8&&var(3)>=8&&Pos Y<-10&&var(59)
var(7) = 1

[state 1320]
type = VelSet
trigger1 = var(7)=1
y = 2.0
persistent=0

[state 1320]
type = VelAdd
trigger1 = var(7)>1&&Vel Y<8.0
y = .2

[state 1320]
type = VelSet
trigger1 = Pos Y>=0
y = 0

[state 1320]
type = PosSet
trigger1 = Pos Y>-1
y = -1
;~~~~~

[state 200]
type = ChangeState
triggerall = AnimElemTime(2)>=0
trigger1 = command="Hikou-End"&&!var(59)
trigger2 = roundstate>=3||var(37)<=0||var(40)<=-1000
trigger3 = time>30&&var(12)<360&&var(59)
value = 1350

;振り向き動作~~

[state 1320]
type = ChangeState
triggerall = AnimElemTime(2)>=0
trigger1 = Time&&P2dist X<0
value = 1321
;~~~

[state 1320]
type = ChangeState
triggerall = AnimElemTime(2)>=0
trigger1 = command="holdup"&&command!="holdfwd"&&!var(59)
value = 1341

[state 1320]
type = ChangeState
triggerall = AnimElemTime(2)>=0
trigger1 = command="holddown"&&command!="holdfwd"&&!var(59)
value = 1344

[state 1320]
type = ChangeState
triggerall = AnimElemTime(2)>=0
trigger1 = P2dist X<0
trigger2 = command!="holdfwd"&&!var(59)
trigger3 = var(7)>2&&time>=3&&(fvar(36)=[-11,11])&&var(59)
value = 1300

;後退（飛行形態）
[statedef 1321]
type = A
movetype=I
physics = N
velset = ifelse(fvar(9),fvar(9)*0,0)+fvar(8),0
anim = 1321

[state 200]
type = VarSet
trigger1 = !Time&&P2dist X<0
fvar(8) = -fvar(8)

[state 200]
type = VarSet
trigger1 = !Time&&P2dist X<0
fvar(9) = -fvar(9)

[state 200]
type = VelSet
trigger1 = !Time&&P2dist X<0
x = fvar(8)

[state 200]
type = Turn
trigger1 = !Time&&P2dist X<0

[state 1000]
type = VarAdd
trigger1 = 1
var(37) = -4/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 200]
type = PlaySND
trigger1 = Time=0
value = 20,3
;channel = 10
;volume = 128

[state 1320]
type = PosFreeze
trigger1 = (P2bodydist X=[-15,0])&&(P2bodydist Y=[-50,50])&&vel x>0
value = 1

[state 1320]
type = PosAdd
trigger1 = (P2bodydist X=[-15,0])&&(P2bodydist Y=[-50,50])
y = floor(vel Y)

[state 1320]
type = VarSet
trigger1 = AnimElem=1,=1
fvar(5) = 0
persistent=0

[state 1320]
type = VarSet
trigger1 = AnimElem=1,>=1&&(!fvar(10)||fvar(10)>=97)
fvar(10) = 98

[state 1320]
type = VarSet
trigger1 = AnimElem=1,=1
fvar(9) = -1.5+fvar(9)
persistent=0

[state 1320]
type = VarSet
trigger1 = (Time>10&&(fvar(9)=[0,1)))
fvar(9) = -.5
persistent=0

[state 1320]
type = VarAdd
trigger1 = AnimElem=2,>=0&&fvar(9)>-8.0
fvar(9) = -.2*ifelse(var(40)>-10&&var(40)!=0,1.25,1)


;~~上昇・下降
[state 1320]
type = VarSet
trigger1 = !time
var(7) = ifelse(prevstateno=1341,-1,ifelse(prevstateno=1344,1,0))

[state 1320]
type = VarAdd
trigger1 = var(7)
var(7) = -1+(var(7)>0)*2

;~~~~~上昇~~~~~
[state 1320]
type = VarSet
trigger1 = var(7)>=0&&command="holdup"&&!var(59)
var(7) = -1

[state 1320]
type = VelSet
trigger1 = var(7)=-1
y = -2.0
persistent=0

[state 1320]
type = VelAdd
trigger1 = var(7)<-1&&Vel Y>-8.0
y = -.2

[state 1320]
type = VelSet
trigger1 = Pos Y<=-160
y = 0
;~~~~~

;~~~~~下降~~~~~
[state 1320]
type = VarSet
trigger1 = var(7)<=0&&command="holddown"&&!var(59)
trigger2 = var(7)<=0&&var(2)>=8&&var(3)>=8&&var(59)
var(7) = 1

[state 1320]
type = VelSet
trigger1 = var(7)=1
y = 2.0
persistent=0

[state 1320]
type = VelAdd
trigger1 = var(7)>1&&Vel Y<8.0
y = .2

[state 1320]
type = VelSet
trigger1 = Pos Y>=0
y = 0

[state 1320]
type = PosSet
trigger1 = Pos Y>-1
y = -1
;~~~~~

[state 200]
type = ChangeState
triggerall = AnimElemTime(2)>=0
trigger1 = command="Hikou-End"&&!var(59)
trigger2 = roundstate>=3||var(37)<=0||var(40)<=-1000
trigger3 = time>48&&var(12)<360&&Pos Y>=-1&&var(59)
value = 1350

[state 1320]
type = ChangeState
triggerall = AnimElemTime(2)>=0
trigger1 = command="holdup"&&command!="holdback"&&!var(59)
value = 1341

[state 1320]
type = ChangeState
triggerall = AnimElemTime(2)>=0
trigger1 = command="holddown"&&command!="holdback"&&!var(59)
value = 1344

[state 1320]
type = ChangeState
triggerall = AnimElemTime(2)>=0
trigger1 = P2dist X<0
trigger2 = command!="holdback"&&!var(59)
trigger3 = pos Y>=0&&time>32&&var(59)
value = 1300

;上昇（飛行形態）
[statedef 1341]
type = A
movetype=I
physics = N
velset = ifelse(fvar(9),fvar(9)*0,0)+fvar(8),0
anim = 1341

[state 1000]
type = VarAdd
trigger1 = 1
var(37) = -4/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 200]
type = PlaySND
trigger1 = Time=0
value = 20,3
;channel = 10
;volume = 128

[state 1320]
type = VelSet
trigger1 = Time=0
y = -2.0

[state 1320]
type = VelAdd
trigger1 = Time>0&&Vel Y>-8.0
y = -.2

[state 1320]
type = VelSet
trigger1 = Pos Y<=-160
y = 0

[state 1320]
type = PosSet
trigger1 = Pos Y<-160
y = -160

;前進
[state 200]
type = ChangeState
triggerall = AnimElemTime(3)>=0
trigger1 = command="holdfwd"&&!var(59)
value = 1320

;後退
[state 200]
type = ChangeState
triggerall = AnimElemTime(3)>=0
trigger1 = command="holdback"&&!var(59)
value = 1321

[state 200]
type = ChangeState
triggerall = AnimElemTime(3)>=0
trigger1 = command="Hikou-End"&&!var(59)
trigger2 = roundstate>=3||var(37)<=0||var(40)<=-1000
value = 1350

[state 1320]
type = ChangeState
triggerall = AnimElemTime(3)>=0
trigger1 = P2dist X<0
trigger2 = command!="holdup"&&!var(59)
value = 1300

;下降（飛行形態）
[statedef 1344]
type = A
movetype=I
physics = N
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
anim = 1341

[state 1000]
type = VarAdd
trigger1 = 1
var(37) = -4/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 200]
type = PlaySND
trigger1 = Time=0
value = 20,3
;channel = 10
;volume = 128

[state 1320]
type = VelSet
trigger1 = Time=0
y = 2.0

[state 1320]
type = VelAdd
trigger1 = Time>0&&Vel Y<8.0
y = .2

[state 1320]
type = VelSet
trigger1 = Pos Y>=0
y = 0

[state 1320]
type = PosSet
trigger1 = Pos Y>-1
y = -1

;前進
[state 200]
type = ChangeState
triggerall = AnimElemTime(3)>=0
trigger1 = command="holdfwd"&&!var(59)
value = 1320

;後退
[state 200]
type = ChangeState
triggerall = AnimElemTime(3)>=0
trigger1 = command="holdback"&&!var(59)
value = 1321

[state 200]
type = ChangeState
triggerall = AnimElemTime(3)>=0
trigger1 = command="Hikou-End"&&!var(59)
trigger2 = roundstate>=3||var(37)<=0||var(40)<=-1000
value = 1350

[state 1320]
type = ChangeState
triggerall = AnimElemTime(3)>=0
trigger1 = P2dist X<0
trigger2 = command!="holddown"&&!var(59)
trigger3 = Pos Y>=-1&&random%3=0&&var(59)
value = 1300

;終了（飛行形態）
[statedef 1350]
type = A
movetype=I
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
anim = 1350

[state 1320]
type = PosFreeze
trigger1 = (P2bodydist X=[-15,0])&&(P2bodydist Y=[-50,50])&&Vel X>0
value = 1

[state 200]
type = VarSet
trigger1 = Time=0
fvar(8) = 0

[state 200]
type = VarSet
trigger1 = Time=0
fvar(9) = 0

[state -2]
type = varset
trigger1 = !time&&var(37)<=0
var(37) = -300/ifelse(var(40)>-10&&var(40)!=0,2,1)

[state 200]
type = VarSet
trigger1 = Time=0
var(10) = 0

[state 1320]
type = VelSet
trigger1 = AnimTime=-1
y = 2.0

[state 1320]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 50
ctrl = 1


;削岩直下
[statedef 1400]
type = A
movetype=A
physics = N
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1400

[state 210]
type = ChangeAnim
trigger1 = Time=1&&AnimElemNo(0)=5&&!IsHelper
value = anim
elem = 6

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 1320]
type = VarSet
trigger1 = !time
fvar(8) = 0

;攻撃、飛行形態終了
[state 1320]
type = VarSet
trigger1 = !time&&var(10)%8>=4
fvar(9) = 0

[state 1400]
type = varset
trigger1 = !time
var(10) = 0

[state 1400]
type = VelSet
trigger1 = Anim=1400&&AnimElem=6
y = 4.0

[state 1400]
type = VelAdd
trigger1 = Anim=1400&&AnimElem=6,>0
y = .5

[state 200]
type = ChangeAnim
trigger1 = Anim=1400&&Vel Y>0&&Pos Y>=-Vel Y
value = 1410

[state 190]
type = PlaySND
triggerall = (var(52)<=0||var(52)=100)
trigger1 = Anim=1400&&(AnimElem=7||AnimTime=0)
trigger2 = Anim=1410&&(AnimElem=1||AnimElem=3||AnimElem=5)
value = 20,12
;channel = 10
;volume = 128

[state 1050]
type = playsnd
trigger1 = Anim=1410
value = 20,7
;channel = 10
;volume = 128
persistent=0

;~~~自分側のhitpause作成~~
[state 250]
type = movehitreset
triggerall = Anim=1410
trigger1 = AnimElem=1
trigger2 = AnimElem=2
trigger3 = AnimElem=3
trigger4 = AnimElem=4
trigger5 = AnimElem=5

[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varset
triggerall = Anim=1410
trigger1 = AnimElem=1
trigger2 = AnimElem=2
trigger3 = AnimElem=3
trigger4 = AnimElem=4
trigger5 = AnimElem=5
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0&&Anim=1410&&AnimElemTime(4)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1&&Anim=1400
trigger2 = movecontact=1&&Anim=1410&&AnimElemTime(4)<0
var(52) = 0

[state 250]
type = varset
trigger1 = movecontact=1&&Anim=1410&&AnimElemTime(4)>=0
var(52) = 14

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
triggerall = Anim=1400
trigger1 = AnimElem=7||AnimTime=0
trigger2 = AnimElem=8
damage = floor(17*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*ifelse(var(1)%4>=2,.5,1.0)*1.22),floor(ceil(17*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,0
ground.velocity = 0*const(size.xscale),0*const(size.yscale)
guard.velocity = 0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0000,ifelse(var(6)%10>0,-8,0)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,0*const(size.yscale))
airguard.velocity = 0*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(1)*fvar(3)*.8)*1.38,ceil(20*ifelse(var(1)%4>=2,.5,1.0)*fvar(3)*.8*1.0/8)*1.38
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
triggerall = Anim=1410
trigger1 = AnimElem=1
trigger2 = AnimElem=2
trigger3 = AnimElem=3
damage = floor(26*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*ifelse(var(1)%4>=2,.5,1.0)*1.22),floor(ceil(26*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,0
ground.velocity = -12.0*const(size.xscale),0*const(size.yscale)
guard.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0000,ifelse(var(6)%10>0,-8,-6)*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-4.0*(51-var(3))/51)*const(size.yscale))
airguard.velocity = -6.0*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(16*ifelse(var(1)%4>=2,.5,1.0)*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(16*ifelse(var(1)%4>=2,.5,1.0)*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(16*ifelse(var(1)%4>=2,.5,1.0)*fvar(1)*fvar(3)*.8)*1.38,ceil(16*ifelse(var(1)%4>=2,.5,1.0)*fvar(3)*.8*1.0/8)*1.38
fall = 0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||var(52)=100)
triggerall = Anim=1410
trigger1 = AnimElem=4
trigger2 = AnimElem=5
damage = floor(26*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*ifelse(var(1)%4>=2,.5,1.0)*1.22),floor(ceil(26*fvar(3)*fvar(4)*1.0/4)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = ifelse((AnimElemTime(2)>=0),-6,0)*const(size.xscale),ifelse((AnimElemTime(2)>=0),-10,0)*const(size.yscale)
guard.velocity = ifelse(numtarget(920),-44,-15.0)*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%8>=4||var(1)%2>=1,-7.0*(1.0+ifelse(var(2)>31,31,var(2))*.050)-.0014,-6.0*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,(-12.0*(51-var(3))/51)*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = floor(ifelse(var(9),0,floor(16*ifelse(var(1)%4>=2,.5,1.0)*fvar(1)*fvar(3))*1.38*fvar(16))),floor(ifelse(var(9),0,ceil(16*ifelse(var(1)%4>=2,.5,1.0)*fvar(3)*1.0/8)*1.38*fvar(16)))
givepower = floor(16*ifelse(var(1)%4>=2,.5,1.0)*fvar(1)*fvar(3)*.8)*1.38,ceil(16*ifelse(var(1)%4>=2,.5,1.0)*fvar(3)*.8*1.0/8)*1.38
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-100*const(size.xscale))
animtype = hard
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = MA

;~~岩~~~
[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6920
anim = 6920
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
ignorehitpause=1
persistent=0
sprpriority = -2
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6924
anim = 6924
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = .75*1.2,-11.0
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6924
anim = 6924
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = -.75*1.2,-10.0
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6925
anim = 6925
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = .75*1.2,-9.5
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6926
anim = 6926
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = .5*1.2,-10.0
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6924
anim = 6924
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = 1*1.2,-9.0
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6927
anim = 6927
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = -.5,-11.5
accel = 0*1.2,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6926
anim = 6926
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = .5,-8.0
accel = 0*1.2,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6925
anim = 6925
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = -.75*1.2,-9.5
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6926
anim = 6926
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = -1*1.2,-8.5
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6924
anim = 6924
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = .75*1.2,-7.5
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6928
anim = 6928
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = -1*1.2,-9.5
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6928
anim = 6928
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = 1*1.2,-8.5
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6929
anim = 6929
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = -1*1.2,-10.0
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 7000]
type = Explod
trigger1 = Anim=1410 && AnimElem=1
id = 6929
anim = 6929
pos = floor(110*const(size.xscale)),floor(90*const(size.yscale))
postype = p1
vel = 1*1.2,-11.0
accel = 0,.4
ignorehitpause=1
persistent=0
sprpriority = 5
scale = .75,.75

[state 200]
type = AttackDist
trigger1 = Anim=1410&&AnimElem=6
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&anim=1400
fvar(15) = .00005*floor(17*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*ifelse(var(1)%4>=2,.5,1.0)*1.22)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&Anim=1410
fvar(15) = .00005*floor(26*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*ifelse(var(1)%4>=2,.5,1.0)*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
triggerall = Anim=1400
trigger1 = AnimElem=7||AnimTime=0
trigger2 = AnimElem=8
var(16) = 10+random%6

[state 240]
type = VarSet
triggerall = Anim=1410
trigger1 = AnimElem=1,>=0&&AnimElem=6,<0
var(16) = 10+random%6

;X座標
[state 240]
type = VarSet
trigger1 = 1
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Anim=1400
var(18) = floor(-100*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = Anim=1410
var(18) = floor(-80*const(size.yscale))

;・・・・自分側ヒットバック・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2&&statetype!=A&&animelemtime(4)>0
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = ifelse(var(3)&&target,statetype=A,-9.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.06),-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2&&statetype!=A&&animelemtime(4)>0
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2&&statetype!=A&&animelemtime(4)>0
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2&&statetype!=A&&animelemtime(4)>0
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (ifelse(var(49)&&!var(2),15,12)-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 200]
type = VelSet
trigger1 = Anim=1410&&AnimElem=1
y = 0

[state 200]
type = PosSet
trigger1 = Anim=1410&&AnimElem=1
y = 0

[state 200]
type = StatetypeSet
trigger1 = Anim=1410&&AnimElem=1
statetype=S
physics =S

[state 200]
type = ChangeState
trigger1 = Anim=1410&&AnimTime=0
value = 0
ctrl = 1

;防御形態
[statedef 1500]
type = S
movetype=I
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
anim = 1500

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;ガードポイント効果
[state 200]
type = VarSet
trigger1 = Time=0&&(prevstateno!=[5000,5099])
var(32) = -ifelse(command="y"&&!var(59)||var(53)=1510,2,1)

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;盾アニメーション
[state 1500]
type = RemoveExplod
trigger1 = !time&&(prevstateno!=[5000,5099])
id = 1505

;ガードポイント制限時間再設定フラグ
[state 200]
type = VarSet
trigger1 = Time=0&&(prevstateno!=[5000,5099])
var(7) = (var(33)>=0)

;ガードポイント制限時間
[state 200]
type = VarSet
trigger1 = Time=0&&(prevstateno!=[5000,5099])
var(33) = -1

;援護形態へ移行
[state 1500]
type = ChangeState
triggerall = !Time&&(var(40)=1||(var(40)=[5,6]))&&!var(12)&&(prevstateno!=[5000,5099])&&roundstate=2
trigger1 = command="a"&&command!="holddown"&&!var(59)
trigger2 = var(7)&&var(59)
value = 1600

[state 200]
type = VarSet
trigger1 = Time=0&&(prevstateno!=[5000,5099])
var(33) = 0

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)&&var(46)
var(46) = 1

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=1&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[1,15]
value = 1500
elem = 1

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=2&&var(46)=16
value = 1500
elem = 2

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = anim
elem = AnimElemNo(0)

[state 1610]
type = PosFreeze
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = 1


;経過時間
[state 1610]
type = varset
trigger1 = Time>=var(48)&&AnimElem=2,>=0
var(46) = 0

;ガードポイント制限時間
[state 200]
type = VarSet
trigger1 = var(32)<0&&AnimElem=3,=8
var(32) = -var(32)

;ガードポイント制限時間
[state 200]
type = VarSet
trigger1 = AnimElem=3,=8
var(33) = ifelse(var(7),720,-1)

[state 1320]
type = PlaySND
trigger1 = AnimElem=3
value = 20,6
;channel = 10
;volume = 128

;盾アニメーション
[state 1500]
type = Explod
trigger1 = AnimElem=3
id = 1505
anim = 1505
pos = floor(-112*const(size.xscale)),floor((-195+190*(var(32)=-2))*const(size.yscale))
postype = p1
bindtime=-1
ignorehitpause=1
sprpriority = 2
scale = const(size.xscale)*.75,const(size.yscale)*.75
;removetime = ifelse(var(7),720,15)

;盾アニメーション
[state 1500]
type = Helper
trigger1 = !NumHelper(1505)&&AnimElem=3,=8
id = 1505
stateno = 1505
pos = floor(-120*const(size.xscale)),floor((-180+100*(var(32)=2))*const(size.yscale))
postype = p1
bindtime=-1
ignorehitpause=1
sprpriority = 2
;size.xscale = const(size.xscale)*.75
;size.yscale = const(size.yscale)*.75

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;防御形態
[statedef 1505]
type = A
movetype = I
physics = N
anim = 6000
sprpriority = 3

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = AssertSpecial
trigger1 = (root,stateno=1500&&root,animelemtime(3)>=0)
flag = noshadow
flag2 = invisible

[state 6050]
type = AngleDraw
trigger1 = 1
value = ifelse(root,stateno=1500,-90,0)
scale = const(size.xscale)*3,const(size.yscale)*3

[state 6050]
type = Trans
trigger1 = 1
trans = add

[state 6150]
type = VarSet
trigger1 = !time
fvar(15) = 0

[state 6150]
type = VarAdd
trigger1 = Time>=12
fvar(15) = -.25*cos(time*Pi/30)

[state 6200]
type = BindtoRoot
trigger1 = 1
pos = floor(ifelse(root,stateno!=1500,-102,-112)*const(size.xscale))-floor(25*const(size.xscale)),floor((-195+fvar(15)+190*(root,var(32)=2))*const(size.yscale))-floor(45*const(size.yscale))

[state 6050]
type = ChangeAnim
trigger1 = root,stateno!=1500&&anim!=6005
value = 6005

[state 6200]
type = Turn
trigger1 = var(20)=2;facing!=root,facing

[state 6150]
type = varadd
trigger1 = var(20)>0
var(20)=-1

[state 6150]
type = varset
trigger1 = facing!=root,facing&&!var(20)
var(20)=2

[state 6150]
type = RemoveExplod
trigger1 = !time||var(20)=1||(root,stateno=1500&&root,animelemtime(3)>=0);||facing!=root,facing
id = 1505

[state 6150]
type = Explod
trigger1 = !numexplod(1505)&&!(root,stateno=1500&&root,animelemtime(3)>=0)
id = 1505
anim=1505
pos = floor(ifelse(root,stateno!=1500,15,25)*const(size.xscale)),floor(45*const(size.yscale))
postype = p1
ignorehitpause=1
bindtime=-1
sprpriority = 4
removetime=-1
scale = const(size.xscale)*.75,const(size.yscale)*.75

[state 6150]
type = RemoveExplod
trigger1 = root,var(33)<=0
trigger2 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
id = 1505

[state -2]
type = DestroySelf
trigger1 = root,var(33)<=0
trigger2 = (Root,stateno=180||Root,stateno=5150)&&root,time=1

;援護形態
[statedef 1600]
type = S
movetype = I
physics = S
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
ctrl = 0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1600

[state 210]
type = ChangeAnim
trigger1 = Time=2&&AnimElemNo(0)=8&&!IsHelper
value = anim
elem = 9

;援護形態発動
[state 1800]
type = Explod
trigger1 = AnimElem=1&&!numexplod(6297)
id = 6297
anim = 90000
pos = 0,0
postype = p1
removetime=1
pausemovetime=999
supermovetime=999

;援軍アタック・勝利(プレイヤーヘルパー削除時用)
[state -2]
type = Helper
trigger1 = AnimElem=1&&!numhelper(11000)&&!IsHelper
name="Tokugawa-Ieyasu"
id = 11000
stateno = 11000
pos = floor(helper(10000),pos x-pos x)*ifelse(helper(10000),facing!=facing,-1,1),-floor(Pos Y)
postype = p1
ownpal = 1
size.xscale = const(size.xscale)
size.yscale = const(size.yscale)
size.ground.fwd = 20
size.ground.back = 20
size.head.pos = -10,-80
size.mid.pos = -5,-50
facing = helper(10000),facing
ignorehitpause=1

[state -2]
type = varset
trigger1 = AnimElem=1
var(40) = 5

;援軍ゲージを最大値に設定
[state 1800]
type = varset
trigger1 = AnimElem=11
var(42) = var(41)

[state 200]
type = VarSet
trigger1 = Time=1&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=1&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=1&&var(34)
var(35)=12

[state 200]
type = Helper
trigger1 = Time=1&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=1&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 1320]
type = VarSet
trigger1 = Time=0
fvar(8) = 0

[state 200]
type = VarSet
trigger1 = !Time
var(53) = 1600

[state 200]
type = VarSet
trigger1 = AnimElem=11
var(53) = 0

;自動解除までの時間
[state 1800]
type = varset
trigger1 = AnimElem=11
var(12) = 240

[state 1320]
type = VarSet
trigger1 = Time=0&&var(10)<0
var(10) = 0

;初期角度設定
[state 1320]
type = VarSet
trigger1 = AnimElem=11
var(13) = 0

;ファンネル1
[state -2]
type = Helper
trigger1 = AnimElem=11&&!NumHelper(6200)
id = 6200
stateno=6200
pos = 0,0
postype = p1
ownpal = 1
xscale = const(size.xscale)
yscale = const(size.yscale)
pausemovetime = 9999999
supermovetime = 9999999

;ファンネル2
[state -2]
type = null;Helper
trigger1 = AnimElem=11&&!NumHelper(6201)&&var(43)>=50000
id = 6201
stateno=6201
pos = 0,0
postype = p1
ownpal = 1
xscale = const(size.xscale)
yscale = const(size.yscale)
pausemovetime = 9999999
supermovetime = 9999999

;ファンネル3
[state -2]
type = null;Helper
trigger1 = AnimElem=11&&!NumHelper(6202)&&var(43)>=100000
id = 6202
stateno=6202
pos = 0,0
postype = p1
ownpal = 1
xscale = const(size.xscale)
yscale = const(size.yscale)
pausemovetime = 9999999
supermovetime = 9999999

[state 2200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;援護形態解除
[statedef 1610]
type = S
movetype = I
physics = S
velset = 0,0
anim = 1610
ctrl = 0

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)
var(46) = 1

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=1&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[1,2]
value = 1610
elem = 1

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=2&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[3,4]
value = 1610
elem = 2

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=3&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[5,6]
value = 1610
elem = 3

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=4&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[7,8]
value = 1610
elem = 4

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=5&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[9,10]
value = 1610
elem = 5

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=6&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[11,12]
value = 1610
elem = 6

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=7&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[13,15]
value = 1610
elem = 7

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=8&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[16,19]
value = 1610
elem = 8

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=9&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[20,23]
value = 1610
elem = 9

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=10&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[24,27]
value = 1610
elem = 10

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=11&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[28,43]
value = 1610
elem = 11

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=12&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[44,46]
value = 1610
elem = 12

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=13&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[47,49]
value = 1610
elem = 13

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=14&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[50,52]
value = 1610
elem = 14

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=15&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[53,54]
value = 1610
elem = 15

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=16&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[55,56]
value = 1610
elem = 16

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=17&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[57,58]
value = 1610
elem = 17

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=18&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[59,60]
value = 1610
elem = 18

[state 1610]
type = ChangeAnim
trigger1 = Time<var(48)
value = anim
elem = AnimElemNo(0)

[state 1320]
type = VarSet
trigger1 = Time=0
fvar(8) = 0

[state 1610]
type = Explod
trigger1 = !time&&!numexplod(6205)&&(prevstateno!=[5000,5099])
id = 6205
anim = 6205
pos = floor(-20*const(size.xscale)),floor(-200*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 4
bindtime=-1
scale = const(size.xscale),const(size.yscale)

[state 1610]
type = Explod
trigger1 = !time&&!numexplod(6219)&&(prevstateno!=[5000,5099])
id = 6219
anim = 6219
pos = floor(-20*const(size.xscale)),floor(-200*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 4
removetime=-1
bindtime=-1
ownpal = 1
scale = const(size.xscale),const(size.yscale)

[state 1610]
type = RemoveExplod
trigger1 = AnimElem=11,>=0
id = 6201

[state 1610]
type = RemoveExplod
trigger1 = AnimElem=11,>=0
id = 6219

;自動解除までの時間
[state 1800]
type = varset
trigger1 = AnimElem=1
var(12) = 0

[state 2200]
type = ChangeState
trigger1 = AnimTime=0||(time>=var(48)&&var(46)>60)
value = 0
ctrl = 1

;援護形態(空中)
[statedef 1650]
type = A
movetype = I
physics = N
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
ctrl = 0

[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 1650

[state 210]
type = ChangeAnim
trigger1 = Time=8&&AnimElemNo(0)=3&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))&&!IsHelper
value = anim
elem = 4

;援護形態発動
[state 1800]
type = Explod
trigger1 = AnimElem=1&&!numexplod(6297)
id = 6297
anim = 90000
pos = 0,0
postype = p1
removetime=1
pausemovetime=999
supermovetime=999

[state -2]
type = varset
trigger1 = AnimElem=1
var(40) = 5

;援軍アタック・勝利(プレイヤーヘルパー削除時用)
[state -2]
type = Helper
trigger1 = AnimElem=1&&!numhelper(11000)
name="Tokugawa-Ieyasu"
id = 11000
stateno = 11000
pos = floor(helper(10000),pos x-pos x)*ifelse(helper(10000),facing!=facing,-1,1),-floor(Pos Y)
postype = p1
ownpal = 1
size.xscale = const(size.xscale)
size.yscale = const(size.yscale)
size.ground.fwd = 20
size.ground.back = 20
size.head.pos = -10,-80
size.mid.pos = -5,-50
facing = helper(10000),facing
ignorehitpause=1

;援軍ゲージを最大値に設定
[state 1800]
type = varset
trigger1 = AnimElem=4
var(42) = var(41)

[state 200]
type = VarSet
trigger1 = Time=1&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=1&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=1&&var(34)
var(35)=12

[state 200]
type = Helper
trigger1 = Time=1&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=1&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno
persistent=0

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 1320]
type = VarSet
trigger1 = Time=0
fvar(8) = 0

[state 1320]
type = VarSet
trigger1 = Time=0&&var(10)<0
var(10) = 0

;飛行形態へ移行
[state 200]
type = VarSet
trigger1 = !Time
var(10) = 4

;自動解除までの時間
[state 1800]
type = varset
trigger1 = AnimElem=4
var(12) = 240

;初期角度設定
[state 1320]
type = VarSet
trigger1 = AnimElem=4
var(13) = 0

;ファンネル1
[state -2]
type = Helper
trigger1 = AnimElem=4&&!NumHelper(6200)
id = 6200
stateno=6200
pos = 0,0
postype = p1
ownpal = 1
xscale = const(size.xscale)
yscale = const(size.yscale)
pausemovetime = 9999999
supermovetime = 9999999

;ファンネル2
[state -2]
type = Helper
trigger1 = AnimElem=4&&!NumHelper(6201)&&var(43)>=50000
id = 6201
stateno=6201
pos = 0,0
postype = p1
ownpal = 1
xscale = const(size.xscale)
yscale = const(size.yscale)
pausemovetime = 9999999
supermovetime = 9999999

;ファンネル3
[state -2]
type = Helper
trigger1 = AnimElem=4&&!NumHelper(6202)&&var(43)>=100000
id = 6202
stateno=6202
pos = 0,0
postype = p1
ownpal = 1
xscale = const(size.xscale)
yscale = const(size.yscale)
pausemovetime = 9999999
supermovetime = 9999999

[state 2200]
type = ChangeState
trigger1 = AnimTime=0
value = 1300
ctrl = 1

;解除（空中）
[statedef 1660]
type = A
movetype=I
physics = N
ctrl = 0
velset = 0,0
anim = 1660

;自動解除までの時間
[state 1320]
type = VarSet
trigger1 = Time=0
var(12) = 0

[state 1320]
type = VarSet
trigger1 = Time=0
fvar(5) = 0

[state 1320]
type = VarSet
trigger1 = Time=0
fvar(6) = 0

[state 1320]
type = VarSet
trigger1 = Time=0
fvar(7) = 0

[state 1320]
type = VarSet
trigger1 = Time=0
fvar(8) = 0

[state 1610]
type = Explod
trigger1 = !time&&!numexplod(6205)
id = 6205
anim = 6205
pos = floor(-40*const(size.xscale)),floor(-260*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 4
bindtime=-1
ownpal = 1
scale = const(size.xscale),const(size.yscale)

[state 1610]
type = Explod
trigger1 = !time&&!numexplod(6219)
id = 6219
anim = 6219
pos = floor(-40*const(size.xscale)),floor(-260*const(size.yscale))
postype = p1
ownpal = 1
sprpriority = 4
removetime=-1
bindtime=-1
scale = const(size.xscale),const(size.yscale)

[state 1610]
type = RemoveExplod
trigger1 = AnimElem=4,>=12
id = 6201

[state 1610]
type = RemoveExplod
trigger1 = AnimElem=4,>=12
id = 6219

[state 1320]
type = VelSet
trigger1 = AnimTime=-1
y = 2.0

[state 1320]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 1320]
type = ChangeState
trigger1 = AnimTime=0
value = ifelse(var(10)%8>=4,1300,50)
ctrl = 1

;ファンネル1
[statedef 6200]
type = A
movetype = I
physics = N
anim = 90000
sprpriority = 3

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6150]
type = RemoveExplod
trigger1 = !time||var(13)!=root,var(13)||var(20)=1;||facing!=root,facing
id = 6200

[state 6150]
type = RemoveExplod
trigger1 = !time||var(13)!=root,var(13)||var(20)=1;||facing!=root,facing
id = 6201

[state 6150]
type = RemoveExplod
trigger1 = !time||var(13)!=root,var(13)||var(20)=1;||facing!=root,facing
id = 6202

[state 6150]
type = Explod
trigger1 = !numexplod(6200)
id = 6200
anim=6200+ifelse(!time,2,ifelse(root,var(13)=1,3,ifelse(root,var(13)=2,4,ifelse(root,var(13)=3,1,ifelse(root,var(13)=4,0,2)))))
pos = 0,0
postype = p1
ignorehitpause=1
bindtime=-1
sprpriority = 3
removetime=-1
scale = const(size.xscale),const(size.yscale)

;~~LV50〜
[state 6150]
type = Explod
trigger1 = !numexplod(6201)&&floor(root,var(43)/1000)>=50
id = 6201
anim=6200+ifelse(!time,2,ifelse(root,var(13)=1,3,ifelse(root,var(13)=2,4,ifelse(root,var(13)=3,1,ifelse(root,var(13)=4,0,2)))))
pos = -115,-50
postype = p1
ignorehitpause=1
bindtime=-1
sprpriority = 3
removetime=-1
scale = const(size.xscale),const(size.yscale)

;~~LV100
[state 6150]
type = Explod
trigger1 = !numexplod(6202)&&floor(root,var(43)/1000)>=100
id = 6202
anim=6200+ifelse(!time,2,ifelse(root,var(13)=1,3,ifelse(root,var(13)=2,4,ifelse(root,var(13)=3,1,ifelse(root,var(13)=4,0,2)))))
pos = -115,40
postype = p1
ignorehitpause=1
bindtime=-1
sprpriority = 3
removetime=-1
scale = const(size.xscale),const(size.yscale)

[state 6200]
type = BindtoRoot
trigger1 = 1
pos = 47,-100

[state 6200]
type = Turn
trigger1 = var(20)=2;facing!=root,facing

[state 6150]
type = varadd
trigger1 = var(20)>0
var(20)=-1

[state 6150]
type = varset
trigger1 = facing!=root,facing&&!var(20)
var(20)=2

[state 6150]
type = RemoveExplod
trigger1 = !time||var(13)!=root,var(13)||var(20)=1;||facing!=root,facing
id = 6210

[state 6150]
type = RemoveExplod
trigger1 = !time||var(13)!=root,var(13)||var(20)=1;||facing!=root,facing
id = 6211

[state 6150]
type = RemoveExplod
trigger1 = !time||var(13)!=root,var(13)||var(20)=1;||facing!=root,facing
id = 6212

[state 6150]
type = Explod
trigger1 = !numexplod(6210)
id = 6210
anim=6210+ifelse(!time,2,ifelse(root,var(13)=1,3,ifelse(root,var(13)=2,4,ifelse(root,var(13)=3,1,ifelse(root,var(13)=4,0,2)))))
pos = 0,0
postype = p1
ignorehitpause=1
bindtime=-1
sprpriority = 3
removetime=-1
scale = const(size.xscale),const(size.yscale)

;~~LV50〜
[state 6150]
type = Explod
trigger1 = !numexplod(6211)&&floor(root,var(43)/1000)>=50
id = 6211
anim=6210+ifelse(!time,2,ifelse(root,var(13)=1,3,ifelse(root,var(13)=2,4,ifelse(root,var(13)=3,1,ifelse(root,var(13)=4,0,2)))))
pos = -115,-50
postype = p1
ignorehitpause=1
bindtime=-1
sprpriority = 3
removetime=-1
scale = const(size.xscale),const(size.yscale)

;~~LV100
[state 6150]
type = Explod
trigger1 = !numexplod(6212)&&floor(root,var(43)/1000)>=100
id = 6212
anim=6210+ifelse(!time,2,ifelse(root,var(13)=1,3,ifelse(root,var(13)=2,4,ifelse(root,var(13)=3,1,ifelse(root,var(13)=4,0,2)))))
pos = -115,40
postype = p1
ignorehitpause=1
bindtime=-1
sprpriority = 3
removetime=-1
scale = const(size.xscale),const(size.yscale)

[state 6150]
type = RemoveExplod
trigger1 = (Root,var(12)<=0&&(Root,stateno=1610||Root,stateno=1660))||(!root,var(12)&&(root,stateno!=[1600,1650])&&(root,var(34)!=[1600,1650]))
trigger2 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger3 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)

[state 6200]
type = varset
trigger1 = 1
var(13) = root,var(13)

;自動解除までの時間
[state 6200]
type = parentvarset
trigger1 = (Root,NumExplod(6295)||Root,NumExplod(6296)||Root,NumExplod(6297)||Root,NumExplod(6298)||Root,NumExplod(6299))&&!var(0)&&Root,var(42)>0&&root,var(12)>=0
var(12) = 420

;自動解除までの時間
[state 6200]
type = parentvarset
trigger1 = (Root,NumExplod(6295)||Root,NumExplod(6296)||Root,NumExplod(6297)||Root,NumExplod(6298)||Root,NumExplod(6299))&&Root,var(42)<=0&&((root,var(12)>0&&!var(0))||(root,var(12)>6&&var(0)=12))
var(12) = 6

;ボタン１回押しで２発出るのを防止
[state 6200]
type = varadd
trigger1 = var(0)
var(0) = -1

;ボタン１回押しで２発出るのを防止
[state 6200]
type = varset
trigger1 = (Root,NumExplod(6295)||Root,NumExplod(6296)||Root,NumExplod(6297)||Root,NumExplod(6298)||Root,NumExplod(6299))
var(0) = 12

[state 1050]
type = playsnd
trigger1 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger2 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)
value = 20,15
;channel = 10
;volume = 128

[state 6150]
type = Explod
trigger1 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger2 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)
id = 6150
anim=6150
pos = 0,0
postype = p1
ignorehitpause=1
sprpriority = 4
persistent=0
scale = const(size.xscale)*2,const(size.yscale)*2
persistent=0

[state 6150]
type = Explod
trigger1 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger2 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)
id = 6151
anim=6150
pos = -117,-52
postype = p1
ignorehitpause=1
sprpriority = 4
persistent=0
scale = const(size.xscale)*2,const(size.yscale)*2
persistent=0

[state 6150]
type = Explod
trigger1 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger2 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)
id = 6152
anim=6150
pos = -120,40
postype = p1
ignorehitpause=1
sprpriority = 4
persistent=0
scale = const(size.xscale)*2,const(size.yscale)*2
persistent=0

[state -2]
type = DestroySelf
trigger1 = (Root,var(12)<=0&&(Root,stateno=1610||Root,stateno=1660))||(!root,var(12)&&(root,stateno!=[1600,1650])&&(root,var(34)!=[1600,1650]))
trigger2 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger3 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)

;ファンネル2
[statedef 6201]
type = A
movetype = I
physics = N
anim = 6200
sprpriority = 3

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = AngleDraw
trigger1 = 1
value = ifelse(root,var(13)=4,-180,ifelse(root,var(13)=3,-135,ifelse(root,var(13)=2,0,ifelse(root,var(13)=1,-45,-90))))
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6200]
type = BindtoRoot
trigger1 = 1
pos = -67-ifelse(root,var(13)=4,5,ifelse(root,var(13)=3,2,ifelse(root,var(13)=2,5,ifelse(root,var(13)=1,2,0)))),-152+ifelse(root,var(13)=4,5,ifelse(root,var(13)=3,5,ifelse(root,var(13)=2,0,ifelse(root,var(13)=1,5,0))))


[state 6200]
type = Turn
trigger1 = var(20)=2;facing!=root,facing

[state 6150]
type = varadd
trigger1 = var(20)>0
var(20)=-1

[state 6150]
type = varset
trigger1 = facing!=root,facing&&!var(20)
var(20)=2

[state 6150]
type = RemoveExplod
trigger1 = !time||var(13)!=root,var(13)||var(20)=1;||facing!=root,facing
id = 6210

[state 6150]
type = Explod
trigger1 = !numexplod(6210)
id = 6210
anim=6210+ifelse(!time,0,root,var(13))
pos = 0,0
postype = p1
ignorehitpause=1
bindtime=-1
sprpriority = 3
removetime=-1
scale = const(size.xscale),const(size.yscale)

[state 6150]
type = RemoveExplod
trigger1 = (Root,var(12)<=0&&(Root,stateno=1610||Root,stateno=1660))||(!root,var(12)&&(root,stateno!=[1600,1650])&&(root,var(34)!=[1600,1650]))
trigger2 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger3 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)
id = 6210

[state 6200]
type = varset
trigger1 = 1
var(13) = root,var(13)

;自動解除までの時間
[state 6200]
type = parentvarset
trigger1 = (Root,NumExplod(6295)||Root,NumExplod(6296)||Root,NumExplod(6297)||Root,NumExplod(6298)||Root,NumExplod(6299))&&!var(0)&&Root,var(42)>0&&root,var(12)>=0
var(12) = 420

;自動解除までの時間
[state 6200]
type = parentvarset
trigger1 = (Root,NumExplod(6295)||Root,NumExplod(6296)||Root,NumExplod(6297)||Root,NumExplod(6298)||Root,NumExplod(6299))&&Root,var(42)<=0&&((root,var(12)>0&&!var(0))||(root,var(12)>6&&var(0)=12))
var(12) = 6

;ボタン１回押しで２発出るのを防止
[state 6200]
type = varadd
trigger1 = var(0)
var(0) = -1

;ボタン１回押しで２発出るのを防止
[state 6200]
type = varset
trigger1 = (Root,NumExplod(6295)||Root,NumExplod(6296)||Root,NumExplod(6297)||Root,NumExplod(6298)||Root,NumExplod(6299))
var(0) = 12

[state 1050]
type = playsnd
trigger1 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger2 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)
value = 20,15
;channel = 10
;volume = 128

[state 6150]
type = Explod
trigger1 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger2 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)
id = 6150
anim=6150
pos = 0,0
postype = p1
ignorehitpause=1
sprpriority = 4
persistent=0
scale = const(size.xscale)*2,const(size.yscale)*2

[state -2]
type = DestroySelf
trigger1 = (Root,var(12)<=0&&(Root,stateno=1610||Root,stateno=1660))||(!root,var(12)&&(root,stateno!=[1600,1650])&&(root,var(34)!=[1600,1650]))
trigger2 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger3 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)


;ファンネル3
[statedef 6202]
type = A
movetype = I
physics = N
anim = 6200
sprpriority = 3

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = AngleDraw
trigger1 = 1
value = ifelse(root,var(13)=4,-180,ifelse(root,var(13)=3,-135,ifelse(root,var(13)=2,0,ifelse(root,var(13)=1,-45,-90))))
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6200]
type = BindtoRoot
trigger1 = 1
pos = -70-ifelse(root,var(13)=4,5,ifelse(root,var(13)=3,2,ifelse(root,var(13)=2,5,ifelse(root,var(13)=1,2,0)))),-60+ifelse(root,var(13)=4,5,ifelse(root,var(13)=3,5,ifelse(root,var(13)=2,0,ifelse(root,var(13)=1,5,0))))

[state 6200]
type = Turn
trigger1 = var(20)=2;facing!=root,facing

[state 6150]
type = varadd
trigger1 = var(20)>0
var(20)=-1

[state 6150]
type = varset
trigger1 = facing!=root,facing&&!var(20)
var(20)=2

[state 6150]
type = RemoveExplod
trigger1 = !time||var(13)!=root,var(13)||var(20)=1;||facing!=root,facing
id = 6210

[state 6150]
type = Explod
trigger1 = !numexplod(6210)
id = 6210
anim=6210+ifelse(!time,0,root,var(13))
pos = 0,0
postype = p1
ignorehitpause=1
bindtime=-1
sprpriority = 3
removetime=-1
scale = const(size.xscale),const(size.yscale)

[state 6150]
type = RemoveExplod
trigger1 = (Root,var(12)<=0&&(Root,stateno=1610||Root,stateno=1660))||(!root,var(12)&&(root,stateno!=[1600,1650])&&(root,var(34)!=[1600,1650]))
trigger2 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger3 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)
id = 6210

[state 6200]
type = varset
trigger1 = 1
var(13) = root,var(13)

;自動解除までの時間
[state 6200]
type = parentvarset
trigger1 = (Root,NumExplod(6295)||Root,NumExplod(6296)||Root,NumExplod(6297)||Root,NumExplod(6298)||Root,NumExplod(6299))&&!var(0)&&Root,var(42)>0&&root,var(12)>=0
var(12) = 420

;自動解除までの時間
[state 6200]
type = parentvarset
trigger1 = (Root,NumExplod(6295)||Root,NumExplod(6296)||Root,NumExplod(6297)||Root,NumExplod(6298)||Root,NumExplod(6299))&&Root,var(42)<=0&&((root,var(12)>0&&!var(0))||(root,var(12)>6&&var(0)=12))
var(12) = 6

;ボタン１回押しで２発出るのを防止
[state 6200]
type = varadd
trigger1 = var(0)
var(0) = -1

;ボタン１回押しで２発出るのを防止
[state 6200]
type = varset
trigger1 = (Root,NumExplod(6295)||Root,NumExplod(6296)||Root,NumExplod(6297)||Root,NumExplod(6298)||Root,NumExplod(6299))
var(0) = 12

[state 1050]
type = playsnd
trigger1 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger2 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)
value = 20,15
;channel = 10
;volume = 128

[state 6150]
type = Explod
trigger1 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger2 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)
id = 6150
anim=6150
pos = 0,0
postype = p1
ignorehitpause=1
sprpriority = 4
persistent=0
scale = const(size.xscale)*2,const(size.yscale)*2

[state -2]
type = DestroySelf
trigger1 = (Root,var(12)<=0&&(Root,stateno=1610||Root,stateno=1660))||(!root,var(12)&&(root,stateno!=[1600,1650])&&(root,var(34)!=[1600,1650]))
trigger2 = (Root,stateno=180||Root,stateno=5150)&&root,time=1
trigger3 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)


;ファンネル1
[statedef 6210]
type = A
movetype = I
physics = N
anim = 6210
sprpriority = 3

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = ifelse(root,var(13)=4,-180,ifelse(root,var(13)=3,-135,ifelse(root,var(13)=2,0,ifelse(root,var(13)=1,-45,-90))))
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6200]
type = BindtoRoot
trigger1 = 1
pos = 47-ifelse(root,var(13)=4,5,ifelse(root,var(13)=3,7,ifelse(root,var(13)=2,5,ifelse(root,var(13)=1,7,10)))),-100+ifelse(root,var(13)=4,-5,ifelse(root,var(13)=3,0,ifelse(root,var(13)=2,0,ifelse(root,var(13)=1,10,0))))

[state 6200]
type = Turn
trigger1 = facing!=root,facing

[state -2]
type = ChangeAnim
trigger1 = Anim!=6210+ifelse(root,var(13)=4,4,ifelse(root,var(13)=3,3,ifelse(root,var(13)=2,2,ifelse(root,var(13)=1,1,0))))
value = 6210+ifelse(root,var(13)=4,4,ifelse(root,var(13)=3,3,ifelse(root,var(13)=2,2,ifelse(root,var(13)=1,1,0))))

[state -2]
type = DestroySelf
trigger1 = (Root,var(12)<=0&&(Root,stateno=1610||Root,stateno=1660))||(!root,var(12)&&(root,stateno!=[1600,1650])&&(root,var(34)!=[1600,1650]))
trigger2 = Root,stateno=180&&root,time=1
trigger3 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)


;ファンネル2
[statedef 6211]
type = A
movetype = I
physics = N
anim = 6210
sprpriority = 3

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = ifelse(root,var(13)=4,-180,ifelse(root,var(13)=3,-135,ifelse(root,var(13)=2,0,ifelse(root,var(13)=1,-45,-90))))
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6200]
type = BindtoRoot
trigger1 = 1
pos = -67-ifelse(root,var(13)=4,5,ifelse(root,var(13)=3,7,ifelse(root,var(13)=2,5,ifelse(root,var(13)=1,7,10)))),-152+ifelse(root,var(13)=4,-5,ifelse(root,var(13)=3,0,ifelse(root,var(13)=2,0,ifelse(root,var(13)=1,10,0))))

[state 6200]
type = Turn
trigger1 = facing!=root,facing

[state -2]
type = ChangeAnim
trigger1 = Anim!=6210+ifelse(root,var(13)=4,4,ifelse(root,var(13)=3,3,ifelse(root,var(13)=2,2,ifelse(root,var(13)=1,1,0))))
value = 6210+ifelse(root,var(13)=4,4,ifelse(root,var(13)=3,3,ifelse(root,var(13)=2,2,ifelse(root,var(13)=1,1,0))))

[state -2]
type = DestroySelf
trigger1 = (Root,var(12)<=0&&(Root,stateno=1610||Root,stateno=1660))||(!root,var(12)&&(root,stateno!=[1600,1650])&&(root,var(34)!=[1600,1650]))
trigger2 = Root,stateno=180&&root,time=1
trigger3 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)


;ファンネル3
[statedef 6212]
type = A
movetype = I
physics = N
anim = 6210
sprpriority = 3

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = ifelse(root,var(13)=4,-180,ifelse(root,var(13)=3,-135,ifelse(root,var(13)=2,0,ifelse(root,var(13)=1,-45,-90))))
scale = const(size.xscale)*2,const(size.yscale)*2

[state 6200]
type = BindtoRoot
trigger1 = 1
pos = -70-ifelse(root,var(13)=4,5,ifelse(root,var(13)=3,7,ifelse(root,var(13)=2,5,ifelse(root,var(13)=1,7,10)))),-60+ifelse(root,var(13)=4,-5,ifelse(root,var(13)=3,0,ifelse(root,var(13)=2,0,ifelse(root,var(13)=1,10,0))))

[state 6200]
type = Turn
trigger1 = facing!=root,facing

[state -2]
type = ChangeAnim
trigger1 = Anim!=6210+ifelse(root,var(13)=4,4,ifelse(root,var(13)=3,3,ifelse(root,var(13)=2,2,ifelse(root,var(13)=1,1,0))))
value = 6210+ifelse(root,var(13)=4,4,ifelse(root,var(13)=3,3,ifelse(root,var(13)=2,2,ifelse(root,var(13)=1,1,0))))

[state -2]
type = DestroySelf
trigger1 = (Root,var(12)<=0&&(Root,stateno=1610||Root,stateno=1660))||(!root,var(12)&&(root,stateno!=[1600,1650])&&(root,var(34)!=[1600,1650]))
trigger2 = Root,stateno=180&&root,time=1
trigger3 = (Root,stateno=3500&&root,animelemtime(3)>=2)||(root,var(34)=3500&&root,var(35)=31)


;飛び道具1
[statedef 6250]
type = A
physics = N
movetype=A
anim = 6240
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = -90
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47+73,-100

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6250

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 6
y = 0

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6255
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具2
[statedef 6251]
type = A
physics = N
movetype=A
anim = 6241
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = -45
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47+52,-100-52

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6251

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 6
y = -6

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA


;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6256
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具3
[statedef 6252]
type = A
physics = N
movetype=A
anim = 6242
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = -180
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47,-100+73

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6252

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 0
y = 6

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA


;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6259
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具4
[statedef 6253]
type = A
physics = N
movetype=A
anim = 6243
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = -135
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47+52,-100+52

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6253

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 6
y = 6

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6258
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具5
[statedef 6254]
type = A
physics = N
movetype=A
anim = 6244
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = 0
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47,-100-73

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6254

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 0
y = -5

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA


;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6257
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具2-1
[statedef 6260]
type = A
physics = N
movetype=A
anim = 6240
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = -90
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47-115+73,-150

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6250

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 6
y = 0

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA


;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6255
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具2-2
[statedef 6261]
type = A
physics = N
movetype=A
anim = 6241
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = -45
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47-115+52,-150-52

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6251

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 6
y = -6

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA


;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6256
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具2-3
[statedef 6262]
type = A
physics = N
movetype=A
anim = 6242
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = -180
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47-115,-150+73

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6252

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 0
y = 6

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA


;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6259
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=13

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具2-4
[statedef 6263]
type = A
physics = N
movetype=A
anim = 6243
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = -135
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47-115+52,-150+52

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6253

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 6
y = 6

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6258
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具2-5
[statedef 6264]
type = A
physics = N
movetype=A
anim = 6244
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = 0
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47-115,-150-73

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6254

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 0
y = -5

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA


;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6257
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具3-1
[statedef 6270]
type = A
physics = N
movetype=A
anim = 6240
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = -90
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47-115+73,-60

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6250

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 6
y = 0

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA


;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6255
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具2-2
[statedef 6271]
type = A
physics = N
movetype=A
anim = 6241
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = -45
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47-115+52,-60-52

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6251

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 6
y = -6

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA


;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6256
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具3-3
[statedef 6272]
type = A
physics = N
movetype=A
anim = 6242
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = -180
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47-115,-60+73

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6252

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 0
y = 6

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA


;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6259
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具3-4
[statedef 6273]
type = A
physics = N
movetype=A
anim = 6243
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = -135
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47-115+52,-60+52

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6253

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 6
y = 6

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA


;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6258
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;飛び道具3-5
[statedef 6274]
type = A
physics = N
movetype=A
anim = 6244
velset = 0,0
sprpriority = 4

[state 6200]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6200]
type = Trans
trigger1 = 1
trans = add

[state 6200]
type = AngleDraw
trigger1 = 1
value = 0
scale = const(size.xscale)*2,const(size.yscale)*ifelse(Time<6,.5,5)

[state 6200]
type = BindtoRoot
trigger1 = Time<6;ファンネル
pos = 47-115,-60-73

[state 6200]
type = ChangeAnim
trigger1 = Time=6;ファンネル
value = 6254

[state 6200]
type = VelSet
trigger1 = Time=6;ファンネル
x = 0
y = -5

;発射
[state 6200]
type = HitDef
trigger1 = Time=6;ファンネル
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 1,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA


;発射
[state 6200]
type = null;Projectile
trigger1 = Time=6;ファンネル
projid = 6200
projanim = 6257
projshadow = -1
velocity = vel x,vel y
damage = floor(ifelse(26*root,fvar(0)<1,1,26*root,fvar(0))*1.22)
ground.slidetime = 14+(P2statetype=C)+root,var(49)*6
ground.hittime = 14+(P2statetype=C)+root,var(49)*6
guard.slidetime = 12
guard.hittime = 12
pausetime = 16,15
ground.velocity = -12.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(root,var(1)%8>=4||root,var(1)%2>=1,-10.0-.0015,-10.0*(1.0+ifelse(root,var(3)>31,31,root,var(3))*.06)*const(size.xscale)),ifelse(root,var(6)%10>0,2,(-11.0*(51-root,var(3))/51-.9)*const(size.yscale));ファンネル
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = ifelse(root,var(6)%10>0||root,var(28)>0,0,1)
fall.recovertime = ifelse(root,var(49)&&!root,var(2),50+15,36-ifelse(floor(root,var(14)/70)>7,7,floor(root,var(14)/70))+15)
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,1)
guardsound = s7000,1
getpower = floor(ifelse(root,var(9),0,floor(16*root,fvar(1)*root,fvar(3))*1.38*root,fvar(16))),floor(ifelse(root,var(9),0,ceil(16*root,fvar(3)*1.0/8)*1.38*root,fvar(16)))
givepower = floor(16*root,fvar(1)*root,fvar(3)*.8)*1.38,ceil(16*root,fvar(3)*.8*1.0/8)*1.38
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-30*const(size.xscale))
animtype = Light
ground.type = Low
attr = S,NP
hitflag = MAFD
guardflag = MA

;ダウン追撃引きはがし効果
[state -1]
type = parentvaradd
trigger1 = root,var(6)%2>=1&&numtarget
trigger1 = movehit=1 && target,time=0
var(6) = -1
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;援軍ヒット判別
[state 12000]
type = ParentVarSet
trigger1 = movecontact=1&&root,numhelper(6200)&&root,var(12)>0
var(15) = ifelse((root,stateno=[1000,1999]),36,28)*ifelse(moveguarded||!numtarget,-1,1)
persistent=0
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1
fvar(15) = .00005*floor(ifelse(26*root,fvar(14)<1,1+(root,var(2)%5=1),26*root,fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=6;ファンネル
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = Time>=9;ファンネル
var(18) = 0

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999

;ガードクラッシュ減少値/気絶値増加値判別
[State 100, Helper]
type = Helper
triggerall = !enemynear,numpartner && !numhelper(15903)&&IsHelper
trigger1 = time=1
id = 15903
stateno=15903
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state 1000]
type = parentvaradd
trigger1 = var(25)
var(25) = var(25)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(25)
var(25) = 0
ignorehitpause=1

[state 1000]
type = parentvarset
trigger1 = var(28)
var(28) = var(28)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(28)
var(28) = 0
ignorehitpause=1

[state 1000]
type = parentvaradd
trigger1 = var(29)
var(29) = var(29)
ignorehitpause=1

[state 1000]
type = varset
trigger1 = var(29)
var(29) = 0
ignorehitpause=1

;ガードクラッシュ減少値判別
[State 100, Helper]
type = Helper
triggerall = moveguarded=1&&!numhelper(15908)&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=150||target,stateno=152||target,stateno=154)
trigger2 = !numtarget && movetype=H && (P2stateno=[150,155])
id = 15905+3
stateno=15905
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

;気絶増加値判別
[State 100, Helper]
type = Helper
triggerall = movehit=1&&!numhelper(15388)&&root,var(28)>=0&&IsHelper
triggerall = !enemynear,numpartner
trigger1 = numtarget
trigger1 = target,time=0 && (target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = !numtarget && movetype=H && P2movetype=H && (P2stateno!=[150,155])
id = 15380+8
stateno=15380
pos = 0,0
postype = p2
ownpal = 1
ignorehitpause = 1

[state -2]
type = DestroySelf
trigger1 = FrontEdgebodydist <-80||ScreenPos Y>=340||ScreenPos Y<=-120

;加速追尾
[statedef 1700]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,ifelse(pos Y<0,vel Y,0)
anim = 2000

[state 2000]
type = ChangeState
trigger1 = !time
value = 2000

;ブースト(吹き飛ばし攻撃後・加速追尾　兼用)
[statedef 2000]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,ifelse(pos Y<0,vel Y,0)
anim = 2000

;ブーストエフェクト
[state 2000]
type = Helper
trigger1 = !time
id = 7720
stateno=7720
pos = 0,floor(-160*const(size.yscale))
postype = p1
pausemovetime=999
supermovetime=999
ownpal = 1
sprpriority = 2
ignorehitpause=1

[state 2000]
type = PlaySND
trigger1 = !time
value = 2000,0
volume = 255

[State 0, AfterImage]
type = AfterImage
trigger1 = !time
time=24
length = 5
palbright = 0,0,0
palcontrast = 256,256,256
palpostbright = -30,0,0
paladd = 0,0,0
palmul = 1,1,1
timegap = 1
framegap = 2
trans = AddAlpha
alpha = 128,128

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = !time||(fvar(10)=[32,40])
time = 1
add = ifelse(fvar(10)<32,255,floor(fvar(10)-32)*32),ifelse(fvar(10)<32,255,floor(fvar(10)-32)*32),ifelse(fvar(10)<32,255,floor(fvar(10)-32)*32)

;ブースト
[state 2000]
type = varadd
trigger1 = !time
var(6) = 100*(!floor(var(6)%1000/100))+1000*(var(1)%2<1&&!floor(var(6)%10000/1000))

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = !time
var(9)=ifelse(var(9)>=10000,12000-floor(var(9)/100)*100,12000)

;ヒットバック0
[state 900]
type = VarSet
trigger1 = !time
fvar(5) = 0

[state 2000]
type = PosAdd
trigger1 = time=0
x = -13.0

[state 2000]
type = VelSet
trigger1 = time=0
x = 13.0
y = ifelse(vel Y<0,-4,0)

[state 2000]
type = VelSet
trigger1 = time=1&&prevstateno=1700&&var(36)%2>=1&&(floor(fvar(24))-pos x)*facing>0
x = (floor(fvar(24))-pos x)*facing/20
y = -((fvar(24)-floor(fvar(24)))*10000-80+pos y)*1.0/20

[state 2000]
type = VelSet
trigger1 = time=1&&prevstateno=1700&&var(36)%4>=2&&(floor(fvar(25))-pos x)*facing>0&&((floor(fvar(25))-pos x)*facing<(floor(fvar(24))-pos x)*facing)
x = (floor(fvar(25))-pos x)*facing/20
y = -((fvar(25)-floor(fvar(25)))*10000-80+pos y)*1.0/20

[state 2000]
type = VelSet
trigger1 = time=1&&prevstateno=1700&&var(36)%8>=4&&(floor(fvar(26))-pos x)*facing>0
trigger1 = ((floor(fvar(26))-pos x)*facing<(floor(fvar(24))-pos x)*facing||(floor(fvar(26))-pos x)*facing<(floor(fvar(25))-pos x)*facing)
x = (floor(fvar(26))-pos x)*facing/20
y = -((fvar(26)-floor(fvar(26)))*10000-80+pos y)*1.0/20

[state 2000]
type = StatetypeSet
trigger1 = Pos Y<0
statetype=A
physics = N

[state 2000]
type = StatetypeSet
trigger1 = Pos Y>=0
statetype=S
physics = N

[state 2000]
type = VelSet
trigger1 = Statetype!=A
y = 0

[state 2000]
type = PosSet
trigger1 = Statetype!=A
y = 0

[state 2000]
type = Gravity
trigger1 = time>=2&&statetype=A

;現在の速度
[state 2000]
type = VarSet
trigger1 = !time
fvar(8) = 0

;ブースト速度
[state 2000]
type = VarSet
trigger1 = !time
fvar(9) = 13.0

[state 2000]
type = VarSet
trigger1 = !time&&prevstateno=1700&&var(36)%2>=1&&(floor(fvar(24))-pos x)*facing>0
fvar(9) = (floor(fvar(24))-pos x)*facing/20

[state 2000]
type = VarSet
trigger1 = !time&&prevstateno=1700&&var(36)%4>=2&&(floor(fvar(25))-pos x)*facing>0&&((floor(fvar(25))-pos x)*facing<(floor(fvar(24))-pos x)*facing)
fvar(9) = (floor(fvar(25))-pos x)*facing/20

[state 2000]
type = VarSet
trigger1 = !time&&prevstateno=1700&&var(36)%8>=4&&(floor(fvar(26))-pos x)*facing>0
trigger1 = ((floor(fvar(26))-pos x)*facing<(floor(fvar(24))-pos x)*facing||(floor(fvar(26))-pos x)*facing<(floor(fvar(25))-pos x)*facing)
fvar(9) = (floor(fvar(26))-pos x)*facing/20

;ブースト時間
[state 2000]
type = VarSet
trigger1 = !time
fvar(10) = 40

[state 200]
type = VarAdd
trigger1 = !Time&&var(53)>2000
var(53) = -2000

[state 2000]
type = ChangeState
trigger1 = !time&&(var(53)=40||var(53)=50)
value = 40

[state 200]
type = VarSet
trigger1 = !Time
var(53) = 0

[state 2000]
type = ChangeState
trigger1 = time>=4
trigger1 = !fvar(10)||(P2bodydist X<=0&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
trigger2 = time>=30
value = 0
ctrl = 1

[state 200]
type = VarSet
trigger1 = !Time
var(34) = 0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 2000]
type = VarSet
trigger1 = !time&&prevstateno=1700
var(37) = -540/ifelse(var(40)>-10&&var(40)!=0,2,1)

;ガードキャンセル攻撃
[statedef 2500]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 2500
poweradd =-1000

;ガードゲージ減少
[state 2000]
type = VarAdd
trigger1 = Time=0
var(23)=ifelse(var(23)<=128,-var(23)+1,-128)

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = 1
var(9)=ifelse((var(9)=[1,999]),420-var(9),420)

[state 2000]
type = PalFX
trigger1 = Time=[0,7]
add = 255-32*time,255-32*time,255-32*time
time = 1

[state 900]
type = PlaySND
trigger1 = Time=0
value = 2500,0

[state 2000]
type = HitBy
trigger1 = Time=[0,13]
value = ,AT

[state 900]
type = StatetypeSet
trigger1 = AnimElem=5
physics = N

;現在の速度取得
[state 900]
type = VarSet
trigger1 = AnimElem=5
fvar(8) = 6.0

[state 900]
type = VarSet
trigger1 = AnimElem=5,>0
fvar(8) = fvar(8)*.9

[state 900]
type = VarSet
trigger1 = !time
trigger2 = AnimElem=7
fvar(8) = 0

[state -2]
type = velset
trigger1 = animelem=5,>0 && !(fvar(5) && !fvar(7)&&(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5))
x = fvar(8)+fvar(9)

;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = AnimElem=5
damage = floor(ifelse(40*fvar(0)<1,1+(var(2)%5=4),40*fvar(0))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 15,14
ground.velocity = -18*const(size.xscale),-5*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -18*const(size.xscale),ifelse(var(6)%2>=1,2,-5*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = High
ground.type = High
attr = S,NA
hitflag = MAFD
guardflag = M
kill = 0
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=6
value = 0

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&hitpausetime=ifelse(var(49)&&var(2)=1,14,12)
fvar(15) = .00005*floor(ifelse(40*fvar(14)<1,1+(var(2)%5=1),40*fvar(14))*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(16) = 1
persistent=0

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=6,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5&&AnimElem=6,<0
var(18) = floor(-180*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = var(1)%2<1&&var(1)%8<4&&target,time=0
fvar(5) = (-15.0*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.1))*const(size.xscale)
ignorehitpause=1

;ヒットバック量取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2>=1||var(1)%8>=4)&&target,time=1
fvar(5) = (-15.0*1.25*((enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5||var(1)%8>=4)&&fvar(10)<=0)*(1.0+ifelse(var(2)>=32,31,var(2)-1)*.050))*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,18,20+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = (movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
;・・・・・・・・

[state 2000]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;電磁形態
[statedef 3000]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3000

[state 200]
type = ChangeAnim
trigger1 = Time=2&&AnimElemNo(0)=5
value = 3000
elem = 6

;~~~~攻撃形態中
[state -2]
type = Explod
trigger1 = !time&&var(36)%2<1&&var(10)&&(var(40)=-2||var(40)>0)
id = 6170
anim = 6175
pos = floor(180*const(size.xscale)),floor(-240*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state -2]
type = Explod
trigger1 = !time&&var(36)%4<2&&var(10)&&(var(40)=-2||var(40)>0) && floor(var(43)/1000)>=100
id = 6171
anim = 6175
pos = floor(0*const(size.xscale)),floor(-400*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state -2]
type = Explod
trigger1 = !time&&var(36)%8<4&&var(10)&&(var(40)=-2||var(40)>0) && floor(var(43)/1000)>=50
id = 6172
anim = 6175
pos = floor(-180*const(size.xscale)),floor(-240*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state 200]
type = VarSet
trigger1 = Time=0
var(10) = 0
;~~~~

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper&&(prevstateno!=[5000,5099])
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=13

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = 1
var(9)=ifelse((var(9)=[1,999]),420-var(9),420)

[state 200]
type = null;NotHitBy
trigger1 = !IsHelper&&AnimElem=11
value = SCA
time=34

[state 200]
type = pause
trigger1 = !IsHelper&&AnimElem=11
time = 42
movetime = 42

[state 200]
type = NotHitBy
trigger1 = P2movetype=A&&inguarddist&&(prevstateno!=[5000,5099])&&!IsHelper&&AnimElem=11
value = SCA
time=42

[state 200]
type = helper
trigger1 = !IsHelper&&AnimElem=11
id = 7560
stateno = 7560
pos = 0,floor(-260*const(size.yscale))
postype = P1
pausemovetime=38+999
ownpal = 1

[state -2]
type = poweradd
trigger1 = !IsHelper&&(prevstateno!=[5000,5099])&&AnimElem=11
value = -1000
persistent=0

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)
var(46) = 1

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=1&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[1,3]
value = 3000
elem = 1

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=2&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[4,6]
value = 3000
elem = 2

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=3&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[7,9]
value = 3000
elem = 3

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=4&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[10,12]
value = 3000
elem = 4

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=5&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[13,15]
value = 3000
elem = 5

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=6&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[16,18]
value = 3000
elem = 6

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=7&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[19,20]
value = 3000
elem = 7

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=8&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[21,23]
value = 3000
elem = 8

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=9&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[24,26]
value = 3000
elem = 9

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=10&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[27,30]
value = 3000
elem = 10

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=11&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[31,72]
value = 3000
elem = 11

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=12&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[73,76]
value = 3000
elem = 12

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=13&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[77,80]
value = 3000
elem = 13

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=14&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[81,84]
value = 3000
elem = 14

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=15&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[85,88]
value = 3000
elem = 15

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=16&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[89,92]
value = 3000
elem = 16

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=17&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[93,96]
value = 3000
elem = 17

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=18&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[97,100]
value = 3000
elem = 18

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=19&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[101,104]
value = 3000
elem = 19

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=20&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[105,108]
value = 3000
elem = 20

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=21&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[109,112]
value = 3000
elem = 21

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=22&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[113,116]
value = 3000
elem = 22

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=23&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[117,120]
value = 3000
elem = 23

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=24&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[121,123]
value = 3000
elem = 24

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=25&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[124,127]
value = 3000
elem = 25

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=26&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[128,131]
value = 3000
elem = 26

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=27&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[132,135]
value = 3000
elem = 27

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=28&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[136,138]
value = 3000
elem = 28

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=29&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[139,141]
value = 3000
elem = 29

[state 1610]
type = null;ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = anim
elem = AnimElemNo(0)

[state 1610]
type = PosFreeze
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = 1


[state 200]
type = helper
trigger1 = !IsHelper&&AnimElem=11,=40
id = 6300
stateno = 6300
pos = 0,floor(-220*const(size.yscale))
postype = P1
pausemovetime=4
size.xscale = const(size.xscale)*2
size.yscale = const(size.xscale)*2

[state 200]
type = helper
trigger1 = !IsHelper&&AnimElem=11,=40
id = 6310
stateno = 6310
pos = 320,0
postype = P1
pausemovetime=4
size.xscale = const(size.xscale)
size.yscale = const(size.xscale)
size.ground.fwd = 30
size.ground.back = 0
size.height = 240

[state 200]
type = helper
trigger1 = !IsHelper&&AnimElem=11,=40
id = 6315
stateno = 6310
pos = -320,0
postype = P1
pausemovetime=4
size.xscale = const(size.xscale)
size.yscale = const(size.xscale)
size.ground.fwd = 0
size.ground.back = 30
size.height = 240

[State 40, 1]
type = PlaySND
trigger1 = AnimElem=12
value = 20,18
;channel = 10
;volume = 128

[state 200]
type = AttackDist
trigger1 = AnimElem=16
value = 0

;強制停止中に動かないように
[state -2]
type = PosFreeze
trigger1 = (AnimElem=11)
trigger2 = NumHelper(7560)
trigger2 = helper(7560),time<30
value = 1

[state 200]
type = VarSet
trigger1 = AnimTime=-1&&var(12)
var(12) = -1

[state 200]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;飛び道具
[statedef 6300]
type = S
movetype=A
physiscs = S
ctrl = 0
anim = 6300
sprpriority = 4

[state 6300]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6300]
type = ChangeAnim
trigger1 = var(5)>=51
value = 90000

[state 6300]
type = AngleDraw
trigger1 = var(5)<8
scale = const(size.xscale)*(var(5)*.1+.3),const(size.yscale)*(var(5)*.1+.3)

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = !(root,anim=3110&&root,animelemtime(3)>=0&&root,animelemtime(4)<0)
trigger1 = var(5)=0
trigger2 = var(5)=4
trigger3 = var(5)=8
trigger4 = var(5)=12
trigger5 = var(5)=16
trigger6 = var(5)=20
trigger7 = var(5)=24
trigger8 = var(5)=28
trigger9 = var(5)=32
trigger10 = var(5)=36
trigger11 = var(5)=40
trigger12 = var(5)=44
trigger13 = var(5)=48
damage = floor(ifelse(root,fvar(21),30,24+(uniqhitcount>=4)*4)*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)*1.22),floor(ceil(ifelse(root,fvar(21),30,24)*root,fvar(3)*root,fvar(4)/ifelse(root,fvar(21),6,5))*1.22)
ground.slidetime = 20+(P2statetype=C)+root,var(49)*7
ground.hittime = 20+(P2statetype=C)+root,var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -6*root,const(size.xscale),-8*root,const(size.yscale)
guard.velocity = -15.0*root,const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -6*root,const(size.xscale),ifelse(root,var(6),4,-8)*root,const(size.yscale)
airguard.velocity = -6*root,const(size.xscale),-2*root,const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*root,const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower =  0,0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HP
hitflag = MAFD
guardflag = MA
sprpriority = 4
palfx.time=32+14
palfx.sinadd = 32,0,32,4
palfx.color = 0
palfx.add = 64,0,128
palfx.mul = 256,256,256

;KO
[state 3500]
type = explod
trigger1 = WinKO && !numexplod(60000)
id = 60000
anim = 90000
name="ko"
ownpal = 1
removetime=-1
facing=facing
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1&&hitpausetime=0
fvar(15) = .00005*floor(ifelse(root,fvar(21),30,24+(Time=[18,50])*2)*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = var(5)=[0,51]
var(16) = 10+random%6
persistent=4

;X座標
[state 240]
type = VarSet
trigger1 = var(5)=[0,51]
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10
ignorehitpause=1

;Y座標
[state 240]
type = VarSet
trigger1 = var(5)=[0,51]
var(18) = floor(70*const(size.yscale))
ignorehitpause=1

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

[state 6300]
type = ParentVarAdd
trigger1 = movehit=1
ignorehitpause=1
var(2) = 1

[state 6300]
type = ParentVarAdd
trigger1 = movehit=1
ignorehitpause=1
var(3) = 1

[state 6300]
type = BindtoRoot
trigger1 = 1
pos = 0,floor(-220*const(size.yscale)*.5)
ignorehitpause=1

[state 200]
type = varadd
trigger1 = 1
var(5) = 1

[state 6300]
type = DestroySelf
trigger1 = var(5)>=71&&!NumHelper(6305)

;飛び道具(電磁突進)
[statedef 6305]
type = S
movetype=A
physiscs = S
ctrl = 0
anim = 6300
sprpriority = 4

[state 6300]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6300]
type = AngleDraw
trigger1 = time<10
scale = const(size.xscale)*time*.1,const(size.yscale)*time*.1

;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = Time=0
trigger2 = Time=4
trigger3 = Time=8
trigger4 = Time=12
trigger5 = Time=16
trigger6 = Time=20
trigger7 = Time=24
trigger8 = Time=28
trigger9 = Time=32
trigger10 = Time=36
trigger11 = Time=40
trigger12 = Time=44
trigger13 = Time=48
damage = floor(ifelse(root,fvar(21),30,24)*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)*1.22),floor(ceil(ifelse(root,fvar(21),30,24)*root,fvar(3)*root,fvar(4)/ifelse(root,fvar(21),6,5))*1.22)
ground.slidetime = 20+(P2statetype=C)+root,var(49)*7
ground.hittime = 20+(P2statetype=C)+root,var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -6*root,const(size.xscale),-8*root,const(size.yscale)
guard.velocity = -15.0*root,const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = -6*root,const(size.xscale),ifelse(root,var(6),4,-8)*root,const(size.yscale)
airguard.velocity = -6*root,const(size.xscale),-2*root,const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*root,const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = 0,0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HP
hitflag = MAFD
guardflag = MA
sprpriority = 4
palfx.time=32+14
palfx.sinadd = 32,0,32,4
palfx.color = 0
palfx.add = 64,0,128
palfx.mul = 256,256,256

;KO
[state 3500]
type = explod
trigger1 = WinKO && !numexplod(60000)
id = 60000
anim = 90000
name="ko"
ownpal = 1
removetime=-1
facing=facing
ignorehitpause=1

;壁コンボ解除
[state -1]
type = parentvaradd
trigger1 = (root,var(1)%2>=1||root,var(1)%8>=4)&&numtarget
trigger1 = movehit=1 && target,time=0
var(1) = ifelse(root,var(1)%8>=4,-4,-1)
ignorehitpause=1

;ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
var(2) = 1
persistent=0
ignorehitpause=1

;空中ヒット数補正増加
[state 12000]
type = ParentVarAdd
trigger1 = movehit=1&&numtarget
trigger1 = target,statetype=A||target,statetype=L
var(3) = 1
persistent=0
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = parentvaradd
trigger1 = movehit=1&&hitpausetime=0
fvar(15) = .00005*floor(ifelse(root,fvar(21),30,24)*ifelse(root,fvar(1)<.25,.25,root,fvar(1))*root,fvar(2)*root,fvar(3)*root,fvar(4)*1.22)
ignorehitpause=1

[state -2]
type = parentvarset
trigger1 = movehit=1
fvar(14) = root,fvar(1)*root,fvar(2)*root,fvar(3)*root,fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = Time=[0,51]
var(16) = 10+random%6

;X座標
[state 240]
type = VarSet
trigger1 = Time=[0,51]
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)+10
ignorehitpause=1

;Y座標
[state 240]
type = VarSet
trigger1 = Time=[0,51]
var(18) = floor(70*const(size.yscale))
ignorehitpause=1

;ヒットスパーク
[state 1000]
type = Helper
triggerall = movecontact=1
trigger1 = numtarget
trigger1 = target,time=0&&(target,stateno=150||target,stateno=152||target,stateno=154||target,stateno=5000||target,stateno=5010||target,stateno=5020||target,stateno=5070||target,stateno=5080)
trigger2 = movetype=H
trigger3 = !numtarget && P2movetype=A&&(enemynear,prevstateno=5000||enemynear,prevstateno=5010||enemynear,prevstateno=5020||enemynear,prevstateno=5070||enemynear,prevstateno=5080)&&enemynear,time=1
id = 7000
stateno=7000+(movehit)*100
pos = var(17),var(18)
postype = p1
ignorehitpause=1
pausemovetime=99999
supermovetime=99999
size.xscale = .5
size.yscale = .5

[state 6300]
type = ParentVarAdd
trigger1 = movehit=1
ignorehitpause=1
var(2) = 1

[state 6300]
type = ParentVarAdd
trigger1 = movehit=1
ignorehitpause=1
var(3) = 1

[state 6300]
type = BindtoRoot
trigger1 = 1
pos = floor(20*const(size.xscale)*.5),floor(-220*const(size.yscale)*.5)
ignorehitpause=1

[state 6300]
type = DestroySelf
trigger1 = Time>=51

;押し合い判定
[statedef 6310]
type = S
movetype=I
physiscs = N
ctrl = 0
anim = 6310
sprpriority = 4

[state 6310]
type = VelSet
trigger1 = Time
x = -7.00*ifelse(IsHelper(6315),-1,1)

[state 6310]
type = VelAdd
trigger1 = Time>1
x = -.7*ifelse(IsHelper(6315),-1,1)

[state 6310]
type = NotHitBy
trigger1 = 1
value = SCA

[state 6310]
type = PlayerPush
trigger1 = 1
value = 1

[state 6310]
type = PosSet
trigger1 = !Time&&IsHelper(6310)
x = floor(enemynear,pos x)

[state 6310]
type = PosAdd
trigger1 = !Time&&IsHelper(6310)
x = 20

[state 6310]
type = ScreenBound
trigger1 = 1
value = 0

[state 6300]
type = DestroySelf
trigger1 = Root,Stateno!=3000
trigger2 = Root,Stateno=3000 && root,animelemTime(25)>=0
trigger3 = (rootDist X=[-140+(P2statetype=L&&enemynear,alive)*60,140-(P2statetype=L&&enemynear,alive)*60])

;突進形態
[statedef 3100]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0
movehitpersist=1

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||prevstateno=310||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3100

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=2
value = 3100
elem = 3

;~~~~攻撃形態中
[state 1050]
type = varset
trigger1 = !time&&var(10)
var(7) = -1

[state -2]
type = Explod
trigger1 = !time&&var(36)%2<1&&var(10)&&(var(40)=-2||var(40)>0)
id = 6170
anim = 6175
pos = floor(180*const(size.xscale)),floor(-240*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state -2]
type = Explod
trigger1 = !time&&var(36)%4<2&&var(10)&&(var(40)=-2||var(40)>0) && floor(var(43)/1000)>=100
id = 6171
anim = 6175
pos = floor(0*const(size.xscale)),floor(-400*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state -2]
type = Explod
trigger1 = !time&&var(36)%8<4&&var(10)&&(var(40)=-2||var(40)>0) && floor(var(43)/1000)>=50
id = 6172
anim = 6175
pos = floor(-180*const(size.xscale)),floor(-240*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state 200]
type = VarSet
trigger1 = Time=0
var(10) = 0
;~~~~

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper&&(prevstateno!=[5000,5099])
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=11

;攻撃発生中のガードポイント
[state 200]
type = HitBy
trigger1 = var(32)&&Time<=1&&(prevstateno!=[5000,5099])
value = ,AT

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

[state 200]
type = HitAdd
trigger1 = !IsHelper
trigger1 = movehit=1&&var(19)>=2
trigger2 = IsHelper
trigger2 = movehit=1&&root,var(19)>=2
value = 1
ignorehitpause=1
persistent=0

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = 1
var(9)=ifelse((var(9)=[1,999]),420-var(9),420)

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&AnimElem=3
value = SCA
time=46

[state 200]
type = pause
trigger1 = !IsHelper&&AnimElem=3
time = 46
movetime = 46

[state 200]
type = helper
trigger1 = !IsHelper&&AnimElem=3
id = 7560
stateno = 7560
pos = floor(-80*const(size.yscale)),floor(-180*const(size.yscale))
postype = P1
pausemovetime=46+999
ownpal = 1

[state -2]
type = poweradd
trigger1 = !IsHelper&&(prevstateno!=[5000,5099])&&AnimElem=3
value = -1000
persistent=0

[state 200]
type = NotHitBy
trigger1 = P2movetype=A&&inguarddist&&(prevstateno!=[5000,5099])&&!IsHelper&&AnimElem=3
value = SCA
time=46

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&AnimElem=3,=45
value = SCA
time = 48

;援軍アシスト
[state 3000]
type = VarSet
triggerall = (var(40)=1||(var(40)=[5,6]))&&Power>=1000&&AnimElemTime(3)>=1&&AnimElemTime(10)<3
trigger1 = command="a"&&!var(59)
trigger2 = (enemynear,life=[80,140])&&animelemtime(4)>=0&&animelemtime(6)<=0&&ifelse(facing=1,helper(30000),pos x-enemynear,pos x,-(helper(30005),pos x-enemynear,pos x))>=(60+enemynear,const(size.air.front))
trigger2 = random%3=0&&var(59)
var(40) = 7
ignorehitpause=1

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)&&!(var(52)>0&&movecontact)
var(46) = 1

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=1&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[1,5]
value = 3100
elem = 1

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=2&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[6,11]
value = 3100
elem = 2

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=3&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[12,59]
value = 3100
elem = 3

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=4&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[60,63]
value = 3100
elem = 4

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=5&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[64,67]
value = 3100
elem = 5

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=6&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[68,71]
value = 3100
elem = 6

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=7&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[72,75]
value = 3100
elem = 7

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=8&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[76,79]
value = 3100
elem = 8

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=9&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[80,83]
value = 3100
elem = 9

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=10&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[84,88]
value = 3100
elem = 10

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=11&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[89,91]
value = 3100
elem = 11

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=12&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[92,94]
value = 3100
elem = 12

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=13&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[95,97]
value = 3100
elem = 13

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=14&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[98,100]
value = 3100
elem = 14

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=15&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[101,106]
value = 3100
elem = 15

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=16&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[107,128]
value = 3100
elem = 16

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=17&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[129,133]
value = 3100
elem = 17

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=18&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[134,138]
value = 3100
elem = 18

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=19&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[139,143]
value = 3100
elem = 19

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=20&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[144,148]
value = 3100
elem = 20

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=21&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[149,153]
value = 3100
elem = 21

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=17&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[154,158]
value = 3100
elem = 22

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = anim
elem = AnimElemNo(0)

[state 1610]
type = PosFreeze
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = 1


[state 200]
type = VarSet
trigger1 = !IsHelper&&!Time
fvar(8) = 0

[state 200]
type = VarSet
trigger1 = !IsHelper&&AnimElem=4,>0&&AnimElem=5,<=0
fvar(8) = 8.0

[state 200]
type = VarSet
trigger1 = !IsHelper&&AnimElem=5,>0
fvar(8) = fvar(8)*.9

[state 200]
type = StatetypeSet
trigger1 = !IsHelper&&AnimElem=4,>0&&AnimElem=11,<0
physics = N

[state 200]
type = VelSet
trigger1 = !IsHelper&&AnimElem=4,>0
x = fvar(8)+ifelse(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5,fvar(5),0)

[state 6150]
type = Explod
trigger1 = AnimElem=5
trigger2 = AnimElem=5,=3
trigger3 = AnimElem=6
trigger4 = AnimElem=6,=3
trigger5 = AnimElem=7
trigger6 = AnimElem=7,=3
id = 6115
anim=6115
pos = floor(-180*const(size.xscale)),floor(-60*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[State 40, 1]
type = PlaySND
trigger1 = AnimElem=5
trigger2 = AnimElem=5,=3
trigger3 = AnimElem=6
trigger4 = AnimElem=6,=3
trigger5 = AnimElem=7
trigger6 = AnimElem=7,=3
value = 20,2
;channel = 10
;volume = 128

[State 40, 1]
type = PlaySND
trigger1 = AnimElem=15
value = 20,13
;channel = 10
;volume = 128

[state 190]
type = Explod
trigger1 = AnimElem=5
trigger2 = AnimElem=6&&movecontact
trigger3 = AnimElem=7
trigger4 = AnimElem=8&&movecontact
trigger5 = AnimElem=9
trigger6 = AnimElem=10&&movecontact
id = 6400
anim = 6400
pos = floor(190*const(size.xscale)),floor(-50*const(size.yscale));floor(300*const(size.xscale)),floor(-50*const(size.yscale))
postype = P1
sprpriority = 3
scale = const(size.xscale),const(size.yscale)
removetime=12;-1
removeongethit=1

[state 190]
type = Explod
trigger1 = AnimElem=5,=3
trigger2 = AnimElem=6,=3&&movecontact
trigger3 = AnimElem=7,=3
trigger4 = AnimElem=8,=3&&movecontact
trigger5 = AnimElem=9,=3
trigger6 = AnimElem=10,=3&&movecontact
id = 6400
anim = 6400
pos = floor(80*const(size.xscale)),floor(-50*const(size.yscale))
postype = P1
sprpriority = 3
scale = const(size.xscale),const(size.yscale)
removetime=12;-1
removeongethit=1


[state 190]
type = Explod
trigger1 = AnimElem=5
id = 6050
anim = 6050
pos = floor(45*const(size.xscale)),0
postype = P1
sprpriority = 3
bindtime=-1
scale = const(size.xscale)*1.5,const(size.yscale)*1.5

[state 190]
type = Explod
trigger1 = AnimElem=5
id = 6050
anim = 6050
pos = floor(-150*const(size.xscale)),0
postype = P1
sprpriority = 3
bindtime=-1
scale = const(size.xscale)*1.5,const(size.yscale)*1.5

[state 190]
type = null;RemoveExplod
trigger1 = AnimElem=11
id = 6400

;KO
[state 3500]
type = explod
trigger1 = WinKO && !numexplod(60000)
id = 60000
anim = 90000
name="ko"
ownpal = 1
removetime=-1
facing=facing
ignorehitpause=1

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = !time
var(52) = 0
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = AnimElem=5
trigger2 = AnimElem=6
trigger3 = AnimElem=7
trigger4 = AnimElem=8
trigger5 = AnimElem=9
trigger6 = AnimElem=10
damage = floor(ifelse(fvar(21),34*ifelse(fvar(1)<.25,.25,fvar(1)),17)*fvar(2)*fvar(3)*fvar(4)*1.22),floor(ceil(ifelse(fvar(21),34*ifelse(fvar(1)<.25,.25,fvar(1)),17)*fvar(3)*fvar(4)/ifelse(fvar(21),6,4))*1.22)
ground.slidetime = 17+(P2statetype=C)+var(49)*7
ground.hittime = 17+(P2statetype=C)+var(49)*7
guard.slidetime = 15
guard.hittime = 15
pausetime = 4,ifelse((AnimElem=10),3,6)
ground.velocity = -6*const(size.xscale),-10*const(size.yscale)
guard.velocity = -13.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%2>=1||var(1)%8>=4,-11.0-.0005,-6.0*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,-10*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,10)
guardsound = s7000,4
getpower = 0,0
givepower = 0,0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-130*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = M

;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = AnimElem=15
damage = floor(ifelse(fvar(21),72,52)*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*1.22),floor(ceil(ifelse(fvar(21),72,52)*fvar(3)*fvar(4)/ifelse(fvar(21),6,4))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 15,14
ground.velocity = -8*const(size.xscale),-11*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%2>=1||var(1)%8>=4||var(6)%10=0,-11.0-.0005,-8.0*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,-10*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,9+random%2)
guardsound = s7000,4
getpower = 0,0
givepower = 0,0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = M

;=====攻撃形態時
[state 1050]
type = varset
trigger1 = var(7)>0
var(7) = -1

[state 1050]
type = varset
triggerall = AnimElemTime(5)>=0&&AnimElemTime(10)<=3 && var(7)!=0 && var(50)<3
trigger1 = command="z"&&!var(59)
trigger2 = (teammode=simul)&&var(59)&&random%7=0
var(7) = 1

[state 1050]
type = varset
trigger1 = AnimElemTime(5)=0&&(prevstateno!=[5000,5099])
var(50) = 0

[state 1050]
type = varadd
triggerall = AnimElemTime(5)>=0&&AnimElemTime(10)<=3 && var(7)=1
trigger1 = var(7)=1
var(50) = 1

[state 1050]
type = playsnd
trigger1 = AnimElemTime(5)>=0&&AnimElemTime(10)<=3 && var(7)=1
value = 20,15
;channel = 10
;volume = 128

[state 6150]
type = Explod
trigger1 = AnimElemTime(5)>=0&&AnimElemTime(10)<=3 && var(7)=1
id = 6150
anim=6150
pos = floor(30*const(size.xscale)),floor(-300*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale)*2,const(size.yscale)*2
pausemovetime=ifelse(AnimElemTime(4)<0,AnimElemTime(3),0)

[state 1000]
type = Helper
trigger1 = AnimElemTime(5)>=0&&AnimElemTime(10)<=3 && var(7)=1 && (!NumHelper(6101)||!NumHelper(6103)||!NumHelper(6105))&&numhelper(6100)&&numhelper(6102)&&numhelper(6104)
id = 6101+(NumHelper(6101))*2+(NumHelper(6103))*2
stateno = 6100
pos = floor(30*const(size.xscale)),floor(-300*const(size.yscale))
postype = P1
ownpal = 1
pausemovetime=ifelse(AnimElemTime(4)<0,AnimElemTime(3),0)

[state 1000]
type = Helper
trigger1 = AnimElemTime(5)>=0&&AnimElemTime(10)<=3 && var(7)=1 && (!NumHelper(6100)||!NumHelper(6102)||!NumHelper(6104))
id = 6100+(NumHelper(6100))*2+(NumHelper(6102))*2
stateno = 6100
pos = floor(30*const(size.xscale)),floor(-300*const(size.yscale))
postype = P1
ownpal = 1
pausemovetime=ifelse(AnimElemTime(4)<0,AnimElemTime(3),0)

;==壁ダウンに
[state 920]
type = varadd
trigger1 = AnimElem=15,>=0&&(movehit=[1,5])&&numtarget&&!var(6) && var(1)%2<1
trigger1 = target,time=0
var(1) = 1-(var(1)%16>=8&&var(1)%8>=4)*4
ignorehitpause=1
persistent=0

[state 920]
type = TargetState
trigger1 = AnimElem=15,>=0&&(movehit=[1,5])&&numtarget&&!var(6)
trigger1 = target,time=0
value = 926
ignorehitpause=1
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=16
value = 0

;強制停止中に動かないように
[state -2]
type = PosFreeze
trigger1 = (AnimElem=3)
trigger2 = NumHelper(7560)
trigger2 = helper(7560),time<30
value = 1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&hitpausetime=ifelse(AnimElem=15,>=0,14,2)
fvar(15) = .00005*ifelse(AnimElem=15,>=0,floor(ifelse(ifelse(fvar(21),72,52)*fvar(14)<1,1+(var(2)%5=1),ifelse(fvar(21),72,52)*fvar(14))*1.22),floor(ifelse(fvar(21),34*fvar(1),17)*fvar(2)*1.22))
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
trigger2 = AnimElem=6
trigger3 = AnimElem=7
trigger4 = AnimElem=8
trigger5 = AnimElem=9
trigger6 = AnimElem=10
trigger7 = AnimElem=15
var(16) = 10+random%6

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=10,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(18) = floor(-130*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=15
var(18) = floor(-180*const(size.yscale))

;・・・・自分側ヒットバック・・・・

;ヒットバック量取得
[state -2]
type = varset
triggerall = animelemtime(15)>=0&&(movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = target,time=0
fvar(5) = ifelse(movehit,-15.0*1.5,-15.0)*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = animelemtime(15)>=0&&(movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = animelemtime(15)>=0&&(movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
persistent=0
;・・・・・・・・

[state 200]
type = VarSet
trigger1 = AnimTime=-1&&var(12)
var(12) = -1

[state 200]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;突進形態（電磁形態派生）
[statedef 3110]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3110

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=1
value = 3110
elem = 2

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper&&(prevstateno!=[5000,5099])
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=11

;攻撃発生中のガードポイント
[state 200]
type = HitBy
trigger1 = var(32)&&Time<=1&&(prevstateno!=[5000,5099])
value = ,AT

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = 1
var(9)=ifelse((var(9)=[1,999]),420-var(9),420)

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&AnimElem=3
value = SCA
time=40

[state 200]
type = pause
trigger1 = !IsHelper&&AnimElem=3
time = 40
movetime = 40

[state 200]
type = helper
trigger1 = !IsHelper&&AnimElem=3
id = 7560
stateno = 7560
pos = floor(-80*const(size.yscale)),floor(-180*const(size.yscale))
postype = P1
pausemovetime=40+999
ownpal = 1

[state -2]
type = poweradd
trigger1 = !IsHelper&&(prevstateno!=[5000,5099])&&AnimElem=3
value = -1000
persistent=0

[state 200]
type = NotHitBy
trigger1 = P2movetype=A&&inguarddist&&(prevstateno!=[5000,5099])&&!IsHelper&&AnimElem=3
value = SCA
time=40

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&AnimElem=3,=40
value = SCA
time = 48

;援軍アシスト
[state 3000]
type = VarSet
triggerall = (var(40)=1||(var(40)=[5,6]))&&Power>=1000&&AnimElemTime(3)>=1&&AnimElemTime(10)<3
trigger1 = command="a"&&!var(59)
trigger2 = (enemynear,life=[80,140])&&animelemtime(4)>=0&&animelemtime(6)<=0&&ifelse(facing=1,helper(30000),pos x-enemynear,pos x,-(helper(30005),pos x-enemynear,pos x))>=(60+enemynear,const(size.air.front))
trigger2 = random%3=0&&var(59)
var(40) = 7
ignorehitpause=1

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)&&!(var(52)>0&&movecontact)
var(46) = 1

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=1&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[1,11]
value = 3110
elem = 1

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=2&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[12,17]
value = 3110
elem = 2

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=3&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[18,65]
value = 3110
elem = 3

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=4&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[66,69]
value = 3110
elem = 4

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=5&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[70,73]
value = 3110
elem = 5

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=6&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[74,77]
value = 3110
elem = 6

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=7&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[78,81]
value = 3110
elem = 7

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=8&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[82,85]
value = 3110
elem = 8

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=9&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[86,89]
value = 3110
elem = 9

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=10&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[90,94]
value = 3110
elem = 10

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=11&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[95,97]
value = 3110
elem = 11

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=12&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[98,100]
value = 3110
elem = 12

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=13&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[101,103]
value = 3110
elem = 13

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=14&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[104,106]
value = 3110
elem = 14

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=15&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[107,112]
value = 3110
elem = 15

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=16&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[113,134]
value = 3110
elem = 16

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=17&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[135,139]
value = 3110
elem = 17

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=18&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[140,144]
value = 3110
elem = 18

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=19&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[145,149]
value = 3110
elem = 19

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=20&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[150,154]
value = 3110
elem = 20

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=21&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[155,159]
value = 3110
elem = 21

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=22&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[160,164]
value = 3110
elem = 22

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = anim
elem = AnimElemNo(0)

[state 1610]
type = PosFreeze
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = 1


[state 200]
type = VarSet
trigger1 = !IsHelper&&!Time
fvar(8) = 0

[state 200]
type = VarSet
trigger1 = !IsHelper&&AnimElem=4,>0&&AnimElem=5,<=0
fvar(8) = 4.0

[state 200]
type = VarSet
trigger1 = !IsHelper&&AnimElem=5,>0
fvar(8) = fvar(8)*.7

[state 200]
type = StatetypeSet
trigger1 = !IsHelper&&AnimElem=4,>0&&AnimElem=11,<0
physics = N

[state 200]
type = VelSet
trigger1 = !IsHelper&&AnimElem=4,>0
x = fvar(8)+ifelse(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5,fvar(5),0)

[State 40, 1]
type = PlaySND
trigger1 = AnimElem=5
trigger2 = AnimElem=5,=3
trigger3 = AnimElem=6
trigger4 = AnimElem=6,=3
trigger5 = AnimElem=7
trigger6 = AnimElem=7,=3
value = 20,2
;channel = 10
;volume = 128

[State 40, 1]
type = PlaySND
trigger1 = AnimElem=15
value = 20,13
;channel = 10
;volume = 128

[state 200]
type = helper
trigger1 = !IsHelper&&AnimElem=3,=46
id = 6305
stateno = 6305
pos = floor(20*const(size.xscale)),floor(-220*const(size.yscale))
postype = P1
pausemovetime=20
size.xscale = const(size.xscale)*2
size.yscale = const(size.xscale)*2

[state 190]
type = Explod
trigger1 = AnimElem=5
trigger2 = AnimElem=6&&movecontact
trigger3 = AnimElem=7
trigger4 = AnimElem=8&&movecontact
trigger5 = AnimElem=9
trigger6 = AnimElem=10&&movecontact
id = 6400
anim = 6400
pos = floor(190*const(size.xscale)),floor(-50*const(size.yscale));floor(300*const(size.xscale)),floor(-50*const(size.yscale))
postype = P1
sprpriority = 3
scale = const(size.xscale),const(size.yscale)
removetime=12;-1
removeongethit=1

[state 190]
type = Explod
trigger1 = AnimElem=5,=3
trigger2 = AnimElem=6,=3&&movecontact
trigger3 = AnimElem=7,=3
trigger4 = AnimElem=8,=3&&movecontact
trigger5 = AnimElem=9,=3
trigger6 = AnimElem=10,=3&&movecontact
id = 6400
anim = 6400
pos = floor(80*const(size.xscale)),floor(-50*const(size.yscale))
postype = P1
sprpriority = 3
scale = const(size.xscale),const(size.yscale)
removetime=12;-1
removeongethit=1

[state 190]
type = null;RemoveExplod
trigger1 = AnimElem=11
id = 6400

;KO
[state 3500]
type = explod
trigger1 = WinKO && !numexplod(60000)
id = 60000
anim = 90000
name="ko"
ownpal = 1
removetime=-1
facing=facing
ignorehitpause=1

;~~~自分側のhitpause作成~~
[state 200]
type = MoveHitReset
trigger1 = AnimElem=5
trigger2 = AnimElem=6
trigger3 = AnimElem=7
trigger4 = AnimElem=8
trigger5 = AnimElem=9
trigger6 = AnimElem=10

[state 250]
type = varset
trigger1 = time=0
trigger2 = AnimElem=5
trigger3 = AnimElem=6
trigger4 = AnimElem=7
trigger5 = AnimElem=8
trigger6 = AnimElem=9
trigger7 = AnimElem=10
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = ifelse(animelemtime(15)>=0,14,2)

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = (movecontact||var(19)) && var(52)>var(54) && var(52)<100 && time
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&(movecontact||var(19))
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
triggerall = (var(52)<=0||!movecontact)
trigger1 = AnimElem=5
trigger2 = AnimElem=6
trigger3 = AnimElem=7
trigger4 = AnimElem=8
trigger5 = AnimElem=9
trigger6 = AnimElem=10
damage = floor(ifelse(fvar(21),34*ifelse(fvar(1)<.25,.25,fvar(1)),17)*fvar(2)*fvar(3)*fvar(4)*1.22)
ground.slidetime = 17+(P2statetype=C)+var(49)*7
ground.hittime = 17+(P2statetype=C)+var(49)*7
guard.slidetime = 15
guard.hittime = 15
pausetime = 1,2
ground.velocity = -6*const(size.xscale),-10*const(size.yscale)
guard.velocity = -13.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%2>=1||var(1)%8>=4,-11.0-.0005,-6.0*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,-10*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,9+random%2)
guardsound = s7000,4
getpower = 0,0
givepower = 0,0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-130*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = M

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = (var(52)<=0||!movecontact)
trigger1 = AnimElem=15
damage = floor(ifelse(fvar(21),72,52)*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*1.22),floor(ifelse(fvar(21),72,52)*fvar(3)*fvar(4)/ifelse(fvar(21),6,4)*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = -8*const(size.xscale),-10*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%2>=1||var(1)%8>=4,-11.0-.0005,-8.0*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,-10*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,9+random%2)
guardsound = s7000,4
getpower = 0,0
givepower = 0,0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = M

;==壁ダウンに
[state 920]
type = varadd
trigger1 = AnimElem=15,>=0&&(movehit=[1,5])&&numtarget&&!var(6) && var(1)%2<1
trigger1 = target,time=0
var(1) = 11-(var(1)%16>=8&&var(1)%8>=4)*4
ignorehitpause=1
persistent=0

[state 920]
type = TargetState
trigger1 = AnimElem=15,>=0&&(movehit=[1,5])&&numtarget&&!var(6)
trigger1 = target,time=0
value = 926
ignorehitpause=1
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=16
value = 0

;強制停止中に動かないように
[state -2]
type = PosFreeze
trigger1 = (AnimElem=3)
trigger2 = NumHelper(7560)
trigger2 = helper(7560),time<30
value = 1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
trigger1 = movehit=1&&hitpausetime=ifelse(AnimElem=15,>=0,14,2)
fvar(15) = .00005*ifelse(AnimElem=15,>=0,floor(ifelse(fvar(21),72,52)*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*1.22),floor(ifelse(fvar(21),34*ifelse(fvar(1)<.25,.25,fvar(1)),17)*fvar(2)*fvar(3)*fvar(4)*1.22))
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
trigger2 = AnimElem=6
trigger3 = AnimElem=7
trigger4 = AnimElem=8
trigger5 = AnimElem=9
trigger6 = AnimElem=10
trigger7 = AnimElem=15
var(16) = 10+random%6

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=10,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(18) = floor(-130*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=15
var(18) = floor(-180*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = animelemtime(15)>=0&&(movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = target,time=0
fvar(5) = ifelse(movehit,-15.0*1.5,-15.0)*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = animelemtime(15)>=0&&(movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = animelemtime(15)>=0&&(movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
persistent=0
;・・・・・・・・

[state 200]
type = VarSet
trigger1 = AnimTime=-1&&var(12)
var(12) = -1

[state 200]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1


;突進形態(飛行形態派生)
[statedef 3120]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0

[state 3120]
type = PosSet
trigger1 = !time
y = 0

;先行入力処理リセット
[state 200]
type = VarSet
trigger1 = !Time
trigger2 = animtime=-1&&(var(53)!=[110,115])
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3120

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=1
value = 3120
elem = 2

;~~~~飛行形態中
[state -2]
type = Explod
trigger1 = !time&&var(36)%2<1&&var(10)%8>=4
id = 6170
anim = 6175
pos = floor(180*const(size.xscale)),floor(-240*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state -2]
type = Explod
trigger1 = !time&&var(36)%4<2&&var(10)%8>=4
id = 6171
anim = 6175
pos = floor(0*const(size.xscale)),floor(-400*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state -2]
type = Explod
trigger1 = !time&&var(36)%8<4&&var(10)%8>=4
id = 6172
anim = 6175
pos = floor(-180*const(size.xscale)),floor(-240*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state 200]
type = VarSet
trigger1 = Time=0
var(10) = 0

[state 200]
type = VarSet
trigger1 = Time=0
fvar(9) = 0

[state 200]
type = VarSet
trigger1 = Time=0
fvar(10) = 0
;~~~~

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper&&(prevstateno!=[5000,5099])
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=11

;攻撃発生中のガードポイント
[state 200]
type = HitBy
trigger1 = var(32)&&Time<=1
value = ,AT

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+3100;stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;BASARAゲージ回復不能時間
[state 2000]
type = VarAdd
trigger1 = 1
var(9)=ifelse((var(9)=[1,999]),420-var(9),420)

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&AnimElem=3
value = SCA
time=40

[state 200]
type = pause
trigger1 = !IsHelper&&AnimElem=3
time = 40
movetime = 40

[state 200]
type = helper
trigger1 = !IsHelper&&AnimElem=3
id = 7560
stateno = 7560
pos = floor(-80*const(size.yscale)),floor(-180*const(size.yscale))
postype = P1
pausemovetime=40+999
ownpal = 1

[state -2]
type = poweradd
trigger1 = !IsHelper&&(prevstateno!=[5000,5099])&&AnimElem=3
value = -1000
persistent=0

[state 200]
type = NotHitBy
trigger1 = P2movetype=A&&inguarddist&&(prevstateno!=[5000,5099])&&!IsHelper&&AnimElem=3
value = SCA
time=40

[state 200]
type = NotHitBy
trigger1 = !IsHelper&&AnimElem=3,=40
value = SCA
time = 48

;援軍アシスト
[state 3000]
type = VarSet
triggerall = (var(40)=1||(var(40)=[5,6]))&&Power>=1000&&AnimElemTime(3)>=1&&AnimElemTime(28)<0
trigger1 = command="a"&&!var(59)
trigger2 = (enemynear,life=[80,140])&&animelemtime(20)>=0&&animelemtime(24)<=0&&ifelse(facing=1,helper(30000),pos x-enemynear,pos x,-(helper(30005),pos x-enemynear,pos x))>=(60+enemynear,const(size.air.front))
trigger2 = random%3=0&&var(59)
var(40) = 7
ignorehitpause=1

;~~~スーパーアーマー~~~
;経過時間
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(46) = 1

;経過時間
[state 1610]
type = varadd
trigger1 = time>0&&time>=var(48)&&!(var(52)>0&&movecontact)
var(46) = 1

;ダメージ
[state 1610]
type = LifeAdd
trigger1 = !time&&(prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)
value = -var(47)

;ヒットポーズ
[state 1610]
type = varset
trigger1 = !time&&(prevstateno!=5000&&prevstateno!=5010&&prevstateno!=5020&&prevstateno!=5070)
var(48) = 0

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=1&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[1,5]
value = 3120
elem = 1

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=2&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[6,11]
value = 3120
elem = 2

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=3&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[12,59]
value = 3120
elem = 3

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=4&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[60,62]
value = 3120
elem = 4

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=12&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=63
value = 3120
elem = 5

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=12&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=64
value = 3120
elem = 6

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=13&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=65
value = 3120
elem = 7

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=8&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=66
value = 3120
elem = 8

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=9&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=67
value = 3120
elem = 9

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=10&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=68
value = 3120
elem = 10

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=11&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=69
value = 3120
elem = 11

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=12&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=70
value = 3120
elem = 12

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=13&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=71
value = 3120
elem = 13

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=14&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=72
value = 3120
elem = 14

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=15&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=73
value = 3120
elem = 15

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=16&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=74
value = 3120
elem = 16

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=17&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=75
value = 3120
elem = 17

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=18&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=76
value = 3120
elem = 18

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=19&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=77
value = 3120
elem = 19

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=20&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=78
value = 3120
elem = 20

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=21&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=79
value = 3120
elem = 21

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=22&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=80
value = 3120
elem = 22

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=23&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=81
value = 3120
elem = 23

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=24&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=82
value = 3120
elem = 24

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=25&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=83
value = 3120
elem = 25

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=26&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=84
value = 3120
elem = 26

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=27&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=85
value = 3120
elem = 27

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=28&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=86
value = 3120
elem = 28

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=29&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=87
value = 3120
elem = 29

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=30&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[88,90]
value = 3120
elem = 30

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=31&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[91,93]
value = 3110
elem = 31

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=32&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[94,96]
value = 3110
elem = 32

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=33&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[97,99]
value = 3110
elem = 33

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=34&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[100,105]
value = 3110
elem = 34

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=35&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[106,127]
value = 3110
elem = 35

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=36&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[128,132]
value = 3110
elem = 36

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=37&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[133,137]
value = 3110
elem = 37

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=38&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[138,142]
value = 3110
elem = 38

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=39&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[143,147]
value = 3110
elem = 39

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=40&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[148,152]
value = 3110
elem = 40

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&AnimElemNo(0)!=41&&AnimElemNo(0)!=AnimElemNo(-1)&&var(46)=[153,157]
value = 3110
elem = 41

[state 1610]
type = ChangeAnim
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = anim
elem = AnimElemNo(0)

[state 1610]
type = PosFreeze
trigger1 = (prevstateno=5000||prevstateno=5010||prevstateno=5020||prevstateno=5070)&&Time<var(48)
value = 1

[state 200]
type = VarSet
trigger1 = !IsHelper&&!Time
fvar(8) = 0

[state 200]
type = VarSet
trigger1 = !IsHelper&&AnimElem=4,>0&&AnimElem=5,<0
fvar(8) = 8.0

[state 200]
type = VarSet
trigger1 = !IsHelper&&AnimElem=5,=0
fvar(8) = 36.0

[state 200]
type = VarSet
trigger1 = !IsHelper&&AnimElem=5,>0
fvar(8) = fvar(8)*.9

[state 200]
type = StatetypeSet
trigger1 = !IsHelper&&AnimElem=4,=0&&AnimElem=29,<0
physics = N

[state 200]
type = VelSet
trigger1 = !IsHelper&&AnimElem=4,>0
x = fvar(8)+ifelse(enemynear,backedgebodydist<=5||enemynear,frontedgebodydist<=5,fvar(5),0)

[state 6150]
type = Explod
trigger1 = AnimElem=5
trigger2 = AnimElem=9
trigger3 = AnimElem=13
trigger4 = AnimElem=17
trigger5 = AnimElem=21
trigger6 = AnimElem=25
id = 6115
anim=6115
pos = floor(-180*const(size.xscale)),floor(-60*const(size.yscale))
postype = p1
sprpriority = 4
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[State 40, 1]
type = PlaySND
trigger1 = AnimElem=7
trigger2 = AnimElem=11
trigger3 = AnimElem=15
trigger4 = AnimElem=19
trigger5 = AnimElem=23
trigger6 = AnimElem=27
value = 20,2
;channel = 10
;volume = 128

[State 40, 1]
type = PlaySND
trigger1 = AnimElem=34
value = 20,13
;channel = 10
;volume = 128

[state 190]
type = Explod
trigger1 = AnimElem=5
trigger2 = AnimElem=7
trigger3 = AnimElem=9
trigger4 = AnimElem=11
trigger5 = AnimElem=13
trigger6 = AnimElem=15
trigger7 = AnimElem=17
trigger8 = AnimElem=19
trigger9 = AnimElem=21
trigger10 = AnimElem=23
trigger11 = AnimElem=25
trigger12 = AnimElem=27
id = 6400
anim = 6400
pos = floor(190*const(size.xscale)),floor(-50*const(size.yscale));floor(300*const(size.xscale)),floor(-50*const(size.yscale))
postype = P1
sprpriority = 3
scale = const(size.xscale),const(size.yscale)
removetime=12;-1
removeongethit=1

[state 190]
type = Explod
trigger1 = AnimElem=6
trigger2 = AnimElem=8
trigger3 = AnimElem=10
trigger4 = AnimElem=12
trigger5 = AnimElem=14
trigger6 = AnimElem=16
trigger7 = AnimElem=18
trigger8 = AnimElem=20
trigger9 = AnimElem=22
trigger10 = AnimElem=24
trigger11 = AnimElem=26
trigger12 = AnimElem=28
id = 6400
anim = 6400
pos = floor(80*const(size.xscale)),floor(-50*const(size.yscale))
postype = P1
sprpriority = 3
scale = const(size.xscale),const(size.yscale)
removetime=12;-1
removeongethit=1

[state 190]
type = Explod
trigger1 = AnimElem=5
id = 6050
anim = 6050
pos = floor(45*const(size.xscale)),0
postype = P1
sprpriority = 3
bindtime=-1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 190]
type = Explod
trigger1 = AnimElem=5
id = 6050
anim = 6050
pos = floor(-150*const(size.xscale)),0
postype = P1
sprpriority = 3
bindtime=-1
scale = const(size.xscale)*2,const(size.yscale)*2

[state 190]
type = Helper
trigger1 = AnimElem=5
id = 6000
stateno = 6000
pos = floor(-35*const(size.xscale)),floor(-210*const(size.yscale))
postype = p1
sprpriority = -1
scale = const(size.xscale),const(size.yscale)

[state 190]
type = Helper
trigger1 = AnimElem=5
id = 6010
stateno = 6010
pos = floor(-35*const(size.xscale)),floor(-360*const(size.yscale))
postype = p1
sprpriority = -1
scale = const(size.xscale),const(size.yscale)

;KO
[state 3500]
type = explod
trigger1 = WinKO && !numexplod(60000)
id = 60000
anim = 90000
name="ko"
ownpal = 1
removetime=-1
facing=facing
ignorehitpause=1


;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = !time
var(52) = 0
;~~~~~~~~~~~~~~~~~~~~~~

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = AnimElem=5
trigger2 = AnimElem=6
trigger3 = AnimElem=8
trigger4 = AnimElem=9
trigger5 = AnimElem=10
trigger6 = AnimElem=12
trigger7 = AnimElem=13
trigger8 = AnimElem=14
trigger9 = AnimElem=16
trigger10 = AnimElem=17
trigger11 = AnimElem=18
trigger12 = AnimElem=20
trigger13 = AnimElem=21
trigger14 = AnimElem=22
trigger15 = AnimElem=24
trigger16 = AnimElem=25
trigger17 = AnimElem=26
trigger18 = AnimElem=28
trigger19 = AnimElem=29
damage = floor(ifelse(fvar(21),12*ifelse(fvar(1)<.25,.2,fvar(1)),8+.3)*fvar(2)*fvar(3)*fvar(4)*1.22)
ground.slidetime = 17+(P2statetype=C)+var(49)*7
ground.hittime = 17+(P2statetype=C)+var(49)*7
guard.slidetime = 15
guard.hittime = 15
pausetime = 2,12
ground.velocity = -6.0*const(size.xscale),-6.0*const(size.yscale)
guard.velocity = -13.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%2>=1||var(1)%8>=4,-11.0-.0012,-6.0*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,-6.0*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,9+random%2)
guardsound = s7000,4
getpower = 0,0
givepower = 0,0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-130*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = M

;Attack Lv.4
[state 200]
type = Hitdef
trigger1 = AnimElem=7
trigger2 = AnimElem=11
trigger3 = AnimElem=15
trigger4 = AnimElem=19
trigger5 = AnimElem=23
trigger6 = AnimElem=27
damage = floor(ifelse(fvar(21),24*ifelse(fvar(1)<.25,.25,fvar(1)),17)*fvar(2)*fvar(3)*fvar(4)*1.22),floor(ceil(ifelse(fvar(21),24,17)*fvar(3)*fvar(4)/ifelse(fvar(21),6,4))*1.22)
ground.slidetime = 17+(P2statetype=C)+var(49)*7
ground.hittime = 17+(P2statetype=C)+var(49)*7
guard.slidetime = 15
guard.hittime = 15
pausetime = 2,12
ground.velocity = -6.0*const(size.xscale),-6.0*const(size.yscale)
guard.velocity = -13.5*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%2>=1||var(1)%8>=4,-11.0-.0012,-6.0*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,-6.0*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,9+random%2)
guardsound = s7000,4
getpower = 0,0
givepower = 0,0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-130*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = M

;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = AnimElem=34
damage = floor(ifelse(fvar(21),72,52)*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*1.22),floor(ceil(ifelse(fvar(21),72,52)*fvar(3)*fvar(4)/ifelse(fvar(21),6,4))*1.22)
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 15,14
ground.velocity = -8.0*const(size.xscale),-10.0*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = ifelse(var(1)%2>=1||var(1)%8>=4,-11.0-.0014,-8.0*const(size.xscale)),ifelse(var(6)%10>0,var(6)%10*1.5,-10.0*const(size.yscale))
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,9+random%2)
guardsound = s7000,4
getpower = 0,0
givepower = 0,0
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-180*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = M

;==壁ダウンに
[state 920]
type = varadd
trigger1 = AnimElem=34,>=0&&(movehit=[1,5])&&numtarget&&!var(6) && var(1)%2<1
trigger1 = target,time=0
var(1) = 11-(var(1)%16>=8&&var(1)%8>=4)*4
ignorehitpause=1
persistent=0

[state 920]
type = TargetState
trigger1 = AnimElem=34,>=0&&(movehit=[1,5])&&numtarget&&!var(6)
trigger1 = target,time=0
value = 926
ignorehitpause=1
persistent=0

[state 200]
type = AttackDist
trigger1 = AnimElem=35
value = 0

;強制停止中に動かないように
[state -2]
type = PosFreeze
trigger1 = (AnimElem=3)
trigger2 = NumHelper(7560)
trigger2 = helper(7560),time<30
value = 1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
triggerall = movehit=1&&hitpausetime=1
trigger1 = (animelemtime(5)>0&&animelemtime(7)<=0)||(animelemtime(8)>0&&animelemtime(11)<=0)||(animelemtime(12)>0&&animelemtime(15)<=0)||(animelemtime(16)>0&&animelemtime(19)<=0)||(animelemtime(20)>0&&animelemtime(23)<=0)
trigger2 = (animelemtime(24)>0&&animelemtime(27)<=0)||(animelemtime(28)>0&&animelemtime(29)<=0)
fvar(15) = .00005*floor(ifelse(fvar(21),12*ifelse(fvar(1)<.25,.2,fvar(1)),8+.3)*fvar(2)*fvar(3)*fvar(4)*1.22)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
triggerall = movehit=1&&hitpausetime=1
trigger1 = (animelemtime(7)>0&&animelemtime(8)<=0)||(animelemtime(11)>0&&animelemtime(12)<=0)||(animelemtime(15)>0&&animelemtime(16)<=0)||(animelemtime(19)>0&&animelemtime(20)<=0)
trigger2 = (animelemtime(23)>0&&animelemtime(24)<=0)||(animelemtime(27)>0&&animelemtime(28)<=0)
fvar(15) = .00005*floor(ifelse(fvar(21),24*ifelse(fvar(1)<.25,.25,fvar(1)),17)*fvar(2)*fvar(3)*fvar(4)*1.22)
ignorehitpause=1

;ヒットによる増加(スタイリッシュポイント)
[state -2]
type = varadd
triggerall = movehit=1&&hitpausetime=ifelse(AnimElem=34,>=0,14,1)
trigger1 = (animelemtime(34)>0&&animelemtime(35)<=0)
fvar(15) = .00005*floor(ifelse(fvar(21),72,52)*ifelse(fvar(1)<.25,.25,fvar(1))*fvar(2)*fvar(3)*fvar(4)*1.22)
ignorehitpause=1

[state -2]
type = varset
trigger1 = movehit=1
fvar(14) = fvar(1)*fvar(2)*fvar(3)*fvar(4)
ignorehitpause=1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=5
trigger2 = AnimElem=6
trigger3 = AnimElem=7
trigger4 = AnimElem=8
trigger5 = AnimElem=9
trigger6 = AnimElem=10
trigger7 = AnimElem=11
trigger8 = AnimElem=12
trigger9 = AnimElem=13
trigger10 = AnimElem=14
trigger11 = AnimElem=15
trigger12 = AnimElem=16
trigger13 = AnimElem=17
trigger14 = AnimElem=18
trigger15 = AnimElem=19
trigger16 = AnimElem=20
trigger17 = AnimElem=21
trigger18 = AnimElem=22
trigger19 = AnimElem=23
trigger20 = AnimElem=24
trigger21 = AnimElem=25
trigger22 = AnimElem=26
trigger23 = AnimElem=27
trigger24 = AnimElem=28
trigger25 = AnimElem=29
trigger26 = AnimElem=34
var(16) = 10+random%6

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=5,>=0&&AnimElem=35,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=5
var(18) = floor(-130*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=34
var(18) = floor(-180*const(size.yscale))

;・・・・自分側ヒットバック・・・・
;ヒットバック量取得
[state -2]
type = varset
triggerall = animelemtime(34)>=0&&(movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = target,time=0
fvar(5) = ifelse(movehit,-15.0*1.5,-15.0)*const(size.xscale)
ignorehitpause=1

;ヒットバック時間取得
[state -2]
type = varset
triggerall = animelemtime(34)>=0&&(movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(6) = ifelse(moveguarded,15,17+(P2statetype=C))
ignorehitpause=1

;ヒットポーズ取得
[state -2]
type = varset
triggerall = animelemtime(34)>=0&&(movecontact=[1,2])&&numtarget&&var(1)%4<2
trigger1 = (var(1)%2<1&&var(1)%8<4&&target,time=0)||((var(1)%2>=1||var(1)%8>=4)&&target,time=1)
fvar(7) = (14-(var(1)%2>=1||var(1)%8>=4))*ifelse(moveguarded,-1,1)
ignorehitpause=1
persistent=0
;・・・・・・・・

[state 200]
type = VarSet
trigger1 = AnimTime=-1&&var(12)
var(12) = -1

[state 200]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 200]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;戦国最強・出力最大
[statedef 3500]
type = S
movetype=A
physics = S
ctrl = 0
velset = ifelse(fvar(9),fvar(9)*ifelse(P2dist X<0&&(prevstateno=52||(prevstateno=[100,1999])),-1.00,1.00),0),0

[state 200]
type = VarSet
trigger1 = !time&&P2dist X<0&&(prevstateno=52||((prevstateno=[100,1999])&&fvar(10)<=0))
fvar(9) = -fvar(9)

[state 200]
type = Turn
trigger1 = !time&&P2dist X<0&&(prevstateno=52||(prevstateno=[200,1999]))

;速度取得
[state -2]
type = varset
trigger1 = !time
fvar(8) = 0
ignorehitpause=1

;先行入力リセット
[state 1100]
type = varset
trigger1 = !time
var(53) = 0

[state 200]
type = ChangeAnim
trigger1 = Time=0&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
value = 3500

[state 200]
type = ChangeAnim
trigger1 = Time=0&&AnimElemNo(0)=4
value = 3500
elem = 5

;~~~~攻撃形態中
[state 1050]
type = varset
trigger1 = !time&&var(10)
var(7) = -1

[state -2]
type = Explod
trigger1 = !time&&var(36)%2<1&&var(10)&&(var(40)=-2||var(40)>0)
id = 6170
anim = 6175
pos = floor(180*const(size.xscale)),floor(-240*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state -2]
type = Explod
trigger1 = !time&&var(36)%4<2&&var(10)&&(var(40)=-2||var(40)>0) && floor(var(43)/1000)>=100
id = 6171
anim = 6175
pos = floor(0*const(size.xscale)),floor(-400*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state -2]
type = Explod
trigger1 = !time&&var(36)%8<4&&var(10)&&(var(40)=-2||var(40)>0) && floor(var(43)/1000)>=50
id = 6172
anim = 6175
pos = floor(-180*const(size.xscale)),floor(-240*const(size.yscale))
postype = p1
ownpal = 1
ignorehitpause=1
scale = const(size.xscale),const(size.yscale)

[state 200]
type = VarSet
trigger1 = Time=0
var(10) = 0
;~~~~

[state 200]
type = VarSet
trigger1 = Time=0&&!IsHelper
var(34) = ifelse(var(32)&&!(var(34)=stateno&&((prevstateno=[130,132])||(prevstateno=150||prevstateno=152))),stateno,0)

;ガード移行に1F要するため
[state 200]
type = NotHitBy
trigger1 = Time=0&&var(34)
value = ,AA,AP

[state 200]
type = VarSet
trigger1 = Time=0&&var(34)
var(35)=38

[state 200]
type = Helper
trigger1 = Time=0&&var(34)
id = 20000
stateno=stateno
helpertype = Player
pos = 1,0
postype = p1
pausemovetime=54+8

;下段ガードポイント用
[state 200]
type = Helper
trigger1 = Time=0&&var(34)&&var(32)=2
id = 21000
stateno=130
helpertype = Normal
pos = 0,0
postype = p1
pausemovetime=54+8

[state 200]
type = ChangeState
trigger1 = Time=0&&var(34)
value = ifelse(var(32)=2,131,130)

[state 200]
type = NotHitBy
trigger1 = IsHelper
value = SCA

[state 200]
type = AssertSpecial
trigger1 = IsHelper
flag = invisible

[state 200]
type = ChangeAnim
trigger1 = IsHelper
value = 20000+stateno

[state 200]
type = BindtoRoot
trigger1 = IsHelper
pos = 1,0

[state 200]
type = DestroySelf
trigger1 = IsHelper
trigger1 = !root,var(34)

;一撃BASARA技使用不能時間
[state 195]
type = VarSet
trigger1 = !Time
var(45) = -1

[state 200]
type = pause
trigger1 = !IsHelper&&time>1&&AnimElem=4
time = 54
movetime = 54

[state 200]
type = NotHitBy
trigger1 = P2movetype=A&&inguarddist&&(prevstateno!=[5000,5099])&&!IsHelper&&AnimElem=4
value = SCA
time=54

[state 200]
type = helper
trigger1 = !IsHelper&&time>1&&AnimElem=4
id = 7580
stateno = 7580
pos = 0,0
postype = P1
pausemovetime=54+999

[state 195]
type = EnvShake
trigger1 = AnimElem=11
ampl = 4
time = 16

[state 200]
type = HitAdd
trigger1 = !IsHelper
trigger1 = movehit=1&&var(19)>=2
trigger2 = IsHelper
trigger2 = movehit=1&&root,var(19)>=2
value = 1
ignorehitpause=1
persistent=0

[state 190]
type = PlaySND
trigger1 = AnimElem=11
value = 20,12
;channel = 10
;volume = 128

[state 3510]
type = Explod
trigger1 = AnimElem=11
anim = 6700
id = 6700
pos = 0,floor(60*const(size.yscale))
postype = p1
sprpriority = 4
removeongethit=1
scale = const(size.xscale)*4,const(size.yscale)*4

;~~~自分側のhitpause作成~~
[state 250]
type = varset
trigger1 = time=0
var(52) = 100

[state 250]
type = varadd
trigger1 = movecontact&&var(52)>=0
var(52) = -1

[state 250]
type = varset
trigger1 = movecontact=1
var(52) = 15

[state 250]
type = null;varset
trigger1 = movecontact&&((enemynear,prevstateno=[5000,5099])||(enemynear,prevstateno=[150,155]))&&P2movetype!=H&&var(52)>0
var(52) = 0

[state 250]
type = ChangeAnim
trigger1 = movecontact && var(52)>var(54) && animelemtime(12)>0
value = anim
elem = ifelse(AnimElemNo(0)=var(47),AnimElemNo(0),AnimElemNo(-1))

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(47) = AnimElemNo(0)

[state 250]
type = varset
trigger1 = (var(52)<=0||var(52)=100)
var(54) = AnimElemTime(AnimElemNo(0))

[state 250]
type = PosFreeze
trigger1 = var(52)>0&&movecontact
value = 1
;~~~~~~~~~~~~~~~~~~~~~~

;>>>>>>>>>>><<<<<<<<<<<
;~~コマンド先行入力~~
[state 250]
type = varset
trigger1 = time=0&&var(53)!=1090&&var(53)!=1390&&!(((prevstateno=[130,132])||(prevstateno=150||prevstateno=152)))
trigger2 = animtime=-1&&(var(53)!=[110,115])&&var(53)!=1090&&var(53)!=1390
var(53) = 0

;~~~~~~~~~~~

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = var(52)<=0||var(52)=100
trigger1 = AnimElem=11
damage = 1
kill = 0
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = 0*const(size.xscale),-22*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = 0*const(size.xscale),-22*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-80*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = MAFD
guardflag = MA

;Attack Lv.5
[state 200]
type = Hitdef
triggerall = var(52)<=0||var(52)=100
trigger1 = AnimElem=12
damage = 1
kill = 0
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,14
ground.velocity = 0*const(size.xscale),-22*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = 0*const(size.xscale),-22*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,2)
guardsound = s7000,2
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-40*const(size.xscale))
animtype = hard
ground.type = High
attr = S,HA
hitflag = M
guardflag = MA

[state 3500]
type = NotHitBy
triggerall = roundstate=2
trigger1 = Movehit
value = SCA
ignorehitpause=1

;相手を固定
[state 6710]
type = targetstate
triggerall = roundstate=2
trigger1 = Movehit=1
value = 3516
ignorehitpause=1

;ヒット後の演出へ
[state 3500]
type = Pause
triggerall = roundstate=2
trigger1 = Movehit=1
time = 0
movetime=0

;ヒット後の演出へ
[state 3500]
type = ChangeState
triggerall = roundstate=2
trigger1 = Movehit&&AnimElemTime(13)>=0
value = 3510

[state 200]
type = AttackDist
trigger1 = AnimElem=13
value = 0

;強制停止中に動かないように
[state -2]
type = PosFreeze
trigger1 = (AnimElem=4)
trigger2 = NumHelper(7580)
trigger2 = helper(7580),time<30
value = 1

;◇◇ヒットスパーク◇◇
[state 240]
type = VarSet
trigger1 = AnimElem=11
trigger2 = AnimElem=12
var(16) = 10+random%6

;X座標
[state 240]
type = VarSet
trigger1 = AnimElem=11,>=0&&AnimElem=13,<0
var(17) = floor(P2dist X)+ifelse((P2dist X=[1,60]),10,-10)

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=11&&AnimElem=12,<0
var(18) = floor(-80*const(size.yscale))

;Y座標
[state 240]
type = VarSet
trigger1 = AnimElem=12&&AnimElem=13,<0
var(18) = floor(-40*const(size.yscale))

[state 195]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 195]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;一撃BASARA技ヒット後
[statedef 3510]
type = S
movetype=A
physics = S
ctrl = 0
velset = 0,0

[state 3500]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause=1

[state 3510]
type = ChangeAnim
trigger1 = AnimElemTime(13)>=6&&AnimElemTime(14)<0 && Anim=3500
value = 3500
elem = 14

[state 3510]
type = ChangeAnim
trigger1 = AnimTime=-1 && Anim=3500
value = 3510

[state 190]
type = ScreenBound
trigger1 = Anim=3510 && animelem=1,>=0
trigger1 = numhelper(10000)
value = 0
movecamera = (animelemtime(3)>=32),(animelemtime(3)>=32)

[state 190]
type = PosSet
trigger1 = Anim=3510 && animelem=1
trigger1 = numhelper(10000)
x = floor(fvar(27))-ifelse(teamside=2,-80,80)

[state 190]
type = TargetBind
trigger1 = Anim=3510 && animelem=1
trigger1 = numhelper(10000) && numtarget=1
pos = 140,target,pos y+25

[state 190]
type = TargetBind
trigger1 = Anim=3510 && animelem=1
trigger1 = numhelper(10000) && numtarget>1
pos = 140,enemynear,pos y+25

;ダウン中の槍~~~
[state 190]
type = Explod
trigger1 = Anim=3510 && animelem=1
id = 25110
anim = 25110
pos = floor(0*const(size.xscale)),floor(-100*const(size.yscale))
postype = P1
sprpriority = 4
scale = const(size.xscale),const(size.yscale)

[state 190]
type = Explod
trigger1 = Anim=3510 && animelem=1
id = 25111
anim = 25111
pos = floor(0*const(size.xscale)),floor(-100*const(size.yscale))
postype = P1
sprpriority = 4
scale = const(size.xscale),const(size.yscale)

;一撃BASARA技成功後
[state 195]
type = VarSet
trigger1 = !Time
var(45) = 10000
ignorehitpause=1

[state 801]
type = AssertSpecial
trigger1 = roundstate<3
flag = NoMusic
flag2 = TimerFreeze

[state 801]
type = AssertSpecial
trigger1 = roundstate>=3
flag = NoMusic

[state 801]
type = PlaySND
trigger1 = !Time
value = 7900,0
loop = 1
channel = 30
lowpriority = 1

[state 3510]
type = Statetypeset
trigger1 = Anim=3510 && AnimElem=1
statetype=A
physics = N

[state 3510]
type = Posset
trigger1 = Anim=3510 && AnimElem=1
y = -25

[state 3510]
type = Helper
trigger1 = AnimElemTime(14)>=0 && Anim=3500
id  = 6750
stateno=6750
pos = 160,240
postype = left
scale = const(size.xscale),const(size.yscale)
persistent=0

[state 3510]
type = PlaySND
trigger1 = Anim=3510 && AnimElem=3,<20
value = 20,21
channel = 10
persisntent=20

[state 3510]
type = StopSND
trigger1 = Anim=3510 && AnimElem=4
channel = 10

[state 3510]
type = Explod
trigger1 = Anim=3510 && AnimElem=1,=5
anim = 3550
id = 3550
pos = floor(-15*const(size.xscale)),floor(-65*const(size.yscale))
postype = p1
ownpal = 1
scale = const(size.xscale),const(size.yscale)

[state 3510]
type = RemoveExplod
trigger1 = Anim=3510 && AnimElem=4
id = 3550

[state 3510]
type = Helper
trigger1 = Anim=3510 && AnimElem=1,=5
stateno=6710
id = 6710
pos = 0,0
postype = p1
ownpal = 1

[state 3510]
type = Helper
trigger1 = Anim=3510 && AnimElem=1,=5
stateno=6720
id = 6720
pos = floor(-35*const(size.xscale)),floor(-275*const(size.yscale))
postype = p1
ownpal = 1

;BASARA K.O.
[state 3510]
type = Helper
trigger1 = Anim=3510 && AnimElem=3,=23
id  = 8850
stateno=8850
pos = 0,0
postype = left
scale = const(size.xscale),const(size.yscale)
persistent=0
pausemovetime=999
ignorehitpause=1

[state 3510]
type = veladd
trigger1 = Anim=3510 && AnimElem=5,>=0&&animelem=6,<0
y = .25

[state 3510]
type = Statetypeset
trigger1 = Anim=3510 && AnimElem=6
statetype=S
physics = S

[state 3510]
type = velset
trigger1 = Anim=3510 && AnimElem=6
y = 0

[state 3510]
type = Posset
trigger1 = Anim=3510 && AnimElem=6
y = 0

[State 40, 1]
type = PlaySND
trigger1 = Anim=3510 && AnimElem=6
value = 20,4
;channel = 10

[state 3510]
type = AttackDist
trigger1 = 1
value = 0

[state 195]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 195]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

;一撃BASARA技ヒット後（相手）
[statedef 3516]
type = A
movetype=H
physics = N
ctrl = 0
velset = gethitvar(xvel),gethitvar(yvel)

[state 3516]
type = ChangeAnim2
trigger1 = !Time
value = 3516

[state 3516]
type = PosFreeze
trigger1 = !HitShakeover
value = 1

[state 3516]
type = NotHitBy
trigger1 = Time<48
value = SCA

[state 3516]
type = VelAdd
trigger1 = HitShakeover
y = gethitvar(yaccel)

[state 3516]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,1

[state 3516]
type = SelfState
trigger1 = HitShakeover && Time && Vel Y>0 && Pos Y>=0
value = 5100

;一撃BASARA技ヒット後（相手）
[statedef 3517]
type = A
movetype=H
physics = N
ctrl = 0
velset = 0,0

[state 3516]
type = ChangeAnim2
trigger1 = !Time
value = 3517

[state 3516]
type = NotHitBy
trigger1 = 1
value = SCA

[state 3516]
type = VelSet
trigger1 = gethitvar(hitshaketime)
x = 0

[state 3516]
type = VelSet
trigger1 = Time=[12,59]
x = -10.0*(time%3=0)

[state 3516]
type = VelSet
trigger1 = Time>=60
x = -20.0

[state 3516]
type = LifeSet
trigger1 = Time=60
value = 0

[state 3516]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3516]
type = VelSet
trigger1 = Time>=102
x = 0

[state 3516]
type = PosSet
trigger1 = Time>=112
y = 0

[state 3516]
type = SelfState
trigger1 = Time>=132 && alive
value = 5110

[state 3516]
type = ChangeState
trigger1 = Time>=132 && !alive && (enemynear(numenemy-1),stateno=0&&enemynear(0),stateno=0)
trigger2 = Time>=132 && IsHelper
value = 5150

;一撃BASARA技ヒット後（相手）
[statedef 3518]
type = L
movetype=H
physics = N
ctrl = 0
velset = 0,0

[state 3516]
type = ChangeAnim2
trigger1 = !Time
value = 3516

[state 3516]
type = AssertSpecial
trigger1 = 1
flag = invisible

[state 3516]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3516]
type = StatetypeSet
trigger1 = (Time=[1,80])
movetype=I

[state 3516]
type = StatetypeSet
trigger1 = Time>=80
movetype=H

[state 3516]
type = ChangeState
trigger1 = Time>=80 && !alive && (enemynear(numenemy-1),stateno=0&&enemynear(0),stateno=0) && roundstate=3
value = 5150

;レーザー
[statedef 6710]
type = A
physics = N
movetype = A
anim = 6715

[state 6720]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6710]
type = Explod
trigger1 = !Time
anim = 6710
id = 6710
pos = floor(118*const(size.xscale)),floor(-400*const(size.xscale))
postype = p1
scale = const(size.xscale)*6,const(size.yscale)
sprpriority = 4

[state 6710]
type = Explod
trigger1 = !Time
anim = 6711
id = 6715
pos = floor(-10*const(size.xscale)),floor(-400*const(size.xscale))
postype = p1
scale = const(size.xscale),const(size.yscale)
sprpriority = 4

[state 6710]
type = Explod;null;Explod
trigger1 = !Time
anim = 6710
id = 6711
pos = floor(38*const(size.xscale)),floor(-300*const(size.xscale))
postype = p1
scale = const(size.xscale)*6,const(size.yscale)
sprpriority = 4

[state 6710]
type = Explod;null;Explod
trigger1 = !Time
anim = 6711
id = 6716
pos = floor(-90*const(size.xscale)),floor(-300*const(size.xscale))
postype = p1
scale = const(size.xscale),const(size.yscale)
sprpriority = 4

[state 6710]
type = Explod;null;Explod
trigger1 = !Time
anim = 6710
id = 6712
pos = floor(38*const(size.xscale)),floor(-180*const(size.xscale))
postype = p1
scale = const(size.xscale)*6,const(size.yscale)
sprpriority = 4

[state 6710]
type = Explod;null;Explod
trigger1 = !Time
anim = 6711
id = 6717
pos = floor(-90*const(size.xscale)),floor(-180*const(size.xscale))
postype = p1
scale = const(size.xscale),const(size.yscale)
sprpriority = 4

[state 6710]
type = Explod;null;Explod
trigger1 = !Time
anim = 6710
id = 6713
pos = floor(118*const(size.xscale)),floor(-120*const(size.xscale))
postype = p1
scale = const(size.xscale)*6,const(size.yscale)
sprpriority = 4

[state 6710]
type = Explod;null;Explod
trigger1 = !Time
anim = 6711
id = 6718
pos = floor(-10*const(size.xscale)),floor(-120*const(size.xscale))
postype = p1
scale = const(size.xscale),const(size.yscale)
sprpriority = 4

[state 200]
type = ModifyExplod
trigger1 = time>=76
id = 6710
scale = const(size.xscale)*6,const(size.yscale)-.0175*(time-76)

[state 200]
type = ModifyExplod
trigger1 = time>=76
id = 6711
scale = const(size.xscale)*6,const(size.yscale)-.0175*(time-76)

[state 200]
type = ModifyExplod
trigger1 = time>=76
id = 6712
scale = const(size.xscale)*6,const(size.yscale)-.0175*(time-76)

[state 200]
type = ModifyExplod
trigger1 = time>=76
id = 6713
scale = const(size.xscale)*6,const(size.yscale)-.0175*(time-76)

[state 200]
type = ModifyExplod
trigger1 = time>=76
id = 6715
scale = const(size.xscale),const(size.yscale)-.0175*(time-76)

[state 200]
type = ModifyExplod
trigger1 = time>=76
id = 6716
scale = const(size.xscale),const(size.yscale)-.0175*(time-76)

[state 200]
type = ModifyExplod
trigger1 = time>=76
id = 6717
scale = const(size.xscale),const(size.yscale)-.0175*(time-76)

[state 200]
type = ModifyExplod
trigger1 = time>=76
id = 6718
scale = const(size.xscale),const(size.yscale)-.0175*(time-76)

;Attack Lv.5
[state 200]
type = Hitdef
trigger1 = !Time
damage = 1
kill = 0
ground.slidetime = 20+(P2statetype=C)+var(49)*7
ground.hittime = 20+(P2statetype=C)+var(49)*7
guard.slidetime = 18
guard.hittime = 18
pausetime = 1,12
ground.velocity = 0*const(size.xscale),-18*const(size.yscale)
guard.velocity = -15.0*const(size.xscale)
ground.cornerpush.veloff = 0
air.velocity = 0*const(size.xscale),-18*const(size.yscale)
airguard.velocity = -6*const(size.xscale),-2*const(size.yscale)
air.cornerpush.veloff = 0
yaccel = .9*const(size.yscale)
fall.recover = 0
hitsound = s7100,ifelse(!(enemynear,teammode=simul)&&enemynear,name="Honda Tadakatsu",999,3)
guardsound = s7000,3
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1
sparkno = -1;0
guard.sparkno = -1;40
sparkxy = ifelse(P2bodydist X<20,-20,-10),floor(-260*const(size.xscale))
animtype = up
ground.type = High
attr = A,HP
hitflag = MAFD
p2facing=1
palfx.time=32+14
palfx.sinadd = 32,0,32,4
palfx.color = 0
palfx.add = 64,0,128
palfx.mul = 256,256,256

;相手を画面外へ飛ばす
[state 6710]
type = targetstate
trigger1 = movehit=1
value = 3517
persistent=0

[state 6710]
type = RemoveExplod
trigger1 = Time=106

[state 6710]
type = DestroySelf
trigger1 = Time=106


;周り
[statedef 6720]
type = A
physics = N
movetype = A
anim = 6720
sprpriority = 3

[state 6720]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[state 6720]
type = AngleDraw
trigger1 = 1
value = (time%16)*90
scale = 4,2

[state 6720]
type = Trans
trigger1 = 1
trans = add

[state 6710]
type = DestroySelf
trigger1 = Time=116

;一撃BASARA技発動準備
[statedef 2900]
type = S
movetype=I
physics = S
ctrl = 0
velset = 0,0
anim = 2900
movehitpersist=1

;援軍ヒットキャンセル
[state 100]
type = Helper
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
id = 7710
stateno = 7710
pos = 0,const(size.mid.pos.y)
postype = P1
pausemovetime=20
supermovetime=20
ignorehitpause=1

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
fvar(5) = 0

;援軍ヒットキャンセル
[state 100]
type = VarSet
trigger1 = !time&&var(15)>0&&(prevstateno=[199,1999])&&(prevstateno!=[800,999])
trigger1 = !(movecontact&&((prevstateno=[200,220])||(prevstateno=[400,420])))
var(15) = 0

;援軍ヒットキャンセル
[state 100]
type = MoveHitReset
trigger1 = !time

;一撃BASARA技発動可能時間
[state 195]
type = VarSet
trigger1 = AnimElem=14
var(45) = 600+ifelse(Life*100/const(data.life)<40,600,(100-Life*100/const(data.life))*10)+1

[state 1050]
type = playsnd
trigger1 = AnimElem=14
value = 7400,0
;channel = 10
;volume = 128

[state 195]
type = PlaySND
trigger1 = AnimElem=14
value = 20,0
;channel = 10
;volume = 128

[state 195]
type = EnvShake
trigger1 = AnimElem=14
ampl = 4
time = 16

[state 195]
type = CtrlSet
trigger1 = AnimTime=-1
value = 1

[state 195]
type = ChangeState
trigger1 = AnimTime=0
value = 0
ctrl = 1

[statedef 6750]
type = S
ctrl = 0
velset = 0,0
anim = 90000

[state 801]
type = AssertSpecial
trigger1 = roundstate<3
flag = NoMusic
flag2 = nobg
flag3 = nofg

[state 801]
type = AssertSpecial
trigger1 = roundstate>=3
flag = NoMusic

[state 6750]
type = AllPalFX
trigger1 = time<25
add = -10*time,-10*time,-10*time
time=1

[state 6750]
type = AllPalFX
trigger1 = time=[26,49]
add = -255,-255,-255
time=1

[state 6750]
type = AllPalFX
trigger1 = time=[50,81]
add = -255+8*(time-50),-255+8*(time-50),-255+8*(time-50)
time=1

[state 6750]
type = AllPalFX
trigger1 = time>=98
add = 8*(time-98),8*(time-98),8*(time-98)
time=1

[state 6750]
type = AllPalFX
trigger1 = time>=128
add = 255,255,255
time=1

[state 3510]
type = Pause
trigger1 = Time=24
time = 115
movetime = 115

[state 3510]
type = Explod
trigger1 = Time=50
anim = 6753
id = 6753
pos = 0,0
postype = left
ownpal = 1
ontop = 1
bindtime = -1
pausemovetime=80
scale = 320,240

[state 3510]
type = Explod
trigger1 = Time=50
anim = 6750
id = 6750
pos = 160,240
postype = left
ownpal = 1
ontop = 1
sprpriority = 99
bindtime = -1
pausemovetime=80
scale = const(size.xscale),const(size.yscale)

[state 3510]
type = Explod
trigger1 = Time=50
anim = 6751
id = 6751
pos = 160,240
postype = left
ownpal = 1
ontop = 1
sprpriority = 99
bindtime = -1
pausemovetime=80
scale = const(size.xscale),const(size.yscale)

[state 3510]
type = Explod
trigger1 = Time=50
anim = 6752
id = 6752
pos = 160,240
postype = left
ownpal = 1
ontop = 1
sprpriority = 99
bindtime = -1
pausemovetime=80
scale = const(size.xscale),const(size.yscale)

;眼光
[state 190]
type = Explod
trigger1 = Time=90
id = 6807
anim = 6807
pos = 145,177
postype = left
ownpal = 1
ontop = 1
sprpriority = 99
bindtime = -1
pausemovetime=30
scale = const(size.xscale),const(size.yscale)

[state -2]
type = RemoveExplod
trigger1 = Time=140

[state -2]
type = DestroySelf
trigger1 = Time=140


;=====ブーストゲージ
[statedef 8900]
ctrl = 0
anim = 90000

[state 8900]
type = varset
trigger1 = var(20)=20
var(20) = 0

[state 8900]
type = varadd
trigger1 = var(20)>0
var(20) = -1

[state 8900]
type = PlaySND
trigger1 = Root,var(37)>=2400/ifelse(root,var(40)!=0&&root,var(40)>-10,2,1)&&var(37)<root,var(37)&&!var(20)
trigger1 = var(20):=12
trigger2 = (Root,var(37)=[480/ifelse(root,var(40)!=0&&root,var(40)>-10,2,1),480/ifelse(root,var(40)!=0&&root,var(40)>-10,2,1)+1])&&var(37)<root,var(37)&&!var(20)
trigger2 = var(20):=32
value = 20,17
channel = 10
abspan = 1

[state 8900]
type = RemoveExplod
trigger1 = root,var(37)=0 && var(37)<root,var(37)
id = 8910

[state 8900]
type = RemoveExplod
trigger1 = root,var(37)=0 && var(37)<root,var(37)
id = 8900

[state 8900]
type = RemoveExplod
trigger1 = root,var(37)<0 && var(37)>root,var(37)
id = 8910

[state 8900]
type = RemoveExplod
trigger1 = root,var(37)<0 && var(37)>root,var(37)
id = 8900

[state 8900]
type = VarSet
trigger1 = 1
var(37) = root,var(37)

[state 8900]
type = Explod
trigger1 = !NumExplod(8910)
id = 8910
anim = 8910
pos = 90+(teamside=2)*120+floor(root,fvar(17)),218+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .6,.5
sprpriority = 5
bindtime = -1
ownpal = 0
ontop = 1

[state 8000]
type = ModifyExplod
trigger1 = NumExplod(8910)&&root,var(37)>=0
id = 8910
scale = Root,var(37)*1.0*.6/ifelse(root,var(40)!=0&&root,var(40)>-10,1200,2400),.5*2
pos = 90+(teamside=2)*120+floor(root,fvar(17)),218-3+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back

[state 8000]
type = ModifyExplod
trigger1 = NumExplod(8910)&&Root,var(37)<0
id = 8910
scale = -(Root,var(37)+ifelse(Root,var(37)<-ifelse(root,var(40)!=0&&root,var(40)>-10,150,300),ifelse(root,var(40)!=0&&root,var(40)>-10,150,300),0))*1.0*.6/ifelse(root,var(40)!=0&&root,var(40)>-10,150,300),.5*2
pos = 90+(teamside=2)*120+floor(root,fvar(17)),218-3+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back

[state 8900]
type = PalFX
trigger1 = root,var(37)<2400/ifelse(root,var(40)!=0&&root,var(40)>-10,2,1)
add = 0,0,-224
time = 1

[state 8900]
type = PalFX
trigger1 = root,var(37)<480/ifelse(root,var(40)!=0&&root,var(40)>-10,2,1)
add = -224,-128,0
time = 1

[state 8900]
type = PalFX
trigger1 = root,var(10)>0||root,var(11)>0
add = -224,0,-224
time = 1

[state 8900]
type = PalFX
trigger1 = root,var(37)<0
add = 0,-224,-224
time = 1

[state 8900]
type = Trans
trigger1 = root,var(37)<0
trans = add

[state 8900]
type = Explod
trigger1 = !NumExplod(8900) && (root,var(37)>=0||root,var(40)<=-1000)
id = 8900
anim = 8900
pos = 110+(teamside=2)*120+floor(root,fvar(17)),218-2+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .6,.5
sprpriority = 5
bindtime = -1
ownpal = 1
ontop = 1

[state 8900]
type = Explod
trigger1 = !NumExplod(8900) && root,var(37)<0 && !(root,var(40)<=-1000)
id = 8900
anim = 8900
pos = 110+(teamside=2)*120+floor(root,fvar(17)),218-2+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .6,.5
sprpriority = 5
bindtime = -1
ownpal = 0
ontop = 1

[state 8900]
type = Explod
trigger1 = !NumExplod(8902)
id = 8902
anim = 8902
pos = 110+(teamside=2)*120+floor(root,fvar(17)),218-4+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 6
bindtime = -1
ownpal = 1
ontop = 1

[state 8900]
type = Explod
trigger1 = !NumExplod(8903)
id = 8903
anim = 8903
pos = 110+(teamside=2)*120+floor(root,fvar(17)),218-13+floor(1000*ifelse(((root,fvar(17)-floor(root,fvar(17)))=(0,.001)),-1000,1)*(root,fvar(17)-floor(root,fvar(17))))
postype = back
removetime=-1
scale = .5,.5
sprpriority = 7
bindtime = -1
ownpal = 1
ontop = 1

[state 8900]
type = ModifyExplod
trigger1 = root,var(40)<=-1000
id = 8910
scale = 0,0

[state 8900]
type = ModifyExplod
trigger1 = root,var(40)<=-1000
id = 8900
scale = 0,0

[state 8900]
type = ModifyExplod
trigger1 = root,var(40)<=-1000
id = 8902
scale = 0,0

[state 8900]
type = ModifyExplod
trigger1 = root,var(40)<=-1000
id = 8903
scale = 0,0

[state 8900]
type = ModifyExplod
trigger1 = root,var(40)>-1000
id = 8900
scale = .6,.5

[state 8900]
type = ModifyExplod
trigger1 = root,var(40)>-1000
id = 8902
scale = (Root,var(37)>=2400/ifelse(root,var(40)!=0&&root,var(40)>-10,2,1))*.5,(Root,var(37)>=2400/ifelse(root,var(40)!=0&&root,var(40)>-10,2,1))*.5

[state 8900]
type = ModifyExplod
trigger1 = root,var(40)>-1000
id = 8903
scale = (Root,var(37)>=2400/ifelse(root,var(40)!=0&&root,var(40)>-10,2,1))*.5,(Root,var(37)>=2400/ifelse(root,var(40)!=0&&root,var(40)>-10,2,1))*.5

